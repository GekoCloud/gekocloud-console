(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{2509:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(564),r=n(a(3942)),o=function(){return(0,l.renderRoutes)(r.default)};t.default=o},2885:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(13)),r=n(a(14)),o=n(a(17)),u=n(a(16)),s=n(a(18)),i=n(a(0)),c=n(a(1)),d=n(a(3)),p=n(a(3944)),f=function(e){function t(){return(0,l.default)(this,t),(0,o.default)(this,(0,u.default)(t).apply(this,arguments))}return(0,s.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props,t=e.children,a=e.className;return i.default.createElement("div",{className:p.default.banner},i.default.createElement("div",{className:p.default.inner},i.default.createElement("div",{className:p.default.innerContent},i.default.createElement("div",{className:(0,d.default)(p.default.shape,p.default.shape_1)}),i.default.createElement("div",{className:(0,d.default)(p.default.shape,p.default.shape_3)}),i.default.createElement("div",{className:(0,d.default)(p.default.shape,p.default.shape_4)}),this.isAppsPage?i.default.createElement(i.default.Fragment,null,i.default.createElement("div",{className:p.default.leftShape_1}),i.default.createElement("div",{className:p.default.leftShape_2})):i.default.createElement("div",{className:(0,d.default)(p.default.shape,p.default.shape_2)}),i.default.createElement("div",{className:(0,d.default)(p.default.cont,a)},t))))}},{key:"isAppsPage",get:function(){return"/apps"===location.pathname}}]),t}(i.default.PureComponent);t.default=f,f.propTypes={className:c.default.string,children:c.default.node}},3942:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(3943)),r=n(a(3946)),o=[{path:"/apps",component:l.default,exact:!0},{path:"/apps/:appID",component:r.default}];t.default=o},3943:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(30)),u=l(n(61)),s=l(n(97)),i=l(n(62)),c=l(n(13)),d=l(n(14)),p=l(n(17)),f=l(n(16)),m=l(n(18)),h=l(n(0)),v=l(n(3)),y=n(60),_=l(n(565)),g=n(938),E=l(n(38)),N=l(n(2534)),w=n(570),S=l(n(2690)),C=l(n(2664)),k=n(2531),I=l(n(2885)),D=l(n(2805)),b=l(n(3945)),A=["new","all"],M=200,L=(0,y.inject)("rootStore")(r=(0,y.observer)(r=function(e){function a(e){var t;return(0,c.default)(this,a),(t=(0,p.default)(this,(0,f.default)(a).call(this,e))).fetchApps=(0,i.default)(u.default.mark((function e(){var a,n,l,r,o,i,c,d,p,f=arguments;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=f.length>0&&void 0!==f[0]?f[0]:{},n=!(f.length>1&&void 0!==f[1])||f[1],l=t.queryParams,r=l.category,o=l.keyword,i={},o&&(i.keyword=o),r&&!A.includes(r)&&(i.category_id=r),e.next=8,t.appStore.fetchList(Object.assign({limit:k.STORE_APP_LIMIT,status:"active"},i,a));case 8:c=t.appStore,d=c.allApps,p=c.list,n?(d.clear(),d.replace(p.data)):d.push.apply(d,(0,s.default)(p.data));case 10:case"end":return e.stop()}}),e)}))),t.fetchMoreApps=(0,i.default)(u.default.mark((function e(){var a;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.appStore.list.page,e.next=3,t.fetchApps({page:a+1},!1);case 3:case"end":return e.stop()}}),e)}))),t.handleScroll=function(){if(t.cateRef&&t.cateRef.current){var e=(0,w.getScrollTop)(),a=t.cateRef.current.classList,n=a.contains("fixed-cates");e>=M&&!n?a.add("fixed-cates"):e<M&&n&&a.remove("fixed-cates")}},t.handleClickCate=function(e){t.props.rootStore.query({category:e})},t.handleSearch=function(e){t.props.rootStore.query({keyword:e})},t.appStore=new S.default,t.categoryStore=new C.default,t.cateRef=h.default.createRef(),t}var n,l;return(0,m.default)(a,e),(0,d.default)(a,[{key:"componentDidMount",value:(l=(0,i.default)(u.default.mark((function e(){var a,n,l;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.categoryStore,n=a.fetchList,l=a.list,e.next=3,n({noLimit:!0});case 3:return l.data.unshift({category_id:"all",name:t("All"),description:"templet"}),e.next=6,this.fetchApps();case 6:window.addEventListener("scroll",this.handleScroll);case 7:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"componentDidUpdate",value:(n=(0,i.default)(u.default.mark((function e(t){var a;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.props.location,t.location.search===a.search){e.next=4;break}return e.next=4,this.fetchApps();case 4:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.handleScroll)}},{key:"renderToolbar",value:function(){var e=this.appStore.list.total,a=this.queryParams.keyword;return h.default.createElement("div",{className:b.default.toolbar},h.default.createElement(g.Level,{className:b.default.level},h.default.createElement(g.LevelLeft,{className:b.default.countDesc},t("TOTAL_CATE_COUNT",{total:e})),h.default.createElement(g.LevelRight,null,h.default.createElement(N.default,{onSearch:this.handleSearch,value:a,className:b.default.search,placeholder:t("Find app")}))))}},{key:"renderCategories",value:function(){var e=this,a=this.categoryStore.list.data,n=this.queryParams.category;return h.default.createElement("div",{className:b.default.cates,ref:this.cateRef},h.default.createElement("div",{className:b.default.group},h.default.createElement("p",{className:b.default.title},t("Discoveries")),h.default.createElement("ul",{className:b.default.menu},h.default.createElement("li",{key:"new",className:(0,v.default)(b.default.item,(0,o.default)({},b.default.active,"new"===n)),onClick:function(){return e.handleClickCate("new")}},h.default.createElement(E.default,{name:"cart",size:16,type:"dark",className:b.default.icon}),h.default.createElement("span",{className:b.default.name},t("New Apps"))))),h.default.createElement("div",{className:b.default.group},h.default.createElement("p",{className:b.default.title},t("Categories")),h.default.createElement("ul",{className:b.default.menu},a.map((function(a,l){var r=a.category_id,u=a.name,s=a.description;return h.default.createElement("li",{key:r||l,className:(0,v.default)(b.default.item,(0,o.default)({},b.default.active,n===r)),onClick:function(){return e.handleClickCate(r)}},h.default.createElement(E.default,{name:"ctg-uncategorized"===r?"tag":s,size:16,type:n===r?"coloured":"dark",className:b.default.icon}),h.default.createElement("span",{className:b.default.name},t("APP_CATE_".concat(u.toUpperCase()),{defaultValue:u})))})))))}},{key:"render",value:function(){var e=this.appStore,a=e.list,n=e.allApps,l=a.isLoading,r=a.total,o=this.queryParams,u=o.workspace,s=o.namespace;return h.default.createElement("div",{className:b.default.wrapper},h.default.createElement(I.default,{className:b.default.banner},h.default.createElement("h2",{className:b.default.title},t("App Store")),h.default.createElement("p",{className:b.default.desc},t("HOME_APP_STORE_DESC"))),this.renderToolbar(),h.default.createElement("div",{className:b.default.body},this.renderCategories(),h.default.createElement(D.default,{className:b.default.apps,title:t("All"),apps:n.slice(),isLoading:l,total:r,onFetchMore:this.fetchMoreApps,workspace:u,namespace:s})))}},{key:"queryParams",get:function(){return _.default.parse(location.search.slice(1))}}]),a}(h.default.Component))||r)||r;a.default=L},3944:function(e,t,a){e.exports={banner:"Banner__banner--2qoCO",shape:"Banner__shape--3TZ_9",leftShape_1:"Banner__leftShape_1--16BT6",leftShape_2:"Banner__leftShape_2--kS-nm",inner:"Banner__inner--sf0A7",innerContent:"Banner__innerContent--10bQd",shape_1:"Banner__shape_1--2y_ds",shape_2:"Banner__shape_2--1K841",shape_3:"Banner__shape_3--3Zarp",shape_4:"Banner__shape_4--3XJFr",cont:"Banner__cont--1aOkG"}},3945:function(e,t,a){e.exports={wrapper:"Home__wrapper--2sq5M",body:"Home__body--3JzHb",toolbar:"Home__toolbar--319O9",level:"Home__level--2mmnh",apps:"Home__apps--2-09i",banner:"Home__banner--28VDZ",title:"Home__title--1uD6s",desc:"Home__desc--2PofL",countDesc:"Home__countDesc--3EE58",search:"Home__search--3VxgV",cates:"Home__cates--200HL",group:"Home__group--2pyRA",menu:"Home__menu--1bc4Z",item:"Home__item--2EaQS",active:"Home__active--XAjGz",name:"Home__name--M4YyV",icon:"Home__icon--1QTzo"}},3946:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(63)),u=l(n(61)),s=l(n(37)),i=l(n(62)),c=l(n(13)),d=l(n(14)),p=l(n(17)),f=l(n(16)),m=l(n(18)),h=l(n(0)),v=l(n(22)),y=l(n(55)),_=n(565),g=n(19),E=n(60),N=n(226),w=l(n(131)),S=l(n(2464)),C=n(938),k=l(n(129)),I=n(3947),D=l(n(224)),b=l(n(387)),A=l(n(944)),M=l(n(2807)),L=l(n(2555)),x=l(n(2572)),T=l(n(2885)),O=l(n(2780)),j=l(n(2806)),B=l(n(2808)),P=l(n(2809)),z=l(n(3948)),H=S.default.TabPanel,V=(0,E.inject)("rootStore")(r=(0,E.observer)(r=function(e){function a(e){var t;return(0,c.default)(this,a),(t=(0,p.default)(this,(0,f.default)(a).call(this,e))).fetchVersions=(0,i.default)(u.default.mark((function e(){var a,n=arguments;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.length>0&&void 0!==n[0]?n[0]:{},e.next=3,t.versionStore.fetchList((0,s.default)({},a,{app_id:t.appID}));case 3:case"end":return e.stop()}}),e)}))),t.handleTabChange=function(e){t.setState({tab:e})},t.showDeploy=function(){t.loggedIn?t.setState({showDeploy:!0}):location.href="/login?referer=".concat(location.pathname)},t.hideDeploy=function(){t.setState({showDeploy:!1})},t.handleDeploy=function(e){e.workspace;var a=e.namespace,n=(0,o.default)(e,["workspace","namespace"]);t.appStore.deploy(n,{namespace:a}).then((function(){t.hideDeploy(),t.routing.push("/projects/".concat(a,"/applications/template"))}))},t.changeTab=function(e){t.setState({selectTab:e})},t.handleChangeAppVersion=function(e){t.params.version=e,t.setState({selectAppVersion:e})},t.params=(0,_.parse)(location.search.slice(1))||{},t.htmlOrigBgColor="",t.state={tab:"appInfo",selectAppVersion:"",showDeploy:!1},t.appID=t.props.match.params.appID,t.appStore=new x.default,t.versionStore=new L.default,t}return(0,m.default)(a,e),(0,d.default)(a,[{key:"componentDidMount",value:function(){this.fixBodyColor(),this.getData()}},{key:"componentWillUnmount",value:function(){document.querySelector("html").style.backgroundColor=this.htmlOrigBgColor}},{key:"getData",value:function(){var e=this;this.appStore.fetchDetail({app_id:this.appID}),this.versionStore.fetchList({app_id:this.appID,status:"active"}).then((function(){var t=(0,v.default)(e.versionStore,"list.data[0].version_id","");e.setState({selectAppVersion:t})}))}},{key:"fixBodyColor",value:function(){var e=document.querySelector("html");this.htmlOrigBgColor=window.getComputedStyle(e).backgroundColor,e.style.backgroundColor="white"}},{key:"renderAppFilePreview",value:function(){var e=this.state.selectAppVersion;return h.default.createElement(j.default,{versionId:e,appId:this.appID})}},{key:"renderKeywords",value:function(){var e=this.appStore.detail.keywords,a=void 0===e?"":e;return a=a.split(",").map((function(e){return e.trim()})).filter(Boolean),h.default.createElement("div",{className:z.default.keywords},h.default.createElement("h3",null,t("Keywords")),h.default.createElement("p",null,0===a.length?t("None"):a.map((function(e,t){return h.default.createElement("label",{key:t},e)}))))}},{key:"renderDeployModal",value:function(){return h.default.createElement(b.default,{width:1162,visible:this.state.showDeploy,hideHeader:!0,hideFooter:!0,className:z.default.deployModal},h.default.createElement(M.default,{app:this.appStore.detail,onOk:this.handleDeploy,onCancel:this.hideDeploy,isSubmitting:this.appStore.isSubmitting,params:this.params}))}},{key:"renderTopIntro",value:function(){var e=this.appStore.detail;if(!((0,y.default)(e)&&"name"in e))return null;var t=e.name,a=e.description,n=e.icon;return h.default.createElement("div",{className:z.default.intro},h.default.createElement("span",{className:z.default.icon},h.default.createElement(A.default,{iconSize:48,iconLetter:t,src:n,alt:""})),h.default.createElement("div",{className:z.default.text},h.default.createElement("h3",null,t),h.default.createElement("p",null,a)))}},{key:"renderDeployButton",value:function(){return h.default.createElement("div",{className:z.default.deployButton},h.default.createElement(D.default,{type:"control",onClick:this.showDeploy,noShadow:!0},t("Deploy")))}},{key:"renderContent",value:function(){var e=this.state.tab,a=this.appStore,n=a.detail,l=a.isLoading,r=this.versionStore.list.data;return l?h.default.createElement(k.default,{className:z.default.loading}):h.default.createElement(S.default,{className:"tabs-app",activeName:e,onChange:this.handleTabChange},h.default.createElement(H,{label:t("App Info"),name:"appInfo"},this.renderDeployButton(),h.default.createElement(C.Columns,null,h.default.createElement(C.Column,{className:"is-8"},h.default.createElement(O.default,{app:n,versions:(0,g.toJS)(r)})),h.default.createElement(C.Column,null,h.default.createElement(B.default,{app:n})))),h.default.createElement(H,{label:t("Version"),name:"versions"},this.renderDeployButton(),h.default.createElement(C.Columns,null,h.default.createElement(C.Column,{className:"is-8"},this.renderAppFilePreview()),h.default.createElement(C.Column,null,h.default.createElement(P.default,{versionStore:this.versionStore,selectVersion:this.state.selectAppVersion,fetchVersions:this.fetchVersions,handleChangeVersion:this.handleChangeAppVersion}),this.renderKeywords()))))}},{key:"render",value:function(){return h.default.createElement("div",{className:z.default.main},h.default.createElement(T.default,{className:z.default.banner},h.default.createElement("div",{className:z.default.appOutline},h.default.createElement("div",{className:z.default.back},h.default.createElement(N.Link,{className:"custom-icon",to:"/apps"},h.default.createElement(I.ReactComponent,{width:16,height:16}),h.default.createElement("span",null,t("Back")))),this.renderTopIntro())),h.default.createElement("div",{className:z.default.content},this.renderContent(),this.renderDeployModal()))}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"loggedIn",get:function(){return Boolean(globals.user)}},{key:"versionOptions",get:function(){return this.versionStore.list.data.map((function(e){var a=e.version_id,n=e.name,l=e.create_time;return{label:n,time:(0,w.default)(l).format(t("YYYY-MM-DD")),value:a}}))}}]),a}(h.default.Component))||r)||r;a.default=V},3947:function(e,t,a){"use strict";a.r(t),a.d(t,"ReactComponent",(function(){return s}));var n=a(70),l=a.n(n),r=a(0),o=a.n(r),u=o.a.createElement("g",{fill:"none"},o.a.createElement("path",{fill:"#B6C2CD",d:"M17.613 10.43c1.07.653 2.38 2.418 2.926 4.543.546 2.124.455 4.027.455 4.027s-.706-1.172-.992-1.582c-.287-.411-1.494-1.941-3.367-2.828-1.874-.887-5.005-.73-5.005-.73l.37 3.705-9-6.288 9-6.266-.37 3.716s2.073.16 3.157.39c1.825.389 2.826 1.312 2.826 1.312z"}),o.a.createElement("path",{fill:"#FFF",d:"M12 17.564l-9-6.287 9-6.267z",opacity:.9})),s=function(e){return o.a.createElement("svg",l()({viewBox:"0 0 24 24",width:"1em",height:"1em"},e),u)};t.default="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0ibm9uemVybyI+CiAgICAgICAgPHBhdGggZmlsbD0iI0I2QzJDRCIgZD0iTTE3LjYxMyAxMC40M2MxLjA3LjY1MyAyLjM4IDIuNDE4IDIuOTI2IDQuNTQzLjU0NiAyLjEyNC40NTUgNC4wMjcuNDU1IDQuMDI3cy0uNzA2LTEuMTcyLS45OTItMS41ODJjLS4yODctLjQxMS0xLjQ5NC0xLjk0MS0zLjM2Ny0yLjgyOC0xLjg3NC0uODg3LTUuMDA1LS43My01LjAwNS0uNzNsLjM3IDMuNzA1LTktNi4yODggOS02LjI2Ni0uMzcgMy43MTZzMi4wNzMuMTYgMy4xNTcuMzljMS44MjUuMzg5IDIuODI2IDEuMzEyIDIuODI2IDEuMzEyeiIvPgogICAgICAgIDxwYXRoIGZpbGw9IiNGRkYiIGQ9Ik0xMiAxNy41NjRsLTktNi4yODcgOS02LjI2N3oiIG9wYWNpdHk9Ii45Ii8+CiAgICA8L2c+Cjwvc3ZnPgo="},3948:function(e,t,a){e.exports={content:"App__content--2y0Ms",keywords:"App__keywords--2CQOz",main:"App__main--2XbiU",banner:"App__banner--X1zP6",appOutline:"App__appOutline--1YZ0g",back:"App__back--32hKi",intro:"App__intro--38-4E",icon:"App__icon--Yuh13",text:"App__text--ZJr52",loading:"App__loading--1Byyz",deployButton:"App__deployButton--35L2w",deployModal:"App__deployModal--1sMwk"}}}]);