(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{2504:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(564),l=n(a(3813)),i=function(){return(0,r.renderRoutes)(l.default)};t.default=i},2528:function(e,t,a){e.exports={CodeEditor:"StepModals__CodeEditor--2IGEr",clickable:"StepModals__clickable--3ylLQ",dockerCredentialsContent:"StepModals__dockerCredentialsContent--N9fZk",dockerCredentialsContent__title:"StepModals__dockerCredentialsContent__title--lssVH",dockerCredentialsContent__content:"StepModals__dockerCredentialsContent__content--2VLKA",dockerCredentialsContent__trashicon:"StepModals__dockerCredentialsContent__trashicon--3ibKR",desc:"StepModals__desc--2937j",info:"StepModals__info--1KJL6"}},2549:function(e,a,n){"use strict";var r=n(81),l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=l(n(13)),u=l(n(14)),o=l(n(17)),s=l(n(16)),d=l(n(18)),c=r(n(0)),f=l(n(1)),p=l(n(3)),m=l(n(3818)),h=function(e){function a(){return(0,i.default)(this,a),(0,o.default)(this,(0,s.default)(a).apply(this,arguments))}return(0,d.default)(a,e),(0,u.default)(a,[{key:"render",value:function(){var e=this.props,a=e.className,n=e.type,r=e.label,l=e.hasLabel;return c.default.createElement("span",null,c.default.createElement("span",{className:(0,p.default)("cicd_status_icon",m.default[n.toLowerCase()],a)}),l&&(r||t(n.toLowerCase())))}}]),a}(c.PureComponent);a.default=h,h.propTypes={label:f.default.string,className:f.default.string,type:f.default.string,hasLabel:f.default.bool},h.defaultProps={type:"",label:"",hasLabel:!0}},2575:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,l,i,u,o,s,d,c,f,p,m,h,v,g,b=n(a(61)),y=n(a(63)),_=n(a(62)),E=n(a(44)),k=n(a(13)),C=n(a(14)),S=n(a(17)),w=n(a(16)),D=n(a(66)),I=n(a(18)),N=n(a(41)),P=(n(a(45)),n(a(269))),j=n(a(50)),x=n(a(22)),L=n(a(115)),R=n(a(58)),O=a(953),M=a(19),T=n(a(2576)),A="kapis/devops.kubesphere.io/v1alpha2/devops/",F={headers:{"content-type":"application/x-www-form-urlencoded"}},B=(r=function(e){function t(e){var a;return(0,k.default)(this,t),a=(0,S.default)(this,(0,w.default)(t).call(this,e)),(0,E.default)(a,"project_id",l,(0,D.default)(a)),(0,E.default)(a,"list",i,(0,D.default)(a)),(0,E.default)(a,"branchList",u,(0,D.default)(a)),(0,E.default)(a,"activityList",o,(0,D.default)(a)),(0,E.default)(a,"pullRequestList",s,(0,D.default)(a)),(0,E.default)(a,"credentialsList",d,(0,D.default)(a)),(0,E.default)(a,"detail",c,(0,D.default)(a)),(0,E.default)(a,"isLoading",f,(0,D.default)(a)),(0,E.default)(a,"notFound",p,(0,D.default)(a)),(0,E.default)(a,"reponsitorylog",m,(0,D.default)(a)),(0,E.default)(a,"pipelineJsonData",h,(0,D.default)(a)),(0,E.default)(a,"branchDetail",v,(0,D.default)(a)),(0,E.default)(a,"jenkinsfile",g,(0,D.default)(a)),a.saveAsFile=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default.txt",a=new Blob([e],{type:"text/plain;charset=utf-8"});(0,O.saveAs)(a,t)},a.pipelineConfig={},a}var a,n,r,N,T,B,z,q,U,J,V,Y,H,W,Q,G,K,X,Z,$,ee,te,ae;return(0,I.default)(t,e),(0,C.default)(t,[{key:"fetchList",value:(ae=(0,_.default)(b.default.mark((function e(){var t,a,n,r,l,i,u,o,s=arguments;return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},a=t.project_id,t.workspace,n=(0,y.default)(t,["project_id","workspace"]),this.list.isLoading=!0,r=n.page,l=n.keyword,i=n.filter,u=l?"*".concat(encodeURIComponent(l),"*"):"",e.next=6,this.request.get("kapis/devops.kubesphere.io/v1alpha2/search",{q:"type:pipeline;organization:jenkins;pipeline:".concat(a,"%2F").concat(u||"*",";excludedFromFlattening:jenkins.branch.MultiBranchProject,hudson.matrix.MatrixProject&filter=").concat(i||"no-folders"),start:10*(r-1)||0,limit:10});case 6:o=e.sent,this.list={data:o.items||[],total:o.total_count,limit:10,page:parseInt(r,10)||1,filters:(0,P.default)(n,"project_id"),isLoading:!1};case 8:case"end":return e.stop()}}),e,this)}))),function(){return ae.apply(this,arguments)})},{key:"fetchDetail",value:(te=(0,_.default)(b.default.mark((function e(t){var a,n,r;return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.name,n=t.project_id,t.isSilent||(this.isLoading=!0),e.next=4,this.request.get("".concat(A).concat(n,"/pipelines/").concat(decodeURIComponent(a),"/"));case 4:return r=e.sent,this.detail=r,this.isLoading=!1,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return te.apply(this,arguments)})},{key:"checkPipelineName",value:(ee=(0,_.default)(b.default.mark((function e(t){var a,n;return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.name,n=t.project_id,e.next=3,this.request.get("".concat(A).concat(n,"/pipelines/").concat(a,"/"),{},{headers:{"x-check-exist":!0}});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return ee.apply(this,arguments)})},{key:"getJenkinsFile",value:($=(0,_.default)(b.default.mark((function e(t){var a,n,r,l;return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.name,n=t.project_id,this.pipelineJsonData.isLoading=!0,a=decodeURIComponent(a),!(0,R.default)(this.detail)){e.next=6;break}return e.next=6,this.fetchDetail({name:a,project_id:n});case 6:return e.next=8,this.request.get("kapis/devops.kubesphere.io/v1alpha2/devops/".concat(n,"/pipelines/").concat(this.detail.name,"/config"));case 8:return r=e.sent,this.jenkinsfile=(0,x.default)(r,"pipeline.jenkinsfile",""),this.pipelineConfig=r,e.next=13,this.convertJenkinsFileToJson((0,M.toJS)(this.jenkinsfile));case 13:l=e.sent,this.pipelineJsonData={pipelineJson:l,isLoading:!1};case 15:case"end":return e.stop()}}),e,this)}))),function(e){return $.apply(this,arguments)})},{key:"convertJenkinsFileToJson",value:(Z=(0,_.default)(b.default.mark((function e(t){var a;return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return e.next=3,this.request.post("kapis/devops.kubesphere.io/v1alpha2/tojson",{jenkinsfile:(0,M.toJS)(this.jenkinsfile)},F);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return Z.apply(this,arguments)})},{key:"getPullRequest",value:(X=(0,_.default)(b.default.mark((function e(t){var a,n,r,l,i;return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.name,n=t.project_id,t.workspace,r=(0,y.default)(t,["name","project_id","workspace"]),a=decodeURIComponent(a),l=r.page,!(0,R.default)(this.detail)){e.next=6;break}return e.next=6,this.fetchDetail({name:a,project_id:n});case 6:return e.next=8,this.request.get("".concat(A).concat(n,"/pipelines/").concat(a,"/branches/"),{filter:"pull-requests",start:10*(l-1)||0,limit:10});case 8:i=e.sent,this.pullRequestList={data:i||[],total:this.detail.totalNumberOfPullRequests,limit:10,page:parseInt(l,10)||1,filters:(0,P.default)(r,"project_id"),isLoading:!1,selectedRowKeys:[]};case 10:case"end":return e.stop()}}),e,this)}))),function(e){return X.apply(this,arguments)})},{key:"getBranches",value:(K=(0,_.default)(b.default.mark((function e(t){var a,n,r,l,i,u;return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.project_id,n=t.name,r=t.branch,t.workspace,l=(0,y.default)(t,["project_id","name","branch","workspace"]),n=decodeURIComponent(n),i=l.page,!(0,R.default)(this.detail)){e.next=6;break}return e.next=6,this.fetchDetail({name:n,project_id:a});case 6:return e.next=8,this.request.get("".concat(A).concat(a,"/pipelines/").concat(n,"/branches/"),{filter:"origin",start:10*(i-1)||0,limit:10,branch:r});case 8:u=e.sent,this.branchList={data:u||[],limit:10,total:this.detail.totalNumberOfBranches,page:parseInt(i,10)||1,filters:(0,P.default)(l,"project_id"),isLoading:!1,selectedRowKeys:[]};case 10:case"end":return e.stop()}}),e,this)}))),function(e){return K.apply(this,arguments)})},{key:"getActivities",value:(G=(0,_.default)(b.default.mark((function e(t){var a,n,r,l,i,u,o,s;return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.name,n=t.branch,r=t.project_id,t.workspace,l=(0,y.default)(t,["name","branch","project_id","workspace"]),a=decodeURIComponent(a),i=l.page,u=this.activityList.limit,o=void 0===u?10:u,!(0,R.default)(this.detail)){e.next=7;break}return e.next=7,this.fetchDetail({name:a,project_id:r});case 7:return e.next=9,this.request.get("".concat(A).concat(r,"/pipelines/").concat(a,"/runs/"),{start:(i-1)*o||0,limit:o,branch:n});case 9:s=e.sent,(0,j.default)(s)&&(s=s.filter((function(e){return e._links}))),this.activityList={limit:o,data:s.items||[],total:s.total_count,page:parseInt(i,10)||1,filters:(0,P.default)(l,"project_id"),isLoading:!1,selectedRowKeys:[]};case 12:case"end":return e.stop()}}),e,this)}))),function(e){return G.apply(this,arguments)})},{key:"getBranchDetail",value:(Q=(0,_.default)(b.default.mark((function e(t){var a,n,r,l=this;return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.project_id,n=t.name,r=t.branch,e.next=3,this.request.get("".concat(A).concat(a,"/pipelines/").concat(n,"/branches/").concat(encodeURIComponent(r),"/")).then((function(e){return e.name&&(l.branchDetail=e),e}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return Q.apply(this,arguments)})},{key:"replay",value:(W=(0,_.default)(b.default.mark((function e(t,a){var n,r,l,i;return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.project_id,r=t.name,l=t.branch,i=t.runid,e.next=3,this.request.post("".concat(A).concat(n,"/pipelines/").concat(decodeURIComponent(r)).concat(l?"/branches/".concat(encodeURIComponent(l)):"","/runs/").concat(a||i,"/replay"));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return W.apply(this,arguments)})},{key:"stop",value:(H=(0,_.default)(b.default.mark((function e(t,a){var n,r,l,i;return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.project_id,r=t.name,l=t.branch,i=t.runid,e.next=3,this.request.post("".concat(A).concat(n,"/pipelines/").concat(r).concat(l?"/branches/".concat(encodeURIComponent(l)):"","/runs/").concat(a||i,"/replay/"));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return H.apply(this,arguments)})},{key:"handleActivityReplay",value:(Y=(0,_.default)(b.default.mark((function e(t){return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request.post("kapis/devops.kubesphere.io/v1alpha2/".concat(t,"/replay/"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return Y.apply(this,arguments)})},{key:"handleActivityStop",value:(V=(0,_.default)(b.default.mark((function e(t){return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request.post("kapis/devops.kubesphere.io/v1alpha2/".concat(t,"/stop/?blocking=true&timeOutInSecs=10"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return V.apply(this,arguments)})},{key:"runBranch",value:(J=(0,_.default)(b.default.mark((function e(t){var a,n,r,l,i,u=this;return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.project_id,n=t.name,r=t.branch,l=t.parameters,i="".concat(A).concat(a,"/pipelines/").concat(n).concat(r?"/branches/".concat(encodeURIComponent(r)):"","/runs"),e.next=4,this.request.post(i,(0,R.default)(l)?{}:{parameters:l}).then((function(){setTimeout((function(){u.fetchDetail({project_id:a,name:n,isSilent:!0})}),1e3)}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return J.apply(this,arguments)})},{key:"getPipeLineConfig",value:(U=(0,_.default)(b.default.mark((function e(t,a){var n;return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.project_id,e.next=3,this.request.get("kapis/devops.kubesphere.io/v1alpha2/devops/".concat(n,"/pipelines/").concat(t,"/config"));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return U.apply(this,arguments)})},{key:"createPipeline",value:(q=(0,_.default)(b.default.mark((function e(t){return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.pipelineConfig=t,e.next=3,this.request.post("kapis/devops.kubesphere.io/v1alpha2/devops/".concat(t.project_id,"/pipelines"),t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return q.apply(this,arguments)})},{key:"updatePipeline",value:(z=(0,_.default)(b.default.mark((function e(t,a){var n;return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.project_id,e.next=3,this.request.put("kapis/devops.kubesphere.io/v1alpha2/devops/".concat(n,"/pipelines/").concat((r=t,(0,x.default)(r,"pipeline.name","")||(0,x.default)(r,"multi_branch_pipeline.name",""))),t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}var r}),e,this)}))),function(e,t){return z.apply(this,arguments)})},{key:"updateJenkinsFile",value:function(e,t){return(0,L.default)(this.pipelineConfig,"pipeline.jenkinsfile",e),this.updatePipeline(this.pipelineConfig,t)}},{key:"deletePipeline",value:(B=(0,_.default)(b.default.mark((function e(t,a){return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request.delete("kapis/devops.kubesphere.io/v1alpha2/devops/".concat(a,"/pipelines/").concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return B.apply(this,arguments)})},{key:"scanRepository",value:(T=(0,_.default)(b.default.mark((function e(t){var a,n,r;return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.project_id,n=t.name,void 0!==globals.user.crumb){e.next=4;break}return e.next=4,this.getCrumb();case 4:return r={},globals.user.crumb&&(0,L.default)(r,"headers.Jenkins-Crumb",globals.user.crumb),e.next=8,this.request.defaults({method:"POST",url:"kapis/devops.kubesphere.io/v1alpha2/devops/".concat(a||this.project_id,"/pipelines/").concat(n||this.detail.name,"/scan"),options:r,handler:function(e){return e.text().then((function(){if(e.redirected)return"Scan success"}))}});case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return T.apply(this,arguments)})},{key:"getRepoScanLogs",value:(N=(0,_.default)(b.default.mark((function e(t){var a,n,r;return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.project_id,n=t.name,e.next=3,this.request.get("kapis/devops.kubesphere.io/v1alpha2/devops/".concat(a,"/pipelines/").concat(n,"/consolelog"));case 3:r=e.sent,this.reponsitorylog=r;case 5:case"end":return e.stop()}}),e,this)}))),function(e){return N.apply(this,arguments)})},{key:"checkCron",value:(r=(0,_.default)(b.default.mark((function e(t){return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request.get("".concat(A,"check/cron?value=").concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"checkScriptCompile",value:(n=(0,_.default)(b.default.mark((function e(t){var a,n,r;return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.project_id,n=t.pipeline,r=t.value,e.next=3,this.request.post("".concat(A,"/").concat(a,"/pipelines/").concat(n,"/checkScriptCompile"),{value:r},F);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"getBranchLists",value:(a=(0,_.default)(b.default.mark((function e(t){var a,n,r,l;return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.project_id,n=t.name,t.workspace,r=(0,y.default)(t,["project_id","name","workspace"]),n=decodeURIComponent(n),l=r.page,e.next=5,this.request.get("".concat(A).concat(a,"/pipelines/").concat(n,"/branches/"),{filter:"origin",start:100*(l-1)||0,limit:100});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})}]),t}(T.default),l=(0,N.default)(r.prototype,"project_id",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),i=(0,N.default)(r.prototype,"list",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:[],page:1,limit:10,total:0,order:"",reverse:!1,filters:{},isLoading:!0}}}),u=(0,N.default)(r.prototype,"branchList",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:[],page:1,limit:10,total:0,order:"",reverse:!1,filters:{},isLoading:!0}}}),o=(0,N.default)(r.prototype,"activityList",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:[],page:1,limit:30,total:0,order:"",reverse:!1,filters:{},isLoading:!0}}}),s=(0,N.default)(r.prototype,"pullRequestList",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:[],page:1,limit:10,total:0,order:"",reverse:!1,filters:{},isLoading:!0,selectedRowKeys:[]}}}),d=(0,N.default)(r.prototype,"credentialsList",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:[],total:0,isLoading:!0}}}),c=(0,N.default)(r.prototype,"detail",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),f=(0,N.default)(r.prototype,"isLoading",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),p=(0,N.default)(r.prototype,"notFound",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),m=(0,N.default)(r.prototype,"reponsitorylog",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),h=(0,N.default)(r.prototype,"pipelineJsonData",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{pipelineJson:{},isLoading:!0}}}),v=(0,N.default)(r.prototype,"branchDetail",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),g=(0,N.default)(r.prototype,"jenkinsfile",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),(0,N.default)(r.prototype,"fetchList",[M.action],Object.getOwnPropertyDescriptor(r.prototype,"fetchList"),r.prototype),(0,N.default)(r.prototype,"fetchDetail",[M.action],Object.getOwnPropertyDescriptor(r.prototype,"fetchDetail"),r.prototype),(0,N.default)(r.prototype,"checkPipelineName",[M.action],Object.getOwnPropertyDescriptor(r.prototype,"checkPipelineName"),r.prototype),(0,N.default)(r.prototype,"getJenkinsFile",[M.action],Object.getOwnPropertyDescriptor(r.prototype,"getJenkinsFile"),r.prototype),(0,N.default)(r.prototype,"convertJenkinsFileToJson",[M.action],Object.getOwnPropertyDescriptor(r.prototype,"convertJenkinsFileToJson"),r.prototype),(0,N.default)(r.prototype,"getPullRequest",[M.action],Object.getOwnPropertyDescriptor(r.prototype,"getPullRequest"),r.prototype),(0,N.default)(r.prototype,"getBranches",[M.action],Object.getOwnPropertyDescriptor(r.prototype,"getBranches"),r.prototype),(0,N.default)(r.prototype,"getActivities",[M.action],Object.getOwnPropertyDescriptor(r.prototype,"getActivities"),r.prototype),(0,N.default)(r.prototype,"getBranchDetail",[M.action],Object.getOwnPropertyDescriptor(r.prototype,"getBranchDetail"),r.prototype),(0,N.default)(r.prototype,"getPipeLineConfig",[M.action],Object.getOwnPropertyDescriptor(r.prototype,"getPipeLineConfig"),r.prototype),(0,N.default)(r.prototype,"createPipeline",[M.action],Object.getOwnPropertyDescriptor(r.prototype,"createPipeline"),r.prototype),(0,N.default)(r.prototype,"updatePipeline",[M.action],Object.getOwnPropertyDescriptor(r.prototype,"updatePipeline"),r.prototype),(0,N.default)(r.prototype,"updateJenkinsFile",[M.action],Object.getOwnPropertyDescriptor(r.prototype,"updateJenkinsFile"),r.prototype),(0,N.default)(r.prototype,"deletePipeline",[M.action],Object.getOwnPropertyDescriptor(r.prototype,"deletePipeline"),r.prototype),(0,N.default)(r.prototype,"scanRepository",[M.action],Object.getOwnPropertyDescriptor(r.prototype,"scanRepository"),r.prototype),r);t.default=B},2576:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a(61)),l=n(a(62)),i=n(a(13)),u=n(a(14)),o=n(a(115)),s=function(){function e(){var t=this;(0,i.default)(this,e),this.getCrumb=(0,l.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.catchRequestError("get","kapis/devops.kubesphere.io/v1alpha2/crumbissuer",null,null,(function(){return!0})).then((function(e){e&&e.crumb?globals.user.crumb=e.crumb:globals.user.crumb=null}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),this.handlePostRequest=function(){var e=(0,l.default)(r.default.mark((function e(t,a,n){var l,i,u=arguments;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=u.length>3&&void 0!==u[3]?u[3]:{},i=u.length>4?u[4]:void 0,l||(l={}),void 0!==globals.user.crumb){e.next=6;break}return e.next=6,this.getCrumb();case 6:return globals.user.crumb&&(0,o.default)(l,"headers.Jenkins-Crumb",globals.user.crumb),e.abrupt("return",this.catchRequestError(t,a,n,l,i));case 8:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}(),this.request={post:this.handlePostRequest.bind(this,"post"),put:this.handlePostRequest.bind(this,"put"),patch:this.handlePostRequest.bind(this,"patch"),delete:this.handlePostRequest.bind(this,"delete"),get:this.catchRequestError.bind(this,"get"),defaults:this.catchRequestError.bind(this,"defaults")}}return(0,u.default)(e,[{key:"catchRequestError",value:function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"get",a=arguments.length,n=new Array(a>1?a-1:0),r=1;r<a;r++)n[r-1]=arguments[r];return(e=request)[t].apply(e,n).catch((function(e){return window.onunhandledrejection(e),Promise.reject(e)}))}}]),e}();t.default=s},2591:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=r(n(13)),i=r(n(14)),u=r(n(17)),o=r(n(16)),s=r(n(18)),d=r(n(0)),c=r(n(2456)),f=n(938),p=r(n(224)),m=r(n(2561)),h=r(n(2696)),v=function(e){function a(e){var n;return(0,l.default)(this,a),(n=(0,u.default)(this,(0,o.default)(a).call(this,e))).refreshHandler=function(){n.props.data.some((function(e){return e.state&&"FINISHED"!==e.state&&"PAUSED"!==e.state}))?n.props.onFetch():clearInterval(n.refreshTimer)},n.renderNormalTitle=function(){return d.default.createElement(f.Level,null,d.default.createElement(f.LevelItem,null,n.props.disableSearch?null:d.default.createElement(c.default.FilterInput,{placeholder:t("Enter query conditions to filter"),tags:n.tags,suggestions:n.suggestions,onChange:n.handleFilterInput})),d.default.createElement(f.LevelRight,null,d.default.createElement(p.default,{type:"flat",icon:"refresh",onClick:n.handleRefresh}),n.renderActions()))},n.refreshTimer=setInterval(n.refreshHandler,4e3),n}return(0,s.default)(a,e),(0,i.default)(a,[{key:"componentDidUpdate",value:function(){clearInterval(this.refreshTimer),this.refreshTimer=setInterval(this.refreshHandler,4e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.refreshTimer)}},{key:"renderActions",value:function(){var e=this.props,a=e.onCreate,n=e.actions;return n?n.map((function(e){return d.default.createElement(p.default,{key:e.key,type:e.type,className:h.default.create,onClick:e.onClick},e.text)})):a?d.default.createElement(p.default,{type:"control",className:h.default.create,onClick:a},t("Create")):null}}]),a}(m.default);a.default=v},2612:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o=r(n(63)),s=r(n(61)),d=r(n(37)),c=r(n(62)),f=r(n(13)),p=r(n(14)),m=r(n(17)),h=r(n(16)),v=r(n(18)),g=r(n(0)),b=r(n(1)),y=r(n(386)),_=r(n(2453)),E=r(n(2454)),k=r(n(390)),C=r(n(225)),S=n(60),w=r(n(387)),D=r(n(267)),I=r(n(50)),N=r(n(133)),P=r(n(22)),j=r(n(2575)),x=r(n(3819)),L=(0,S.observer)((u=i=function(e){function a(e){var t;return(0,f.default)(this,a),(t=(0,m.default)(this,(0,h.default)(a).call(this,e))).getBranches=(0,c.default)(s.default.mark((function e(){var a,n,r,l,i;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.props,n=a.params,r=a.name,e.next=3,t.store.getBranchLists((0,d.default)({name:r},n,{page:t.start}));case 3:l=e.sent,(0,I.default)(l)&&l.length&&(i=l.map((function(e){return e.name})),t.setState({branches:(0,d.default)({},t.state.branches,i)}),100===l.length&&(t.start=t.start+1,t.getBranches()),t.getBranchParameters());case 5:case"end":return e.stop()}}),e)}))),t.handleOk=function(){var e=t.formRef.current._formData,a=e.branch,n=(0,o.default)(e,["branch"]);t.formRef.current.validate((function(){var e=Object.keys(n).map((function(e){return{name:e,value:n[e]}}));t.props.onOk(e,a)}))},t.getBranchParameters=function(){var e=t.formRef.current._formData.branch;t.props.onBranchSelect(e)},t.formRef=g.default.createRef(),t.store=new j.default,t.state={branches:[]},t}return(0,v.default)(a,e),(0,p.default)(a,[{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.visible,n=t.branches;!e.visible&&a&&n.length&&(this.start=1,n.length>90&&this.getBranches(),this.props.onBranchSelect((0,P.default)(this.branchOptions,"[0].value","")))}},{key:"renderParamsItem",value:function(e){switch(e.type.toLowerCase().split("parameterdefinition")[0]){case"string":return g.default.createElement(D.default.Item,{key:e.name,label:e.name,desc:e.description},g.default.createElement(y.default,{defaultValue:e.defaultParameterValue.value,name:e.name}));case"text":return g.default.createElement(D.default.Item,{key:e.name,label:e.name,desc:e.description},g.default.createElement(_.default,{defaultValue:e.defaultParameterValue.value,name:e.name}));case"boolean":return g.default.createElement(D.default.Item,{key:e.name,label:e.name,desc:e.description},g.default.createElement(E.default,{name:e.name,defaultValue:String(e.defaultParameterValue.value)},g.default.createElement(k.default,{name:e.name,value:"true"},"True"),g.default.createElement(k.default,{name:e.name,value:"false"},"False")));case"choice":return g.default.createElement(D.default.Item,{key:e.name,label:e.name,desc:e.description},g.default.createElement(C.default,{name:e.name,options:e.choices.map((function(e){return{label:e,value:e}})),defaultValue:e.choices[0]}));case"password":return g.default.createElement(D.default.Item,{key:e.name,label:e.name,desc:e.description},g.default.createElement(y.default,{defaultValue:e.defaultParameterValue.value,type:"password",name:e.name}));default:return g.default.createElement(D.default.Item,{key:e.name,label:e.name,desc:e.description},g.default.createElement(y.default,{defaultValue:e.defaultParameterValue.value,name:e.name}))}}},{key:"render",value:function(){var e=this,a=this.props,n=a.visible,r=a.onCancel,l=a.branches,i=a.parameters;return g.default.createElement(w.default,{width:680,onCancel:r,onOk:this.handleOk,visible:n,closable:!1,title:t("Params input")},g.default.createElement(D.default,{ref:this.formRef},l&&l.length?g.default.createElement(D.default.Item,{label:t("Branch"),rules:[{required:!0,message:t("This param is required")}]},g.default.createElement(C.default,{name:"branch",options:this.branchOptions,defaultValue:this.branchOptions[0]&&this.branchOptions[0].value,onChange:this.props.onBranchSelect})):null,i&&i.length?g.default.createElement("div",{className:x.default.desc},t("PARAMS_DESC")):null,i&&i.map((function(t){return e.renderParamsItem(t)}))))}},{key:"branchOptions",get:function(){var e=this.props,t=e.branches,a=e.params,n=t;this.state.branches.length&&(n=this.state.branches);var r=Array.isArray(n)?n.map((function(e){return{label:e,value:e}})):[];return a&&a.branch&&(r=[{label:a.branch,value:a.branch}]),r.sort((function(e,t){return(0,N.default)(e.value)&&"master"===e.value.toLowerCase()?-1:(0,N.default)(t.value)&&"master"===t.value.toLowerCase()?1:e.value<t.value?-1:e.value>t.value?1:0}))}}]),a}(g.default.Component),i.propTypes={name:b.default.string,branches:b.default.array},i.defaultProps={branches:[],visible:!1,name:"",onOk:function(){},onCancel:function(){},onBranchSelect:function(){}},l=u))||l;a.default=L},2613:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a(13)),l=n(a(14)),i=n(a(17)),u=n(a(16)),o=n(a(18)),s=n(a(0)),d=n(a(1)),c=n(a(3)),f=n(a(3879)),p=function(e){function t(){return(0,r.default)(this,t),(0,i.default)(this,(0,u.default)(t).apply(this,arguments))}return(0,o.default)(t,e),(0,l.default)(t,[{key:"render",value:function(){var e=this.props,t=e.className,a=e.desc;return s.default.createElement("div",{className:(0,c.default)(f.default.wrapper,t)},s.default.createElement("div",null,s.default.createElement("img",{src:"/assets/empty-card.svg",alt:""})),s.default.createElement("div",null,s.default.createElement("p",{className:f.default.desc,dangerouslySetInnerHTML:{__html:a}}),this.props.children))}}]),t}(s.default.Component);t.default=p,p.propTypes={className:d.default.string,title:d.default.string,desc:d.default.string,onCreate:d.default.func}},2636:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d,c,f,p,m,h,v,g,b=r(n(61)),y=r(n(62)),_=r(n(44)),E=r(n(13)),k=r(n(14)),C=r(n(17)),S=r(n(16)),w=r(n(66)),D=r(n(18)),I=r(n(41)),N=(r(n(45)),r(n(0))),P=r(n(1)),j=r(n(22)),x=r(n(115)),L=n(19),R=n(60),O=r(n(267)),M=r(n(387)),T=r(n(386)),A=r(n(225)),F=r(n(2453)),B=r(n(129)),z=r(n(2637)),q=r(n(2865)),U=(0,R.observer)((g=v=function(e){function a(e){var n;return(0,E.default)(this,a),(n=(0,C.default)(this,(0,S.default)(a).call(this,e))).clearData=function(){n.formData={},n.type="username_password"},(0,_.default)(n,"formData",u,(0,w.default)(n)),(0,_.default)(n,"type",o,(0,w.default)(n)),(0,_.default)(n,"isConflict",s,(0,w.default)(n)),(0,_.default)(n,"kubeconfig",d,(0,w.default)(n)),(0,_.default)(n,"isSubmitting",c,(0,w.default)(n)),(0,_.default)(n,"isGetConfigLoading",f,(0,w.default)(n)),(0,_.default)(n,"fetchKubeConfig",p,(0,w.default)(n)),(0,_.default)(n,"handleOk",m,(0,w.default)(n)),(0,_.default)(n,"handleTypeChange",h,(0,w.default)(n)),n.renderCreidentForm=function(){switch(n.type){case"ssh":return N.default.createElement(N.default.Fragment,null,N.default.createElement(O.default.Item,{label:t("Username")},N.default.createElement(T.default,{name:"ssh.username"})),N.default.createElement(O.default.Item,{label:t("Private key")},N.default.createElement(F.default,{name:"ssh.private_key"})),N.default.createElement(O.default.Item,{label:t("passphrase")},N.default.createElement(T.default,{type:"password",name:"ssh.passphrase"})));case"username_password":return N.default.createElement(N.default.Fragment,null,N.default.createElement(O.default.Item,{label:t("Username")},N.default.createElement(T.default,{name:"username_password.username"})),N.default.createElement(O.default.Item,{label:t("token / password")},N.default.createElement(T.default,{name:"username_password.password",type:"password"})));case"secret_text":return N.default.createElement(N.default.Fragment,null,N.default.createElement(O.default.Item,{label:t("secret")},N.default.createElement(F.default,{name:"secret_text.secret"})));case"kubeconfig":return N.default.createElement(O.default.Item,{className:q.default.narrowItem,label:t("Content"),desc:t("The default value here is the current user's kubeconfig")},n.isGetConfigLoading?N.default.createElement(B.default,null,N.default.createElement(F.default,{name:"kubeconfig.content",defaultValue:n.kubeconfig})):N.default.createElement(F.default,{name:"kubeconfig.content",defaultValue:n.kubeconfig}));default:return null}},n.formRef=N.default.createRef(),n.store=new z.default,e.formTemplate&&(n.formData=e.formTemplate,n.type=e.formTemplate.type),e.credentialType&&(n.type=e.credentialType,n.formData.type=e.credentialType),n.username=(0,j.default)(globals,"user.username",""),n}var n;return(0,D.default)(a,e),(0,k.default)(a,[{key:"componentDidMount",value:function(){"kubeconfig"===this.type&&this.fetchKubeConfig()}},{key:"componentWillReceiveProps",value:function(e){e.visible&&!this.props.visible&&(this.clearData(),e.formTemplate&&(this.formData=e.formTemplate,this.type=e.formTemplate.type),e.credentialType&&(this.type=e.credentialType,this.formData.type=e.credentialType,this.kubeconfig||"kubeconfig"!==e.credentialType||this.fetchKubeConfig()))}},{key:"handleCreate",value:(n=(0,y.default)(b.default.mark((function e(t,a,n){return b.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.store.handleCreate(t,{project_id:a},n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t,a){return n.apply(this,arguments)})},{key:"updataFormData",value:function(e){e[this.type]&&(e[this.type].id=e.id)}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel,r=e.isEditMode,l=(e.credentialType,e.title);return N.default.createElement(M.default,{width:680,bodyClassName:q.default.body,onCancel:n,onOk:this.handleOk,visible:a,closable:!1,isSubmitting:this.isSubmitting,title:l||t("Create credentials")},N.default.createElement(O.default,{data:this.formData,ref:this.formRef},N.default.createElement(O.default.Item,{label:t("Credential ID"),error:this.isConflict?{message:t("this name has been used")}:null,rules:[{required:!0,message:t("Please input credential name")}]},N.default.createElement(T.default,{name:"id",disabled:r})),N.default.createElement(O.default.Item,{label:t("Type")},N.default.createElement(A.default,{options:[{label:t("username_password"),value:"username_password"},{label:"SSH",value:"ssh"},{label:t("secret_text"),value:"secret_text"},{label:t("kubeconfig"),value:"kubeconfig"}],disabled:r,onChange:this.handleTypeChange,defaultValue:"username_password",name:"type"})),r?N.default.createElement("div",{className:q.default.desc},t("EDIT_CREDENTIAL_DESC")):null,this.renderCreidentForm(),N.default.createElement(O.default.Item,{label:t("Description")},N.default.createElement(F.default,{name:"description"}))))}}]),a}(N.default.Component),v.propTypes={name:P.default.string,isEditMode:P.default.bool,formTemplate:P.default.object,credentialType:P.default.string,title:P.default.string},v.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isEditMode:!1},i=g,u=(0,I.default)(i.prototype,"formData",[L.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),o=(0,I.default)(i.prototype,"type",[L.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"username_password"}}),s=(0,I.default)(i.prototype,"isConflict",[L.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=(0,I.default)(i.prototype,"kubeconfig",[L.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),c=(0,I.default)(i.prototype,"isSubmitting",[L.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f=(0,I.default)(i.prototype,"isGetConfigLoading",[L.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),(0,I.default)(i.prototype,"handleCreate",[L.action],Object.getOwnPropertyDescriptor(i.prototype,"handleCreate"),i.prototype),p=(0,I.default)(i.prototype,"fetchKubeConfig",[L.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return((0,y.default)(b.default.mark((function t(){var a;return b.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isGetConfigLoading=!0,t.next=3,request.get("kapis/resources.kubesphere.io/v1alpha2/users/".concat(e.username,"/kubeconfig")).finally((function(){e.isGetConfigLoading=!1}));case 3:a=t.sent,e.kubeconfig=a,(0,x.default)(e.formData,"kubeconfig.content",a),e.forceUpdate();case 7:case"end":return t.stop()}}),t)}))))}}),m=(0,I.default)(i.prototype,"handleOk",[L.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=e.props,a=t.isEditMode,n=t.project_id,r=e.formRef.current._formData;e.isConflict=!1,e.formRef.current.validate((0,y.default)(b.default.mark((function t(){return b.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isSubmitting=!0,e.updataFormData(r),!a){t.next=7;break}return t.next=5,e.store.updateCridential(r,{project_id:n}).finally((function(){e.isSubmitting=!1}));case 5:t.next=9;break;case 7:return t.next=9,e.handleCreate(r,n,(function(t){409===t.status&&(e.isConflict=!0)})).finally((function(){e.isSubmitting=!1}));case 9:e.isConflict||e.props.onOk();case 10:case"end":return t.stop()}}),t)}))))}}}),h=(0,I.default)(i.prototype,"handleTypeChange",[L.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.type=t,e.formData[t]={id:(0,j.default)(e.formData,"id","")},e.kubeconfig||"kubeconfig"!==e.type||e.fetchKubeConfig()}}}),l=i))||l;a.default=U},2637:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,l,i,u,o=n(a(61)),s=n(a(63)),d=n(a(62)),c=n(a(44)),f=n(a(13)),p=n(a(14)),m=n(a(17)),h=n(a(16)),v=n(a(66)),g=n(a(18)),b=n(a(41)),y=(n(a(45)),n(a(269))),_=a(19),E=n(a(2576)),k=(r=function(e){function t(){var e,a;(0,f.default)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=(0,m.default)(this,(e=(0,h.default)(t)).call.apply(e,[this].concat(r))),(0,c.default)(a,"list",l,(0,v.default)(a)),(0,c.default)(a,"detail",i,(0,v.default)(a)),(0,c.default)(a,"params",u,(0,v.default)(a)),a}var a,n,r,b,_;return(0,g.default)(t,e),(0,p.default)(t,[{key:"setParams",value:function(e){this.params=e}},{key:"fetchList",value:(_=(0,d.default)(o.default.mark((function e(){var t,a,n,r,l,i=arguments;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},a=t.project_id,t.workspace,n=(0,s.default)(t,["project_id","workspace"]),this.list.isLoading=!0,r=n.page,e.next=5,this.request.get("kapis/devops.kubesphere.io/v1alpha2/devops/".concat(a,"/credentials"),{start:20*(r-1)||0,limit:20});case 5:return l=e.sent,this.list={data:l||[],total:(l||[]).length,limit:100,page:parseInt(r,10)||1,filters:(0,y.default)(n,"project_id"),isLoading:!1},e.abrupt("return",l);case 8:case"end":return e.stop()}}),e,this)}))),function(){return _.apply(this,arguments)})},{key:"handleCreate",value:(b=(0,d.default)(o.default.mark((function e(t,a,n){var r;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.project_id,e.next=3,this.request.post("kapis/devops.kubesphere.io/v1alpha2/devops/".concat(r,"/credentials"),t,null,n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,a){return b.apply(this,arguments)})},{key:"fetchDetail",value:(r=(0,d.default)(o.default.mark((function e(){var t,a,n,r;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.params,a=t.project_id,n=t.cridential_id,e.next=3,this.request.get("kapis/devops.kubesphere.io/v1alpha2/devops/".concat(a,"/credentials/").concat(n,"?content=1"));case 3:(r=e.sent).display_name=r.id,this.detail=r;case 6:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"updateCridential",value:(n=(0,d.default)(o.default.mark((function e(t,a){var n;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.project_id,e.next=3,this.request.put("kapis/devops.kubesphere.io/v1alpha2/devops/".concat(n,"/credentials/").concat(t.id),t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"delete",value:(a=(0,d.default)(o.default.mark((function e(t){var a;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.params.project_id,e.next=3,this.request.delete("kapis/devops.kubesphere.io/v1alpha2/devops/".concat(a,"/credentials/").concat(t));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})}]),t}(E.default),l=(0,b.default)(r.prototype,"list",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:[],page:1,limit:10,total:0,order:"",reverse:!1,filters:{},isLoading:!0}}}),i=(0,b.default)(r.prototype,"detail",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),u=(0,b.default)(r.prototype,"params",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),(0,b.default)(r.prototype,"setParams",[_.action],Object.getOwnPropertyDescriptor(r.prototype,"setParams"),r.prototype),(0,b.default)(r.prototype,"fetchList",[_.action],Object.getOwnPropertyDescriptor(r.prototype,"fetchList"),r.prototype),(0,b.default)(r.prototype,"handleCreate",[_.action],Object.getOwnPropertyDescriptor(r.prototype,"handleCreate"),r.prototype),(0,b.default)(r.prototype,"fetchDetail",[_.action],Object.getOwnPropertyDescriptor(r.prototype,"fetchDetail"),r.prototype),(0,b.default)(r.prototype,"updateCridential",[_.action],Object.getOwnPropertyDescriptor(r.prototype,"updateCridential"),r.prototype),(0,b.default)(r.prototype,"delete",[_.action],Object.getOwnPropertyDescriptor(r.prototype,"delete"),r.prototype),r);t.default=k},2638:function(e,t,a){"use strict";a.r(t),a.d(t,"ReactComponent",(function(){return o}));var n=a(70),r=a.n(n),l=a(0),i=a.n(l),u=i.a.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M19 8.143a2.577 2.577 0 0 0-2.6-2.572 2.586 2.586 0 0 0-2.509 1.898 2.55 2.55 0 0 0 1.209 2.885v.386c-.026.669-.299 1.26-.819 1.774-.52.515-1.118.785-1.794.81-1.079.026-1.924.206-2.6.579v-6.12a2.55 2.55 0 0 0 1.209-2.886A2.586 2.586 0 0 0 8.587 3 2.566 2.566 0 0 0 6 5.571c.006.914.5 1.755 1.3 2.212v8.434c-.767.45-1.3 1.273-1.3 2.212A2.577 2.577 0 0 0 8.6 21c1.443 0 2.6-1.144 2.6-2.571 0-.682-.26-1.286-.689-1.749.117-.077.624-.527.767-.604.325-.142.728-.219 1.222-.219 1.365-.064 2.535-.578 3.575-1.607s1.56-2.546 1.625-3.883h-.026C18.467 9.904 19 9.081 19 8.143zM8.6 4.029c.858 0 1.56.707 1.56 1.542 0 .836-.715 1.543-1.56 1.543-.845 0-1.56-.707-1.56-1.543 0-.835.715-1.542 1.56-1.542zm0 15.955c-.858 0-1.56-.707-1.56-1.543 0-.835.715-1.542 1.56-1.542.845 0 1.56.707 1.56 1.542 0 .836-.715 1.543-1.56 1.543zM16.4 9.7c-.858 0-1.56-.708-1.56-1.543 0-.836.715-1.543 1.56-1.543.845 0 1.56.707 1.56 1.543 0 .835-.715 1.543-1.56 1.543z"}),o=function(e){return i.a.createElement("svg",r()({viewBox:"0 0 24 24",width:"1em",height:"1em"},e),u)};t.default="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxwYXRoIGZpbGw9ImN1cnJlbnRDb2xvciIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTkgOC4xNDNhMi41NzcgMi41NzcgMCAwIDAtMi42LTIuNTcyIDIuNTg2IDIuNTg2IDAgMCAwLTIuNTA5IDEuODk4IDIuNTUgMi41NSAwIDAgMCAxLjIwOSAyLjg4NXYuMzg2Yy0uMDI2LjY2OS0uMjk5IDEuMjYtLjgxOSAxLjc3NC0uNTIuNTE1LTEuMTE4Ljc4NS0xLjc5NC44MS0xLjA3OS4wMjYtMS45MjQuMjA2LTIuNi41Nzl2LTYuMTJhMi41NSAyLjU1IDAgMCAwIDEuMjA5LTIuODg2QTIuNTg2IDIuNTg2IDAgMCAwIDguNTg3IDMgMi41NjYgMi41NjYgMCAwIDAgNiA1LjU3MWMuMDA2LjkxNC41IDEuNzU1IDEuMyAyLjIxMnY4LjQzNGMtLjc2Ny40NS0xLjMgMS4yNzMtMS4zIDIuMjEyQTIuNTc3IDIuNTc3IDAgMCAwIDguNiAyMWMxLjQ0MyAwIDIuNi0xLjE0NCAyLjYtMi41NzEgMC0uNjgyLS4yNi0xLjI4Ni0uNjg5LTEuNzQ5LjExNy0uMDc3LjYyNC0uNTI3Ljc2Ny0uNjA0LjMyNS0uMTQyLjcyOC0uMjE5IDEuMjIyLS4yMTkgMS4zNjUtLjA2NCAyLjUzNS0uNTc4IDMuNTc1LTEuNjA3czEuNTYtMi41NDYgMS42MjUtMy44ODNoLS4wMjZDMTguNDY3IDkuOTA0IDE5IDkuMDgxIDE5IDguMTQzek04LjYgNC4wMjljLjg1OCAwIDEuNTYuNzA3IDEuNTYgMS41NDIgMCAuODM2LS43MTUgMS41NDMtMS41NiAxLjU0My0uODQ1IDAtMS41Ni0uNzA3LTEuNTYtMS41NDMgMC0uODM1LjcxNS0xLjU0MiAxLjU2LTEuNTQyem0wIDE1Ljk1NWMtLjg1OCAwLTEuNTYtLjcwNy0xLjU2LTEuNTQzIDAtLjgzNS43MTUtMS41NDIgMS41Ni0xLjU0Mi44NDUgMCAxLjU2LjcwNyAxLjU2IDEuNTQyIDAgLjgzNi0uNzE1IDEuNTQzLTEuNTYgMS41NDN6TTE2LjQgOS43Yy0uODU4IDAtMS41Ni0uNzA4LTEuNTYtMS41NDMgMC0uODM2LjcxNS0xLjU0MyAxLjU2LTEuNTQzLjg0NSAwIDEuNTYuNzA3IDEuNTYgMS41NDMgMCAuODM1LS43MTUgMS41NDMtMS41NiAxLjU0M3oiLz4KPC9zdmc+Cg=="},2685:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=r(n(13)),i=r(n(14)),u=r(n(17)),o=r(n(16)),s=r(n(18)),d=r(n(0)),c=r(n(3)),f=r(n(3817)),p=function(e){function a(){return(0,l.default)(this,a),(0,u.default)(this,(0,o.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,i.default)(a,[{key:"render",value:function(){var e=this.props,a=e.score,n=e.className;return void 0===a?d.default.createElement("span",null,d.default.createElement("span",{className:(0,c.default)(f.default.icon,f.default.nostatus,n)}),t("no status")):a<=10?d.default.createElement("span",null,d.default.createElement("span",{className:(0,c.default)(f.default.icon,f.default.error,n)}),t("Warning")):a>50&&a<=90?d.default.createElement("span",null,d.default.createElement("span",{className:(0,c.default)(f.default.icon,f.default.subhealth,n)}),t("Sub-healthy")):d.default.createElement("span",null,d.default.createElement("span",{className:(0,c.default)(f.default.icon,f.default.health,n)}),t("Healthy"))}}]),a}(d.default.Component);a.default=p},2686:function(e,t,a){e.exports={pipelineCard:"Card__pipelineCard--uLmxy",pipelineCard__title:"Card__pipelineCard__title--374bD","pipelineCard__title-error":"Card__pipelineCard__title-error--2f_2S",pipelineCard__content:"Card__pipelineCard__content--1yZ2d","pipelineCard-error":"Card__pipelineCard-error--rUnBD",errorTip:"Card__errorTip--1xCvR","pipelineCard-active":"Card__pipelineCard-active--2Rjzu",pipelineCard__item:"Card__pipelineCard__item--1j55r",content__title:"Card__content__title--1LbrO",content__title__error:"Card__content__title__error--dL6e5",content__detail:"Card__content__detail--1EDW6",pipeline_column:"Card__pipeline_column--2Vr4U",addSteps:"Card__addSteps--1XL2T",addBranchCard:"Card__addBranchCard--1TrqG",icon:"Card__icon--3Un3_",conditions:"Card__conditions--1Clw9",nestStage_content:"Card__nestStage_content--8fLMH",indentBorder:"Card__indentBorder--pgY1D",nestsStage_detail:"Card__nestsStage_detail--3vTIW"}},2687:function(e,t,a){e.exports={sider:"Sider__sider--3y7-m",sheet:"Sider__sheet--1VTQE",title:"Sider__title--vlfMO",delete:"Sider__delete--1kpyC",edit:"Sider__edit--17i-N",describtion:"Sider__describtion--1ZLAf",form:"Sider__form--1LP-C",form_lable:"Sider__form_lable--5Q1qF",footer:"Sider__footer--3bSiW",clickable:"Sider__clickable--23bCX",pipelineCard__item__drag:"Sider__pipelineCard__item__drag--2c5vl",conditionList:"Sider__conditionList--3v2nj"}},2688:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Branch",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"Pipeline",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"PullRequest",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"Activity",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"TaskStatus",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"Commit",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"Artifacts",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"CodeQuality",{enumerable:!0,get:function(){return c.default}});var r=n(a(3878)),l=n(a(3880)),i=n(a(3882)),u=n(a(3883)),o=n(a(3885)),s=n(a(3895)),d=n(a(3896)),c=n(a(3897))},2689:function(e,t,a){e.exports={blocker:"CodeQualityIssues__blocker--13Dzf",rotate:"CodeQualityIssues__rotate--Qt2Bn",critical:"CodeQualityIssues__critical--34RT_",info:"CodeQualityIssues__info--293s8",major:"CodeQualityIssues__major--II1m5",minor:"CodeQualityIssues__minor--1vir6",codeStatus:"CodeQualityIssues__codeStatus--3vyWO",status:"CodeQualityIssues__status--2nb5B",type:"CodeQualityIssues__type--RSzYb",header:"CodeQualityIssues__header--21iug",title:"CodeQualityIssues__title--3HJdy",details:"CodeQualityIssues__details--1EFtU",content:"CodeQualityIssues__content--A-eoL",fileTitle:"CodeQualityIssues__fileTitle--nIhyX",errorCard:"CodeQualityIssues__errorCard--3p5Qr",message:"CodeQualityIssues__message--30aQZ","card-blocker":"CodeQualityIssues__card-blocker--10H_d","card-critical":"CodeQualityIssues__card-critical--8-u2i","card-minor":"CodeQualityIssues__card-minor--3bLDF","card-info":"CodeQualityIssues__card-info--Dz7-_",titleShowMore:"CodeQualityIssues__titleShowMore--35etf",displayAll:"CodeQualityIssues__displayAll--21pNh"}},2861:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=r(n(13)),i=r(n(14)),u=r(n(17)),o=r(n(16)),s=r(n(18)),d=r(n(58)),c=r(n(22)),f=r(n(0)),p=r(n(3)),m=r(n(1)),h=r(n(38)),v=r(n(224)),g=n(114),b=r(n(2862)),y=function(e){function a(){var e,t;(0,l.default)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,u.default)(this,(e=(0,o.default)(a)).call.apply(e,[this].concat(r)))).onChange=function(e){t.props.onChange(e)},t.handleDeleteSource=function(){t.props.handleDeleteSource()},t}return(0,s.default)(a,e),(0,i.default)(a,[{key:"renderEmpty",value:function(){var e=this.props.onClick;return f.default.createElement("div",{className:b.default.empty,onClick:e},f.default.createElement("p",null,t("Please select a code repository as the code source for the pipeline")))}},{key:"render",value:function(){var e=this.props.value;if((0,d.default)(e))return this.renderEmpty();var a=(0,c.default)(e,"".concat(g.REPO_KEY_MAP[e.source_type]),{}),n="single_svn"===e.source_type?"svn":e.source_type;return f.default.createElement("div",{className:b.default.wrapper},f.default.createElement("div",{className:(0,p.default)(b.default.branch,b.default.branch__show)},f.default.createElement("div",{className:b.default.icon},f.default.createElement(h.default,{name:n,size:48})),f.default.createElement("div",{className:b.default.info},f.default.createElement("div",{className:b.default.name},a.repo||a.url||a.remote),f.default.createElement("div",{className:b.default.desc},a.description||"-")),f.default.createElement("div",{className:b.default.action},f.default.createElement(v.default,{onClick:this.props.onClick,noShadow:!0},t("Reselect")),this.props.handleDeleteSource?f.default.createElement("span",{onClick:this.handleDeleteSource,className:b.default.deleteRepoBtn},f.default.createElement(h.default,{name:"trash"})):null)))}}]),a}(f.default.Component);a.default=y,y.propTypes={name:m.default.string,value:m.default.object,onClick:m.default.func},y.defaultProps={name:"",value:{},onClick:function(){}}},2862:function(e,t,a){e.exports={wrapper:"RepoSelect__wrapper--g9g3O",empty:"RepoSelect__empty--2ouOL",formWrapper:"RepoSelect__formWrapper--2FtT4",contentWrapper:"RepoSelect__contentWrapper--1a4Ng",repoTypes:"RepoSelect__repoTypes--DyU7i",selectType:"RepoSelect__selectType--2es3G",gitIcon:"RepoSelect__gitIcon--2nYFS",light:"RepoSelect__light--6ix_p",dark:"RepoSelect__dark--3c_wc",branch:"RepoSelect__branch--14eGf",action:"RepoSelect__action--3pzHm",icon:"RepoSelect__icon--1MO7f",info:"RepoSelect__info--3CIqz",name:"RepoSelect__name--3F5vJ",desc:"RepoSelect__desc--2aFEf",branch__show:"RepoSelect__branch__show--QuExa",deleteRepoBtn:"RepoSelect__deleteRepoBtn--3Zr4s",disabled:"RepoSelect__disabled--2TuBd"}},2863:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d,c=r(n(30)),f=r(n(37)),p=r(n(61)),m=r(n(62)),h=r(n(44)),v=r(n(13)),g=r(n(14)),b=r(n(17)),y=r(n(16)),_=r(n(66)),E=r(n(18)),k=r(n(41)),C=(r(n(45)),r(n(0))),S=r(n(1)),w=r(n(3)),D=n(19),I=n(60),N=r(n(22)),P=r(n(58)),j=r(n(2465)),x=r(n(38)),L=r(n(2864)),R=n(114),O=n(945),M=r(n(2636)),T=r(n(3823)),A=r(n(2866)),F=r(n(3826)),B=r(n(3828)),z=r(n(2862)),q=(0,I.observer)((d=s=function(e){function a(e){var t;return(0,v.default)(this,a),t=(0,b.default)(this,(0,y.default)(a).call(this,e)),(0,h.default)(t,"source_type",u,(0,_.default)(t)),(0,h.default)(t,"showCredential",o,(0,_.default)(t)),t.showCreateCredential=function(){t.showCredential=!0},t.hideCreateCredential=(0,m.default)(p.default.mark((function e(){var a;return p.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.props.project_id,e.next=3,t.store.getCredential(a);case 3:t.showCredential=!1;case 4:case"end":return e.stop()}}),e)}))),t.handleGoBack=function(){var e=t.context.resetSubRoute;e&&e(),t.props.onCancel()},t.handleSubmit=function(e){var a=t.props.onSave,n=t.context.resetSubRoute,r=t.store.formData;if(["github","bitbucket_server"].includes(t.source_type)){if((0,P.default)(e))return;return a(t.source_type,e),void(n&&n())}t.formRef.current&&t.formRef.current.validate((function(){if("git"===t.source_type&&a("git",{git_source:(0,f.default)({},r.git_source,{discover_branches:!0})}),["svn","single_svn"].includes(t.source_type)){var e=(0,N.default)(r,"svn_source.type","svn");a(e,(0,c.default)({},R.REPO_KEY_MAP[e],(0,f.default)({},r.svn_source,{remote:(0,N.default)(r,"svn_source.remote","").trim(),discover_branches:!0})))}n&&n()}))},t.handleTypeChange=function(e){var a=e.currentTarget.dataset.type;t.source_type=a,t.store.resetStore()},t.formRef=C.default.createRef(),t.tokenFormRef=C.default.createRef(),t.store=new L.default,t}return(0,E.default)(a,e),(0,g.default)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.onCancel,a=e.project_id,n=e.name,r=this.context.registerSubRoute,l=this.props.sourceData;r&&r(this.handleSubmit,t),this.store.getCredential(a),this.store.name=n,(0,P.default)(l)||(this.source_type=l.source_type,this.store.formData=(0,c.default)({},R.REPO_KEY_MAP[this.source_type],(0,j.default)(l[R.REPO_KEY_MAP[this.source_type]],(function(e,t){return t&&t.startsWith("discover")&&(0,P.default)(e)}))),"single_svn"===this.source_type&&(this.store.formData={svn_source:(0,f.default)({type:"single_svn"},this.store.formData.single_svn_source)}))}},{key:"renderTypes",value:function(){var e=this,t=this.props.enableTypeChange,a="single_svn"===this.source_type?"svn":this.source_type;return C.default.createElement("ul",{className:z.default.repoTypes},R.REPO_TYPES.map((function(n){var r;return C.default.createElement("li",{className:(0,w.default)((r={},(0,c.default)(r,z.default.selectType,n.value===a),(0,c.default)(r,z.default.disabled,!t&&a!==n.value),r)),key:n.value,"data-type":n.value,onClick:e.handleTypeChange},C.default.createElement(x.default,{name:n.icon,type:n.value===a?"light":"dark",size:32}),C.default.createElement("span",null,n.name))})))}},{key:"renderForm",value:function(){var e=this.props,t=e.project_id,a=e.enableTypeChange;return"github"===this.source_type?C.default.createElement(A.default,{store:this.store,formRef:this.formRef,handleSubmit:this.handleSubmit}):["svn","single_svn"].includes(this.source_type)?C.default.createElement(F.default,{store:this.store,formRef:this.formRef,handleSubmit:this.handleSubmit,project_id:t,showCredential:this.showCreateCredential,enableTypeChange:a}):"bitbucket_server"===this.source_type?C.default.createElement(B.default,{store:this.store,formRef:this.formRef,handleSubmit:this.handleSubmit}):C.default.createElement(T.default,{store:this.store,formRef:this.formRef,handleSubmit:this.handleSubmit,project_id:t,showCredential:this.showCreateCredential})}},{key:"render",value:function(){var e=this.props.project_id;return C.default.createElement("div",{className:z.default.formWrapper},C.default.createElement("div",{className:"h4"},C.default.createElement("a",{className:"custom-icon",onClick:this.handleGoBack},C.default.createElement(O.ReactComponent,null)),t("Select Code Repository")),C.default.createElement("div",{className:z.default.contentWrapper},this.renderTypes(),this.renderForm()),C.default.createElement(M.default,{visible:this.showCredential,onOk:this.hideCreateCredential,onCancel:this.hideCreateCredential,project_id:e}))}}]),a}(C.default.Component),s.propTypes={onSave:S.default.func,onCancel:S.default.func,sourceData:S.default.object,enableTypeChange:S.default.bool},s.defaultProps={onSave:function(){},onCancel:function(){},sourceData:{},enableTypeChange:!0},s.contextTypes={registerSubRoute:S.default.func,resetSubRoute:S.default.func},i=d,u=(0,k.default)(i.prototype,"source_type",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"github"}}),o=(0,k.default)(i.prototype,"showCredential",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),l=i))||l;a.default=q},2864:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d,c,f,p,m,h,v,g,b=r(n(63)),y=r(n(37)),_=r(n(61)),E=r(n(62)),k=r(n(44)),C=r(n(13)),S=r(n(14)),w=r(n(17)),D=r(n(16)),I=r(n(66)),N=r(n(18)),P=r(n(41)),j=(r(n(45)),n(19)),x=r(n(50)),L=r(n(22)),R=r(n(58)),O=r(n(115)),M=n(49),T=r(n(3822)),A=(l=function(e){function a(e){var n;return(0,C.default)(this,a),n=(0,w.default)(this,(0,D.default)(a).call(this,e)),(0,k.default)(n,"credentials",i,(0,I.default)(n)),(0,k.default)(n,"orgList",u,(0,I.default)(n)),(0,k.default)(n,"getRepoListLoading",o,(0,I.default)(n)),(0,k.default)(n,"activeRepoIndex",s,(0,I.default)(n)),(0,k.default)(n,"formData",d,(0,I.default)(n)),(0,k.default)(n,"githubCredentialId",c,(0,I.default)(n)),(0,k.default)(n,"creatBitBucketServersError",f,(0,I.default)(n)),(0,k.default)(n,"getCredential",p,(0,I.default)(n)),(0,k.default)(n,"creatBitBucketServers",m,(0,I.default)(n)),(0,k.default)(n,"clearBitbucketErrors",h,(0,I.default)(n)),(0,k.default)(n,"resetStore",v,(0,I.default)(n)),(0,k.default)(n,"checkCronScript",g,(0,I.default)(n)),n.credentials=window.pipelineCredentials||[],n.verifyAccessErrorHandle={github:function(e,t){if(428===e.status)return n.isAccessTokenWrong=!0,void(n.orgList.isLoading=!1);window.onunhandledrejection&&window.onunhandledrejection(t)},"bitbucket-server":function(e,a){if((0,R.default)((0,L.default)(a,"message"))){if(428===e.status)return void(n.creatBitBucketServersError={password:{message:t("username or password wrong, please try again")}});n.creatBitBucketServersError={all:a.message}}else n.creatBitBucketServersError=(0,M.safeParseJSON)(a.message,{errors:[]}).errors.reduce((function(e,t){return e[t.field]=t,e}),{});window.onunhandledrejection&&window.onunhandledrejection(a)}},n}var n,r,l,P,j;return(0,N.default)(a,e),(0,S.default)(a,[{key:"getOrganizationList",value:(j=(0,E.default)(_.default.mark((function e(t,a){var n;return _.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.orgList.isLoading=!0,this.scmType=a,this.orgParams=t,e.next=5,this.request.get("kapis/devops.kubesphere.io/v1alpha2/scms/".concat(a||"github","/organizations/?").concat((0,M.getQueryString)(t)));case 5:n=e.sent,(0,x.default)(n)&&(this.orgList.data=n),this.orgList.isLoading=!1;case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return j.apply(this,arguments)})},{key:"handleChangeActiveRepoIndex",value:function(e){this.activeRepoIndex=e}},{key:"getRepoList",value:(P=(0,E.default)(_.default.mark((function e(){var t,a,n,r,l,i=arguments;return _.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:this.activeRepoIndex,this.getRepoListLoading=!0,a=(0,L.default)(this.orgList.data[t],"repositories.nextPage")||1,n=this.orgList.data[t].key||this.orgList.data[t].name,e.next=6,this.request.get("kapis/devops.kubesphere.io/v1alpha2/scms/".concat(this.scmType||"github","/organizations/").concat(n,"/repositories/?").concat((0,M.getQueryString)((0,y.default)({},this.orgParams,{pageNumber:a,pageSize:20}))));case 6:(r=e.sent).repositories&&(l=(0,L.default)(this.orgList,"data[".concat(t,"].repositories"),{}),(0,x.default)(l.items)?(l.items=l.items.concat(r.repositories.items),l.nextPage=r.repositories.nextPage):(0,O.default)(this.orgList,"data[".concat(t,"].repositories"),r.repositories),this.getRepoListLoading=!1);case 8:case"end":return e.stop()}}),e,this)}))),function(){return P.apply(this,arguments)})},{key:"putAccessToken",value:(l=(0,E.default)(_.default.mark((function e(a){var n,r,l;return _.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.token,r=a.name,e.next=3,this.verifyAccessForRepo({accessToken:n,scmType:"github"});case 3:(l=e.sent)&&l.credentialId&&(this.githubCredentialId="github-".concat(n.slice(0,6)),this.createCredential({id:this.githubCredentialId,username:r,password:n,description:t("Automatically generated by github"),login:"github"}),this.getOrganizationList({credentialId:l.credentialId},"github"));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"verifyAccessForRepo",value:(r=(0,E.default)(_.default.mark((function e(t){var a,n;return _.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.scmType,n=(0,b.default)(t,["scmType"]),e.next=3,this.request.post("kapis/devops.kubesphere.io/v1alpha2/scms/".concat(a,"/verify/"),n,null,this.verifyAccessErrorHandle[a]);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"createCredential",value:(n=(0,E.default)(_.default.mark((function e(t){var a,n,r,l,i;return _.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.id,n=t.username,r=t.password,l=t.description,i=t.login,e.next=3,this.request.post("kapis/devops.kubesphere.io/v1alpha2/devops/".concat(this.project_id,"/credentials"),{id:a,type:"username_password",username_password:{type:"username_password",id:a,username:n,password:r,description:l,login:i}},null,(function(e,t){if(409===e.status)return t}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}]),a}(r(n(2576)).default),i=(0,P.default)(l.prototype,"credentials",[j.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{isLoading:!1,data:[]}}}),u=(0,P.default)(l.prototype,"orgList",[j.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{isLoading:!1,data:[]}}}),o=(0,P.default)(l.prototype,"getRepoListLoading",[j.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=(0,P.default)(l.prototype,"activeRepoIndex",[j.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),d=(0,P.default)(l.prototype,"formData",[j.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),c=(0,P.default)(l.prototype,"githubCredentialId",[j.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),f=(0,P.default)(l.prototype,"creatBitBucketServersError",[j.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),(0,P.default)(l.prototype,"getOrganizationList",[j.action],Object.getOwnPropertyDescriptor(l.prototype,"getOrganizationList"),l.prototype),(0,P.default)(l.prototype,"handleChangeActiveRepoIndex",[j.action],Object.getOwnPropertyDescriptor(l.prototype,"handleChangeActiveRepoIndex"),l.prototype),(0,P.default)(l.prototype,"getRepoList",[j.action],Object.getOwnPropertyDescriptor(l.prototype,"getRepoList"),l.prototype),p=(0,P.default)(l.prototype,"getCredential",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return(function(){var t=(0,E.default)(_.default.mark((function t(a){var n;return _.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a&&(e.project_id=a),e.credentials.isLoading=!0,t.next=4,e.request.get("kapis/devops.kubesphere.io/v1alpha2/devops/".concat(a||e.project_id,"/credentials")).finally((function(){e.credentials.isLoading=!1}));case 4:n=t.sent,e.credentials={data:n.map((function(e){return{label:e.id,value:e.id}})),isLoading:!1},window.pipelineCredentials=(0,j.toJS)(e.credentials);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}),m=(0,P.default)(l.prototype,"creatBitBucketServers",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return(function(){var a=(0,E.default)(_.default.mark((function a(n){var r,l,i,u,o;return _.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=n.username,l=n.password,i=n.apiUrl,e.creatBitBucketServersError={},e.tokenFormData={username:r,password:l,apiUrl:i},!(0,R.default)((0,M.parseUrl)(i))){a.next=6;break}return e.creatBitBucketServersError={apiUrl:{message:t("url is invalid")}},a.abrupt("return");case 6:return e.bitbucketCredentialId="bitbucket-".concat(r,"-").concat((0,T.default)(i+r+l).slice(0,6)),a.next=9,e.request.post("kapis/devops.kubesphere.io/v1alpha2/scms/bitbucket-server/servers",{apiUrl:i,name:e.bitbucketCredentialId},null,e.verifyAccessErrorHandle["bitbucket-server"]);case 9:if((u=a.sent)&&u.id){a.next=12;break}return a.abrupt("return");case 12:return a.next=14,e.verifyAccessForRepo({apiUrl:i,userName:r,password:l,scmType:"bitbucket-server"});case 14:if(!(o=a.sent)||!o.credentialId){a.next=20;break}return e.orgList.isLoading=!1,e.getOrganizationList({credentialId:"bitbucket-server:".concat(u.id),apiUrl:i},"bitbucket-server"),a.next=20,e.createCredential({id:e.bitbucketCredentialId,username:r,password:l,description:t("Automatically generated by bitbucket(".concat(r,")"))});case 20:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())}}),h=(0,P.default)(l.prototype,"clearBitbucketErrors",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.creatBitBucketServersError={}}}}),v=(0,P.default)(l.prototype,"resetStore",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.orgList={isLoading:!1,data:[]},e.activeRepoIndex="",e.githubCredentialId="",e.formData={}}}}),g=(0,P.default)(l.prototype,"checkCronScript",[j.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=t.devops,n=t.script,r=t.pipeline;return e.request.post("kapis/devops.kubesphere.io/v1alpha2/devops/".concat(a,"/checkCron"),{cron:n,pipelineName:r})}}}),l);a.default=A},2865:function(e,t,a){e.exports={desc:"Cridential__desc--2emvX",narrowItem:"Cridential__narrowItem--rP-DT"}},2866:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s=r(n(61)),d=r(n(62)),c=r(n(30)),f=r(n(44)),p=r(n(13)),m=r(n(14)),h=r(n(17)),v=r(n(16)),g=r(n(66)),b=r(n(18)),y=r(n(41)),_=(r(n(45)),r(n(0))),E=r(n(3)),k=n(19),C=n(60),S=r(n(22)),w=r(n(58)),D=r(n(386)),I=r(n(38)),N=r(n(129)),P=r(n(267)),j=r(n(224)),x=n(114),L=r(n(3825)),R=(0,C.observer)((i=function(e){function a(e){var t;return(0,p.default)(this,a),t=(0,h.default)(this,(0,v.default)(a).call(this,e)),(0,f.default)(t,"handleActiveRepoChange",u,(0,g.default)(t)),t.handleGetRepoList=function(){t.props.store.getRepoList()},t.handleSubmit=function(e){var a,n=t.props.store,r=n.orgList,l=n.activeRepoIndex,i=n.githubCredentialId,u=e.currentTarget.dataset&&e.currentTarget.dataset.repoIndex,o=(a={},(0,c.default)(a,x.REPO_KEY_MAP[t.scmType],{repo:(0,S.default)(r.data,"".concat(l,".repositories.items.").concat(u,".name")),credential_id:i,owner:(0,S.default)(r.data[l],"name"),discover_branches:1,discover_pr_from_forks:{strategy:2,trust:2},discover_pr_from_origin:2}),(0,c.default)(a,"description",(0,S.default)(r.data,"".concat(l,".repositories.items.").concat(u,".description"))),a);t.props.handleSubmit(o)},(0,f.default)(t,"handlePasswordConfirm",o,(0,g.default)(t)),t.tokenFormRef=_.default.createRef(),t.state={},t}return(0,b.default)(a,e),(0,m.default)(a,[{key:"renderAccessTokenForm",value:function(){var e=this.props.store,a=e.tokenFormData,n=e.isAccessTokenWrong;return _.default.createElement("div",{className:L.default.card},_.default.createElement(P.default,{data:a,onSubmit:this.handlePasswordConfirm,ref:this.tokenFormRef},_.default.createElement(P.default.Item,{error:n?{message:{message:t.html("WRONG_GITHUB_TOKEN_DESC")}}:{},label:t("Token"),desc:_.default.createElement("div",{className:"clear-right"},_.default.createElement("p",null,t.html("GET_GITHUB_TOKEN_DESC")))},_.default.createElement(D.default,{name:"token"})),_.default.createElement(j.default,{className:L.default.confirmButton,loading:this.state.isLoading,onClick:this.handlePasswordConfirm},t("Confirm"))))}},{key:"render",value:function(){var e=this,a=this.props.store,n=a.orgList,r=a.activeRepoIndex,l=a.getRepoListLoading,i=(0,S.default)(n.data,"".concat(r,".repositories.items"),[]),u=(0,S.default)(n.data,"".concat(r,".repositories.nextPage"));return!n.isLoading&&(0,w.default)(n.data)?_.default.createElement("div",{className:L.default.tabContent},n.isLoading?_.default.createElement(N.default,null,_.default.createElement("div",{className:L.default.orgList})):_.default.createElement("div",{className:L.default.orgList},this.renderAccessTokenForm()),_.default.createElement("div",{className:L.default.repoList},_.default.createElement("div",{className:L.default.placeHolder},_.default.createElement("img",{src:"/assets/empty-card.svg",alt:""}),_.default.createElement("p",{className:L.default.title},t("".concat(this.scmType,"_ACCESSTOKEN_PLACEHOLDER")))))):_.default.createElement("div",{className:L.default.tabContent},_.default.createElement("div",{className:L.default.orgList},n.isLoading?_.default.createElement(N.default,null,_.default.createElement("div",{className:L.default.orgList})):null,n.isLoading?null:n.data.map((function(t,a){return _.default.createElement("div",{key:t.name,className:(0,E.default)(L.default.repo,(0,c.default)({},L.default["repo-active"],r===a)),"data-repo-index":a,onClick:e.handleActiveRepoChange},_.default.createElement("div",{className:L.default.avatar},_.default.createElement("img",{src:t.avatar,alt:t.name})),_.default.createElement("div",{className:L.default.name},t.name))}))),l?_.default.createElement(N.default,null,_.default.createElement("div",{className:L.default.repoList})):_.default.createElement("div",{className:L.default.repoList},i.length?i.map((function(a,n){return _.default.createElement("div",{className:L.default.repo,key:a.name},_.default.createElement("div",{className:L.default.icon},_.default.createElement(I.default,{name:e.scmType,size:40})),_.default.createElement("div",{className:L.default.info},_.default.createElement("div",{className:L.default.name},a.name),_.default.createElement("div",{className:L.default.desc},a.description)),_.default.createElement("div",{className:L.default.action,onClick:e.handleSubmit,"data-repo-index":n},_.default.createElement(j.default,{type:"control"},t("Select this repo"))))})):null,u?_.default.createElement("div",{className:(0,E.default)(L.default.repo,L.default.loadMore),onClick:this.handleGetRepoList},t("Load more")):null))}},{key:"scmType",get:function(){return"github"}}]),a}(_.default.Component),u=(0,y.default)(i.prototype,"handleActiveRepoChange",[k.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=t.currentTarget.dataset.repoIndex,n=e.props.store.orgList;e.props.store.handleChangeActiveRepoIndex(parseInt(a,10)),(0,S.default)(n.data,"[".concat(a,"].repositories.items"),[]).length||e.props.store.getRepoList(parseInt(a,10))}}}),o=(0,y.default)(i.prototype,"handlePasswordConfirm",[k.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return((0,d.default)(s.default.mark((function t(){var a,n;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.props.name,n=e.tokenFormRef.current._formData,e.setState({isLoading:!0}),e.props.store.putAccessToken({token:n.token,name:a}).finally((function(){e.setState({isLoading:!1})}));case 4:case"end":return t.stop()}}),t)}))))}}),l=i))||l;a.default=R},2867:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o=r(n(61)),s=r(n(62)),d=r(n(13)),c=r(n(14)),f=r(n(17)),p=r(n(16)),m=r(n(18)),h=r(n(22)),v=r(n(58)),g=r(n(115)),b=r(n(0)),y=n(60),_=r(n(227)),E=r(n(38)),k=n(938),C=r(n(386)),S=r(n(225)),w=r(n(267)),D=r(n(2602)),I=r(n(2578)),N=r(n(2530)),P=n(49),j=n(114),x=r(n(2864)),L=r(n(2575)),R=r(n(3830)),O=r(n(3832)),M=r(n(3834)),T=(0,y.observer)((u=i=function(e){function a(e){var n;return(0,d.default)(this,a),(n=(0,f.default)(this,(0,p.default)(a).call(this,e))).handleChange=function(e){return function(t){var a=n.props.formTemplate;(0,g.default)(a,e,t),n.forceUpdate()}},n.removeCronError=function(){n.state.cronMessage&&n.setState({cronMessage:{}})},n.checkCronScript=(0,s.default)(o.default.mark((function e(){var a,r,l,i,u,s,d,c;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.props,r=a.formTemplate,l=a.type,i=r.project_id,u=r.name,(s=(0,h.default)(r,"".concat(n.prefix,".timer_trigger.cron"),""))&&n.script!==s){e.next=5;break}return e.abrupt("return");case 5:return n.script=s,e.next=8,n.scmStore.checkCronScript({devops:i,script:s,pipeline:"create"===l?void 0:u});case 8:if("error"!==(d=e.sent).result){e.next=12;break}return n.setState({cronMessage:{error:d.message}}),e.abrupt("return");case 12:"ok"===d.result&&(c=t("CRON_DESC",{lastTime:(0,P.getLocalTime)(d.lastTime).format("".concat(t("MMMM Do YYYY")," HH:mm:ss")),nextTime:(0,P.getLocalTime)(d.nextTime).format("".concat(t("MMMM Do YYYY")," HH:mm:ss"))}),n.setState({cronMessage:{message:c}}));case 13:case"end":return e.stop()}}),e)}))),n.handleScrollToBottom=function(){var e=n.props.formTemplate.project_id,t=n.pipelineStore.list,a=t.total,r=t.page;a<=t.limit*r||n.pipelineStore.fetchList({project_id:e,filter:"no-multi-branch-job",page:r+1})},n.renderDisCarder=function(){var e=n.props.formTemplate,a=(0,h.default)(e,"multi_branch_pipeline");if(e.enable_discarder)return(0,v.default)(a)?b.default.createElement("div",{className:M.default.wrapper},b.default.createElement(k.Columns,null,b.default.createElement(k.Column,null,b.default.createElement(w.default.Item,{label:t("Days to keep old items"),desc:"".concat(t("if not empty, old items are only kept up to this number of days"),". (").concat(t("defaultValue -1 means not discard"),")")},b.default.createElement(C.default,{name:"".concat(n.prefix,".discarder.days_to_keep"),defaultValue:"7"}))),b.default.createElement(k.Column,null,b.default.createElement(w.default.Item,{label:t("Maximum number of builds to keep"),desc:"".concat(t("if not empty, only up to this number of old items are kept"),". (").concat(t("defaultValue -1 means not discard"),")")},b.default.createElement(C.default,{name:"".concat(n.prefix,".discarder.num_to_keep"),defaultValue:"10"}))))):b.default.createElement("div",{className:M.default.wrapper},b.default.createElement(k.Columns,null,b.default.createElement(k.Column,null,b.default.createElement(w.default.Item,{label:t("Days to keep old branches"),desc:t("tips_days_keep_withscm")},b.default.createElement(C.default,{name:"".concat(n.prefix,".discarder.days_to_keep"),defaultValue:"-1"}))),b.default.createElement(k.Column,null,b.default.createElement(w.default.Item,{label:t("Max # of old branches to keep"),desc:t("tips_numbers_keep_withscm")},b.default.createElement(C.default,{name:"".concat(n.prefix,".discarder.num_to_keep"),defaultValue:"-1"})))))},n.scmStore=new x.default,n.pipelineStore=new L.default,n.state={cronMessage:{}},n}return(0,m.default)(a,e),(0,c.default)(a,[{key:"componentDidMount",value:function(){var e=this.props.formTemplate.project_id;this.pipelineStore.fetchList({project_id:e,filter:"no-multi-branch-job"})}},{key:"renderTip",value:function(e){return b.default.createElement(_.default,{content:e,placement:"right"},b.default.createElement(E.default,{name:"question",className:"margin-l12"}))}},{key:"renderNoSource",value:function(){var e=this.props.formTemplate,a=(0,h.default)(e,"enable_timer_trigger"),n=(0,h.default)(e,"enable_remote_trigger");return b.default.createElement("div",null,b.default.createElement(w.default.Item,{desc:t("If you check this option, you cannot run multiple builds concurrently.")},b.default.createElement(D.default,{name:"".concat(this.prefix,".disable_concurrent"),value:"true"},t("No concurrent builds"))),b.default.createElement("div",{className:"h6"},t("Parametric build")," ",this.renderTip(t("tips_Parametric_build"))),b.default.createElement(R.default,{name:"".concat(this.prefix,".parameters"),formTemplate:this.props.formTemplate}),b.default.createElement("div",{className:"h6"},t("Build trigger")),b.default.createElement(w.default.Item,null,b.default.createElement(D.default,{name:"enable_timer_trigger",onChange:this.handleChange("enable_timer_trigger")},t("Timing build"),this.renderTip(t("tips_Timing_build")))),a&&b.default.createElement("div",{className:M.default.wrapper},b.default.createElement(k.Columns,null,b.default.createElement(k.Column,null,b.default.createElement(w.default.Item,{label:t("Schedule"),desc:this.state.cronMessage.message||t.html("PIPELINE_CRONJOB_CRON_DESC"),tip:t("tips_timer_trigger"),error:this.state.cronMessage.error?{message:this.state.cronMessage.error}:null},b.default.createElement(C.default,{name:"".concat(this.prefix,".timer_trigger.cron"),placeholder:"Every hour, on the hour",onChange:this.removeCronError,onBlur:this.checkCronScript}))))),b.default.createElement(w.default.Item,null,b.default.createElement(D.default,{name:"enable_remote_trigger",onChange:this.handleChange("enable_remote_trigger")},t("Trigger a remote build (for example, using a script)"))),n&&b.default.createElement("div",{className:M.default.wrapper},b.default.createElement(w.default.Item,{label:t("Authentication token"),desc:t("AUTHENTICATION_TOKEN_DESC"),tip:t("tips_Authentication_token")},b.default.createElement(C.default,{name:"".concat(this.prefix,".remote_trigger.token"),placeholder:t("Use the following URL to remotely trigger the build")}))))}},{key:"renderGitOptions",value:function(){return b.default.createElement(b.default.Fragment,null,b.default.createElement("div",{className:"h6"},t("Git Clone Options")),b.default.createElement(k.Columns,null,b.default.createElement(k.Column,null,b.default.createElement(w.default.Item,{label:t("clone depth")},b.default.createElement(N.default,{name:"".concat(this.scmPrefix,".git_clone_option.depth"),defaultValue:1}))),b.default.createElement(k.Column,null,b.default.createElement(w.default.Item,{label:t("Pipeline clone timeout (in minutes)")},b.default.createElement(N.default,{name:"".concat(this.scmPrefix,".git_clone_option.timeout"),defaultValue:20})))),b.default.createElement(w.default.Item,null,b.default.createElement(D.default,{name:"".concat(this.scmPrefix,".git_clone_option.shallow"),defaultValue:!0},t("Whether to open shallow clone"))),b.default.createElement("div",{className:"h6"},t("Webhook")),b.default.createElement(w.default.Item,{label:t("Push message to"),tip:t("WEBHOOK_DESC")},b.default.createElement(C.default,{value:this.webhookUrl,disabled:!0})))}},{key:"renderRegFilter",value:function(){var e=this.props.formTemplate.enable_regex_filter;return b.default.createElement(b.default.Fragment,null,b.default.createElement(w.default.Item,null,b.default.createElement(D.default,{name:"enable_regex_filter",onChange:this.handleChange("enable_regex_filter")},t("REG_FILTER_DESC"))),e&&b.default.createElement("div",{className:M.default.wrapper},b.default.createElement(w.default.Item,{label:t("Regex filter")},b.default.createElement(C.default,{name:"".concat(this.scmPrefix,".regex_filter"),defaultValue:".*"}))))}},{key:"renderWithSource",value:function(){var e=this.props.formTemplate,a=(0,h.default)(e,"multi_branch_pipeline.source_type",""),n=e.enable_timer_trigger,r=e.enable_multibranch_job_trigger,l=this.pipelineStore.list.isLoading,i=["git","github","bitbucket_server"].includes(a);return b.default.createElement("div",null,"github"===a?b.default.createElement(b.default.Fragment,null,b.default.createElement("div",{className:"h6"},t("Behavioral strategy")),b.default.createElement(w.default.Item,null,b.default.createElement(O.default,{name:"multi_branch_pipeline.github_source"}))):null,b.default.createElement("div",{className:"h6"},t("Script Path")),b.default.createElement(w.default.Item,{label:t("Path"),desc:t("Specify the location of the Jenkinsfile in the source code repository")},b.default.createElement(C.default,{name:"".concat(this.prefix,".script_path"),defaultValue:"Jenkinsfile"})),b.default.createElement("div",{className:"h6"},t("Scan Repo Trigger")),i?this.renderRegFilter():null,b.default.createElement(w.default.Item,null,b.default.createElement(D.default,{name:"enable_timer_trigger",onChange:this.handleChange("enable_timer_trigger")},t("If not, scan regularly"),this.renderTip(t("TIME_TRIGGER_DESC")))),n&&b.default.createElement("div",{className:M.default.wrapper},b.default.createElement(w.default.Item,{label:t("Scan interval")},b.default.createElement(S.default,{name:"".concat(this.prefix,".timer_trigger.interval"),options:j.TIMETRIGGERINTERVALS,defaultValue:"svn"===a||"single_svn"===a?"600000":"3600000"}))),b.default.createElement("div",{className:"h6"},t("Build trigger")),b.default.createElement(w.default.Item,null,b.default.createElement(D.default,{name:"enable_multibranch_job_trigger",onChange:this.handleChange("enable_multibranch_job_trigger")},t("Pipeline Event Trigger"))),r&&b.default.createElement("div",{className:M.default.wrapper},b.default.createElement(k.Columns,null,b.default.createElement(k.Column,null,b.default.createElement(w.default.Item,{label:t("When Create Pipeline"),desc:t("WHEN_CHRETE_PIEPLINE_DESC")},b.default.createElement(S.default,{name:"".concat(this.prefix,".multibranch_job_trigger.create_action_job_to_trigger"),isLoading:l,isLoadingAtBottom:!0,onMenuScrollToBottom:this.handleScrollToBottom,options:this.pipelineLists,placeholder:t("select a pipeline")}))),b.default.createElement(k.Column,null,b.default.createElement(w.default.Item,{label:t("When Delete Pipeline"),desc:t("WHEN_DELETE_PIEPLINE_DESC")},b.default.createElement(S.default,{name:"".concat(this.prefix,".multibranch_job_trigger.delete_action_job_to_trigger"),isLoading:l,isLoadingAtBottom:!0,onMenuScrollToBottom:this.handleScrollToBottom,options:this.pipelineLists,placeholder:t("select a pipeline")}))))),i?this.renderGitOptions():null)}},{key:"render",value:function(){var e=this.props,a=e.formRef,n=e.formTemplate,r=(0,h.default)(n,"multi_branch_pipeline");return b.default.createElement("div",{className:M.default.advance},b.default.createElement(I.default,{title:t("Advanced Settings"),desc:t("CICD_ADVANCE_SETTINGS_DESC")}),b.default.createElement(w.default,{data:n,ref:a},b.default.createElement("div",{className:"h6"},(0,v.default)(r)?t("Build Settings"):t("Branches Settings")),b.default.createElement(w.default.Item,null,b.default.createElement(D.default,{value:"true",name:"enable_discarder",onChange:this.handleChange("enable_discarder")},(0,v.default)(r)?t("Discard old items"):t("Discard old branch"),this.renderTip((0,v.default)(r)?t("tips_disable_concurrent"):t("tips_disable_concurrent_withscm")))),this.renderDisCarder(),(0,v.default)(r)?this.renderNoSource():this.renderWithSource()))}},{key:"sourceType",get:function(){var e=this.props.formTemplate;return(0,h.default)(e,"multi_branch_pipeline.source_type","")}},{key:"prefix",get:function(){return this.sourceType?"multi_branch_pipeline":"pipeline"}},{key:"scmPrefix",get:function(){return"multi_branch_pipeline.".concat(j.REPO_KEY_MAP[this.sourceType])}},{key:"webhookUrl",get:function(){var e=this.props.formTemplate,t=(0,h.default)(e,"".concat(this.scmPrefix,".url"),""),a=(0,h.default)(e,"".concat(this.scmPrefix,".api_uri"),""),n=(0,h.default)(e,"".concat(this.scmPrefix,".owner"),""),r=(0,h.default)(e,"".concat(this.scmPrefix,".repo"),""),l="".concat(a,"/scm/").concat(n,"/").concat(r,".git");switch(this.sourceType){case"bitbucket_server":return"".concat(window.location.protocol,"//").concat(window.location.host,"/devops_webhook/git/?url=").concat(l);case"github":return"".concat(window.location.protocol,"//").concat(window.location.host,"/devops_webhook/").concat(this.sourceType,"/");default:return"".concat(window.location.protocol,"//").concat(window.location.host,"/devops_webhook/git/?url=").concat(t)}}},{key:"pipelineLists",get:function(){return this.pipelineStore.list.data.map((function(e){return{label:e.name,value:e.fullName}}))}}]),a}(b.default.Component),i.defaultProps={type:"create"},l=u))||l;a.default=T},2868:function(e,t,a){e.exports={wrapper:"ParamsInput__wrapper--3bgN1",header:"ParamsInput__header--3GgJx",content:"ParamsInput__content--2mKNb",itemWrapper:"ParamsInput__itemWrapper--39ii4",itemTitle:"ParamsInput__itemTitle--2qP8L",delete:"ParamsInput__delete--1Vqm9"}},2869:function(e,t,a){e.exports={wrapper:"ActionsInput__wrapper--9gF5T",header:"ActionsInput__header--1r0Y5",content:"ActionsInput__content--3EhVO",itemWrapper:"ActionsInput__itemWrapper--2QSjL",itemTitle:"ActionsInput__itemTitle--1EB3D",delete:"ActionsInput__delete--7pDxW"}},2870:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=r(n(13)),i=r(n(14)),u=r(n(17)),o=r(n(16)),s=r(n(18)),d=r(n(0)),c=r(n(1)),f=r(n(387)),p=r(n(2524)),m=r(n(2871)),h=r(n(3864)),v=function(e){function a(e){var t;return(0,l.default)(this,a),(t=(0,u.default)(this,(0,o.default)(a).call(this,e))).hideConfim=function(){t.setState({isshowComfim:!1})},t.showConfirm=function(){t.setState({isshowComfim:!0})},t.handleCancel=function(){t.hideConfim();var e=t.props.params,a=e.project_id,n=e.name;localStorage.removeItem("".concat(globals.user.username,"-").concat(a,"-").concat(n)),t.props.onCancel()},t.CLIENT_WIDTH=document.body.clientWidth,t.state={isshowComfim:!1},t}return(0,s.default)(a,e),(0,i.default)(a,[{key:"renderForms",value:function(){var e=this.props,t=e.jsonData,a=e.projectName,n=e.params,r=e.isSubmitting;return d.default.createElement(m.default,{className:h.default.content,isEditMode:!0,params:n,jsonData:t,projectName:a,onOk:this.props.onOk,onCancel:this.showConfirm,isSubmitting:r})}},{key:"render",value:function(){var e=this.props.visible;return d.default.createElement(d.default.Fragment,null,d.default.createElement(f.default,{width:Math.max(this.CLIENT_WIDTH-40,1200),bodyClassName:h.default.body,visible:e,closable:!1,maskClosable:!1,onOk:this.props.onOk,onCancel:this.showConfirm,hideHeader:!0,hideFooter:!0},d.default.createElement("div",{className:h.default.title},t("Pipeline Configuration")),this.renderForms()),d.default.createElement(p.default,{visible:this.state.isshowComfim,onCancel:this.hideConfim,onOk:this.handleCancel,title:t("Close"),desc:t("Are you sure to close this pipeline Editor ?")}))}}]),a}(d.default.Component);a.default=v,v.propTypes={name:c.default.string,module:c.default.string,store:c.default.object,formTemplate:c.default.object,visible:c.default.bool,onOk:c.default.func,onCancel:c.default.func,jsonData:c.default.object,isSubmitting:c.default.bool},v.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1}},2871:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d,c,f=r(n(37)),p=r(n(44)),m=r(n(13)),h=r(n(14)),v=r(n(17)),g=r(n(16)),b=r(n(66)),y=r(n(18)),_=r(n(41)),E=(r(n(45)),r(n(0))),k=r(n(3)),C=r(n(22)),S=r(n(58)),w=n(60),D=n(19),I=r(n(2682)),N=r(n(2676)),P=r(n(3835)),j=r(n(3838)),x=r(n(3862)),L=r(n(3863)),R={json:{pipeline:{stages:[],agent:{type:"any"}}}},O=(0,w.observer)((c=d=function(e){function a(e){var t;if((0,m.default)(this,a),t=(0,v.default)(this,(0,g.default)(a).call(this,e)),(0,p.default)(t,"clearFocus",u,(0,b.default)(t)),(0,p.default)(t,"handleContinue",o,(0,b.default)(t)),(0,p.default)(t,"handleDiscard",s,(0,b.default)(t)),t.state={},e.isEditMode){t.store=new x.default,t.store.params=e.params;var n=e.params,r=n.project_id,l=n.name;t.prevData=JSON.parse(localStorage.getItem("".concat(globals.user.username,"-").concat(r,"-").concat(l))),(0,S.default)(e.jsonData)?t.store.setData(t.prevData||R):(t.store.jsonData=(0,f.default)({},e.jsonData),t.prevData&&(t.state={showConfirmPrevdata:!0}))}return t}return(0,y.default)(a,e),(0,h.default)(a,[{key:"render",value:function(){var e=this.props,a=e.isEditMode,n=e.className,r=e.isSubmitting;return E.default.createElement("div",{className:(0,k.default)(L.default.content,"pipeline-content",n)},E.default.createElement(I.default,{enableToggleFullScreen:!a,XOffset:30,YOffset:60,onClick:this.clearFocus},E.default.createElement(P.default,{store:this.store,isEditMode:a,stages:this.stages})),a?E.default.createElement(j.default,{store:this.store,onOk:this.props.onOk,onCancel:this.props.onCancel,isSubmitting:r}):null,E.default.createElement(N.default,{visible:this.state.showConfirmPrevdata,width:400,title:t("LoadPrevData_Desc"),content:"",cancelText:t("Discard"),confirmText:t("Continue"),onCancel:this.handleDiscard,onConfirm:this.handleContinue}))}},{key:"stages",get:function(){var e=this.props,t=e.isEditMode,a=e.jsonData;return t?this.store.stages:(0,C.default)(a,"json.pipeline.stages",[])}}]),a}(E.default.Component),d.defaultProps={onOK:function(){},onCancel:function(){}},i=c,u=(0,_.default)(i.prototype,"clearFocus",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.isEditMode&&e.store.clearFocus()}}}),o=(0,_.default)(i.prototype,"handleContinue",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=e.props.params,a=t.project_id,n=t.name;e.setState({showConfirmPrevdata:!1}),e.store.setData(e.prevData),localStorage.removeItem("".concat(globals.user.username,"-").concat(a,"-").concat(n))}}}),s=(0,_.default)(i.prototype,"handleDiscard",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=e.props.params,a=t.project_id,n=t.name;e.setState({showConfirmPrevdata:!1}),localStorage.removeItem("".concat(globals.user.username,"-").concat(a,"-").concat(n))}}}),l=i))||l;a.default=O},2872:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.renderStepArgs=void 0;var l=r(n(0)),i=r(n(133)),u=r(n(22)),o=r(n(2466)),s=n(2566),d=r(n(2686)),c=function(e){return(0,u.default)(e,"value.value")?"string"==typeof e.value.value?e.value.value:JSON.stringify(e.value.value):"string"==typeof e.value?e.value:JSON.stringify(e.value)},f=function(e){return l.default.createElement("div",{key:e.key,className:d.default.content__detail},t(e.key)," ",c(e))},p=function(e){return Object.entries(e).map((function(e){return l.default.createElement("div",{key:e[0],className:d.default.content__detail},t(e[0])," ",e[1])}))},m={git:function(e){return"changelog"===e.key||"poll"===e.key?null:f(e)},withCredentials:function(e){var t=c(e);if((0,i.default)(t)&&t.startsWith("${")){var a=(0,s.groovyToJS)(t);return p(a)}return f(e)},checkout:function(e){if("scm"===e.key){var t=c(e);if((0,i.default)(t)&&t.startsWith("[")){var a=(0,s.groovyToJS)(t);return a=(0,o.default)(a,["remote","credentialsId"]),p(a)}return f(e)}return null},default:f};a.renderStepArgs=function(e){return e.arguments?void 0!==e.arguments.length?e.arguments.map((function(t){return m[e.name]?m[e.name](t):m.default(t)})):m[e.name]?m[e.name](e.arguments):m.default(e.arguments):null}},2873:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a(97)),l=n(a(13)),i=n(a(14)),u=n(a(17)),o=n(a(16)),s=n(a(18)),d=n(a(0)),c=n(a(50)),f=n(a(58)),p=n(a(3837)),m=function(e){function t(){var e,a;(0,l.default)(this,t);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return(a=(0,u.default)(this,(e=(0,o.default)(t)).call.apply(e,[this].concat(i)))).getMaxHeight=function(){var e=a.props,t=e.heights,n=e.index;return Math.max.apply(Math,[].concat((0,r.default)(t[n]||[]),(0,r.default)(t[n+1]||[])))},a.onInsertColunm=function(e){return function(){a.props.onInsertColunm(e)}},a.renderLines=function(e,t){return(0,c.default)(e)?e.map((function(n,r){return r===e.length-1?null:d.default.createElement(d.default.Fragment,{key:r},a.renderLine(n,t))})):null},a.renderEditLines=function(){var e=a.props,t=e.heights,n=e.index,r=e.isEditMode,l=[];if(!(0,c.default)(t)||!r)return null;if((0,c.default)(t[n])&&!(0,f.default)(t[n])){var i=t[n],u=i.length,o=i.last,s=void 0===o?u-1:o;l.push(a.renderLine(t[n][s]-50,"left",!0))}if((0,c.default)(t[n+1])&&!(0,f.default)(t[n+1])){var d=t[n+1],p=d.length,m=d.last,h=void 0===m?p-1:m;l.push(a.renderLine(t[n+1][h]-50,"right",!0))}return l},a}return(0,s.default)(t,e),(0,i.default)(t,[{key:"getRightLinePath",value:function(e){return e?(e+=6,"M".concat(35," ").concat(6,"  V ").concat(e-10," Q ").concat(35,", ").concat(e," ").concat(45,", ").concat(e," H ").concat(64)):"M ".concat(35," ").concat(6," H ").concat(64)}},{key:"getLeftLinePath",value:function(e){return e?(e+=6,"M".concat(6," ").concat(e," H ").concat(25," Q ").concat(35,",").concat(e," ").concat(35,",").concat(e-10," V ").concat(6)):"M".concat(6," ").concat(6," H ").concat(35)}},{key:"renderEditButton",value:function(){var e=this.props,t=e.index;if(e.isEditMode)return d.default.createElement("g",{className:p.default.editButton},d.default.createElement("circle",{cx:35,cy:6,r:"10",stroke:"#d8dee5",strokeDasharray:"3,3",fill:"white",strokeWidth:2,onClick:this.onInsertColunm(t+1)}),d.default.createElement("line",{x1:30,x2:40,y1:6,y2:6,stroke:"black"}),d.default.createElement("line",{x1:35,x2:35,y1:1,y2:11,stroke:"black"}))}},{key:"renderLine",value:function(e,t,a){return"left"===t?d.default.createElement("path",{d:this.getLeftLinePath(e),stroke:a?"#d8dee5":"black",strokeWidth:2,fill:"none",markerStart:"url(#path-marker-".concat(a?"grey":"black",")"),markerEnd:"url(#path-marker-".concat(a?"grey":"black",")")}):d.default.createElement("path",{d:this.getRightLinePath(e),stroke:a?"#d8dee5":"black",strokeWidth:2,fill:"none",markerStart:"url(#path-marker-".concat(a?"grey":"black",")"),markerEnd:"url(#path-marker-".concat(a?"grey":"black",")")})}},{key:"renderFirstLines",value:function(){return d.default.createElement(d.default.Fragment,null,this.renderLine(0,"right"),this.renderLine(0,"left"))}},{key:"renderBoldLines",value:function(){var e=this.props,t=e.heights,a=e.index;return d.default.createElement(d.default.Fragment,null,this.renderLines(t[a],"left"),this.renderLines(t[a+1],"right"))}},{key:"renderEdges",value:function(){return d.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg"},d.default.createElement("defs",null,d.default.createElement("marker",{id:"path-marker-black",viewBox:"0 0 12 12",refX:"6",refY:"6",markerWidth:"6",markerHeight:"6",orient:"auto-start-reverse"},d.default.createElement("circle",{cx:6,cy:6,r:5,fill:"#329dce"})),d.default.createElement("marker",{id:"path-marker-grey",viewBox:"0 0 12 12",refX:"6",refY:"6",markerWidth:"6",markerHeight:"6",orient:"auto-start-reverse"},d.default.createElement("circle",{cx:6,cy:6,r:5,fill:"#d8dee5"}))),this.renderEditLines(),this.renderBoldLines(),this.renderFirstLines(),this.renderEditButton())}},{key:"render",value:function(){var e=this.props,t=e.heights,a=e.index,n=e.posision,r=e.isEditMode;return r||a!==t.length-1?d.default.createElement(d.default.Fragment,null,d.default.createElement("div",{className:p.default.connects__colunm,style:{height:"".concat(this.getMaxHeight()+40,"px")}},this.renderEdges(),r&&!a&&"Right"===n?this.renderEditButton():null)):d.default.createElement("div",{className:p.default.connects__colunm})}}]),t}(d.default.Component);t.default=m},2874:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o=r(n(13)),s=r(n(14)),d=r(n(17)),c=r(n(16)),f=r(n(18)),p=r(n(0)),m=r(n(1)),h=n(60),v=r(n(387)),g=r(n(22)),b=r(n(115)),y=r(n(2867)),_=["discarder","timer_trigger","remote_trigger","regex_filter","multibranch_job_trigger"],E=(0,h.observer)((u=i=function(e){function a(e){var t;return(0,o.default)(this,a),(t=(0,d.default)(this,(0,c.default)(a).call(this,e))).setEnableFlag=function(e){var a=e||{},n=a.pipeline,r=a.multi_branch_pipeline,l=n||r;l&&(_.forEach((function(t){var a=l[t]||(0,g.default)(l,"svn_source.".concat(t))||(0,g.default)(l,"git_source.".concat(t))||(0,g.default)(l,"github_source.".concat(t))||(0,g.default)(l,"bitbucket_server_source.".concat(t))||(0,g.default)(l,"multibranch_job_trigger");(l[t]||a)&&(e["enable_".concat(t)]=!0)})),t.setState({formTemplate:e}))},t.handleOk=function(){var e=t.formRef&&t.formRef.current;e&&e.validate((function(){t.props.onOk(t.formRef.current._formData)}))},t.formRef=p.default.createRef(),t.state={formTemplate:{}},t}return(0,f.default)(a,e),(0,s.default)(a,[{key:"componentWillReceiveProps",value:function(e){var t=e.formTemplate;e.visible&&(this.setEnableFlag(t),(0,b.default)(t,"project_id",this.props.project_id))}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel;return p.default.createElement(v.default,{width:1162,onCancel:n,onOk:this.handleOk,visible:a,closable:!1,title:t("Edit Pipeline")},p.default.createElement(y.default,{type:"edit",formRef:this.formRef,formTemplate:this.state.formTemplate}))}}]),a}(p.default.Component),i.propTypes={name:m.default.string,branches:m.default.array},i.defaultProps={branches:[],visible:!1,onOk:function(){},onCancel:function(){}},l=u))||l;a.default=E},2875:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,l,i,u,o=n(a(61)),s=n(a(62)),d=n(a(44)),c=n(a(13)),f=n(a(17)),p=n(a(16)),m=n(a(66)),h=n(a(18)),v=n(a(41)),g=(n(a(45)),n(a(50))),b=a(19),y=n(a(270)),_=(r=function(e){function t(){var e,a;(0,c.default)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=(0,f.default)(this,(e=(0,p.default)(t)).call.apply(e,[this].concat(r))),(0,d.default)(a,"detail",l,(0,m.default)(a)),(0,d.default)(a,"isLoading",i,(0,m.default)(a)),(0,d.default)(a,"fetchDetail",u,(0,m.default)(a)),a}return(0,h.default)(t,e),t}(n(a(2576)).default),l=(0,v.default)(r.prototype,"detail",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),i=(0,v.default)(r.prototype,"isLoading",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),u=(0,v.default)(r.prototype,"fetchDetail",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return(function(){var t=(0,s.default)(o.default.mark((function t(a){var n,r,l,i,u,s;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.project_id,r=a.branch,l=a.name,i="",i=r?"kapis/devops.kubesphere.io/v1alpha2/devops/".concat(n,"/pipelines/").concat(l,"/branches/").concat(encodeURIComponent(r),"/sonarstatus "):"kapis/devops.kubesphere.io/v1alpha2/devops/".concat(n,"/pipelines/").concat(l,"/sonarstatus"),e.isLoading=!0,t.next=6,e.request.get(i,null,null,(function(){return"no  sonarqube"})).finally((function(){e.isLoading=!1}));case 6:u=t.sent,s=(0,g.default)(u)?u:[],e.detail=s.length?s.map(y.default.codequality)[0]:{};case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}),r);t.default=_},2876:function(e,a,n){"use strict";var r=n(4),l=n(81);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i,u,o,s=r(n(13)),d=r(n(14)),c=r(n(17)),f=r(n(16)),p=r(n(18)),m=l(n(0)),h=n(60),v=n(226),g=n(938),b=r(n(2685)),y=n(2638),_=r(n(3877)),E=(0,h.observer)((o=u=function(e){function a(){return(0,s.default)(this,a),(0,c.default)(this,(0,f.default)(a).apply(this,arguments))}return(0,p.default)(a,e),(0,d.default)(a,[{key:"renderBaseInfo",value:function(){var e=this.props.detailStore.detail;return m.default.createElement(g.Columns,{className:_.default.baseInfo},m.default.createElement(g.Column,{className:_.default.baseInfo__item},m.default.createElement("div",{className:_.default.dashboardValue},m.default.createElement(b.default,{score:e.weatherScore})),m.default.createElement("div",{className:_.default.dashboardLable},t("Health Status"))),m.default.createElement(g.Column,{className:_.default.baseInfo__item},m.default.createElement("div",{className:_.default.dashboardValue},m.default.createElement(y.ReactComponent,{style:{width:"20px",height:"20px"}})," ",e.totalNumberOfBranches||"-"),m.default.createElement("div",{className:_.default.dashboardLable},t("Branch Count"))),m.default.createElement(g.Column,{className:_.default.baseInfo__item}))}},{key:"renderNavLink",value:function(e){var a=e.name,n=e.title,r=this.props,l=r.detailStore,i=r.sonarqubeStore,u=this.enabledActions.includes("edit");if(!a)return null;if(l&&i){if((!u||this.isMutiBranch)&&"pipeline"===a)return null;if(!i.detail.totalStatus&&"code-quality"===a)return null;if(!this.isMutiBranch&&"branch"===a)return null;if(!l.detail.totalNumberOfPullRequests&&"pull-request"===a)return null}return m.default.createElement(v.NavLink,{key:a,className:_.default.navItem,activeClassName:_.default.active,to:"".concat(this.props.match.url,"/").concat(a)},t(n))}},{key:"render",value:function(){var e=this,t=this.props.route;return m.default.createElement(m.default.Fragment,null,this.renderBaseInfo(),m.default.createElement("div",{className:_.default.nav},t.routes.map((function(t){return e.renderNavLink(t)}))))}},{key:"enabledActions",get:function(){var e=this.props.match.params.project_id;return globals.app.getActions({module:"pipelines",project:e})}},{key:"isMutiBranch",get:function(){var e=this.props.detailStore;return Boolean(e.detail.scmSource)}}]),a}(m.Component),u.defaultProps={module:""},i=o))||i,k=(0,h.inject)("rootStore")((0,h.observer)(E));a.default=k},2877:function(e,t,a){e.exports={branchIcon:"Sider__branchIcon--1p8LE",loading:"Sider__loading--2K3nt"}},2878:function(e,t,a){e.exports={pipelineCard:"PipeLine__pipelineCard--1QFjN",pipelineCard__toolbar:"PipeLine__pipelineCard__toolbar--1fCHz",icon:"PipeLine__icon--3lL8K",pipelineCard__btnGroup:"PipeLine__pipelineCard__btnGroup--2Q4jP",pipelineCard__main:"PipeLine__pipelineCard__main--zhBNo",codeEditor:"PipeLine__codeEditor--1yRVO",checkResult:"PipeLine__checkResult--2397F"}},2879:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d,c,f,p,m,h=r(n(61)),v=r(n(63)),g=r(n(62)),b=r(n(44)),y=r(n(13)),_=r(n(14)),E=r(n(17)),k=r(n(16)),C=r(n(66)),S=r(n(18)),w=r(n(41)),D=(r(n(45)),r(n(269))),I=r(n(50)),N=n(953),P=n(19),j=r(n(2476)),x=r(n(2576)),L=r(n(2575)),R="kapis/devops.kubesphere.io/v1alpha2/devops/",O=(l=function(e){function a(){var e;return(0,y.default)(this,a),e=(0,E.default)(this,(0,k.default)(a).call(this)),(0,b.default)(e,"detail",i,(0,C.default)(e)),(0,b.default)(e,"project_id",u,(0,C.default)(e)),(0,b.default)(e,"commitsList",o,(0,C.default)(e)),(0,b.default)(e,"artifactsList",s,(0,C.default)(e)),(0,b.default)(e,"isLoading",d,(0,C.default)(e)),(0,b.default)(e,"getNodesStatusLoading",c,(0,C.default)(e)),(0,b.default)(e,"nodesStatus",f,(0,C.default)(e)),(0,b.default)(e,"runDetail",p,(0,C.default)(e)),(0,b.default)(e,"runDetailLogs",m,(0,C.default)(e)),e.saveAsFile=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default.txt",a=new Blob([e],{type:"text/plain;charset=utf-8"});(0,N.saveAs)(a,t)},e.pipelineStore=new L.default,e}var n,r,l,w,x,O,M,T,A;return(0,S.default)(a,e),(0,_.default)(a,[{key:"getCommits",value:(A=(0,g.default)(h.default.mark((function e(t){var a,n,r,l,i,u,o;return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.name,n=t.branch,r=t.runid,l=t.project_id,t.workspace,i=(0,v.default)(t,["name","branch","runid","project_id","workspace"]),a=decodeURIComponent(a),u=i.page,this.commitsList.isLoading=!0,e.next=6,this.request.get("".concat(R).concat(l,"/pipelines/").concat(a).concat(n?"/branches/".concat(encodeURIComponent(n)):"","/runs/").concat(r,"/"),{start:10*(u-1)||0});case 6:o=e.sent,this.commitsList={data:o.changeSet||[],limit:10,total:o.changeSet.length,page:parseInt(u,10)||1,filters:(0,D.default)(i,"project_id"),isLoading:!1,selectedRowKeys:[]};case 8:case"end":return e.stop()}}),e,this)}))),function(e){return A.apply(this,arguments)})},{key:"getArtifacts",value:(T=(0,g.default)(h.default.mark((function e(t){var a,n,r,l,i,u,o;return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.project_id,n=t.name,r=t.branch,l=t.runid,t.workspace,i=(0,v.default)(t,["project_id","name","branch","runid","workspace"]),n=decodeURIComponent(n),u=i.page,this.artifactsList.isLoading=!0,e.next=6,this.request.get("".concat(R).concat(a,"/pipelines/").concat(n).concat(r?"/branches/".concat(encodeURIComponent(r)):"","/runs/").concat(l,"/artifacts/"),{start:10*(u-1)||0,limit:100});case 6:o=e.sent,this.artifactsList={data:o||[],total:o.length,limit:100,page:parseInt(u,10)||1,filters:(0,D.default)(i,"project_id"),isLoading:!1,selectedRowKeys:[]};case 8:case"end":return e.stop()}}),e,this)}))),function(e){return T.apply(this,arguments)})},{key:"getNodesStatus",value:(M=(0,g.default)(h.default.mark((function e(t){var a,n,r,l,i,u,o=this;return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.project_id,n=t.name,r=t.branch,l=t.runid,n=decodeURIComponent(n),this.getNodesStatusLoading=!0,e.next=5,this.request.get("".concat(R).concat(a,"/pipelines/").concat(n).concat(r?"/branches/".concat(encodeURIComponent(r)):"","/runs/").concat(l,"/nodesdetail/?limit=10000"));case 5:if(i=e.sent,(0,I.default)(i)){e.next=9;break}return this.getNodesStatusLoading=!1,e.abrupt("return");case 9:u=i.some((function(e){return e.steps&&e.steps.length})),this.nodesStatus=u?i.reduce((function(e,t,a){if(t.causeOfBlockage=o.runDetail.causeOfBlockage,"STAGE"===t.type){if(i[a+1]&&"PARALLEL"===i[a+1].type)return e;e.push(t)}else Array.isArray(e[e.length-1])?e[e.length-1].push(t):e.push([t]);return e}),[]):[],i.length&&u||this.getRunStatusLogs({project_id:a,name:n,branch:r,runid:l}),this.getNodesStatusLoading=!1;case 13:case"end":return e.stop()}}),e,this)}))),function(e){return M.apply(this,arguments)})},{key:"getRunDetail",value:(O=(0,g.default)(h.default.mark((function e(t){var a,n,r,l,i,u=this;return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.project_id,n=t.name,r=t.branch,l=t.runid,e.next=3,this.request.get("".concat(R).concat(a,"/pipelines/").concat(decodeURIComponent(n)).concat(r?"/branches/".concat(encodeURIComponent(r)):"","/runs/").concat(l,"/"),null,null,function(){var e=(0,g.default)(h.default.mark((function e(a){var n;return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(404!==a.status){e.next=6;break}return e.next=3,u.pipelineStore.fetchDetail(t);case 3:return n=e.sent,u.runDetail=n.latestRun||{},e.abrupt("return",(0,P.toJS)(u.runDetail));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:i=e.sent,this.runDetail=i,this.isLoading=!1;case 6:case"end":return e.stop()}}),e,this)}))),function(e){return O.apply(this,arguments)})},{key:"replay",value:(x=(0,g.default)(h.default.mark((function e(t,a){var n,r,l,i;return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.project_id,r=t.name,l=t.branch,i=t.runid,e.next=3,this.request.post("".concat(R).concat(n,"/pipelines/").concat(decodeURIComponent(r)).concat(l?"/branches/".concat(encodeURIComponent(l)):"","/runs/").concat(a||i,"/replay"));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return x.apply(this,arguments)})},{key:"getRunStatusLogs",value:(w=(0,g.default)(h.default.mark((function e(t){var a,n,r,l,i;return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.project_id,n=t.name,r=t.branch,l=t.runid,e.next=3,this.request.get("".concat(R).concat(a,"/pipelines/").concat(n).concat(r?"/branches/".concat(encodeURIComponent(r)):"","/runs/").concat(l,"/log/?start=0"));case 3:i=e.sent,this.runDetailLogs=i;case 5:case"end":return e.stop()}}),e,this)}))),function(e){return w.apply(this,arguments)})},{key:"handleDownloadLogs",value:(l=(0,g.default)(h.default.mark((function e(t){var a,n,r,l;return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.project_id,n=t.name,r=t.branch,l=t.runid,n=decodeURIComponent(n),e.next=4,this.getRunStatusLogs({project_id:a,name:n,branch:r,runid:l});case 4:this.saveAsFile(this.runDetailLogs,"log.txt");case 5:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"handleProceed",value:(r=(0,g.default)(h.default.mark((function e(a){var n,r,l,i,u,o,s,d;return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.parameters,r=a.project_id,l=a.name,i=a.runid,u=a.nodeId,o=a.branch,s=a.stepId,d=a.inputId,e.next=3,this.request.post("".concat(R).concat(r,"/pipelines/").concat(l,"/").concat(o?"branches/".concat(encodeURIComponent(o),"/"):"","runs/").concat(i,"/nodes/").concat(u,"/steps/").concat(s,"/"),{id:d,parameters:n},null,(function(e){if(400===e.status)return j.default.error({content:t("Sorry, You don't have permission to do this")}),!0}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"handleBreak",value:(n=(0,g.default)(h.default.mark((function e(t){var a,n,r,l,i,u,o;return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.project_id,n=t.name,r=t.runid,l=t.nodeId,i=t.branch,u=t.stepId,o=t.inputId,e.next=3,this.request.post("".concat(R).concat(a,"/pipelines/").concat(n,"/").concat(i?"branches/".concat(encodeURIComponent(i),"/"):"","runs/").concat(r,"/nodes/").concat(l,"/steps/").concat(u,"/"),{id:o,abort:!0});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}]),a}(x.default),i=(0,w.default)(l.prototype,"detail",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),u=(0,w.default)(l.prototype,"project_id",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),o=(0,w.default)(l.prototype,"commitsList",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:[],page:1,limit:10,total:0,order:"",reverse:!1,filters:{},isLoading:!0}}}),s=(0,w.default)(l.prototype,"artifactsList",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:[],page:1,limit:10,total:0,order:"",reverse:!1,filters:{},isLoading:!0}}}),d=(0,w.default)(l.prototype,"isLoading",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),c=(0,w.default)(l.prototype,"getNodesStatusLoading",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f=(0,w.default)(l.prototype,"nodesStatus",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),p=(0,w.default)(l.prototype,"runDetail",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),m=(0,w.default)(l.prototype,"runDetailLogs",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),(0,w.default)(l.prototype,"getCommits",[P.action],Object.getOwnPropertyDescriptor(l.prototype,"getCommits"),l.prototype),(0,w.default)(l.prototype,"getArtifacts",[P.action],Object.getOwnPropertyDescriptor(l.prototype,"getArtifacts"),l.prototype),(0,w.default)(l.prototype,"getNodesStatus",[P.action],Object.getOwnPropertyDescriptor(l.prototype,"getNodesStatus"),l.prototype),(0,w.default)(l.prototype,"getRunDetail",[P.action],Object.getOwnPropertyDescriptor(l.prototype,"getRunDetail"),l.prototype),(0,w.default)(l.prototype,"getRunStatusLogs",[P.action],Object.getOwnPropertyDescriptor(l.prototype,"getRunStatusLogs"),l.prototype),l);a.default=O},2880:function(e,t,a){e.exports={container:"PipelineLogDialog__container--35WQz",dialogTitle:"PipelineLogDialog__dialogTitle--1HnTm",left:"PipelineLogDialog__left--2XPYd",right:"PipelineLogDialog__right--3bKVu",cutTitle:"PipelineLogDialog__cutTitle--ujjup",leftTab:"PipelineLogDialog__leftTab--1kG5f",leftTab__active:"PipelineLogDialog__leftTab__active--1IuH0",header:"PipelineLogDialog__header--2Took",stageContainer:"PipelineLogDialog__stageContainer--3GP4e",logContainer:"PipelineLogDialog__logContainer--onNir",LogItem:"PipelineLogDialog__LogItem--1HiUE",LogItem__title:"PipelineLogDialog__LogItem__title--3Mx5x",logitem_status:"PipelineLogDialog__logitem_status--wuI80",LogItem_content:"PipelineLogDialog__LogItem_content--lOqJT"}},2881:function(e,t,a){e.exports={content:"CodeQualityResult__content--2GZWN",totalResult:"CodeQualityResult__totalResult--NBt7K",icon:"CodeQualityResult__icon--bz27u",otherCards:"CodeQualityResult__otherCards--1rtnO",resultCard:"CodeQualityResult__resultCard--15y85",title:"CodeQualityResult__title--2m2Ew",value:"CodeQualityResult__value--2fh_X",unit:"CodeQualityResult__unit--3bIia",success:"CodeQualityResult__success--z32XC",error:"CodeQualityResult__error--1knC_",A:"CodeQualityResult__A--1SiVV",B:"CodeQualityResult__B--2Ppec",C:"CodeQualityResult__C--1cGPr",D:"CodeQualityResult__D--152jN",logo:"CodeQualityResult__logo--25dzr"}},2882:function(e,a,n){"use strict";var r=n(81),l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=l(n(13)),u=l(n(14)),o=l(n(17)),s=l(n(16)),d=l(n(18)),c=r(n(0)),f=l(n(1)),p=l(n(3)),m=l(n(2689)),h=function(e){function a(){return(0,i.default)(this,a),(0,o.default)(this,(0,s.default)(a).apply(this,arguments))}return(0,d.default)(a,e),(0,u.default)(a,[{key:"render",value:function(){var e=this.props,a=e.errorClass,n=e.className;return c.default.createElement("span",{className:m.default.codeStatus},c.default.createElement("span",{className:(0,p.default)("codequality-icon",m.default[a],n)}),t(a))}}]),a}(c.PureComponent);a.default=h,h.propTypes={errorClass:f.default.string,className:f.default.string},h.defaultProps={errorClass:"",className:""}},2883:function(e,t,a){e.exports={table:"detail__table--gHTqm",card_content:"detail__card_content--2Bt7p",icon:"detail__icon--DNYO2",info:"detail__info--1ad_4",name:"detail__name--6GhUL",desc:"detail__desc--Y_8kJ"}},3813:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a(97)),l=a(564),i=n(a(3814)),u=n(a(3816)),o=n(a(3866)),s=n(a(3869)),d=n(a(3870)),c=n(a(3871)),f=n(a(3872)),p=n(a(3906)),m="/devops/:project_id",h=[].concat((0,r.default)(f.default),(0,r.default)(p.default),[{path:m,component:i.default,routes:[{path:"".concat(m,"/pipelines"),component:u.default,exact:!0},{path:"".concat(m,"/base-info"),component:o.default,exact:!0},{path:"".concat(m,"/roles"),component:s.default,exact:!0},{path:"".concat(m,"/members"),component:d.default,exact:!0},{path:"".concat(m,"/credentials"),component:c.default,exact:!0},(0,l.getIndexRoute)({path:m,to:"".concat(m,"/pipelines"),exact:!0}),(0,l.getIndexRoute)({path:"*",to:"/404",exact:!0})]}]);t.default=h},3814:function(e,a,n){"use strict";var r=n(4),l=n(81);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i,u=r(n(61)),o=r(n(62)),s=r(n(13)),d=r(n(14)),c=r(n(17)),f=r(n(16)),p=r(n(18)),m=r(n(22)),h=l(n(0)),v=n(60),g=r(n(129)),b=n(564),y=n(955),_=r(n(2783)),E=r(n(2568)),k=r(n(2533)),C=r(n(3815)),S=(0,v.inject)("rootStore")(i=(0,v.observer)(i=function(e){function a(e){var t;if((0,s.default)(this,a),(t=(0,c.default)(this,(0,f.default)(a).call(this,e))).handleChange=function(e){return t.routing.push(e)},!t.props.rootStore.workspace){var n=new k.default;t.props.rootStore.register("workspace",n)}if(!t.props.rootStore.devops){var r=new E.default;e.rootStore.register("devops",r)}return t.init(e.match.params),t}var n;return(0,p.default)(a,e),(0,d.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.match.params.project_id!==this.project&&this.init(e.match.params)}},{key:"init",value:(n=(0,o.default)(u.default.mark((function e(t){var a;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=this.props.rootStore.devops).initializing=!0,e.next=4,this.fetchDevOps(t.project_id);case 4:return e.next=6,this.fetchWorkspace(a.data.workspace);case 6:a.initializing=!1;case 7:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"fetchDevOps",value:function(e){var t=[],a=this.props.rootStore.devops;return t.push(a.fetchDetail({project_id:e})),void 0===(0,m.default)(globals.user,"rules[".concat(e,"]"))&&t.push(a.fetchRules({project_id:e})),Promise.all(t)}},{key:"fetchWorkspace",value:function(e){var t=[],a=this.props.rootStore.workspace;return t.push(a.fetchDetail({workspace:e})),void 0===(0,m.default)(globals.user,"workspace_rules[".concat(e,"]"))&&t.push(a.fetchRules({workspace:e})),Promise.all(t)}},{key:"render",value:function(){var e=this.props,a=e.match,n=e.route,r=e.location,l=this.props.rootStore.devops,i=l.initializing,u=l.data,o=this.props.rootStore.workspace.detail;return i?h.default.createElement(g.default,{className:C.default.loading}):h.default.createElement("div",null,h.default.createElement("div",{className:"ks-page-side"},h.default.createElement(_.default,{type:"devops",icon:"/assets/default-project.svg",defaultIcon:"/assets/default-project.svg",title:t("DevOps Project"),value:u.name,onChange:this.handleChange,workspace:o}),h.default.createElement(y.Nav,{className:"ks-page-nav",navs:globals.app.getDevOpsNavs(this.project),location:r,match:a})),h.default.createElement("div",{className:"ks-page-main"},(0,b.renderRoutes)(n.routes)))}},{key:"project",get:function(){return this.props.match.params.project_id}},{key:"routing",get:function(){return this.props.rootStore.routing}}]),a}(h.Component))||i)||i;a.default=S},3815:function(e,t,a){e.exports={avatar:"containers__avatar--F4dVr",bannerIcon:"containers__bannerIcon--1335x",loading:"containers__loading--Mngmd"}},3816:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i=r(n(37)),u=r(n(61)),o=r(n(62)),s=r(n(13)),d=r(n(14)),c=r(n(17)),f=r(n(16)),p=r(n(18)),m=r(n(0)),h=n(60),v=n(226),g=n(19),b=n(565),y=r(n(22)),_=r(n(269)),E=r(n(271)),k=r(n(190)),C=n(938),S=r(n(38)),w=n(114),D=n(2566),I=r(n(224)),N=r(n(2685)),P=r(n(2542)),j=r(n(2524)),x=r(n(2539)),L=r(n(2549)),R=n(941),O=r(n(2612)),M=r(n(2523)),T=r(n(2561)),A=r(n(2575)),F=r(n(3820)),B=r(n(2870)),z=r(n(2874)),q=r(n(3865)),U={json:{pipeline:{stages:[],agent:{type:"any"}}}},J=(0,h.inject)("rootStore")(l=(0,h.observer)(l=function(e){function a(e){var n;return(0,s.default)(this,a),(n=(0,c.default)(this,(0,f.default)(a).call(this,e))).handleRunBranch=function(){var e=(0,o.default)(u.default.mark((function e(t,a){var r,l;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.props.match.params.project_id,l=n.state.selectPipeline.name,e.next=4,n.store.runBranch({project_id:r,name:l,branch:a,parameters:t});case 4:n.props.rootStore.routing.push("".concat(n.prefix,"/").concat(encodeURIComponent(n.state.selectPipeline.name),"/").concat(a?"branch/".concat(a,"/"):"","activity"));case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.handleMoreMenuClick=function(e){return function(t,a){switch(a){case"edit":n.showEditConfig(e.name);break;case"delete":n.setState({showDelete:!0,selectPipeline:e});break;case"activity":n.props.rootStore.routing.push("".concat(n.prefix,"/").concat(encodeURIComponent(e.name),"/activity"));break;case"run":n.setState({selectPipeline:e}),n.handleRun(e)}}},n.handleFetch=function(e,t){n.routing.query(e,t)},n.handleBranchSelect=function(){var e=(0,o.default)(u.default.mark((function e(t){var a,r,l;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props.match.params,r=n.state.selectPipeline,e.next=4,n.store.getBranchDetail((0,i.default)({},a,{name:r.name,branch:t}));case 4:(l=e.sent).parameters&&(r.parameters=l.parameters,n.setState({selectPipeline:r}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.showCreate=function(){n.setState({showCreate:!0})},n.showEditConfig=function(){var e=(0,o.default)(u.default.mark((function e(t){var a,r;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props.match.params,e.next=3,n.store.getPipeLineConfig(t,a);case 3:(r=e.sent).project_id=a.project_id,n.setState({showEditConfig:!0,configFormData:r});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.hideCreate=function(){n.setState({showCreate:!1}),n.formTemplate={project_id:n.props.match.params.project_id,enable_timer_trigger:!0}},n.hideDelete=function(){n.setState({showDelete:!1})},n.hideEditModal=function(){n.setState({showEdit:!1}),n.props.rootStore.routing.push("".concat(n.prefix,"/").concat(encodeURIComponent(n.createName),"/"))},n.hideEditConfig=function(){n.setState({showEditConfig:!1})},n.hideBranchModal=function(){n.setState({showBranchModal:!1})},n.handleCreate=function(){var e=(0,o.default)(u.default.mark((function e(t){var a,r;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props.match.params,(0,D.updatePipelineParams)(t),n.setState({isSubmitting:!0}),e.next=5,n.store.createPipeline(t).finally((function(){n.setState({isSubmitting:!1})}));case 5:if(r=e.sent){e.next=9;break}return n.setState({isSubmitting:!1}),e.abrupt("return");case 9:if(!t.multi_branch_pipeline){e.next=15;break}return e.next=12,n.store.scanRepository({name:t.multi_branch_pipeline.name,project_id:a.project_id});case 12:return n.setState({showCreate:!1}),n.props.rootStore.routing.push("".concat(n.prefix,"/").concat(encodeURIComponent(t.multi_branch_pipeline.name),"/activity")),e.abrupt("return");case 15:r.name&&(n.createName=r.name,n.setState({showCreate:!1,showEdit:!0}));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleSaveJenkinsFile=function(){var e=(0,o.default)(u.default.mark((function e(t){var a,r,l,i;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props.match.params,n.setState({isSubmitting:!0}),e.next=4,n.store.updateJenkinsFile(t,a).finally((function(){n.setState({isSubmitting:!1})}));case 4:(r=e.sent).name&&(n.setState({showEdit:!1}),n.props.rootStore.routing.push("".concat(n.prefix,"/").concat(encodeURIComponent(r.name),"/")),l=a.namespace,i=a.project_id,localStorage.removeItem("".concat(globals.user.username,"-").concat(l,"-").concat(i,"-").concat(n.createName)));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleEditConfig=function(){var e=(0,o.default)(u.default.mark((function e(t){var a;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props.match.params,(0,D.updatePipelineParams)(t),e.next=4,n.store.updatePipeline(t,a);case 4:n.setState({showEditConfig:!1});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleDelete=(0,o.default)(u.default.mark((function e(){var t;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.match.params,n.setState({isSubmitting:!0}),e.next=4,n.store.deletePipeline(n.state.selectPipeline.name,t.project_id).finally((function(){n.setState({isSubmitting:!1})}));case 4:n.setState({showDelete:!1}),n.handleFetch();case 6:case"end":return e.stop()}}),e)}))),n.getColumns=function(){return[{title:t("Name"),dataIndex:"name",width:"20%",render:function(e,t){return void 0!==t.numberOfFailingBranches?m.default.createElement(v.Link,{className:"item-name",to:"".concat(n.prefix,"/").concat(encodeURIComponent(t.name),"/activity")},e):m.default.createElement(v.Link,{className:"item-name",to:"".concat(n.prefix,"/").concat(encodeURIComponent(t.name))},e)}},{title:t("Status"),width:"15%",render:function(e){return void 0!==e.numberOfSuccessfulBranches?m.default.createElement("span",{className:q.default.sourcePipelineStatus},m.default.createElement("span",{className:q.default.pipelineSuccessNumber},e.numberOfSuccessfulBranches),t("branch success")):m.default.createElement(L.default,(0,R.getPipelineStatus)((0,y.default)(e,"latestRun",{})))}},{title:t("WeatherScore"),dataIndex:"weatherScore",width:"20%",render:function(e){return m.default.createElement(N.default,{score:e})}},{title:t("Branch"),dataIndex:"totalNumberOfBranches",width:"20%",render:function(e){return void 0===e?"-":e}},{title:t("PullRequest"),dataIndex:"totalNumberOfPullRequests",render:function(e){return void 0===e?"-":e},width:"20%"},{key:"more",width:"20%",render:function(e){return n.enabledItemActions.length>0&&m.default.createElement(k.default,{content:n.renderMoreMenu(e),trigger:"click",placement:"bottomRight"},m.default.createElement(I.default,{icon:"more",type:"flat"}))}}]},n.renderMoreMenu=function(e){return m.default.createElement(E.default,{onClick:n.handleMoreMenuClick(e)},n.enabledItemActions.map((function(e){return m.default.createElement(E.default.MenuItem,{key:e.key},m.default.createElement(S.default,{name:e.icon})," ",e.text)})))},n.renderLastUpdatedItem=function(){var e=(0,g.toJS)(n.store.list).data;return m.default.createElement(C.Column,null,m.default.createElement("div",null,e[0]&&e[0].name))},n.store=new A.default,n.formTemplate={project_id:e.match.params.project_id,enable_timer_trigger:!0,enable_discarder:!0},n.state={showCreate:!1,showEdit:!1,showDelete:!1,showBranchModal:!1,configFormData:{},selectPipeline:{}},n}var n;return(0,p.default)(a,e),(0,d.default)(a,[{key:"componentDidMount",value:function(){var e=this;this.unsubscribe=this.routing.history.subscribe((function(t){if(t.pathname===e.props.match.url){var a=(0,b.parse)(t.search.slice(1));e.getData(a)}}))}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.match.params,a=e.match.params;t.project_id!==a.project_id&&this.getData(a)}},{key:"componentWillUnmount",value:function(){this.unsubscribe&&this.unsubscribe()}},{key:"getData",value:function(e){this.store.fetchList((0,i.default)({},this.props.match.params,e))}},{key:"handleRun",value:(n=(0,o.default)(u.default.mark((function e(t){var a,n,r;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.branchNames&&t.branchNames.length,n=t.parameters&&t.parameters.length,!a&&!n){e.next=6;break}this.setState({showBranchModal:!0}),e.next=10;break;case 6:return r=this.props.match.params,e.next=9,this.store.runBranch({project_id:r.project_id,name:t.name});case 9:this.props.rootStore.routing.push("".concat(this.prefix,"/").concat(encodeURIComponent(t.name),"/activity"));case 10:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"getStatus",value:function(){return w.JOB_STATUS.map((function(e){return{text:t(e.text),value:e.value}}))}},{key:"renderContent",value:function(){var e=(0,g.toJS)(this.store.list),a=e.data,n=void 0===a?[]:a,r=e.filters,l=e.isLoading,i=e.total,u=e.page,o=e.limit,s=!1===l&&0===i,d=(0,_.default)(r,"page"),c=this.enabledActions.includes("create")?this.showCreate:null;if(s&&Object.keys(r).length<=0)return m.default.createElement(P.default,{desc:t("CI/CD_CREATE_DESC"),onCreate:c});var f={total:i,page:u,limit:o};return m.default.createElement(T.default,{data:n,columns:this.getColumns(),filters:d,pagination:f,rowKey:"fullName",isLoading:l,onFetch:this.handleFetch,onCreate:c})}},{key:"renderModals",value:function(){var e=this.props.match.params.project_id;return m.default.createElement(m.default.Fragment,null,m.default.createElement(x.default,{title:t("Create Pipeline"),store:this.store,module:this.module,steps:this.steps,formTemplate:this.formTemplate,visible:this.state.showCreate,onOk:this.handleCreate,onCancel:this.hideCreate,isSubmitting:this.state.isSubmitting,noCodeEdit:!0}),m.default.createElement(z.default,{title:t("Edit Pipeline"),formTemplate:this.state.configFormData,project_id:e,visible:this.state.showEditConfig,onOk:this.handleEditConfig,onCancel:this.hideEditConfig}),m.default.createElement(j.default,{type:t("Pipeline"),resource:this.state.selectPipeline.name,visible:this.state.showDelete,onOk:this.handleDelete,onCancel:this.hideDelete,isSubmitting:this.state.isSubmitting}))}},{key:"render",value:function(){var e=this.prefix.match.params;return m.default.createElement("div",{className:q.default.wrapper},m.default.createElement(M.default,{title:t("Pipeline"),icon:"blockchain",description:t("CI/CD_CREATE_DESC"),module:this.module}),this.renderContent(),this.renderModals(),m.default.createElement(B.default,{params:(0,i.default)({},this.props.match.params,{name:this.createName}),jsonData:U,visible:this.state.showEdit,onOk:this.handleSaveJenkinsFile,onCancel:this.hideEditModal,isSubmitting:this.state.isSubmitting}),m.default.createElement(O.default,{onOk:this.handleRunBranch,onCancel:this.hideBranchModal,onBranchSelect:this.handleBranchSelect,visible:this.state.showBranchModal,branches:this.state.selectPipeline&&this.state.selectPipeline.branchNames,parameters:this.state.selectPipeline&&this.state.selectPipeline.parameters,params:(0,i.default)({},e,{name:(0,y.default)(this.state.selectPipeline,"name","")})}))}},{key:"enabledActions",get:function(){return globals.app.getActions({module:"pipelines",project:this.props.match.params.project_id})}},{key:"steps",get:function(){return F.default}},{key:"prefix",get:function(){return this.props.match.url.endsWith("/")?this.props.match.url.slice(0,-1):this.props.match.url}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"module",get:function(){return"cicds"}},{key:"name",get:function(){return"CI/CD"}},{key:"itemActions",get:function(){return[{key:"run",icon:"triangle-right",text:t("Run"),action:"trigger"},{key:"activity",icon:"calendar",text:t("Activity"),action:"view"},{key:"edit",icon:"pen",text:t("Edit"),action:"edit"},{key:"delete",icon:"trash",text:t("Delete"),action:"delete"}]}},{key:"enabledItemActions",get:function(){var e=this;return this.itemActions.filter((function(t){return!t.action||e.enabledActions.includes(t.action)}))}}]),a}(m.default.Component))||l)||l;a.default=J},3817:function(e,t,a){e.exports={icon:"Health__icon--1ZoTk",health:"Health__health--4Ni3U",subhealth:"Health__subhealth--3tYYL",error:"Health__error--3KJb3",nostatus:"Health__nostatus--3fmT1"}},3818:function(e,t,a){e.exports={queued:"Status__queued--3se7n",running:"Status__running--3G5m5",rotate:"Status__rotate--3n_f3",warning:"Status__warning---fgoz",unstable:"Status__unstable--1CwDF",failure:"Status__failure--3RqPG",error:"Status__error--36tdc",aborted:"Status__aborted--1hJsx",nostatus:"Status__nostatus--1_ElD",success:"Status__success--1kNC2",paused:"Status__paused--3ny_p"}},3819:function(e,t,a){e.exports={desc:"CICDs__desc--jid35"}},3820:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a(3821)),l=n(a(2867)),i=[{title:"Basic Info",component:r.default,required:!0},{title:"Advanced Settings",component:l.default,required:!0}];t.default=i},3821:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=r(n(37)),i=r(n(13)),u=r(n(14)),o=r(n(17)),s=r(n(16)),d=r(n(18)),c=r(n(0)),f=n(938),p=r(n(386)),m=r(n(2453)),h=r(n(267)),v=r(n(2578)),g=n(114),b=r(n(2861)),y=r(n(2863)),_=function(e){function a(e){var n;return(0,i.default)(this,a),(n=(0,o.default)(this,(0,s.default)(a).call(this,e))).showSelectRepo=function(){n.setState({showSelectRepo:!0})},n.hideSelectRepo=function(){n.setState({showSelectRepo:!1})},n.handleRepoChange=function(e,t){n.setState({showSelectRepo:!1},(function(){n.scmRef.current.onChange((0,l.default)({source_type:e},t))}))},n.handleDeleteSource=function(){n.scmRef.current.onChange()},n.validator=function(e,a,r){if(!a)return r();n.props.store.checkPipelineName({name:a,project_id:n.props.formTemplate.project_id}).then((function(a){if(a.exist)return r({field:e.field,message:t("This name has exsited")});r()}))},n.state={showSelectRepo:!1},n.scmRef=c.default.createRef(),n}return(0,d.default)(a,e),(0,u.default)(a,[{key:"renderRepoSelectForm",value:function(){var e=this.props.formTemplate;return c.default.createElement(y.default,{sourceData:e.multi_branch_pipeline,project_id:e.project_id,name:e.name,onSave:this.handleRepoChange,onCancel:this.hideSelectRepo})}},{key:"render",value:function(){var e=this.props,a=e.module,n=e.formRef,r=e.formTemplate;return this.state.showSelectRepo?this.renderRepoSelectForm():c.default.createElement("div",null,c.default.createElement(v.default,{title:t("Basic Info"),desc:t("".concat(a.toUpperCase(),"_BASEINFO_DESC"))}),c.default.createElement(h.default,{ref:n,data:r},c.default.createElement(f.Columns,null,c.default.createElement(f.Column,null,c.default.createElement(h.default.Item,{label:t("Name"),desc:t("The name of the Pipeline, the pipeline within the same project cannot be renamed"),rules:[{required:!0,message:t("Please input pipeline name")},{pattern:g.PATTERN_PIPELINE_NAME,message:t("PATTERN_PIPELINE_NAME_VALID_NAME_TIP")},{validator:this.validator}]},c.default.createElement(p.default,{name:"name"})),c.default.createElement(h.default.Item,{label:t("Description")},c.default.createElement(m.default,{name:"desc"}))),c.default.createElement(f.Column,null,c.default.createElement(h.default.Item,{label:t("Project"),desc:t("PROJECT_DESC")},c.default.createElement(p.default,{name:"project_id",disabled:!0})))),c.default.createElement(f.Columns,null,c.default.createElement(f.Column,null,c.default.createElement(h.default.Item,{label:"".concat(t("Code Repository"),"(").concat(t("Optional"),")")},c.default.createElement(b.default,{name:"multi_branch_pipeline",ref:this.scmRef,onClick:this.showSelectRepo,handleDeleteSource:this.handleDeleteSource}))))))}}]),a}(c.default.Component);a.default=_},3822:function(e,t,a){"use strict";var n;a(4)(a(574));!function(r){function l(e,t){var a=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(a>>16)<<16|65535&a}function i(e,t,a,n,r,i){return l((u=l(l(t,e),l(n,i)))<<(o=r)|u>>>32-o,a);var u,o}function u(e,t,a,n,r,l,u){return i(t&a|~t&n,e,t,r,l,u)}function o(e,t,a,n,r,l,u){return i(t&n|a&~n,e,t,r,l,u)}function s(e,t,a,n,r,l,u){return i(t^a^n,e,t,r,l,u)}function d(e,t,a,n,r,l,u){return i(a^(t|~n),e,t,r,l,u)}function c(e,t){var a,n,r,i,c;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var f=1732584193,p=-271733879,m=-1732584194,h=271733878;for(a=0;a<e.length;a+=16)n=f,r=p,i=m,c=h,f=u(f,p,m,h,e[a],7,-680876936),h=u(h,f,p,m,e[a+1],12,-389564586),m=u(m,h,f,p,e[a+2],17,606105819),p=u(p,m,h,f,e[a+3],22,-1044525330),f=u(f,p,m,h,e[a+4],7,-176418897),h=u(h,f,p,m,e[a+5],12,1200080426),m=u(m,h,f,p,e[a+6],17,-1473231341),p=u(p,m,h,f,e[a+7],22,-45705983),f=u(f,p,m,h,e[a+8],7,1770035416),h=u(h,f,p,m,e[a+9],12,-1958414417),m=u(m,h,f,p,e[a+10],17,-42063),p=u(p,m,h,f,e[a+11],22,-1990404162),f=u(f,p,m,h,e[a+12],7,1804603682),h=u(h,f,p,m,e[a+13],12,-40341101),m=u(m,h,f,p,e[a+14],17,-1502002290),f=o(f,p=u(p,m,h,f,e[a+15],22,1236535329),m,h,e[a+1],5,-165796510),h=o(h,f,p,m,e[a+6],9,-1069501632),m=o(m,h,f,p,e[a+11],14,643717713),p=o(p,m,h,f,e[a],20,-373897302),f=o(f,p,m,h,e[a+5],5,-701558691),h=o(h,f,p,m,e[a+10],9,38016083),m=o(m,h,f,p,e[a+15],14,-660478335),p=o(p,m,h,f,e[a+4],20,-405537848),f=o(f,p,m,h,e[a+9],5,568446438),h=o(h,f,p,m,e[a+14],9,-1019803690),m=o(m,h,f,p,e[a+3],14,-187363961),p=o(p,m,h,f,e[a+8],20,1163531501),f=o(f,p,m,h,e[a+13],5,-1444681467),h=o(h,f,p,m,e[a+2],9,-51403784),m=o(m,h,f,p,e[a+7],14,1735328473),f=s(f,p=o(p,m,h,f,e[a+12],20,-1926607734),m,h,e[a+5],4,-378558),h=s(h,f,p,m,e[a+8],11,-2022574463),m=s(m,h,f,p,e[a+11],16,1839030562),p=s(p,m,h,f,e[a+14],23,-35309556),f=s(f,p,m,h,e[a+1],4,-1530992060),h=s(h,f,p,m,e[a+4],11,1272893353),m=s(m,h,f,p,e[a+7],16,-155497632),p=s(p,m,h,f,e[a+10],23,-1094730640),f=s(f,p,m,h,e[a+13],4,681279174),h=s(h,f,p,m,e[a],11,-358537222),m=s(m,h,f,p,e[a+3],16,-722521979),p=s(p,m,h,f,e[a+6],23,76029189),f=s(f,p,m,h,e[a+9],4,-640364487),h=s(h,f,p,m,e[a+12],11,-421815835),m=s(m,h,f,p,e[a+15],16,530742520),f=d(f,p=s(p,m,h,f,e[a+2],23,-995338651),m,h,e[a],6,-198630844),h=d(h,f,p,m,e[a+7],10,1126891415),m=d(m,h,f,p,e[a+14],15,-1416354905),p=d(p,m,h,f,e[a+5],21,-57434055),f=d(f,p,m,h,e[a+12],6,1700485571),h=d(h,f,p,m,e[a+3],10,-1894986606),m=d(m,h,f,p,e[a+10],15,-1051523),p=d(p,m,h,f,e[a+1],21,-2054922799),f=d(f,p,m,h,e[a+8],6,1873313359),h=d(h,f,p,m,e[a+15],10,-30611744),m=d(m,h,f,p,e[a+6],15,-1560198380),p=d(p,m,h,f,e[a+13],21,1309151649),f=d(f,p,m,h,e[a+4],6,-145523070),h=d(h,f,p,m,e[a+11],10,-1120210379),m=d(m,h,f,p,e[a+2],15,718787259),p=d(p,m,h,f,e[a+9],21,-343485551),f=l(f,n),p=l(p,r),m=l(m,i),h=l(h,c);return[f,p,m,h]}function f(e){var t,a="",n=32*e.length;for(t=0;t<n;t+=8)a+=String.fromCharCode(e[t>>5]>>>t%32&255);return a}function p(e){var t,a=[];for(a[(e.length>>2)-1]=void 0,t=0;t<a.length;t+=1)a[t]=0;var n=8*e.length;for(t=0;t<n;t+=8)a[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return a}function m(e){var t,a,n="";for(a=0;a<e.length;a+=1)t=e.charCodeAt(a),n+="0123456789abcdef".charAt(t>>>4&15)+"0123456789abcdef".charAt(15&t);return n}function h(e){return unescape(encodeURIComponent(e))}function v(e){return function(e){return f(c(p(e),8*e.length))}(h(e))}function g(e,t){return function(e,t){var a,n,r=p(e),l=[],i=[];for(l[15]=i[15]=void 0,r.length>16&&(r=c(r,8*e.length)),a=0;a<16;a+=1)l[a]=909522486^r[a],i[a]=1549556828^r[a];return n=c(l.concat(p(t)),512+8*t.length),f(c(i.concat(n),640))}(h(e),h(t))}function b(e,t,a){return t?a?g(t,e):m(g(t,e)):a?v(e):m(v(e))}void 0===(n=function(){return b}.call(t,a,t,e))||(e.exports=n)}()},3823:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i=r(n(13)),u=r(n(14)),o=r(n(17)),s=r(n(16)),d=r(n(18)),c=r(n(0)),f=n(19),p=n(60),m=r(n(386)),h=r(n(225)),v=r(n(267)),g=r(n(3824)),b=(0,p.observer)(l=function(e){function a(){return(0,i.default)(this,a),(0,o.default)(this,(0,s.default)(a).apply(this,arguments))}return(0,d.default)(a,e),(0,u.default)(a,[{key:"render",value:function(){var e=this.props.store,a=e.formData,n=e.credentials,r=this.props.formRef;return c.default.createElement("div",{className:g.default.card},c.default.createElement(v.default,{data:a,ref:r},c.default.createElement(v.default.Item,{label:t("Repository Url"),desc:t("Any repository containing Jenkinsfile will be built automatically"),rules:[{required:!0,message:t("This param is required")}]},c.default.createElement(m.default,{name:"git_source.url"})),c.default.createElement(v.default.Item,{label:t("Certificate"),desc:c.default.createElement("p",null,t("ADD_NEW_CREDENTIAL_DESC"),c.default.createElement("span",{className:g.default.clickable,onClick:this.props.showCredential},t("Create a credential")))},c.default.createElement(h.default,{loading:n.isLoading,name:"git_source.credential_id",options:(0,f.toJS)(n.data)}))))}}]),a}(c.default.Component))||l;a.default=b},3824:function(e,t,a){e.exports={clickable:"GitForm__clickable--FaVul",card:"GitForm__card--1yNjp"}},3825:function(e,t,a){e.exports={repo:"GithubForm__repo--epz_p",action:"GithubForm__action--1m1Pg",icon:"GithubForm__icon--1MhpA",info:"GithubForm__info--9ygJd",name:"GithubForm__name--3LEgU",desc:"GithubForm__desc--3JKAe",clickable:"GithubForm__clickable--3Epk-",orgList:"GithubForm__orgList--6bRu9","repo-active":"GithubForm__repo-active--1v5CU",avatar:"GithubForm__avatar--np9P2",repoList:"GithubForm__repoList--2ZihE",placeHolder:"GithubForm__placeHolder--1FOo-",title:"GithubForm__title--3nwB_",tabContent:"GithubForm__tabContent--1Ehuf",card:"GithubForm__card--3MPbJ",loadMore:"GithubForm__loadMore--2gwHM",confirmButton:"GithubForm__confirmButton--1S-U2"}},3826:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i=r(n(13)),u=r(n(14)),o=r(n(17)),s=r(n(16)),d=r(n(18)),c=r(n(0)),f=n(19),p=r(n(386)),m=r(n(225)),h=r(n(267)),v=n(60),g=r(n(3827)),b=(0,v.observer)(l=function(e){function a(e){var t;return(0,i.default)(this,a),(t=(0,o.default)(this,(0,s.default)(a).call(this,e))).handleTypeChange=function(e){t.setState({type:e})},t.state={type:"svn"},t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"render",value:function(){var e=this.props.store,a=e.formData,n=e.credentials,r=this.props,l=r.formRef,i=r.enableTypeChange;return c.default.createElement("div",{className:g.default.card},c.default.createElement(h.default,{data:a,ref:l},c.default.createElement(h.default.Item,{label:t("type")},c.default.createElement(m.default,{name:"svn_source.type",disabled:!1===i,onChange:this.handleTypeChange,options:[{label:t("single Svn"),value:"single_svn"},{label:"svn",value:"svn"}],defaultValue:"svn"})),c.default.createElement(h.default.Item,{label:t("remote url"),rules:[{required:!0,message:t("This param is required")}]},c.default.createElement(p.default,{name:"svn_source.remote"})),c.default.createElement(h.default.Item,{label:t("Certificate"),desc:c.default.createElement("p",null,t("ADD_NEW_CREDENTIAL_DESC"),c.default.createElement("span",{className:g.default.clickable,onClick:this.props.showCredential},t("Create a credential"))),rules:[{required:!0,message:t("This param is required")}]},c.default.createElement(m.default,{loading:n.isLoading,name:"svn_source.credential_id",options:(0,f.toJS)(n.data)})),"single_svn"!==this.state.type?c.default.createElement(c.default.Fragment,null,c.default.createElement(h.default.Item,{label:t("includes branch")},c.default.createElement(p.default,{name:"svn_source.includes",defaultValue:"trunk,branches/*,tags/*,sandbox/*"})),c.default.createElement(h.default.Item,{label:t("excludes branch")},c.default.createElement(p.default,{name:"svn_source.excludes"}))):null))}}]),a}(c.default.Component))||l;a.default=b},3827:function(e,t,a){e.exports={clickable:"SVNForm__clickable--3XPVQ",card:"SVNForm__card--SHoAx"}},3828:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o=r(n(61)),s=r(n(62)),d=r(n(30)),c=r(n(44)),f=r(n(13)),p=r(n(14)),m=r(n(17)),h=r(n(16)),v=r(n(66)),g=r(n(18)),b=r(n(41)),y=(r(n(45)),r(n(0))),_=n(19),E=n(60),k=r(n(58)),C=r(n(22)),S=r(n(386)),w=r(n(267)),D=r(n(224)),I=n(114),N=r(n(2866)),P=r(n(3829)),j=(0,E.observer)((i=function(e){function a(){var e,t;(0,f.default)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(t=(0,m.default)(this,(e=(0,h.default)(a)).call.apply(e,[this].concat(r)))).handleFormChange=function(){var e=t.props.store.creatBitBucketServersError,a=void 0===e?{}:e;(0,k.default)(a)||t.props.store.clearBitbucketErrors()},(0,c.default)(t,"handlePasswordConfirm",u,(0,v.default)(t)),t.handleSubmit=function(e){var a,n=t.props.store,r=n.orgList,l=n.activeRepoIndex,i=n.bitbucketCredentialId,u=n.tokenFormData,o=e.currentTarget.dataset&&e.currentTarget.dataset.repoIndex,s=(a={},(0,d.default)(a,I.REPO_KEY_MAP[t.scmType],{repo:(0,C.default)(r.data,"".concat(l,".repositories.items.").concat(o,".name")),credential_id:i,owner:(0,C.default)(r.data[l],"key"),api_uri:(0,C.default)(u,"apiUrl"),discover_branches:1,discover_pr_from_forks:{strategy:2,trust:2},discover_pr_from_origin:2}),(0,d.default)(a,"description",(0,C.default)(r.data,"".concat(l,".repositories.items.").concat(o,".description"))),a);t.props.handleSubmit(s)},t}return(0,g.default)(a,e),(0,p.default)(a,[{key:"renderAccessTokenForm",value:function(){var e=this.props.store,a=e.tokenFormData,n=e.creatBitBucketServersError,r=void 0===n?{}:n;return y.default.createElement("div",{className:P.default.card},y.default.createElement(w.default,{data:a,onChange:this.handleFormChange,onSubmit:this.handlePasswordConfirm,ref:this.tokenFormRef},y.default.createElement(w.default.Item,{label:"Bitbucket Server",error:r.apiUrl},y.default.createElement(S.default,{name:"apiUrl"})),y.default.createElement(w.default.Item,{label:t("Username"),error:r.username},y.default.createElement(S.default,{name:"username"})),y.default.createElement(w.default.Item,{label:t("Password"),error:r.password},y.default.createElement(S.default,{name:"password",type:"password"})),r.all?y.default.createElement("p",{className:P.default.error},r.all):null,y.default.createElement(D.default,{className:P.default.confirmButton,onClick:this.handlePasswordConfirm,loading:this.state.isLoading},t("Confirm"))))}},{key:"scmType",get:function(){return"bitbucket_server"}}]),a}(N.default),u=(0,b.default)(i.prototype,"handlePasswordConfirm",[_.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return((0,s.default)(o.default.mark((function t(){var a;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.tokenFormRef.current._formData,e.setState({isLoading:!0}),e.props.store.creatBitBucketServers(a).finally((function(){e.setState({isLoading:!1})}));case 3:case"end":return t.stop()}}),t)}))))}}),l=i))||l;a.default=j},3829:function(e,t,a){e.exports={confirmButton:"BitBucketForm__confirmButton--2Rjkr",card:"BitBucketForm__card--r7Xig",error:"BitBucketForm__error--sBvD6"}},3830:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=r(n(97)),i=r(n(13)),u=r(n(14)),o=r(n(17)),s=r(n(16)),d=r(n(18)),c=r(n(58)),f=r(n(50)),p=r(n(22)),m=r(n(115)),h=r(n(0)),v=r(n(1)),g=r(n(271)),b=r(n(190)),y=r(n(38)),_=r(n(224)),E=n(114),k=r(n(3831)),C=r(n(2868)),S=function(e){function a(){var e,t;(0,i.default)(this,a);for(var n=arguments.length,r=new Array(n),u=0;u<n;u++)r[u]=arguments[u];return(t=(0,o.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(r)))).handleDelete=function(e){var a=t.props,n=a.formTemplate,r=a.name;(0,m.default)(n,r,t.value.filter((function(t,a){return a!==e}))),t.forceUpdate()},t.handleMoreMenuClick=function(e,a){var n=t.props,r=n.formTemplate,i=n.name;(0,m.default)(r,i,[].concat((0,l.default)((0,f.default)(t.value)?t.value:[]),[{type:a}])),t.forceUpdate()},t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"renderMoreMenu",value:function(){return h.default.createElement(g.default,{onClick:this.handleMoreMenuClick},Object.keys(E.PIPELINE_PARAMS_TYPES).map((function(e){return h.default.createElement(g.default.MenuItem,{key:e},h.default.createElement(y.default,{name:"ticket"})," ",t(E.PIPELINE_PARAMS_TYPES[e]))})))}},{key:"render",value:function(){var e=this,a=this.props.name;return h.default.createElement("div",{className:C.default.wrapper},h.default.createElement("div",{className:C.default.header},h.default.createElement(b.default,{className:"dropdown-default",content:this.renderMoreMenu(),trigger:"click",placement:"bottomRight"},h.default.createElement(_.default,{type:"control"},t("Add parameter")))),h.default.createElement("div",{className:C.default.content},(0,c.default)(this.value)&&h.default.createElement("p",{className:"text-center padding-12"},t("No parameters")),(0,f.default)(this.value)&&this.value.map((function(t,n){return h.default.createElement(k.default,{key:n,value:t,prefix:"".concat(a,"[").concat(n,"]"),onDelete:e.handleDelete.bind(e,n)})}))))}},{key:"value",get:function(){return(0,p.default)(this.props.formTemplate,this.props.name,[])}}]),a}(h.default.Component);a.default=S,S.propTypes={name:v.default.string,value:v.default.array,onChange:v.default.func},S.defaultProps={name:"",value:[],onChange:function(){}}},3831:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=r(n(13)),i=r(n(14)),u=r(n(17)),o=r(n(16)),s=r(n(18)),d=r(n(0)),c=r(n(1)),f=n(938),p=r(n(386)),m=r(n(2453)),h=r(n(2454)),v=r(n(390)),g=r(n(224)),b=r(n(267)),y=n(114),_=r(n(2868)),E=function(e){function a(){return(0,l.default)(this,a),(0,u.default)(this,(0,o.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,i.default)(a,[{key:"renderFormItems",value:function(e){var t=null;switch(e){case"string":t=this.renderStringFormItems();break;case"text":t=this.renderTextFormItems();break;case"boolean":t=this.renderBooleanFormItems();break;case"choice":t=this.renderChoiceFormItems();break;case"password":t=this.renderPasswordFormItems()}return t}},{key:"renderStringFormItems",value:function(){var e=this.props.value;return d.default.createElement("div",null,d.default.createElement(f.Columns,null,d.default.createElement(f.Column,null,d.default.createElement(b.default.Item,{label:t("Name"),rules:[{required:!0,message:t("This param is required")}]},d.default.createElement(p.default,{name:"".concat(this.props.prefix,".name"),defaultValue:e.name}))),d.default.createElement(f.Column,null,d.default.createElement(b.default.Item,{label:t("Default Value"),desc:t("Specifies the default value of the field, allowing the user to save the typed actual value.")},d.default.createElement(p.default,{name:"".concat(this.props.prefix,".default_value"),defaultValue:e.default_value||""})))),d.default.createElement(b.default.Item,{label:t("Description"),desc:t("Comment information")},d.default.createElement(m.default,{className:"max-width-full",name:"".concat(this.props.prefix,".description"),defaultValue:e.description})))}},{key:"renderTextFormItems",value:function(){var e=this.props.value;return d.default.createElement("div",null,d.default.createElement(b.default.Item,{label:t("Name"),rules:[{required:!0,message:t("This param is required")}]},d.default.createElement(p.default,{name:"".concat(this.props.prefix,".name"),defaultValue:e.name})),d.default.createElement(b.default.Item,{label:t("Default Value")},d.default.createElement(m.default,{className:"max-width-full",name:"".concat(this.props.prefix,".default_value"),defaultValue:e.default_value||""})),d.default.createElement(b.default.Item,{label:t("Description"),desc:t("Comment information")},d.default.createElement(m.default,{className:"max-width-full",name:"".concat(this.props.prefix,".description"),defaultValue:e.description})))}},{key:"renderBooleanFormItems",value:function(){var e=this.props.value;return d.default.createElement("div",null,d.default.createElement(f.Columns,null,d.default.createElement(f.Column,null,d.default.createElement(b.default.Item,{label:t("Name"),rules:[{required:!0,message:t("This param is required")}]},d.default.createElement(p.default,{name:"".concat(this.props.prefix,".name"),defaultValue:e.name}))),d.default.createElement(f.Column,null,d.default.createElement(b.default.Item,{label:t("Default Value")},d.default.createElement(h.default,{name:"".concat(this.props.prefix,".default_value"),defaultValue:JSON.parse(e.default_value||"true")},d.default.createElement(v.default,{value:"true"},"True"),d.default.createElement(v.default,{value:"false"},"False"))))),d.default.createElement(b.default.Item,{label:t("Description"),desc:t("Comment information")},d.default.createElement(m.default,{className:"max-width-full",name:"".concat(this.props.prefix,".description"),defaultValue:e.description})))}},{key:"renderChoiceFormItems",value:function(){var e=this.props.value;return d.default.createElement("div",null,d.default.createElement(f.Columns,null,d.default.createElement(f.Column,null,d.default.createElement(b.default.Item,{label:t("Name"),rules:[{required:!0,message:t("This param is required")}]},d.default.createElement(p.default,{name:"".concat(this.props.prefix,".name"),defaultValue:e.name}))),d.default.createElement(f.Column,null,d.default.createElement(b.default.Item,{label:t("Options"),desc:t("Alternate options, one per line. The first line will be used as the default option.")},d.default.createElement(m.default,{className:"max-width-full",name:"".concat(this.props.prefix,".default_value"),defaultValue:e.choice})))),d.default.createElement(b.default.Item,{label:t("Description"),desc:t("Comment information")},d.default.createElement(m.default,{className:"max-width-full",name:"".concat(this.props.prefix,".description"),defaultValue:e.description})))}},{key:"renderPasswordFormItems",value:function(){var e=this.props.value;return d.default.createElement("div",null,d.default.createElement(f.Columns,null,d.default.createElement(f.Column,null,d.default.createElement(b.default.Item,{label:t("Name"),rules:[{required:!0,message:t("This param is required")}]},d.default.createElement(p.default,{name:"".concat(this.props.prefix,".name"),defaultValue:e.name}))),d.default.createElement(f.Column,null,d.default.createElement(b.default.Item,{label:t("Password")},d.default.createElement(p.default,{name:"".concat(this.props.prefix,".default_value"),type:"password",defaultValue:e.default_value||""})))),d.default.createElement(b.default.Item,{label:t("Description"),desc:t("Comment information")},d.default.createElement(m.default,{name:"".concat(this.props.prefix,".description"),defaultValue:e.description})))}},{key:"render",value:function(){var e=this.props,a=e.value,n=e.onDelete;return d.default.createElement("div",{className:_.default.itemWrapper},d.default.createElement("div",{className:_.default.itemTitle},d.default.createElement("p",null,d.default.createElement("strong",null,t(y.PIPELINE_PARAMS_TYPES[a.type]))),d.default.createElement(g.default,{className:_.default.delete,type:"flat",icon:"trash",onClick:n})),a.type&&this.renderFormItems(a.type))}}]),a}(d.default.Component);a.default=E,E.propTypes={value:c.default.object,onChange:c.default.func,onDelete:c.default.func},E.defaultProps={value:{},onChange:function(){},onDelete:function(){}}},3832:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=r(n(30)),i=r(n(37)),u=r(n(13)),o=r(n(14)),s=r(n(17)),d=r(n(16)),c=r(n(18)),f=r(n(569)),p=r(n(269)),m=r(n(0)),h=r(n(1)),v=r(n(271)),g=r(n(190)),b=r(n(38)),y=r(n(224)),_=n(114),E=r(n(3833)),k=r(n(2869)),C=function(e){function a(){var e,t;(0,u.default)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(t=(0,s.default)(this,(e=(0,d.default)(a)).call.apply(e,[this].concat(r)))).handleChange=function(e){var a=t.props,n=a.value;(0,a.onChange)((0,i.default)({},n,e))},t.handleDelete=function(e){var a=t.props,n=a.value;(0,a.onChange)((0,p.default)(n,e))},t.handleMoreMenuClick=function(e,a){var n=t.props,r=n.value,l=n.onChange;(0,f.default)(r,a)||("discover_branches"===a?l((0,i.default)({},r,{discover_branches:1})):"discover_pr_from_origin"===a?l((0,i.default)({},r,{discover_pr_from_origin:1})):"discover_pr_from_forks"===a&&l((0,i.default)({},r,{discover_pr_from_forks:{strategy:1,trust:0}})))},t}return(0,c.default)(a,e),(0,o.default)(a,[{key:"renderMoreMenu",value:function(){return m.default.createElement(v.default,{onClick:this.handleMoreMenuClick},Object.keys(_.PIPELINE_ACTION_TYPES).map((function(e){return m.default.createElement(v.default.MenuItem,{key:e},m.default.createElement(b.default,{name:"ticket"})," ",t(_.PIPELINE_ACTION_TYPES[e]))})))}},{key:"render",value:function(){var e=this,a=this.props,n=a.name,r=a.value;return m.default.createElement("div",{className:k.default.wrapper},m.default.createElement("div",{className:k.default.header},m.default.createElement(g.default,{className:"dropdown-default",content:this.renderMoreMenu(),trigger:"click",placement:"bottomRight"},m.default.createElement(y.default,{type:"control"},t("Add Action")))),m.default.createElement("div",{className:k.default.content},Object.keys(_.PIPELINE_ACTION_TYPES).filter(f.default.bind(this,r)).map((function(t,a){return m.default.createElement(E.default,{key:a,value:(0,l.default)({},t,r[t]),prefix:"".concat(n,"[").concat(a,"]"),onDelete:e.handleDelete.bind(e,t),onChange:e.handleChange})}))))}}]),a}(m.default.Component);a.default=C,C.propTypes={name:h.default.string,value:h.default.object,onChange:h.default.func},C.defaultProps={name:"",value:{},onChange:function(){}}},3833:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=r(n(37)),i=r(n(30)),u=r(n(13)),o=r(n(14)),s=r(n(17)),d=r(n(16)),c=r(n(18)),f=r(n(0)),p=r(n(1)),m=r(n(22)),h=r(n(268)),v=r(n(115)),g=n(938),b=r(n(225)),y=r(n(224)),_=r(n(267)),E=n(114),k=r(n(2869)),C=function(e){function a(){var e,t;(0,u.default)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=(0,s.default)(this,(e=(0,d.default)(a)).call.apply(e,[this].concat(r)))).triggerChange=(0,h.default)((function(e){t.props.onChange(e)}),500),t.handleChange=function(e){return function(a){var n=e.split(".");if(n.length>1){var r=(0,m.default)(t.props.value,n[0]);return r?(0,v.default)(r,n[1],a):r=(0,i.default)({},n[1],a),void t.triggerChange((0,l.default)({},t.props.value,(0,i.default)({},n[0],r)))}t.triggerChange((0,l.default)({},t.props.value,(0,i.default)({},e,a)))}},t}return(0,c.default)(a,e),(0,o.default)(a,[{key:"renderFormItems",value:function(e){var t=null;switch(e){case"discover_branches":t=this.renderBranchesFormItems();break;case"discover_pr_from_origin":t=this.renderPrOriginFormItems();break;case"discover_pr_from_forks":t=this.renderPrForkFormItems()}return t}},{key:"renderBranchesFormItems",value:function(){var e=this.props.value;return f.default.createElement("div",null,f.default.createElement(_.default.Item,{label:t("Strategy")},f.default.createElement(b.default,{name:"discover_branches",defaultValue:e.discover_branches,onChange:this.handleChange("discover_branches"),options:[{label:t("Exclude branches that are also filed as PRs"),value:1},{label:t("Only branches that are also filed as PRs"),value:2},{label:t("All branches"),value:3}]})))}},{key:"renderPrOriginFormItems",value:function(){var e=this.props.value;return f.default.createElement("div",null,f.default.createElement(_.default.Item,{label:t("Pull Strategy")},f.default.createElement(b.default,{name:"discover_pr_from_origin",defaultValue:e.discover_pr_from_origin,onChange:this.handleChange("discover_pr_from_origin"),options:[{label:t("OPTIONS_PR_PARAMS_1"),value:1},{label:t("OPTIONS_PR_PARAMS_2"),value:2},{label:t("OPTIONS_PR_PARAMS_3"),value:3}]})))}},{key:"renderPrForkFormItems",value:function(){var e=this.props.value;return f.default.createElement("div",null,f.default.createElement(g.Columns,null,f.default.createElement(g.Column,null,f.default.createElement(_.default.Item,{label:t("Pull Strategy")},f.default.createElement(b.default,{name:"discover_pr_from_forks.strategy",defaultValue:e.discover_pr_from_forks&&e.discover_pr_from_forks.strategy,onChange:this.handleChange("discover_pr_from_forks.strategy"),options:[{label:t("OPTIONS_PR_PARAMS_1"),value:1},{label:t("OPTIONS_PR_PARAMS_2"),value:2},{label:t("OPTIONS_PR_PARAMS_3"),value:3}]}))),f.default.createElement(g.Column,null,f.default.createElement(_.default.Item,{label:t("Trusted User")},f.default.createElement(b.default,{name:"discover_pr_from_forks.trust",defaultValue:e.discover_pr_from_forks&&e.discover_pr_from_forks.trust,onChange:this.handleChange("discover_pr_from_forks.trust"),options:[{label:t("Contributors"),value:1},{label:t("Everyone"),value:2},{label:t("From users with Admin or Write permission"),value:3},{label:t("Nobody"),value:4}]})))))}},{key:"render",value:function(){var e=this.props,a=e.value,n=e.onDelete,r=Object.keys(a)[0];return f.default.createElement("div",{className:k.default.itemWrapper},f.default.createElement("div",{className:k.default.itemTitle},f.default.createElement("p",null,f.default.createElement("strong",null,t(E.PIPELINE_ACTION_TYPES[r]))),f.default.createElement(y.default,{className:k.default.delete,type:"flat",icon:"trash",onClick:n})),r&&this.renderFormItems(r))}}]),a}(f.default.Component);a.default=C,C.propTypes={value:p.default.object,onChange:p.default.func,onDelete:p.default.func},C.defaultProps={value:{},onChange:function(){},onDelete:function(){}}},3834:function(e,t,a){e.exports={advance:"AdvanceSettings__advance--p1Kp3",wrapper:"AdvanceSettings__wrapper--3-X9H"}},3835:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,l,i,u,o,s,d,c=n(a(97)),f=n(a(44)),p=n(a(13)),m=n(a(14)),h=n(a(17)),v=n(a(16)),g=n(a(66)),b=n(a(18)),y=n(a(41)),_=(n(a(45)),n(a(0))),E=a(19),k=a(60),C=n(a(3836)),S=n(a(2873)),w=(0,k.observer)((d=s=function(e){function t(){var e,a;(0,p.default)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return a=(0,h.default)(this,(e=(0,v.default)(t)).call.apply(e,[this].concat(r))),(0,f.default)(a,"heights",i,(0,g.default)(a)),a.handleAddBranch=function(e){return function(){a.props.store.handleAddBranch(e)}},a.onInsertColunm=function(e){a.props.store.insertColunm(e)},a.handleFocus=function(e){return function(t){a.props.store.setFocus(e,t)}},(0,f.default)(a,"onAddStep",u,(0,g.default)(a)),(0,f.default)(a,"setHeight",o,(0,g.default)(a)),a}return(0,b.default)(t,e),(0,m.default)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.stages,n=t.isEditMode;return!a.length&&n?_.default.createElement(S.default,{onInsertColunm:this.onInsertColunm,isEditMode:n,index:-1,heights:[]}):_.default.createElement(_.default.Fragment,null,_.default.createElement(S.default,{onInsertColunm:this.onInsertColunm,isEditMode:n,index:-1,heights:this.sumHeights}),a.map((function(t,a){return _.default.createElement(_.default.Fragment,{key:"".concat(t.name).concat(a)},_.default.createElement(C.default,{onAddBranch:e.handleAddBranch(a),onAddStep:e.onAddStep,isEditMode:n,nodes:t,index:a,setHeight:e.setHeight(a),onFocus:e.handleFocus(a)}),_.default.createElement(S.default,{onInsertColunm:e.onInsertColunm,isEditMode:n,index:a,heights:e.sumHeights}))})))}},{key:"sumHeights",get:function(){var e=this.props.stages,t=void 0===e?[]:e;return this.heights.slice(0,t.length).map((function(e){var t=0;return e.map((function(e){return t+=e}))}))}}]),t}(_.default.Component),s.defaultProps={},l=d,i=(0,y.default)(l.prototype,"heights",[E.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),(0,y.default)(l.prototype,"sumHeights",[E.computed],Object.getOwnPropertyDescriptor(l.prototype,"sumHeights"),l.prototype),u=(0,y.default)(l.prototype,"onAddStep",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.store.isAddingStep=!0}}}),o=(0,y.default)(l.prototype,"setHeight",[E.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){return function(a){var n=(0,c.default)(e.heights);n[t]=a,e.heights=n}}}}),r=l))||r;t.default=w},3836:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i=r(n(30)),u=r(n(13)),o=r(n(14)),s=r(n(17)),d=r(n(16)),c=r(n(18)),f=r(n(0)),p=r(n(3)),m=n(60),h=n(19),v=r(n(38)),g=r(n(22)),b=r(n(2505)),y=r(n(58)),_=n(2872),E=r(n(2686)),k=(0,m.observer)(l=function(e){function a(e){var n;return(0,u.default)(this,a),(n=(0,s.default)(this,(0,d.default)(a).call(this,e))).handleAddStep=function(){n.props.onAddStep()},n.handleFocus=function(e){return function(t){n.props.isEditMode&&(t.stopPropagation(),n.props.onFocus(e))}},n.renderNestStages=function(e){return n.props.isEditMode?f.default.createElement("div",{className:E.default.errorTip},t("not support edit nested stage")):!(0,y.default)(e)&&(0,h.isObservableArray)(e)?f.default.createElement("div",{className:E.default.nestStage_content},f.default.createElement("div",{className:E.default.indentBorder}),f.default.createElement("div",{className:E.default.nestsStage_detail},e.map((function(e){return n.renderCardContent(e)})))):void 0},n.renderSteps=function(e,a){if(e&&e.length)return e.map((function(e,r){return f.default.createElement("div",{key:JSON.stringify(e)+r,className:E.default.pipelineCard__item},f.default.createElement("div",{className:(0,p.default)(E.default.content__title,(0,i.default)({},E.default.content__title__error,a&&a.index===r))},t(e.name)),(0,_.renderStepArgs)(e),n.renderSteps(e.children))}))},n.domTree=[],n.heights=[],n}return(0,c.default)(a,e),(0,o.default)(a,[{key:"componentDidMount",value:function(){this.calculateHeight()}},{key:"componentDidUpdate",value:function(){this.calculateHeight()}},{key:"calculateHeight",value:function(){var e=(0,b.default)(this.domTree.map((function(e){return e&&e.clientHeight})),null);JSON.stringify(e)!==JSON.stringify(this.heights)&&(this.heights=e,this.props.setHeight(this.heights))}},{key:"renderAddBranchCard",value:function(){return f.default.createElement("div",{className:E.default.addBranchCard,onClick:this.props.onAddBranch},f.default.createElement(v.default,{name:"add"}),"",t("Add Parallel Stage"))}},{key:"renderConditions",value:function(e){return e.when?f.default.createElement("div",{className:E.default.conditions},f.default.createElement("p",{className:E.default.conditions__title},t("pipeline_conditions")),this.renderSteps(e.when.conditions,e.conditionError)):null}},{key:"renderCard",value:function(e,a){var n,r=this.props.isEditMode;return f.default.createElement("div",{className:(0,p.default)(E.default.pipelineCard,{"pipelineCard-edit":r}),onClick:this.handleFocus(a)},f.default.createElement("div",{className:(0,p.default)(E.default.pipelineCard__title,(0,i.default)({},E.default["pipelineCard__title-error"],e.error))},e.name||t("No name")),f.default.createElement("div",{className:(0,p.default)(E.default.pipelineCard__content,(n={},(0,i.default)(n,E.default["pipelineCard-active"],e.isActive),(0,i.default)(n,E.default["pipelineCard-error"],e.error),n))},this.renderCardContent(e)))}},{key:"renderCardContent",value:function(e){var a=this.props.isEditMode,n=!!e.stages;return f.default.createElement(f.default.Fragment,null,e.error||e.conditionError?f.default.createElement("div",{className:E.default.errorTip},t((0,g.default)(e,"error.error")||(0,g.default)(e,"conditionError.error"))||t("Configuration error")):null,this.renderConditions(e,e.conditionError),e.stages?this.renderNestStages(e.stages):this.renderSteps((0,g.default)(e,"branches[0].steps"),e.error),a&&!n?f.default.createElement("div",{className:E.default.addSteps,onClick:this.handleAddStep},f.default.createElement(v.default,{name:"add"})," ",t("Add Step")):null)}},{key:"render",value:function(){var e=this,t=this.props,a=t.nodes,n=t.isEditMode;return a.parallel?f.default.createElement("div",{className:E.default.pipeline_column,"data-card":"card"},a.parallel.map((function(t,a){return f.default.createElement("div",{key:JSON.stringify(t),ref:function(t){e.domTree[a]=t}},e.renderCard(t,a))})),n?this.renderAddBranchCard():null):f.default.createElement("div",{className:E.default.pipeline_column,"data-card":"card"},f.default.createElement("div",{ref:function(t){e.domTree=[t]}},this.renderCard(a,0)),n?this.renderAddBranchCard():null)}}]),a}(f.default.Component))||l;a.default=k},3837:function(e,t,a){e.exports={connects__colunm:"Edges__connects__colunm--n5fW4",editButton:"Edges__editButton--PnGDJ"}},3838:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d,c,f,p,m,h=r(n(61)),v=r(n(62)),g=r(n(44)),b=r(n(13)),y=r(n(14)),_=r(n(17)),E=r(n(16)),k=r(n(66)),C=r(n(18)),S=r(n(41)),w=(r(n(45)),r(n(0))),D=n(19),I=n(60),N=r(n(115)),P=r(n(22)),j=r(n(224)),x=r(n(267)),L=r(n(386)),R=r(n(225)),O=r(n(3839)),M=r(n(3840)),T=r(n(2687)),A=[{label:"Any",value:"any"},{label:"node",value:"node"},{label:"kubernetes",value:"kubernetes"}],F=(0,I.observer)((i=function(e){function a(){var e,n;(0,b.default)(this,a);for(var r=arguments.length,l=new Array(r),i=0;i<r;i++)l[i]=arguments[i];return n=(0,_.default)(this,(e=(0,E.default)(a)).call.apply(e,[this].concat(l))),(0,g.default)(n,"stageName",u,(0,k.default)(n)),(0,g.default)(n,"formData",o,(0,k.default)(n)),(0,g.default)(n,"showYaml",s,(0,k.default)(n)),(0,g.default)(n,"loading",d,(0,k.default)(n)),(0,g.default)(n,"handleSetYaml",c,(0,k.default)(n)),(0,g.default)(n,"hideYamlEditor",f,(0,k.default)(n)),(0,g.default)(n,"showEditor",p,(0,k.default)(n)),n.handleDelete=function(){n.props.store.deleteStage()},n.handleCancel=function(){n.props.onCancel()},(0,g.default)(n,"handleAgentTypeChange",m,(0,k.default)(n)),n.handleConfirm=(0,v.default)(h.default.mark((function e(){var t;return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.getAgentArguments(),n.loading=!0,e.next=4,n.props.store.convertJsonToJenkinsFile().finally((function(){n.loading=!1}));case 4:(t=e.sent)&&"success"===(0,P.default)(t,"data.result")&&n.props.onOk((0,P.default)(t,"data.jenkinsfile",""));case 6:case"end":return e.stop()}}),e)}))),n.renderAgentForms=function(){switch(n.agentType){case"node":return w.default.createElement(x.default,{data:n.formData,ref:n.formRef},w.default.createElement(x.default.Item,{label:t("label"),desc:t("The label on which to run the Pipeline or individual stage")},w.default.createElement(L.default,{name:"label",defaultValue:"default"})));case"kubernetes":return w.default.createElement(x.default,{data:n.formData,ref:n.formRef},w.default.createElement(x.default.Item,{label:t("label"),desc:t("")},w.default.createElement(L.default,{name:"label",defaultValue:"default"})),w.default.createElement(x.default.Item,{label:t("yaml"),desc:w.default.createElement("span",{className:T.default.clickable,onClick:n.showEditor},t("show yaml editor"))},w.default.createElement(L.default,{name:"yaml"})),w.default.createElement(x.default.Item,{label:t("defaultContainer"),desc:t("")},w.default.createElement(L.default,{name:"defaultContainer"})));default:return null}},n}return(0,C.default)(a,e),(0,y.default)(a,[{key:"componentDidMount",value:function(){var e=(0,D.toJS)((0,P.default)(this.props.store.jsonData,"json.pipeline.agent.arguments",[]));this.formData=e.reduce((function(e,t){return e[t.key]=t.value.value,e}),{})}},{key:"getAgentArguments",value:function(){var e=this,t=Object.keys(this.formData).map((function(t){return{key:t,value:{isLiteral:!0,value:e.formData[t]}}}));(0,N.default)(this.props.store.jsonData,"json.pipeline.agent.arguments",t)}},{key:"render",value:function(){var e=this.props.store,a=e.activeStage,n=e.jsonData.json.pipeline,r=this.props.isSubmitting;return w.default.createElement("div",{className:T.default.sider},w.default.createElement("div",{className:T.default.sheet},w.default.createElement("div",{className:T.default.title},t("Agent")),w.default.createElement(x.default.Item,{desc:t("AGENT_TYPE_DESC"),label:t("Type")},w.default.createElement(R.default,{options:A,value:n.agent.type,onChange:this.handleAgentTypeChange})),this.renderAgentForms(),w.default.createElement("div",{className:T.default.footer},w.default.createElement(j.default,{onClick:this.handleCancel},t("Cancel")),w.default.createElement(j.default,{disabled:!n||!n.stages.length,loading:r||this.loading,type:"control",onClick:this.handleConfirm},t("Save")))),a?w.default.createElement(M.default,{activeStage:a,store:this.props.store}):null,w.default.createElement(O.default,{value:this.formData.yaml,visible:this.showYaml,onCancel:this.hideYamlEditor,onOk:this.handleSetYaml}))}},{key:"agentType",get:function(){return(0,P.default)(this.props.store.jsonData,"json.pipeline.agent.type","")}}]),a}(w.default.Component),u=(0,S.default)(i.prototype,"stageName",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=(0,S.default)(i.prototype,"formData",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),s=(0,S.default)(i.prototype,"showYaml",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=(0,S.default)(i.prototype,"loading",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),c=(0,S.default)(i.prototype,"handleSetYaml",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.formData.yaml=t,e.showYaml=!1}}}),f=(0,S.default)(i.prototype,"hideYamlEditor",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.showYaml=!1}}}),p=(0,S.default)(i.prototype,"showEditor",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.showYaml=!0}}}),(0,S.default)(i.prototype,"agentType",[D.computed],Object.getOwnPropertyDescriptor(i.prototype,"agentType"),i.prototype),m=(0,S.default)(i.prototype,"handleAgentTypeChange",[D.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.formData={},(0,N.default)(e.props.store.jsonData,"json.pipeline.agent.type",t)}}}),l=i))||l;a.default=F},3839:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d=r(n(44)),c=r(n(13)),f=r(n(14)),p=r(n(17)),m=r(n(16)),h=r(n(66)),v=r(n(18)),g=r(n(41)),b=(r(n(45)),r(n(0))),y=r(n(1)),_=n(19),E=n(60),k=r(n(387)),C=r(n(951)),S=r(n(2528)),w=(0,E.observer)((s=o=function(e){function a(){var e,t;(0,c.default)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return t=(0,p.default)(this,(e=(0,m.default)(a)).call.apply(e,[this].concat(r))),(0,d.default)(t,"value",u,(0,h.default)(t)),t.handleChange=function(e){t.newValue=e},t.handleOk=function(){t.props.onOk(t.newValue)},t}return(0,v.default)(a,e),(0,f.default)(a,[{key:"componentDidMount",value:function(){var e=this.props.value;this.value=e}},{key:"componentWillReceiveProps",value:function(e){var t=e.value;this.value=t}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel;return b.default.createElement(k.default,{width:680,bodyClassName:S.default.body,onCancel:n,onOk:this.handleOk,visible:a,closable:!1,title:t("yaml")},b.default.createElement(C.default,{className:S.default.CodeEditor,name:"script",mode:"yaml",value:this.value,onChange:this.handleChange}))}}]),a}(b.default.Component),o.propTypes={name:y.default.string},o.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},i=s,u=(0,g.default)(i.prototype,"value",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),l=i))||l;a.default=w},3840:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d,c,f,p,m,h,v,g,b=r(n(97)),y=r(n(44)),_=r(n(13)),E=r(n(14)),k=r(n(17)),C=r(n(16)),S=r(n(66)),w=r(n(18)),D=r(n(41)),I=(r(n(45)),r(n(22))),N=r(n(115)),P=r(n(0)),j=r(n(3)),x=n(19),L=n(60),R=r(n(386)),O=r(n(38)),M=r(n(2506)),T=r(n(267)),A=r(n(224)),F=n(114),B=n(2872),z=r(n(3841)),q=r(n(2687)),U=r(n(2686)),J={withCredentials:!0,dir:!0,container:!0,timeout:!0,withSonarQubeEnv:!0,not:!0,allOf:!0,anyOf:!0},V=function(e){return F.PIPELINE_TASKS.All.includes(e)||"sh"===e},Y=(0,L.observer)((i=function(e){function a(e){var n;return(0,_.default)(this,a),n=(0,k.default)(this,(0,C.default)(a).call(this,e)),(0,y.default)(n,"stage",u,(0,S.default)(n)),(0,y.default)(n,"zIndex",o,(0,S.default)(n)),(0,y.default)(n,"isEditMode",s,(0,S.default)(n)),(0,y.default)(n,"handleChangeName",d,(0,S.default)(n)),n.handleDelete=function(){n.props.store.deleteStage()},(0,y.default)(n,"toggleAddStep",c,(0,S.default)(n)),(0,y.default)(n,"handleEdit",f,(0,S.default)(n)),(0,y.default)(n,"handleEditCancel",p,(0,S.default)(n)),(0,y.default)(n,"handleEditStep",m,(0,S.default)(n)),(0,y.default)(n,"handleAddStep",h,(0,S.default)(n)),n.addNoInputTask=function(e){if(n.stage.when||(n.stage.when={conditions:[]}),n.zIndex.length){var t=n.zIndex.reduce((function(e,t,a){return 0===a?"[".concat(t,"]"):"".concat(e,".children[").concat(t,"]")}),"");(0,I.default)(n.stage.when.conditions,"".concat(t,".children")).push({name:e,children:[]})}else n.stage.when.conditions.push({name:e,children:[]});n.props.store.isAddingStep=!1,n.handleSetValue()},(0,y.default)(n,"handleDeleteStep",v,(0,S.default)(n)),(0,y.default)(n,"handleSortSteps",g,(0,S.default)(n)),n.handleSetValue=function(){n.stage.error=void 0,n.stage.when&&!n.stage.when.conditions.length&&delete n.stage.when,n.props.store.setValue(n.stage)},n.cancelFocus=function(){n.props.store.clearFocus()},n.renderLists=function(e,a,r){return e.map((function(e,l){return P.default.createElement("div",{key:JSON.stringify(e)+l,className:(0,j.default)("pipelineCard__item-".concat(a),U.default.pipelineCard__item),"data-id":JSON.stringify(e)+l},P.default.createElement("span",{className:q.default.delete,onClick:n.handleDeleteStep(l,a,r)},P.default.createElement(O.default,{name:"trash",clickable:!0})),r||!V(e.name)?null:P.default.createElement("span",{className:q.default.edit,onClick:n.handleEdit(a,l,e,r)},P.default.createElement(O.default,{name:"wrench",clickable:!0})),P.default.createElement("div",{className:U.default.content__title},P.default.createElement("span",{className:(0,j.default)("pipelineCard__item__drag-".concat(a),q.default.pipelineCard__item__drag),style:{cursor:"-webkit-grab"}},P.default.createElement(O.default,{name:"drag-handle",color:{primary:"#41b1ea"}})),t(e.name)),(0,B.renderStepArgs)(e),n.renderSteps(e.children,[].concat((0,b.default)(a),[l]),r),e.name in J?P.default.createElement("div",{className:U.default.addSteps,onClick:n.toggleAddStep([].concat((0,b.default)(a),[l]),r)},P.default.createElement(O.default,{name:"add"})," ",r?t("Add nesting ".concat(r,"s")):t("Add nesting steps")):null)}))},n.renderSteps=function(e,t,a){if(e&&e.length)return P.default.createElement(M.default,{tag:"div",options:{handle:".pipelineCard__item__drag-".concat(t),draggable:".pipelineCard__item-".concat(t),animation:150},onChange:n.handleSortSteps(t)},n.renderLists(e,t,a))},n.stage=(0,x.toJS)(e.activeStage),n}return(0,w.default)(a,e),(0,E.default)(a,[{key:"componentWillReceiveProps",value:function(e){this.stage=(0,x.toJS)(e.activeStage)}},{key:"renderConditions",value:function(){return this.stage.when&&this.stage.when.conditions?this.renderLists(this.stage.when.conditions,[],"condition"):null}},{key:"render",value:function(){var e=this.props.store.isAddingStep;return P.default.createElement("div",{className:q.default.sheet},P.default.createElement("div",{className:q.default.title},t("Stage")," ",P.default.createElement("span",{className:q.default.delete,onClick:this.handleDelete},P.default.createElement(O.default,{name:"trash",clickable:!0}))),P.default.createElement("div",{className:q.default.form},P.default.createElement(T.default.Item,{label:t("Name")},P.default.createElement(R.default,{value:this.stage.name||"",onChange:this.handleChangeName})),P.default.createElement("div",{className:q.default.title},t("pipeline_conditions"),P.default.createElement("span",null,t("The conditions required to perform the current phase. (optional)"))),P.default.createElement("div",{className:q.default.conditionList},this.renderConditions()),this.hasNestStage?null:P.default.createElement("div",{className:U.default.addSteps,onClick:this.toggleAddStep("","condition")},P.default.createElement(O.default,{name:"add"})," ",t("Add conditions")),P.default.createElement("div",{className:q.default.title},t("Task"),P.default.createElement("span",null,t("drag and drop tasks to sort"))),this.renderSteps(this.steps,[]),this.hasNestStage?null:P.default.createElement("div",{className:U.default.addSteps,onClick:this.toggleAddStep("")},P.default.createElement(O.default,{name:"add"})," ",t("Add Step"))),P.default.createElement("div",{className:q.default.footer},P.default.createElement(A.default,{onClick:this.cancelFocus},t("Confirm"))),e?P.default.createElement(z.default,{onAddStep:this.handleAddStep,store:this.props.store,isEditMode:this.isEditMode,onCancel:this.handleEditCancel,onAddNoInputTask:this.addNoInputTask}):null)}},{key:"steps",get:function(){return(0,I.default)(this.stage,"branches[0].steps",[])}},{key:"hasNestStage",get:function(){return!!this.stage.stages}}]),a}(P.default.Component),u=(0,D.default)(i.prototype,"stage",[x.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),o=(0,D.default)(i.prototype,"zIndex",[x.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),s=(0,D.default)(i.prototype,"isEditMode",[x.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=(0,D.default)(i.prototype,"handleChangeName",[x.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.stage.name=t,e.handleSetValue()}}}),c=(0,D.default)(i.prototype,"toggleAddStep",[x.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a){return function(){e.isEditMode=!1,e.zIndex=t,e.props.store.isAddingStep=a||!0}}}}),f=(0,D.default)(i.prototype,"handleEdit",[x.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a,n,r){return function(){e.props.store.setEdittingData({type:n.name,data:n.arguments}),e.index=a,e.zIndex=t,e.isEditMode=!0,e.props.store.isAddingStep=r||!0}}}}),p=(0,D.default)(i.prototype,"handleEditCancel",[x.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isEditMode&&(e.isEditMode=!1,e.props.store.isAddingStep=!1,e.props.store.setEdittingData({}))}}}),m=(0,D.default)(i.prototype,"handleEditStep",[x.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){if(e.zIndex.length){var a=e.zIndex.reduce((function(e,t,a){return 0===a?"[".concat(t,"]"):"".concat(e,".children[").concat(t,"]")}),""),n=(0,I.default)(e.steps,"".concat(a,".children[").concat(e.index,"].children"));n&&(t.children=n),(0,I.default)(e.steps,"".concat(a,".children")).splice(e.index,1,t)}else{var r=(0,I.default)(e.steps,"[".concat(e.index,"].children"));r&&(t.children=r),e.steps.splice(e.index,1,t)}e.props.store.isAddingStep=!1,e.isEditMode=!1,e.props.store.setEdittingData({}),e.handleSetValue()}}}),h=(0,D.default)(i.prototype,"handleAddStep",[x.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){if(e.isEditMode)e.handleEditStep(t);else{var a=e.steps;if("string"==typeof e.props.store.isAddingStep&&(e.stage.when||(e.stage.when={conditions:[]}),a=e.stage.when.conditions),e.zIndex.length){var n=e.zIndex.reduce((function(e,t,a){return 0===a?"[".concat(t,"]"):"".concat(e,".children[").concat(t,"]")}),"");(0,I.default)(a,"".concat(n,".children")).push(t)}else a.push(t);e.props.store.isAddingStep=!1,e.handleSetValue()}}}}),v=(0,D.default)(i.prototype,"handleDeleteStep",[x.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a,n){return function(){var r=n?e.stage.when.conditions:e.steps;if(a.length){var l=a.reduce((function(e,t,a){return 0===a?"[".concat(t,"]"):"".concat(e,".children[").concat(t,"]")}),"");(0,I.default)(r,"".concat(l,".children")).splice(t,1)}else r.splice(t,1);e.handleSetValue()}}}}),g=(0,D.default)(i.prototype,"handleSortSteps",[x.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){return function(a){if(t.length){var n=t.reduce((function(e,t,a){return 0===a?"[".concat(t,"]"):"".concat(e,".children[").concat(t,"]")}),""),r=(0,I.default)(e.steps,"".concat(n,".children")),l=a.map((function(e){return r.find((function(t,a){return JSON.stringify(t)+a===e}))}));(0,N.default)(e.steps,"".concat(n,".children"),l)}else{var i=e.steps,u=a.map((function(e){return i.find((function(t,a){return JSON.stringify(t)+a===e}))}));(0,N.default)(e.stage,"branches[0].steps",u)}e.handleSetValue()}}}}),l=i))||l;a.default=Y},3841:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d,c,f,p=r(n(97)),m=r(n(30)),h=r(n(61)),v=r(n(62)),g=r(n(44)),b=r(n(13)),y=r(n(14)),_=r(n(17)),E=r(n(16)),k=r(n(66)),C=r(n(18)),S=r(n(41)),w=(r(n(45)),r(n(0))),D=r(n(3)),I=r(n(38)),N=n(19),P=n(60),j=n(945),x=r(n(2636)),L=n(114),R=n(3842),O=r(n(2687)),M=r(n(3861)),T={not:!0,allOf:!0,anyOf:!0},A={echo:"loudspeaker",mail:"mail",shell:"terminal",container:"terminal",checkout:"network-router",git:"network-router",withCredentials:"key",kubernetesDeploy:"kubernetes",branch:"network-router",timeout:"clock",withSonarQubeEnv:"network"},F=(0,P.observer)((i=function(e){function a(e){var n;return(0,b.default)(this,a),n=(0,_.default)(this,(0,E.default)(a).call(this,e)),(0,g.default)(n,"activeTab",u,(0,k.default)(n)),(0,g.default)(n,"handleBack",o,(0,k.default)(n)),(0,g.default)(n,"handleAddTask",s,(0,k.default)(n)),(0,g.default)(n,"handleCancel",d,(0,k.default)(n)),(0,g.default)(n,"handleChangeActiveTab",c,(0,k.default)(n)),(0,g.default)(n,"handleAddStep",f,(0,k.default)(n)),n.handleSetValue=function(){n.stage.name=n.stageName||n.stage.name,n.props.store.setValue(n.stage)},n.hideCreateCredential=(0,v.default)(h.default.mark((function e(){return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.store.getCredentials();case 2:n.setState({showCredential:!1});case 3:case"end":return e.stop()}}),e)}))),n.handleShowCredential=function(){n.setState({showCredential:!0})},n.renderStepsModal=function(){var e=n.props.store.params.project_id,t=n.props.store,a=t.edittingData;return"condition"===t.isAddingStep?w.default.createElement(w.default.Fragment,null,w.default.createElement(R.Branch,{visible:n.state.isShowbranch,onAddStep:n.handleAddStep("branch"),onCancel:n.handleCancel("branch"),edittingData:a}),w.default.createElement(R.Environment,{visible:n.state.isShowenvironment,onAddStep:n.handleAddStep("environment"),onCancel:n.handleCancel("environment"),edittingData:a}),w.default.createElement(R.Expression,{visible:n.state.isShowexpression,onAddStep:n.handleAddStep("expression"),onCancel:n.handleCancel("expression"),edittingData:a})):w.default.createElement(w.default.Fragment,null,w.default.createElement(R.Echo,{visible:n.state.isShowecho,onAddStep:n.handleAddStep("echo"),onCancel:n.handleCancel("echo"),edittingData:a}),w.default.createElement(R.Shell,{visible:n.state.isShowshell,onAddStep:n.handleAddStep("shell"),onCancel:n.handleCancel("shell"),edittingData:a}),w.default.createElement(R.Dir,{visible:n.state.isShowdir,onAddStep:n.handleAddStep("dir"),onCancel:n.handleCancel("dir"),edittingData:a}),w.default.createElement(R.Container,{visible:n.state.isShowcontainer,onAddStep:n.handleAddStep("container"),onCancel:n.handleCancel("container"),edittingData:a}),w.default.createElement(R.ArchiveArtifacts,{visible:n.state.isShowarchiveArtifacts,onAddStep:n.handleAddStep("archiveArtifacts"),onCancel:n.handleCancel("archiveArtifacts"),edittingData:a}),w.default.createElement(R.Git,{visible:n.state.isShowgit,showCredential:n.handleShowCredential,onAddStep:n.handleAddStep("git"),onCancel:n.handleCancel("git"),edittingData:a,store:n.props.store}),w.default.createElement(R.Checkout,{visible:n.state.isShowcheckout,showCredential:n.handleShowCredential,onAddStep:n.handleAddStep("checkout"),onCancel:n.handleCancel("checkout"),edittingData:a,store:n.props.store}),w.default.createElement(R.InputStep,{project_id:e,visible:n.state.isShowinput,edittingData:a,onAddStep:n.handleAddStep("input"),onCancel:n.handleCancel("input")}),w.default.createElement(R.WithCredentials,{visible:n.state.isShowwithCredentials,onAddStep:n.handleAddStep("withCredentials"),onCancel:n.handleCancel("withCredentials"),store:n.props.store,showCredential:n.handleShowCredential,edittingData:a}),w.default.createElement(R.KubernetesDeploy,{visible:n.state.isShowkubernetesDeploy,onAddStep:n.handleAddStep("kubernetesDeploy"),onCancel:n.handleCancel("kubernetesDeploy"),store:n.props.store,showCredential:n.handleShowCredential,edittingData:a}),w.default.createElement(R.Timeout,{visible:n.state.isShowtimeout,onAddStep:n.handleAddStep("timeout"),onCancel:n.handleCancel("timeout"),edittingData:a}),w.default.createElement(x.default,{visible:n.state.showCredential,onOk:n.hideCreateCredential,onCancel:n.hideCreateCredential,project_id:e,credentialType:n.state.isShowkubernetesDeploy?"kubeconfig":""}),w.default.createElement(R.Sonarqube,{visible:n.state.isShowwithSonarQubeEnv,onAddStep:n.handleAddStep("withSonarQubeEnv"),onCancel:n.handleCancel("withSonarQubeEnv"),edittingData:a}),w.default.createElement(R.WaitForQualityGate,{visible:n.state.isShowwaitForQualityGate,onAddStep:n.handleAddStep("waitForQualityGate"),onCancel:n.handleCancel("waitForQualityGate"),edittingData:a}),w.default.createElement(R.Script,{visible:n.state.isShowscript,onAddStep:n.handleAddStep("script"),onCancel:n.handleCancel("script"),edittingData:a}),w.default.createElement(R.Mail,{visible:n.state.isShowmail,onAddStep:n.handleAddStep("mail"),onCancel:n.handleCancel("mail"),edittingData:a}))},n.renderSider=function(){return"condition"===n.props.store.isAddingStep?w.default.createElement("div",{className:O.default.sheet},w.default.createElement("div",{className:O.default.title},w.default.createElement("span",{className:(0,D.default)("custom-icon",M.default.back),onClick:n.handleBack},w.default.createElement(j.ReactComponent,null)),t("Add conditions")),w.default.createElement("div",{className:M.default.taskList},L.PIPELINE_CONDITIONS.map((function(e){return w.default.createElement("div",{className:M.default.task,key:e,onClick:n.handleAddTask(e)},w.default.createElement("div",{className:M.default.taskIcon},w.default.createElement(I.default,{name:A[e]||"cdn",size:24})),w.default.createElement("div",{className:M.default.taskInfo},w.default.createElement("div",{className:M.default.taskName},e),w.default.createElement("div",{className:M.default.desc},n.taskDescs[e]||"-")))})))):w.default.createElement("div",{className:O.default.sheet},w.default.createElement("div",{className:O.default.title},w.default.createElement("span",{className:(0,D.default)("custom-icon",M.default.back),onClick:n.handleBack},w.default.createElement(j.ReactComponent,null)),t("Add Step")),w.default.createElement("div",{className:M.default.tabs},Object.keys(L.PIPELINE_TASKS).map((function(e){return w.default.createElement("div",{className:(0,D.default)(M.default.tab,(0,m.default)({},M.default.tab_active,n.activeTab===e)),onClick:n.handleChangeActiveTab(e)},t(e))}))),w.default.createElement("div",{className:M.default.taskList},L.PIPELINE_TASKS[n.activeTab].map((function(e){return w.default.createElement("div",{className:M.default.task,key:e,onClick:n.handleAddTask(e)},w.default.createElement("div",{className:M.default.taskIcon},w.default.createElement(I.default,{name:A[e]||"cdn",size:24})),w.default.createElement("div",{className:M.default.taskInfo},w.default.createElement("div",{className:M.default.taskName},t(e)),w.default.createElement("div",{className:M.default.desc},n.taskDescs[e]||"-")))}))))},n.taskDescs={git:t("Pull code by Git"),shell:t("You can execute shell commands or windows batch commands in the build."),container:t("Specify a container to add nested tasks to execute inside the container"),echo:t("Can send messages in the build"),mail:t("Can send messages by email"),checkout:t("CHECKOUT_DESC"),dir:t("Change Current Directory"),archiveArtifacts:t("Save Artifact"),cleanWs:t("Clean Workspace"),input:t("REVIEW_DESC"),withCredentials:t("Load credentials into environment variables"),kubernetesDeploy:t("Deploy resources to the kubernetes cluster"),timeout:t("Executes the code inside the block with a determined time out limit."),branch:t("Current branch name must match the input value"),environment:t("The environment variable entered before running the pipeline is match the current value."),expression:t("Enter an expression"),not:t("Negative prefix"),allOf:t("Internal nesting conditions must be matched"),anyOf:t("Internal nested conditions only need to satisfy one"),withSonarQubeEnv:t("withSonarQubeEnv_DESC"),waitForQualityGate:t("waitForQualityGate_DESC"),script:t("script_DESC")},n.state=[].concat((0,p.default)(L.PIPELINE_TASKS.All),(0,p.default)(L.PIPELINE_CONDITIONS)).reduce((function(e,t){return e["isShow".concat(t)]=!1,e}),{}),n.state.showCredential=!1,n}return(0,C.default)(a,e),(0,y.default)(a,[{key:"componentDidMount",value:function(){var e=this.props.store.edittingData.type,t="sh"===e?"shell":e;this.setState((0,m.default)({},"isShow".concat(t),!0))}},{key:"render",value:function(){return w.default.createElement(w.default.Fragment,null,this.props.isEditMode?null:this.renderSider(),this.renderStepsModal())}}]),a}(w.default.Component),u=(0,S.default)(i.prototype,"activeTab",[N.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"All"}}),o=(0,S.default)(i.prototype,"handleBack",[N.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.props.store.isAddingStep=!1}}}),s=(0,S.default)(i.prototype,"handleAddTask",[N.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){return function(){t in T?e.props.onAddNoInputTask(t):e.setState((0,m.default)({},"isShow".concat(t),!0))}}}}),d=(0,S.default)(i.prototype,"handleCancel",[N.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){return function(){e.setState((0,m.default)({},"isShow".concat(t),!1)),e.props.onCancel()}}}}),c=(0,S.default)(i.prototype,"handleChangeActiveTab",[N.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){return function(){e.activeTab=t}}}}),f=(0,S.default)(i.prototype,"handleAddStep",[N.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){return function(a){e.props.onAddStep(a),e.setState((0,m.default)({},"isShow".concat(t),!1))}}}}),l=i))||l;a.default=F},3842:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Echo",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"Shell",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"Dir",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"Container",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"ArchiveArtifacts",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"Git",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"Checkout",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"InputStep",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"WithCredentials",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(t,"KubernetesDeploy",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(t,"Timeout",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(t,"Branch",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(t,"Environment",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(t,"Expression",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(t,"Sonarqube",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(t,"Script",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(t,"WaitForQualityGate",{enumerable:!0,get:function(){return _.default}}),Object.defineProperty(t,"Mail",{enumerable:!0,get:function(){return E.default}});var r=n(a(3843)),l=n(a(3844)),i=n(a(3845)),u=n(a(3846)),o=n(a(3847)),s=n(a(3848)),d=n(a(3849)),c=n(a(3850)),f=n(a(3851)),p=n(a(3852)),m=n(a(3853)),h=n(a(3854)),v=n(a(3855)),g=n(a(3856)),b=n(a(3857)),y=n(a(3858)),_=n(a(3859)),E=n(a(3860))},3843:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o=r(n(13)),s=r(n(14)),d=r(n(17)),c=r(n(16)),f=r(n(18)),p=r(n(0)),m=r(n(1)),h=n(60),v=r(n(2453)),g=r(n(387)),b=r(n(267)),y=r(n(2528)),_=(0,h.observer)((u=i=function(e){function a(e){var t;return(0,o.default)(this,a),(t=(0,d.default)(this,(0,c.default)(a).call(this,e))).handleOk=function(){var e=t.formRef.current._formData;t.formRef.current.validate((function(){var a=Object.keys(e).map((function(t){return{key:t,value:{isLiteral:!0,value:e[t].trim()}}}));t.props.onAddStep({name:"echo",arguments:a.filter((function(e){return""!==e.value.value}))})}))},t.formRef=p.default.createRef(),t}return(0,f.default)(a,e),(0,s.default)(a,[{key:"componentWillReceiveProps",value:function(e){"echo"===e.edittingData.type&&(this.formData=e.edittingData.data.reduce((function(e,t){return e[t.key]=t.value.value,e}),{}))}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel;return p.default.createElement(g.default,{width:680,bodyClassName:y.default.body,onCancel:n,onOk:this.handleOk,visible:a,closable:!1,title:t("Print message")},p.default.createElement(b.default,{data:this.formData,ref:this.formRef},p.default.createElement(b.default.Item,{label:t("message"),rules:[{required:!0,message:t("This param is required")}]},p.default.createElement(v.default,{name:"message"}))))}}]),a}(p.default.Component),i.propTypes={name:m.default.string},i.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},l=u))||l;a.default=_},3844:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d=r(n(44)),c=r(n(13)),f=r(n(14)),p=r(n(17)),m=r(n(16)),h=r(n(66)),v=r(n(18)),g=r(n(41)),b=(r(n(45)),r(n(0))),y=r(n(1)),_=r(n(22)),E=n(19),k=n(60),C=r(n(387)),S=r(n(951)),w=r(n(2528)),D=(0,k.observer)((s=o=function(e){function a(){var e,t;(0,c.default)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return t=(0,p.default)(this,(e=(0,m.default)(a)).call.apply(e,[this].concat(r))),(0,d.default)(t,"value",u,(0,h.default)(t)),t.handleChange=function(e){t.newValue=e},t.handleOk=function(){t.props.onAddStep({name:"sh",arguments:[{key:"script",value:{isLiteral:!0,value:t.newValue}}]})},t}return(0,v.default)(a,e),(0,f.default)(a,[{key:"componentWillReceiveProps",value:function(e){"sh"===e.edittingData.type&&(this.value=(0,_.default)(e.edittingData.data,"[0].value.value",""))}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel;return b.default.createElement(C.default,{width:680,bodyClassName:w.default.body,onCancel:n,onOk:this.handleOk,visible:a,closable:!1,title:t("shell")},b.default.createElement(S.default,{className:w.default.CodeEditor,name:"script",mode:"yaml",value:this.value,onChange:this.handleChange}))}}]),a}(b.default.Component),o.propTypes={name:y.default.string},o.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},i=s,u=(0,g.default)(i.prototype,"value",[E.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),l=i))||l;a.default=D},3845:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d=r(n(44)),c=r(n(13)),f=r(n(14)),p=r(n(17)),m=r(n(16)),h=r(n(66)),v=r(n(18)),g=r(n(41)),b=(r(n(45)),r(n(0))),y=r(n(1)),_=r(n(22)),E=n(19),k=n(60),C=r(n(267)),S=r(n(387)),w=r(n(386)),D=r(n(2528)),I=(0,k.observer)((s=o=function(e){function a(e){var t;return(0,c.default)(this,a),t=(0,p.default)(this,(0,m.default)(a).call(this,e)),(0,d.default)(t,"formData",u,(0,h.default)(t)),t.handleOk=function(){var e=t.formRef.current._formData;t.props.onAddStep({name:"dir",arguments:{isLiteral:!0,value:e.path},children:[]})},t.formRef=b.default.createRef(),t}return(0,v.default)(a,e),(0,f.default)(a,[{key:"componentWillReceiveProps",value:function(e){"dir"===e.edittingData.type&&(this.formData={path:(0,_.default)(e.edittingData,"data.value","")})}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel;return b.default.createElement(S.default,{width:680,bodyClassName:D.default.body,onCancel:n,onOk:this.handleOk,visible:a,closable:!1,title:t("dir")},b.default.createElement(C.default,{data:this.formData,ref:this.formRef},b.default.createElement(C.default.Item,{label:t("Path")},b.default.createElement(w.default,{name:"path"}))))}}]),a}(b.default.Component),o.propTypes={name:y.default.string},o.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},i=s,u=(0,g.default)(i.prototype,"formData",[E.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),l=i))||l;a.default=I},3846:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d=r(n(44)),c=r(n(13)),f=r(n(14)),p=r(n(17)),m=r(n(16)),h=r(n(66)),v=r(n(18)),g=r(n(41)),b=(r(n(45)),r(n(0))),y=r(n(1)),_=r(n(22)),E=n(19),k=n(60),C=r(n(267)),S=r(n(387)),w=r(n(386)),D=r(n(2528)),I=(0,k.observer)((s=o=function(e){function a(e){var t;return(0,c.default)(this,a),t=(0,p.default)(this,(0,m.default)(a).call(this,e)),(0,d.default)(t,"formData",u,(0,h.default)(t)),t.handleOk=function(){var e=t.formRef.current._formData;t.formRef.current.validate((function(){t.props.onAddStep({name:"container",arguments:{isLiteral:!0,value:e.name},children:[]})}))},t.formRef=b.default.createRef(),t}return(0,v.default)(a,e),(0,f.default)(a,[{key:"componentWillReceiveProps",value:function(e){"container"===e.edittingData.type&&(this.formData={name:(0,_.default)(e.edittingData,"data.value","")})}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel;return b.default.createElement(S.default,{width:680,bodyClassName:D.default.body,onCancel:n,onOk:this.handleOk,visible:a,closable:!1,title:t("container")},b.default.createElement(C.default,{data:this.formData,ref:this.formRef},b.default.createElement(C.default.Item,{label:t("name"),rules:[{required:!0,message:t("This param is required")}]},b.default.createElement(w.default,{name:"name"}))))}}]),a}(b.default.Component),o.propTypes={name:y.default.string},o.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},i=s,u=(0,g.default)(i.prototype,"formData",[E.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),l=i))||l;a.default=I},3847:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d=r(n(44)),c=r(n(13)),f=r(n(14)),p=r(n(17)),m=r(n(16)),h=r(n(66)),v=r(n(18)),g=r(n(41)),b=(r(n(45)),r(n(0))),y=r(n(1)),_=n(19),E=n(60),k=r(n(267)),C=r(n(387)),S=r(n(386)),w=r(n(2528)),D=(0,E.observer)((s=o=function(e){function a(e){var t;return(0,c.default)(this,a),t=(0,p.default)(this,(0,m.default)(a).call(this,e)),(0,d.default)(t,"formData",u,(0,h.default)(t)),t.handleOk=function(){var e=t.formRef.current._formData,a=Object.keys(e).map((function(t){return{key:t,value:{isLiteral:!0,value:e[t]}}}));t.props.onAddStep({name:"archiveArtifacts",arguments:a})},t.formRef=b.default.createRef(),t}return(0,v.default)(a,e),(0,f.default)(a,[{key:"componentWillReceiveProps",value:function(e){"archiveArtifacts"===e.edittingData.type&&(this.formData=e.edittingData.data.reduce((function(e,t){return e[t.key]=t.value.value,e}),{}))}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel;return b.default.createElement(C.default,{width:680,bodyClassName:w.default.body,onCancel:n,onOk:this.handleOk,visible:a,closable:!1,title:t("archiveArtifacts")},b.default.createElement(k.default,{data:this.formData,ref:this.formRef},b.default.createElement(k.default.Item,{label:t("artifacts")},b.default.createElement(S.default,{name:"artifacts"}))))}}]),a}(b.default.Component),o.propTypes={name:y.default.string},o.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},i=s,u=(0,g.default)(i.prototype,"formData",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),l=i))||l;a.default=D},3848:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d=r(n(97)),c=r(n(44)),f=r(n(13)),p=r(n(14)),m=r(n(17)),h=r(n(16)),v=r(n(66)),g=r(n(18)),b=r(n(41)),y=(r(n(45)),r(n(0))),_=r(n(1)),E=n(19),k=n(60),C=r(n(267)),S=r(n(387)),w=r(n(386)),D=r(n(225)),I=r(n(2528)),N=(0,k.observer)((s=o=function(e){function a(e){var t;return(0,f.default)(this,a),t=(0,m.default)(this,(0,h.default)(a).call(this,e)),(0,c.default)(t,"formData",u,(0,v.default)(t)),t.handleOk=function(){var e=t.formRef.current._formData;t.formRef.current.validate((function(){var a=Object.keys(e).map((function(t){return{key:t,value:{isLiteral:!0,value:e[t]}}}));t.props.onAddStep({name:"git",arguments:[].concat((0,d.default)(a.filter((function(e){return""!==e.value.value}))),[{key:"changelog",value:{isLiteral:!0,value:!0}},{key:"poll",value:{isLiteral:!0,value:!1}}])})}))},t.formRef=y.default.createRef(),t}return(0,g.default)(a,e),(0,p.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.edittingData&&"git"===e.edittingData.type&&(this.formData=e.edittingData.data.reduce((function(e,t){return e[t.key]=t.value.value,e}),{}))}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel,r=this.props.store.credentials;return y.default.createElement(S.default,{width:680,bodyClassName:I.default.body,onCancel:n,onOk:this.handleOk,visible:a,closable:!1,title:"Git"},y.default.createElement(C.default,{data:this.formData,ref:this.formRef},y.default.createElement(C.default.Item,{label:t("Url"),rules:[{required:!0,message:t("This param is required")}]},y.default.createElement(w.default,{name:"url"})),y.default.createElement(C.default.Item,{label:t("Credential Id"),desc:y.default.createElement("p",null,t("ADD_NEW_CREDENTIAL_DESC"),y.default.createElement("span",{className:I.default.clickable,onClick:this.props.showCredential},t("Create a credential")))},y.default.createElement(D.default,{name:"credentialsId",options:r})),y.default.createElement(C.default.Item,{label:t("Branch")},y.default.createElement(w.default,{name:"branch"}))))}}]),a}(y.default.Component),o.propTypes={name:_.default.string},o.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},i=s,u=(0,b.default)(i.prototype,"formData",[E.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),l=i))||l;a.default=N},3849:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d=r(n(44)),c=r(n(13)),f=r(n(14)),p=r(n(17)),m=r(n(16)),h=r(n(66)),v=r(n(18)),g=r(n(41)),b=(r(n(45)),r(n(0))),y=r(n(1)),_=n(19),E=n(60),k=r(n(267)),C=r(n(387)),S=r(n(386)),w=r(n(225)),D=n(2566),I=r(n(2528)),N=(0,E.observer)((s=o=function(e){function a(e){var t;return(0,c.default)(this,a),t=(0,p.default)(this,(0,m.default)(a).call(this,e)),(0,d.default)(t,"formData",u,(0,h.default)(t)),t.handleOk=function(){t.formRef.current.validate((function(){t.props.onAddStep({name:"checkout",arguments:[{key:"scm",value:{isLiteral:!1,value:"[$class: 'SubversionSCM', locations: [[cancelProcessOnExternalsFail: true,  ".concat(t.formData.credentialsId?"credentialsId: '".concat(t.formData.credentialsId,"',"):""," depthOption: 'infinity', ignoreExternalsOption: true, local: '.', remote: '").concat(t.formData.remote,"']], quietOperation: true, workspaceUpdater: [$class: 'UpdateUpdater']]")}},{key:"poll",value:{isLiteral:!0,value:!1}}]})}))},t.formRef=b.default.createRef(),t}return(0,v.default)(a,e),(0,f.default)(a,[{key:"componentWillReceiveProps",value:function(e){"checkout"===e.edittingData.type&&(this.formData=e.edittingData.data.reduce((function(e,t){if("scm"===t.key){var a=t.value.value;a&&Object.assign(e,(0,D.groovyToJS)(a))}return e[t.key]=t.value.value,e}),{}))}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel,r=this.props.store.passWordCredentials;return b.default.createElement(C.default,{width:680,bodyClassName:I.default.body,onCancel:n,onOk:this.handleOk,visible:a,closable:!1,title:t("checkout (svn)")},b.default.createElement(k.default,{data:this.formData,ref:this.formRef},b.default.createElement(k.default.Item,{label:t("Credential ID"),desc:b.default.createElement("p",null,t("ADD_NEW_CREDENTIAL_DESC"),b.default.createElement("span",{className:I.default.clickable,onClick:this.props.showCredential},t("Create a credential")))},b.default.createElement(w.default,{name:"credentialsId",options:r})),b.default.createElement(k.default.Item,{label:t("remote url"),rules:[{required:!0,message:t("This param is required")}]},b.default.createElement(S.default,{name:"remote"}))))}}]),a}(b.default.Component),o.propTypes={name:y.default.string},o.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},i=s,u=(0,g.default)(i.prototype,"formData",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),l=i))||l;a.default=N},3850:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d,c,f=r(n(44)),p=r(n(13)),m=r(n(14)),h=r(n(17)),v=r(n(16)),g=r(n(66)),b=r(n(18)),y=r(n(41)),_=(r(n(45)),r(n(0))),E=r(n(1)),k=r(n(268)),C=r(n(959)),S=n(19),w=n(60),D=r(n(267)),I=r(n(387)),N=r(n(986)),P=r(n(942)),j=r(n(2507)),x=r(n(2568)),L=r(n(2528)),R=(0,w.observer)((c=d=function(e){function a(e){var t;return(0,p.default)(this,a),t=(0,h.default)(this,(0,v.default)(a).call(this,e)),(0,f.default)(t,"value",u,(0,g.default)(t)),(0,f.default)(t,"submitter",o,(0,g.default)(t)),t.handleMessageChange=function(e){t.value=e.target.value,t.submitter=(0,C.default)((t.value.match(/@([\w-.]*)?/g)||[]).map((function(e){return e.slice(1)})))},(0,f.default)(t,"fetchUsers",s,(0,g.default)(t)),t.getUsers=function(){t.setState({loading:!0}),t.devopsStore.fetchMembers({project_id:t.props.project_id}).then((function(e){return t.setState({loading:!1}),e.items?e.items.map((function(e){return{id:e.username,display:e.username,sort:e.username.indexOf((0,S.toJS)(t.query))}})).sort((function(e,t){return e.sort>=0&&t.sort>=0?e.sort-t.sort:t.sort-e.sort})):[]})).then(t.callback)},t.handleOk=function(){t.props.onAddStep({name:"input",arguments:[{key:"message",value:{isLiteral:!0,value:t.value}},{key:"submitter",value:{isLiteral:!0,value:t.submitter.join(", ")}}]})},t.devopsStore=new x.default,t.state={loading:!1},t}return(0,b.default)(a,e),(0,m.default)(a,[{key:"componentWillReceiveProps",value:function(e){var t=this;"input"===e.edittingData.type&&e.edittingData.data.forEach((function(e){"message"===e.key&&(t.value=e.value.value),"submitter"===e.key&&(t.submitter=e.value.value.split(", "))}))}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel;return _.default.createElement(I.default,{width:680,bodyClassName:L.default.body,onCancel:n,onOk:this.handleOk,visible:a,closable:!1,title:t("input")},_.default.createElement(P.default,{type:"info",className:L.default.info,message:t("INPUT_DESC")}),_.default.createElement(D.default,{data:this.formData,ref:this.formRef},_.default.createElement(D.default.Item,{label:t("Message"),desc:t("INPUT_MESSAGE_DESC"),rules:[{required:!0,message:t("This param is required")}]},_.default.createElement(j.default,{value:this.value,onChange:this.handleMessageChange,placeholder:t("Can @somebody to help review"),markup:"@__id__ ",displayTransform:function(e){return"@".concat(e)}},_.default.createElement(N.default,{data:this.fetchUsers,loading:this.state.loading,type:"user",appendSpaceOnAdd:!0})))))}}]),a}(_.default.Component),d.propTypes={name:E.default.string},d.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},i=c,u=(0,y.default)(i.prototype,"value",[S.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),o=(0,y.default)(i.prototype,"submitter",[S.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),s=(0,y.default)(i.prototype,"fetchUsers",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a){t&&(e.debounced||(e.debounced=(0,k.default)(e.getUsers,300)),e.query=t,e.callback=a,e.debounced())}}}),l=i))||l;a.default=R},3851:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d,c,f,p=r(n(44)),m=r(n(13)),h=r(n(14)),v=r(n(17)),g=r(n(16)),b=r(n(66)),y=r(n(18)),_=r(n(41)),E=(r(n(45)),r(n(0))),k=r(n(1)),C=r(n(22)),S=n(19),w=n(60),D=r(n(267)),I=r(n(387)),N=r(n(386)),P=r(n(225)),j=n(2566),x=r(n(2528)),L=function(e,t){var a=Object.keys(e).reduce((function(t,a){return"".concat(t).concat(a," : '").concat(e[a],"' ,")}),"");return"${[".concat(t,"(").concat(a,")]}")},R={secret_text:"string",username_password:"usernamePassword",ssh:"sshUserPrivateKey",kubeconfig:"kubeconfigContent"},O=(0,w.observer)((f=c=function(e){function a(e){var n;return(0,m.default)(this,a),n=(0,v.default)(this,(0,g.default)(a).call(this,e)),(0,p.default)(n,"formData",u,(0,b.default)(n)),(0,p.default)(n,"credentialType",o,(0,b.default)(n)),(0,p.default)(n,"setCredentialType",s,(0,b.default)(n)),(0,p.default)(n,"handleCredentialChange",d,(0,b.default)(n)),n.handleOk=function(){var e=n.formRef.current._formData;n.formRef.current.validate((function(){n.props.onAddStep({name:"withCredentials",arguments:{isLiteral:!1,value:L(e,R[n.credentialType])},children:[]})}))},n.renderParams=function(){switch(n.credentialType){case"username_password":return E.default.createElement(E.default.Fragment,null,E.default.createElement(D.default.Item,{label:t("password Variable")},E.default.createElement(N.default,{name:"passwordVariable"})),E.default.createElement(D.default.Item,{label:t("username Variable")},E.default.createElement(N.default,{name:"usernameVariable"})));case"secret_text":return E.default.createElement(E.default.Fragment,null,E.default.createElement(D.default.Item,{label:t("Text Variable")},E.default.createElement(N.default,{name:"variable"})));case"ssh":return E.default.createElement(E.default.Fragment,null,E.default.createElement(D.default.Item,{label:t("key File Variable")},E.default.createElement(N.default,{name:"keyFileVariable"})),E.default.createElement(D.default.Item,{label:t("passphrase Variable")},E.default.createElement(N.default,{name:"passphraseVariable"})),E.default.createElement(D.default.Item,{label:t("username Variable")},E.default.createElement(N.default,{name:"usernameVariable"})));case"kubeconfig":return E.default.createElement(D.default.Item,{label:t("Kubeconfig Variable")},E.default.createElement(N.default,{name:"variable"}));default:return null}},n.formRef=E.default.createRef(),n}return(0,y.default)(a,e),(0,h.default)(a,[{key:"componentDidMount",value:function(){this.props.store.getCredentials()}},{key:"componentWillReceiveProps",value:function(e){if("withCredentials"===e.edittingData.type){var t=(0,C.default)(e,"edittingData.data.value","");t&&(this.formData=(0,j.groovyToJS)(t),this.setCredentialType(t))}}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel,r=this.props.store.credentials;return E.default.createElement(I.default,{width:680,bodyClassName:x.default.body,onCancel:n,onOk:this.handleOk,visible:a,closable:!1,title:t("withCredentials")},E.default.createElement(D.default,{data:this.formData,ref:this.formRef},E.default.createElement(D.default.Item,{label:t("Credential ID"),rules:[{required:!0,message:t("This param is required")}],desc:E.default.createElement("p",null,t("ADD_NEW_CREDENTIAL_DESC"),E.default.createElement("span",{className:x.default.clickable,onClick:this.props.showCredential},t("Create a credential")))},E.default.createElement(P.default,{name:"credentialsId",options:r,onChange:this.handleCredentialChange})),this.renderParams()))}}]),a}(E.default.Component),c.propTypes={name:k.default.string},c.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},i=f,u=(0,_.default)(i.prototype,"formData",[S.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),o=(0,_.default)(i.prototype,"credentialType",[S.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"username_password"}}),s=(0,_.default)(i.prototype,"setCredentialType",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=/\$\{\[([\w-]*)\(/,n=t.match(a)&&t.match(a)[1];n&&(e.credentialType=Object.entries(R).find((function(e){return e[1]===n}))[0])}}}),d=(0,_.default)(i.prototype,"handleCredentialChange",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=e.props.store.credentials.find((function(e){return e.value===t}));e.credentialType=a.type}}}),l=i))||l;a.default=O},3852:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d,c,f,p,m=r(n(44)),h=r(n(13)),v=r(n(14)),g=r(n(17)),b=r(n(16)),y=r(n(66)),_=r(n(18)),E=r(n(41)),k=(r(n(45)),r(n(574))),C=r(n(0)),S=r(n(1)),w=n(19),D=n(60),I=r(n(267)),N=r(n(387)),P=r(n(2602)),j=r(n(386)),x=r(n(225)),L=r(n(38)),R=n(938),O=r(n(2528)),M=function(e){var t=Object.keys(e).map((function(t){if("object"===(0,k.default)(e[t])){var a=Object.keys(e[t]).map((function(a){return"".concat(a,": '").concat(e[t][a],"'")})).join(", ");return"".concat(t,": [[").concat(a,"]]")}return"".concat(t,": '").concat(e[t],"'")})).join(", ");return"[".concat(t,"]")},T=(0,D.observer)((p=f=function(e){function a(e){var n;return(0,h.default)(this,a),n=(0,g.default)(this,(0,b.default)(a).call(this,e)),(0,m.default)(n,"formData",u,(0,y.default)(n)),(0,m.default)(n,"dockerCredentials",o,(0,y.default)(n)),(0,m.default)(n,"isShowAdvenced",s,(0,y.default)(n)),(0,m.default)(n,"isShowDetail",d,(0,y.default)(n)),n.handleChange=function(e){return function(t){n.formData[e]=t.target?t.target.value.trim():t}},(0,m.default)(n,"handleCredentialChange",c,(0,y.default)(n)),n.handleAddDockerCredential=function(){n.dockerCredentials.push({key:"".concat(Math.random())})},n.showAdvencedSetting=function(){n.isShowAdvenced=!0},n.handleRemove=function(e){return function(){n.dockerCredentials=n.dockerCredentials.filter((function(t){return t.key!==e}))}},n.toggleDesc=function(){n.isShowDetail=!n.isShowDetail},n.handleOk=function(){n.formRef.current.validate((function(){var e=Object.keys(n.formData).map((function(e){return{key:e,value:{isLiteral:!0,value:n.formData[e]}}}));if(n.isShowAdvenced){var t=n.dockerCredentials.reduce((function(e,t,a){return delete t.key,a===n.dockerCredentials.length-1?"".concat(e+M(t)):"".concat(e+M(t),",")}),"");"[]"!==t&&e.push({key:"dockerCredentials",value:{isLiteral:!1,value:"${[".concat(t,"]}")}})}n.props.onAddStep({name:"kubernetesDeploy",arguments:e.filter((function(e){return""!==e.value.value}))})}))},n.renderDockerCredentials=function(){var e=n.props.store.passWordCredentials;return C.default.createElement("div",{className:O.default.dockerCredentialsContent},C.default.createElement("div",{className:O.default.dockerCredentialsContent__title},t("Kubernetes Secrets")),C.default.createElement(I.default.Item,{label:t("Kubernetes Namespace for Secret")},C.default.createElement(j.default,{name:"secretNamespace",value:n.formData.secretNamespace,onChange:n.handleChange("secretNamespace")})),C.default.createElement(I.default.Item,{label:t("Secret Name")},C.default.createElement(j.default,{name:"secretName",value:n.formData.secretName,onChange:n.handleChange("secretName")})),C.default.createElement("div",{className:O.default.dockerCredentialsContent__title},t("Docker Container Registry Credentials")),C.default.createElement("div",null,n.dockerCredentials.map((function(a){return C.default.createElement("div",{key:a.key,className:O.default.dockerCredentialsContent__content},C.default.createElement(L.default,{name:"trash",clickable:!0,className:O.default.dockerCredentialsContent__trashicon,onClick:n.handleRemove(a.key)}),C.default.createElement(I.default.Item,{label:t("Docker registry URL")},C.default.createElement(j.default,{value:a.url,onChange:n.handleCredentialChange(a.key,"url")})),C.default.createElement(I.default.Item,{label:t("Registry credentials")},C.default.createElement(x.default,{value:a.credentialsId,options:e,onChange:n.handleCredentialChange(a.key,"credentialsId")})))})),C.default.createElement("div",{onClick:n.handleAddDockerCredential,className:O.default.clickable},t("Add another credential"))))},n.formRef=C.default.createRef(),n}return(0,_.default)(a,e),(0,v.default)(a,[{key:"componentWillReceiveProps",value:function(e){"kubernetesDeploy"===e.edittingData.type&&(this.formData=e.edittingData.data.reduce((function(e,t){return e[t.key]=t.value.value,e}),{}))}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel,r=this.props.store.kubeconfigCredentials;return C.default.createElement(N.default,{width:680,bodyClassName:O.default.body,onCancel:n,onOk:this.handleOk,visible:a,closable:!1,title:t("kubernetesDeploy")},C.default.createElement("div",{className:O.default.desc},t("KUBERNETES_DEPLOY_DESC"),this.isShowDetail?t.html("KUBERNETES_DEPLOY_DESC_MORE"):null,C.default.createElement("span",{className:O.default.clickable,onClick:this.toggleDesc},this.isShowDetail?t("Collapse"):t("More"))),C.default.createElement(I.default,{className:O.default.KubernetesForm,data:this.formData,ref:this.formRef},C.default.createElement(I.default.Item,{label:t("Kubeconfig"),rules:[{required:!0,message:t("This param is required")}],desc:C.default.createElement("p",null,t("ADD_NEW_CREDENTIAL_DESC"),C.default.createElement("span",{className:O.default.clickable,onClick:this.props.showCredential},t("Create a credential")))},C.default.createElement(x.default,{name:"kubeconfigId",options:r})),C.default.createElement(I.default.Item,{label:t("Config Files")},C.default.createElement(j.default,{name:"configs"})),C.default.createElement(R.Columns,{className:"margin-t12"},C.default.createElement(R.Column,null,C.default.createElement(I.default.Item,null,C.default.createElement(P.default,{name:"enableConfigSubstitution",defaultValue:!0},t("Enable Variable Substitution in Config")))),C.default.createElement(R.Column,null,C.default.createElement(I.default.Item,null,C.default.createElement(P.default,{name:"deleteResource",defaultValue:!1},t("Enable Delete All Resource to the deployment file"))))),this.isShowAdvenced?this.renderDockerCredentials():C.default.createElement("div",{className:O.default.clickable,onClick:this.showAdvencedSetting},t("show advanced setting"))))}}]),a}(C.default.Component),f.propTypes={name:S.default.string},f.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},i=p,u=(0,E.default)(i.prototype,"formData",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),o=(0,E.default)(i.prototype,"dockerCredentials",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[{key:"default"}]}}),s=(0,E.default)(i.prototype,"isShowAdvenced",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=(0,E.default)(i.prototype,"isShowDetail",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),c=(0,E.default)(i.prototype,"handleCredentialChange",[w.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a){return function(n){e.dockerCredentials=e.dockerCredentials.map((function(e){return e.key===t&&(e[a]=n.target?n.target.value:n),e}))}}}}),l=i))||l;a.default=T},3853:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d=r(n(44)),c=r(n(13)),f=r(n(14)),p=r(n(17)),m=r(n(16)),h=r(n(66)),v=r(n(18)),g=r(n(41)),b=(r(n(45)),r(n(0))),y=r(n(1)),_=n(19),E=n(60),k=r(n(225)),C=r(n(2454)),S=r(n(267)),w=r(n(387)),D=r(n(2530)),I=r(n(2528)),N=(0,E.observer)((s=o=function(e){function a(e){var t;return(0,c.default)(this,a),t=(0,p.default)(this,(0,m.default)(a).call(this,e)),(0,d.default)(t,"formData",u,(0,h.default)(t)),t.handleOk=function(){var e=t.formRef.current._formData;t.formRef.current.validate((function(){var a=Object.keys(e).map((function(t){return{key:t,value:{isLiteral:!0,value:"time"===t?Number.parseInt(e[t],10):e[t]}}}));t.props.onAddStep({name:"timeout",arguments:a.filter((function(e){return""!==e.value.value})),children:[]})}))},t.formRef=b.default.createRef(),t}return(0,v.default)(a,e),(0,f.default)(a,[{key:"componentWillReceiveProps",value:function(e){"timeout"===e.edittingData.type&&(this.formData=e.edittingData.data.reduce((function(e,t){return e[t.key]=t.value.value,e}),{}))}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel;return b.default.createElement(w.default,{width:680,bodyClassName:I.default.body,onCancel:n,onOk:this.handleOk,visible:a,closable:!1,title:"timeout"},b.default.createElement(S.default,{data:this.formData,ref:this.formRef},b.default.createElement(S.default.Item,{label:t("time")},b.default.createElement(D.default,{name:"time"})),b.default.createElement(S.default.Item,{label:t("unit")},b.default.createElement(k.default,{name:"unit",options:[{value:"NANOSECONDS",label:t("NanoSeconds")},{value:"MICROSECONDS",label:t("MicroSeconds")},{value:"MILLISECONDS",label:t("MilliSeconds")},{value:"SECONDS",label:t("Seconds")},{value:"MINUTES",label:t("Minutes")},{value:"HOURS",label:t("Hours")},{value:"DAYS",label:t("Days")}],defaultValue:"MINUTES"})),b.default.createElement(S.default.Item,null,b.default.createElement(C.default,{name:"activity",defaultValue:!0,options:[{label:t("Timeout after no activity in logs for this block"),value:!0},{label:t("absolute duration"),value:!1}]}))))}}]),a}(b.default.Component),o.propTypes={name:y.default.string},o.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},i=s,u=(0,g.default)(i.prototype,"formData",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),l=i))||l;a.default=N},3854:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d=r(n(44)),c=r(n(13)),f=r(n(14)),p=r(n(17)),m=r(n(16)),h=r(n(66)),v=r(n(18)),g=r(n(41)),b=(r(n(45)),r(n(0))),y=r(n(1)),_=n(19),E=n(60),k=r(n(267)),C=r(n(387)),S=r(n(386)),w=r(n(2528)),D=(0,E.observer)((s=o=function(e){function a(e){var t;return(0,c.default)(this,a),t=(0,p.default)(this,(0,m.default)(a).call(this,e)),(0,d.default)(t,"formData",u,(0,h.default)(t)),t.handleOk=function(){var e=t.formRef.current._formData,a=Object.keys(e).map((function(t){return{isLiteral:!0,value:e[t]}}));t.props.onAddStep({name:"branch",arguments:a[0]})},t.formRef=b.default.createRef(),t}return(0,v.default)(a,e),(0,f.default)(a,[{key:"componentWillReceiveProps",value:function(e){"branch"===e.edittingData.type&&(this.formData=e.edittingData.data.reduce((function(e,t){return e[t.key]=t.value.value,e}),{}))}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel;return b.default.createElement(C.default,{width:680,bodyClassName:w.default.body,onCancel:n,onOk:this.handleOk,visible:a,closable:!1,title:t("branch")},b.default.createElement(k.default,{data:this.formData,ref:this.formRef},b.default.createElement(k.default.Item,{label:t("branch")},b.default.createElement(S.default,{name:"branch"}))))}}]),a}(b.default.Component),o.propTypes={name:y.default.string},o.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},i=s,u=(0,g.default)(i.prototype,"formData",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),l=i))||l;a.default=D},3855:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d=r(n(44)),c=r(n(13)),f=r(n(14)),p=r(n(17)),m=r(n(16)),h=r(n(66)),v=r(n(18)),g=r(n(41)),b=(r(n(45)),r(n(0))),y=r(n(1)),_=n(19),E=n(60),k=r(n(267)),C=r(n(387)),S=r(n(386)),w=r(n(2528)),D=(0,E.observer)((s=o=function(e){function a(e){var t;return(0,c.default)(this,a),t=(0,p.default)(this,(0,m.default)(a).call(this,e)),(0,d.default)(t,"formData",u,(0,h.default)(t)),t.handleOk=function(){var e=t.formRef.current._formData,a=Object.keys(e).map((function(t){return{key:t,value:{isLiteral:!0,value:e[t]}}}));t.props.onAddStep({name:"environment",arguments:a})},t.formRef=b.default.createRef(),t}return(0,v.default)(a,e),(0,f.default)(a,[{key:"componentWillReceiveProps",value:function(e){"environment"===e.edittingData.type&&(this.formData=e.edittingData.data.reduce((function(e,t){return e[t.key]=t.value.value,e}),{}))}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel;return b.default.createElement(C.default,{width:680,bodyClassName:w.default.body,onCancel:n,onOk:this.handleOk,visible:a,closable:!1,title:t("environment")},b.default.createElement(k.default,{data:this.formData,ref:this.formRef},b.default.createElement(k.default.Item,{label:t("Enviroment name")},b.default.createElement(S.default,{name:"name"})),b.default.createElement(k.default.Item,{label:t("Value")},b.default.createElement(S.default,{name:"value"}))))}}]),a}(b.default.Component),o.propTypes={name:y.default.string},o.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},i=s,u=(0,g.default)(i.prototype,"formData",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),l=i))||l;a.default=D},3856:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d=r(n(44)),c=r(n(13)),f=r(n(14)),p=r(n(17)),m=r(n(16)),h=r(n(66)),v=r(n(18)),g=r(n(41)),b=(r(n(45)),r(n(0))),y=r(n(1)),_=n(19),E=n(60),k=r(n(267)),C=r(n(387)),S=r(n(386)),w=r(n(2528)),D=(0,E.observer)((s=o=function(e){function a(e){var t;return(0,c.default)(this,a),t=(0,p.default)(this,(0,m.default)(a).call(this,e)),(0,d.default)(t,"formData",u,(0,h.default)(t)),t.handleOk=function(){var e=t.formRef.current._formData,a=Object.keys(e).map((function(t){return{key:t,value:{isLiteral:!0,value:e[t]}}}));t.props.onAddStep({name:"expression",arguments:a})},t.formRef=b.default.createRef(),t}return(0,v.default)(a,e),(0,f.default)(a,[{key:"componentWillReceiveProps",value:function(e){"expression"===e.edittingData.type&&(this.formData=e.edittingData.data.reduce((function(e,t){return e[t.key]=t.value.value,e}),{}))}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel;return b.default.createElement(C.default,{width:680,bodyClassName:w.default.body,onCancel:n,onOk:this.handleOk,visible:a,closable:!1,title:t("expression")},b.default.createElement(k.default,{data:this.formData,ref:this.formRef},b.default.createElement(k.default.Item,{label:t("expression")},b.default.createElement(S.default,{name:"scriptBlock"}))))}}]),a}(b.default.Component),o.propTypes={name:y.default.string},o.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},i=s,u=(0,g.default)(i.prototype,"formData",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),l=i))||l;a.default=D},3857:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d=r(n(44)),c=r(n(13)),f=r(n(14)),p=r(n(17)),m=r(n(16)),h=r(n(66)),v=r(n(18)),g=r(n(41)),b=(r(n(45)),r(n(0))),y=r(n(1)),_=r(n(22)),E=n(19),k=n(60),C=r(n(267)),S=r(n(387)),w=r(n(386)),D=r(n(942)),I=r(n(2528)),N=(0,k.observer)((s=o=function(e){function a(e){var t;return(0,c.default)(this,a),t=(0,p.default)(this,(0,m.default)(a).call(this,e)),(0,d.default)(t,"formData",u,(0,h.default)(t)),t.handleOk=function(){var e=(t.formRef.current||{}).getData();t.formRef.current.validate((function(){t.props.onAddStep({name:"withSonarQubeEnv",arguments:{isLiteral:!0,value:e.name},children:[]})}))},t.formRef=b.default.createRef(),t}return(0,v.default)(a,e),(0,f.default)(a,[{key:"componentWillReceiveProps",value:function(e){"withSonarQubeEnv"===e.edittingData.type&&(this.formData={name:(0,_.default)(e.edittingData,"data.value","")})}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel;return b.default.createElement(S.default,{width:680,bodyClassName:I.default.body,onCancel:n,onOk:this.handleOk,visible:a,closable:!1,title:t("withSonarQubeEnv")},b.default.createElement(C.default,{data:this.formData,ref:this.formRef},b.default.createElement(D.default,{type:"info",className:I.default.info,message:t("Load the sonarqube configuration provided by Jenkins into the Pipeline")}),b.default.createElement(C.default.Item,{label:t("config name"),rules:[{required:!0,message:t("This param is required")}],desc:t("sonar is the default config name")},b.default.createElement(w.default,{name:"name",defaultValue:"sonar"}))))}}]),a}(b.default.Component),o.propTypes={name:y.default.string,edittingData:y.default.object},o.defaultProps={edittingData:{},visible:!1,onOk:function(){},onCancel:function(){}},i=s,u=(0,g.default)(i.prototype,"formData",[E.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),l=i))||l;a.default=N},3858:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d=r(n(44)),c=r(n(13)),f=r(n(14)),p=r(n(17)),m=r(n(16)),h=r(n(66)),v=r(n(18)),g=r(n(41)),b=(r(n(45)),r(n(0))),y=r(n(1)),_=r(n(22)),E=n(19),k=n(60),C=r(n(387)),S=r(n(951)),w=r(n(2528)),D=(0,k.observer)((s=o=function(e){function a(){var e,t;(0,c.default)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return t=(0,p.default)(this,(e=(0,m.default)(a)).call.apply(e,[this].concat(r))),(0,d.default)(t,"value",u,(0,h.default)(t)),t.handleChange=function(e){t.newValue=e},t.handleOk=function(){t.props.onAddStep({name:"script",arguments:[{key:"scriptBlock",value:{isLiteral:!0,value:t.newValue}}]})},t}return(0,v.default)(a,e),(0,f.default)(a,[{key:"componentWillReceiveProps",value:function(e){"script"===e.edittingData.type&&(this.value=(0,_.default)(e.edittingData.data,"[0].value.value",""))}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel;return b.default.createElement(C.default,{width:680,bodyClassName:w.default.body,onCancel:n,onOk:this.handleOk,visible:a,closable:!1,title:t("script")},b.default.createElement(S.default,{className:w.default.CodeEditor,name:"script",mode:"yaml",value:this.value,onChange:this.handleChange}))}}]),a}(b.default.Component),o.propTypes={name:y.default.string},o.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},i=s,u=(0,g.default)(i.prototype,"value",[E.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),l=i))||l;a.default=D},3859:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d=r(n(44)),c=r(n(13)),f=r(n(17)),p=r(n(16)),m=r(n(66)),h=r(n(14)),v=r(n(18)),g=r(n(41)),b=(r(n(45)),r(n(0))),y=r(n(1)),_=n(19),E=n(60),k=r(n(225)),C=r(n(267)),S=r(n(387)),w=r(n(2544)),D=r(n(2528)),I=(0,E.observer)((s=o=function(e){function a(e){var t;return(0,c.default)(this,a),t=(0,f.default)(this,(0,p.default)(a).call(this,e)),(0,d.default)(t,"formData",u,(0,m.default)(t)),t.handleOk=function(){var e=(t.formRef.current||{}).getData();t.formRef.current.validate((function(){var a=Object.keys(e).map((function(t){return{key:t,value:{isLiteral:!0,value:e[t]}}}));t.props.onAddStep({name:"waitForQualityGate",arguments:a.filter((function(e){return""!==e.value.value}))})}))},t.formRef=b.default.createRef(),t}return(0,v.default)(a,e),(0,h.default)(a,[{key:"options",get:function(){return[{label:t("Inspection results do not affect subsequent tasks"),value:"false"},{label:t("Start the follow-up task after the inspection"),value:"true"}]}}]),(0,h.default)(a,[{key:"componentWillReceiveProps",value:function(e){"waitForQualityGate"===e.edittingData.type&&(this.formData=e.edittingData.data.reduce((function(e,t){return e[t.key]=t.value.value,e}),{}))}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel;return b.default.createElement(S.default,{width:680,bodyClassName:D.default.body,onCancel:n,onOk:this.handleOk,visible:a,closable:!1,title:t("waitForQualityGate")},b.default.createElement(C.default,{data:this.formData,ref:this.formRef},b.default.createElement(w.default,{type:"info",className:D.default.info,message:t("waitForQualityGate_desc")}),b.default.createElement(C.default.Item,{label:t("abortPipeline"),rules:[{required:!0,message:t("This param is required")}]},b.default.createElement(k.default,{name:"abortPipeline",options:this.options,defaultValue:"true"}))))}}]),a}(b.default.Component),o.propTypes={name:y.default.string},o.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},i=s,u=(0,g.default)(i.prototype,"formData",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),l=i))||l;a.default=I},3860:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d=r(n(44)),c=r(n(13)),f=r(n(14)),p=r(n(17)),m=r(n(16)),h=r(n(66)),v=r(n(18)),g=r(n(41)),b=(r(n(45)),r(n(0))),y=r(n(1)),_=n(19),E=n(60),k=r(n(267)),C=r(n(387)),S=r(n(386)),w=r(n(2453)),D=r(n(2528)),I=(0,E.observer)((s=o=function(e){function a(e){var t;return(0,c.default)(this,a),t=(0,p.default)(this,(0,m.default)(a).call(this,e)),(0,d.default)(t,"formData",u,(0,h.default)(t)),t.handleOk=function(){var e=t.formRef.current._formData;t.formRef.current.validate((function(){var a=Object.keys(e).map((function(t){return{key:t,value:{isLiteral:!0,value:e[t]}}}));t.props.onAddStep({name:"mail",arguments:a.filter((function(e){return""!==e.value.value}))})}))},t.formRef=b.default.createRef(),t}return(0,v.default)(a,e),(0,f.default)(a,[{key:"componentWillReceiveProps",value:function(e){"mail"===e.edittingData.type&&(this.formData=e.edittingData.data.reduce((function(e,t){return e[t.key]=t.value.value,e}),{}))}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel;return b.default.createElement(C.default,{width:680,bodyClassName:D.default.body,onCancel:n,onOk:this.handleOk,visible:a,closable:!1,title:t("mail")},b.default.createElement(k.default,{data:this.formData,ref:this.formRef},b.default.createElement(k.default.Item,{label:t("Recipient")},b.default.createElement(S.default,{name:"to"})),b.default.createElement(k.default.Item,{label:t("cc")},b.default.createElement(S.default,{name:"cc"})),b.default.createElement(k.default.Item,{label:t("subject"),rules:[{required:!0,message:t("This param is required")}]},b.default.createElement(S.default,{name:"subject"})),b.default.createElement(k.default.Item,{label:t("body"),rules:[{required:!0,message:t("This param is required")}]},b.default.createElement(w.default,{name:"body"}))))}}]),a}(b.default.Component),o.propTypes={name:y.default.string},o.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},i=s,u=(0,g.default)(i.prototype,"formData",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),l=i))||l;a.default=I},3861:function(e,t,a){e.exports={taskList:"StepsSelector__taskList--2loGh",task:"StepsSelector__task--3H5tv",taskIcon:"StepsSelector__taskIcon--asNYa",taskInfo:"StepsSelector__taskInfo--T1TGQ",taskName:"StepsSelector__taskName--HhpjX",desc:"StepsSelector__desc--1Dc2Z",back:"StepsSelector__back--cvvjf",tabs:"StepsSelector__tabs--2L811",tab:"StepsSelector__tab--3Maur",tab_active:"StepsSelector__tab_active--3Xttz"}},3862:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d,c,f,p,m=r(n(61)),h=r(n(62)),v=r(n(37)),g=r(n(44)),b=r(n(13)),y=r(n(14)),_=r(n(17)),E=r(n(16)),k=r(n(66)),C=r(n(18)),S=(r(n(45)),r(n(41))),w=n(19),D=r(n(22)),I=r(n(115)),N=r(n(566)),P=r(n(2476)),j=r(n(2637)),x=r(n(2576)),L=function(e){if((0,D.default)(e,"pipeline.stages"))return e.pipeline.stages=e.pipeline.stages.map((function(e){return e.parallel?(e.parallel=e.parallel.map((function(e){return(0,N.default)(e,"branches[0].id"),delete e.error,delete e.conditionError,delete e.isActive,e})),e):((0,N.default)(e,"branches[0].id"),delete e.error,delete e.conditionError,delete e.isActive,e)})),e},R=(l=function(e){function a(){var e;return(0,b.default)(this,a),e=(0,_.default)(this,(0,E.default)(a).call(this)),(0,g.default)(e,"jsonData",i,(0,k.default)(e)),(0,g.default)(e,"activeLineIndex",u,(0,k.default)(e)),(0,g.default)(e,"activeColunmIndex",o,(0,k.default)(e)),(0,g.default)(e,"isAddingStep",s,(0,k.default)(e)),(0,g.default)(e,"edittingData",d,(0,k.default)(e)),(0,g.default)(e,"params",c,(0,k.default)(e)),(0,g.default)(e,"credentials",f,(0,k.default)(e)),(0,g.default)(e,"getCredentials",p,(0,k.default)(e)),e.credentialStore=new j.default,e}var n,r;return(0,C.default)(a,e),(0,y.default)(a,[{key:"handleAddBranch",value:function(e){this.jsonData.json.pipeline.stages[e].parallel?this.jsonData.json.pipeline.stages[e].parallel.push(this.newStage):this.jsonData.json.pipeline.stages[e]={name:"default-".concat(e),parallel:[this.jsonData.json.pipeline.stages[e],this.newStage]},this.handleSetInLocalStorage()}},{key:"handleSetInLocalStorage",value:function(){var e=this.params,t=e.project_id,a=e.name;this.prevData=localStorage.setItem("".concat(globals.user.username,"-").concat(t,"-").concat(a),JSON.stringify((0,w.toJS)(this.jsonData)))}},{key:"setData",value:function(e){this.jsonData=e,L(this.jsonData.json)}},{key:"insertColunm",value:function(e){this.jsonData.json.pipeline.stages.splice(e,0,this.newStage)}},{key:"setFocus",value:function(e,t){""!==this.activeLineIndex&&this.setActive(this.activeLineIndex,this.activeColunmIndex,void 0),this.activeLineIndex=e,this.activeColunmIndex=t,this.setActive(e,t,!0)}},{key:"setActive",value:function(e,t,a){this.jsonData.json.pipeline.stages[e]&&this.jsonData.json.pipeline.stages[e].parallel?this.jsonData.json.pipeline.stages[e].parallel[t]=(0,v.default)({},this.jsonData.json.pipeline.stages[e].parallel[t],{isActive:a}):this.jsonData.json.pipeline.stages[e]=(0,v.default)({},this.jsonData.json.pipeline.stages[e],{isActive:a})}},{key:"setEdittingData",value:function(e){this.edittingData=e}},{key:"clearFocus",value:function(){""!==this.activeLineIndex&&this.setActive(this.activeLineIndex,this.activeColunmIndex,void 0),this.activeLineIndex="",this.activeColunmIndex="",this.edittingData={},this.isAddingStep=!1}},{key:"deleteStage",value:function(){this.jsonData.json.pipeline.stages[this.activeLineIndex].parallel?1===this.jsonData.json.pipeline.stages[this.activeLineIndex].parallel.length?this.jsonData.json.pipeline.stages.splice(this.activeLineIndex,1):2===this.jsonData.json.pipeline.stages[this.activeLineIndex].parallel.length?(this.jsonData.json.pipeline.stages[this.activeLineIndex].parallel.splice(this.activeColunmIndex,1),this.jsonData.json.pipeline.stages[this.activeLineIndex]=this.jsonData.json.pipeline.stages[this.activeLineIndex].parallel[0]):this.jsonData.json.pipeline.stages[this.activeLineIndex].parallel.splice(this.activeColunmIndex,1):this.jsonData.json.pipeline.stages.splice(this.activeLineIndex,1),this.activeLineIndex="",this.activeColunmIndex="",this.handleSetInLocalStorage()}},{key:"setValue",value:function(e){this.jsonData.json.pipeline.stages[this.activeLineIndex].parallel?this.jsonData.json.pipeline.stages[this.activeLineIndex].parallel.splice(this.activeColunmIndex,1,e):this.jsonData.json.pipeline.stages.splice(this.activeLineIndex,1,e),this.handleSetInLocalStorage()}},{key:"convertJsonToJenkinsFile",value:(r=(0,h.default)(m.default.mark((function e(){var a=this;return m.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.request.post("kapis/devops.kubesphere.io/v1alpha2/tojenkinsfile",{json:JSON.stringify(L((0,w.toJS)(this.jsonData.json)))},{headers:{"content-type":"application/x-www-form-urlencoded"}}).then((function(e){if(e&&"success"===(0,D.default)(e,"data.result"))return a.jenkinsFile=e.data.jenkinsfile,e;e&&"failure"===(0,D.default)(e,"data.result")&&e.data.errors.forEach((function(e){if(e.location){var n=e.location.join(".").split(".branches"),r=(0,D.default)(a.jsonData.json,n[0]);if(r&&void 0!==r.length)P.default.error({content:e.error});else if(-1===e.location.indexOf("conditions")){var l=-1!==e.location.indexOf("steps")?parseInt(e.location[e.location.indexOf("steps")+1],10):void 0;(0,I.default)(a.jsonData.json,n[0],(0,v.default)({},(0,w.toJS)((0,D.default)(a.jsonData.json,n[0])),{error:{error:e.error,index:l}}))}else{var i=e.location.join(".").split(".when"),u=-1!==e.location.indexOf("conditions")?parseInt(e.location[e.location.indexOf("conditions")+1],10):void 0;(0,I.default)(a.jsonData.json,i[0],(0,v.default)({},(0,w.toJS)((0,D.default)(a.jsonData.json,i[0])),{conditionError:{error:e.error,index:u}}))}}else window.onunhandledrejection({status:"Failure",reason:t("pipeline syntax error"),message:e.error||JSON.stringify(e)})}))})));case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"handleConfirm",value:(n=(0,h.default)(m.default.mark((function e(){return m.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.convertJsonToJenkinsFile();case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"newStage",get:function(){return{branches:[{id:String(Math.random()),name:"",steps:[]}]}}},{key:"stages",get:function(){return(0,D.default)(this.jsonData,"json.pipeline.stages",[])}},{key:"activeStage",get:function(){return""===this.activeLineIndex?"":this.stages[this.activeLineIndex]?this.stages[this.activeLineIndex].parallel?this.stages[this.activeLineIndex].parallel[this.activeColunmIndex]:this.stages[this.activeLineIndex]:""}},{key:"passWordCredentials",get:function(){return this.credentials.filter((function(e){return"username_password"===e.type}))}},{key:"kubeconfigCredentials",get:function(){return this.credentials.filter((function(e){return"kubeconfig"===e.type}))}}]),a}(x.default),(0,S.default)(l.prototype,"stages",[w.computed],Object.getOwnPropertyDescriptor(l.prototype,"stages"),l.prototype),(0,S.default)(l.prototype,"activeStage",[w.computed],Object.getOwnPropertyDescriptor(l.prototype,"activeStage"),l.prototype),(0,S.default)(l.prototype,"passWordCredentials",[w.computed],Object.getOwnPropertyDescriptor(l.prototype,"passWordCredentials"),l.prototype),(0,S.default)(l.prototype,"kubeconfigCredentials",[w.computed],Object.getOwnPropertyDescriptor(l.prototype,"kubeconfigCredentials"),l.prototype),i=(0,S.default)(l.prototype,"jsonData",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),u=(0,S.default)(l.prototype,"activeLineIndex",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),o=(0,S.default)(l.prototype,"activeColunmIndex",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),s=(0,S.default)(l.prototype,"isAddingStep",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=(0,S.default)(l.prototype,"edittingData",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),c=(0,S.default)(l.prototype,"params",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),f=(0,S.default)(l.prototype,"credentials",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),(0,S.default)(l.prototype,"setData",[w.action],Object.getOwnPropertyDescriptor(l.prototype,"setData"),l.prototype),(0,S.default)(l.prototype,"insertColunm",[w.action],Object.getOwnPropertyDescriptor(l.prototype,"insertColunm"),l.prototype),(0,S.default)(l.prototype,"setFocus",[w.action],Object.getOwnPropertyDescriptor(l.prototype,"setFocus"),l.prototype),(0,S.default)(l.prototype,"setActive",[w.action],Object.getOwnPropertyDescriptor(l.prototype,"setActive"),l.prototype),(0,S.default)(l.prototype,"setEdittingData",[w.action],Object.getOwnPropertyDescriptor(l.prototype,"setEdittingData"),l.prototype),(0,S.default)(l.prototype,"clearFocus",[w.action],Object.getOwnPropertyDescriptor(l.prototype,"clearFocus"),l.prototype),(0,S.default)(l.prototype,"deleteStage",[w.action],Object.getOwnPropertyDescriptor(l.prototype,"deleteStage"),l.prototype),(0,S.default)(l.prototype,"setValue",[w.action],Object.getOwnPropertyDescriptor(l.prototype,"setValue"),l.prototype),(0,S.default)(l.prototype,"convertJsonToJenkinsFile",[w.action],Object.getOwnPropertyDescriptor(l.prototype,"convertJsonToJenkinsFile"),l.prototype),p=(0,S.default)(l.prototype,"getCredentials",[w.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return((0,h.default)(m.default.mark((function t(){var a;return m.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isCredentialLoading=!0,t.next=3,e.credentialStore.fetchList({project_id:e.params.project_id});case 3:a=t.sent,e.credentials=a.map((function(e){return{label:e.id,value:e.id,type:e.type}})),e.isCredentialLoading=!1;case 6:case"end":return t.stop()}}),t)}))))}}),(0,S.default)(l.prototype,"handleConfirm",[w.action],Object.getOwnPropertyDescriptor(l.prototype,"handleConfirm"),l.prototype),l);a.default=R},3863:function(e,t,a){e.exports={pipeline_column:"Pipeline__pipeline_column--nWZ33",content:"Pipeline__content--1-oRV"}},3864:function(e,t,a){e.exports={body:"Modals__body--1hocK",title:"Modals__title--uSI8-",content:"Modals__content--1Rpxt"}},3865:function(e,t,a){e.exports={pipelineSuccessNumber:"Pipelines__pipelineSuccessNumber--2WcK1",sourcePipelineStatus:"Pipelines__sourcePipelineStatus--2_UWt"}},3866:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i=r(n(63)),u=r(n(13)),o=r(n(14)),s=r(n(17)),d=r(n(16)),c=r(n(18)),f=r(n(58)),p=r(n(0)),m=n(19),h=n(60),v=r(n(38)),g=r(n(190)),b=r(n(271)),y=r(n(2516)),_=r(n(224)),E=r(n(2524)),k=r(n(2594)),C=r(n(2523)),S=r(n(3867)),w=r(n(3868)),D=(0,h.inject)("rootStore")(l=(0,h.observer)(l=function(e){function a(){var e,t;(0,u.default)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(t=(0,s.default)(this,(e=(0,d.default)(a)).call.apply(e,[this].concat(r)))).state={showEdit:!1,showDelete:!1},t.hideEdit=function(){t.setState({showEdit:!1})},t.handleEdit=function(e){var a=e.project_id,n=(0,i.default)(e,["project_id"]);t.store.update(a,n).then((function(){t.hideEdit(),t.store.fetchDetail(t.props.match.params)}))},t.hideDelete=function(){t.setState({showDelete:!1})},t.handleDelete=function(){var e=t.props.match.params.project_id;t.store.delete({project_id:e},{workspace:t.workspace}).then((function(){t.routing.push("/")}))},t.handleMoreMenuClick=function(e,a){switch(a){case"edit":t.setState({showEdit:!0});break;case"delete":t.setState({showDelete:!0})}},t}return(0,c.default)(a,e),(0,o.default)(a,[{key:"componentDidMount",value:function(){this.store.fetchRoles(this.props.match.params),this.store.fetchMembers(this.props.match.params)}},{key:"getWorkspaceUrl",value:function(){var e=this.workspace;return globals.app.hasPermission({module:"workspaces",action:"manage"})||globals.app.hasPermission({module:"workspaces",action:"view",workspace:e})?"/workspaces/".concat(e,"/overview"):"/"}},{key:"renderMoreMenu",value:function(){return p.default.createElement(b.default,{onClick:this.handleMoreMenuClick},this.enabledItemActions.map((function(e){return p.default.createElement(b.default.MenuItem,{key:e.key},p.default.createElement(v.default,{name:e.icon})," ",e.text)})))}},{key:"renderOperations",value:function(){return(0,f.default)(this.enabledItemActions)?null:p.default.createElement(g.default,{content:this.renderMoreMenu(),trigger:"click",placement:"bottomRight"},p.default.createElement(_.default,{icon:"more",type:"flat"}))}},{key:"renderBaseInfo",value:function(){return p.default.createElement("div",{className:"margin-t12"},p.default.createElement(y.default,{title:t("Basic Info"),operations:this.renderOperations()},p.default.createElement("div",{className:w.default.baseInfo},p.default.createElement(k.default,{className:w.default.info,image:"/assets/default-workspace.svg",title:this.workspace,desc:t("Workspace"),url:this.getWorkspaceUrl()}),p.default.createElement(k.default,{className:w.default.info,icon:"group",title:this.store.members.total,desc:t("Members"),url:"/devops/".concat(this.project_id,"/members")}),p.default.createElement(k.default,{className:w.default.info,icon:"role",title:this.store.roles.total,desc:t("Project Roles"),url:"/devops/".concat(this.project_id,"/roles")}))))}},{key:"render",value:function(){var e=(0,m.toJS)(this.store).data;return p.default.createElement("div",null,p.default.createElement(C.default,{title:t("DevOps BaseInfo"),icon:"cdn",description:t("DEVOPS_DESCRIPTION"),module:this.module}),this.renderBaseInfo(),p.default.createElement(S.default,{detail:e,workspace:this.workspace,members:(0,m.toJS)(this.store.members.data),visible:this.state.showEdit,onOk:this.handleEdit,onCancel:this.hideEdit,isSubmitting:this.store.isSubmitting}),p.default.createElement(E.default,{detail:e,desc:t.html("DELETE_DEVOPS_TIP",{resource:e.name}),visible:this.state.showDelete,onOk:this.handleDelete,onCancel:this.hideDelete,isSubmitting:this.store.isSubmitting}))}},{key:"store",get:function(){return this.props.rootStore.devops}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"workspace",get:function(){return this.store.data.workspace}},{key:"project_id",get:function(){return this.props.match.params.project_id}},{key:"enabledActions",get:function(){return globals.app.getActions({module:"devops",workspace:this.workspace,project:this.props.match.params.devops||this.props.match.params.project_id})}},{key:"itemActions",get:function(){return[{key:"edit",icon:"pen",action:"edit",text:t("Edit Info")},{key:"delete",icon:"trash",action:"delete",text:t("Delete DevOps Project")}]}},{key:"enabledItemActions",get:function(){var e=this;return this.itemActions.filter((function(t){return!t.action||e.enabledActions.includes(t.action)}))}}]),a}(p.default.Component))||l)||l;a.default=D},3867:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o=r(n(13)),s=r(n(14)),d=r(n(17)),c=r(n(16)),f=r(n(18)),p=r(n(22)),m=r(n(0)),h=r(n(1)),v=n(19),g=n(60),b=r(n(386)),y=r(n(2453)),_=r(n(387)),E=r(n(267)),k=n(114),C=r(n(2593)),S=(0,g.observer)((u=i=function(e){function a(e){var t;return(0,o.default)(this,a),(t=(0,d.default)(this,(0,c.default)(a).call(this,e))).handleOk=function(e){(0,t.props.onOk)(e)},t.form=m.default.createRef(),t.store=new C.default,e.workspace&&t.store.fetchList({limit:1/0,workspace:e.workspace}),t}return(0,f.default)(a,e),(0,s.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.detail&&e.detail.project_id&&e.detail.project_id!==(0,p.default)(this.props,"detail.project_id")&&this.store.fetchList({limit:1/0,workspace:e.workspace})}},{key:"getMembersOptions",value:function(){return(0,v.toJS)(this.store.list).data.map((function(e){return{label:e.username,value:e.username}}))}},{key:"render",value:function(){var e=this.props,a=e.detail,n=e.visible,r=e.onCancel,l=e.isSubmitting;return m.default.createElement(_.default.Form,{width:691,title:t("Edit Info"),icon:"pen",data:a,onOk:this.handleOk,onCancel:r,isSubmitting:l,visible:n},m.default.createElement(E.default.Item,{label:t("DevOps Name"),desc:t("NAME_DESC"),rules:[{required:!0,message:t("Please input name")},{pattern:k.PATTERN_NAME,message:t("PATTERN_NAME_INVALID_TIP")}]},m.default.createElement(b.default,{name:"name"})),m.default.createElement(E.default.Item,{label:t("Creator"),desc:t("DEVOPS_ADMIN_DESC")},m.default.createElement(b.default,{name:"creator",disabled:!0})),m.default.createElement(E.default.Item,{label:t("Description"),desc:t("DESCRIPTION_DESC")},m.default.createElement(y.default,{name:"description"})))}}]),a}(m.default.Component),i.propTypes={detail:h.default.object,visible:h.default.bool,onOk:h.default.func,onCancel:h.default.func,isSubmitting:h.default.bool},i.defaultProps={visible:!1,isSubmitting:!1,detail:{},onOk:function(){},onCancel:function(){}},l=u))||l;a.default=S},3868:function(e,t,a){e.exports={baseInfo:"BaseInfo__baseInfo--1Y1Qj",info:"BaseInfo__info--2i1iT"}},3869:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i=r(n(13)),u=r(n(14)),o=r(n(17)),s=r(n(16)),d=r(n(18)),c=r(n(0)),f=n(19),p=n(60),m=n(114),h=r(n(2519)),v=r(n(2523)),g=r(n(2561)),b=(0,p.inject)("rootStore")(l=(0,p.observer)(l=function(e){function a(){var e,n;(0,i.default)(this,a);for(var r=arguments.length,l=new Array(r),u=0;u<r;u++)l[u]=arguments[u];return(n=(0,o.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(l)))).getColumns=function(){return[{title:t("Name"),dataIndex:"name",width:"33%",render:function(e){return c.default.createElement(h.default,{icon:m.ICON_TYPES[n.module],title:e,noLink:!0})}},{title:t("Description"),dataIndex:"description",isHideable:!0,width:"66%",render:function(e){return t(e)}}]},n}return(0,d.default)(a,e),(0,u.default)(a,[{key:"componentDidMount",value:function(){this.getData()}},{key:"getData",value:function(){this.store.fetchRoles(this.props.match.params)}},{key:"renderTable",value:function(){var e=(0,f.toJS)(this.store.roles),t=e.data,a=e.filters,n=e.isLoading,r={total:e.total,page:e.page,limit:e.limit};return c.default.createElement("div",{className:"margin-t12"},c.default.createElement(g.default,{data:t,columns:this.getColumns(),filters:a,pagination:r,isLoading:n,hideSearch:!0}))}},{key:"render",value:function(){return c.default.createElement("div",null,c.default.createElement(v.default,{title:t("DevOps Roles"),icon:"role",description:t("DEVOPS_PROJECT_ROLES_DESC"),module:this.module}),this.renderTable())}},{key:"prefix",get:function(){return this.props.match.url}},{key:"module",get:function(){return"roles"}},{key:"name",get:function(){return"Project Roles"}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"store",get:function(){return this.props.rootStore.devops}}]),a}(c.default.Component))||l)||l;a.default=b},3870:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i=r(n(70)),u=r(n(37)),o=r(n(13)),s=r(n(14)),d=r(n(17)),c=r(n(16)),f=r(n(18)),p=r(n(58)),m=r(n(50)),h=r(n(0)),v=n(19),g=n(60),b=r(n(2519)),y=r(n(2521)),_=r(n(2542)),E=r(n(2524)),k=r(n(2659)),C=r(n(2660)),S=r(n(2523)),w=r(n(2518)),D=(0,g.inject)("rootStore")(l=(0,g.observer)(l=function(e){function a(){var e,n;(0,o.default)(this,a);for(var r=arguments.length,l=new Array(r),i=0;i<r;i++)l[i]=arguments[i];return(n=(0,d.default)(this,(e=(0,c.default)(a)).call.apply(e,[this].concat(l)))).handlePaging=function(e){return n.list.paging(e)},n.getColumns=function(){return[{title:t("Member Name"),dataIndex:"username",search:!0,width:"40%",render:function(e,t){return h.default.createElement(b.default,{avatar:t.avatar_url||"/assets/default-user.svg",title:e,desc:t.email,noLink:!0})}},{title:t("Status"),dataIndex:"status",isHideable:!0,width:"30%",render:function(e){return h.default.createElement(y.default,{type:e,name:t(e)})}},{title:t("Role"),dataIndex:"role",isHideable:!0,width:"30%"},{key:"more",render:function(e,t){return t.username===globals.user.username?null:n.renderMore(e,t)}}]},n.handleInvite=function(e,t){return n.store.addMember((0,u.default)({},n.props.match.params,{username:e,role:t})).then((function(){n.routing.query()}))},n.handleModify=function(e,t){var a=n.props.match.params.project_id,r=[];(0,m.default)(e)?e.forEach((function(e){r.push(n.store.updateMember({project_id:a,username:e.username,role:t}))})):r.push(n.store.updateMember({project_id:a,username:e.username,role:t})),Promise.all(r).then((function(){(0,m.default)(e)&&n.store.setSelectRowKeys("members",[]),n.hideModal("modifyModal")(),n.routing.query()}))},n.handleDelete=function(){var e=n.state.selectItem,t=n.props.match.params.project_id;n.store.deleteMember(t,e).then((function(){n.hideModal("deleteModal")(),n.routing.query()}))},n.handleSelectRowKeys=function(e){n.store.setSelectRowKeys("members",e)},n.handleBatchDelete=function(){var e=n.props.match.params.project_id,t=n.store.members.selectedRowKeys;t.length>0&&n.store.batchDeleteMembers(e,t).then((function(){n.hideModal("batchDeleteModal")(),n.store.setSelectRowKeys("members",[]),n.routing.query()}))},n}return(0,f.default)(a,e),(0,s.default)(a,[{key:"init",value:function(){this.store=this.props.rootStore.devops,this.store.fetchRoles(this.props.match.params)}},{key:"getData",value:function(e){this.store.fetchMembers((0,u.default)({},this.props.match.params,e))}},{key:"getTableProps",value:function(){return{hideSearch:!0,onFetch:this.handleFetch,onPaging:this.handlePaging,onSelectRowKeys:this.handleSelectRowKeys,onDelete:this.showModal("batchDeleteModal"),actions:[{key:"invite",type:"control",text:t("Invite Member"),action:"create",onClick:this.showModal("inviteModal")}],selectActions:[{key:"delete",type:"danger",text:t("Remove Members"),action:"delete",onClick:this.showModal("batchDeleteModal")}],getCheckboxProps:function(e){return{disabled:e.username===globals.user.username,name:e.username}}}}},{key:"renderEmpty",value:function(){var e=this.enabledActions.includes("create")?this.showModal("inviteModal"):null;return h.default.createElement(_.default,(0,i.default)({name:this.name,onCreate:e},this.getEmptyProps()))}},{key:"renderModals",value:function(){var e=this.state,a=e.modifyModal,n=e.inviteModal,r=e.deleteModal,l=e.batchDeleteModal,i=e.selectItem,u=void 0===i?{}:i,o=(0,v.toJS)(this.store.members),s=o.selectedRowKeys,d=o.originData,c=(0,v.toJS)(this.store.roles.data),f=(0,p.default)(u)?s.map((function(e){return d.find((function(t){return t.username===e}))})):[u],m=this.list.selectedRowKeys.join(", ");return h.default.createElement("div",null,h.default.createElement(E.default,{title:t("Sure to remove"),desc:t.html("REMOVE_MEMBER_TIP",{resource:u[this.rowKey]}),resource:u[this.rowKey],visible:r,onOk:this.handleDelete,onCancel:this.hideModal("deleteModal"),isSubmitting:this.store.isSubmitting}),this.list.selectedRowKeys&&h.default.createElement(E.default,{visible:l,title:t("Sure to remove"),desc:t.html("REMOVE_MEMBER_TIP",{resource:m}),resource:m,onOk:this.handleBatchDelete,onCancel:this.hideModal("batchDeleteModal"),isSubmitting:this.store.isSubmitting}),h.default.createElement(k.default,{roles:c,users:f,visible:a,onOk:this.handleModify,onCancel:this.hideModal("modifyModal"),isSubmitting:this.store.isSubmitting}),h.default.createElement(C.default,{title:t("Invite members to the DevOps project"),desc:t("INVITE_MEMBER_DESC_DEVOPS"),visible:n,workspace:this.workspace,roles:c,users:d,onOk:this.handleInvite,onCancel:this.hideModal("inviteModal"),isSubmitting:this.store.isSubmitting}))}},{key:"renderHeader",value:function(){return h.default.createElement(S.default,{title:t("DevOps Members"),icon:"group",description:t("DEVOPS_PROJECT_MEM_DESC"),module:this.module})}},{key:"module",get:function(){return"users"}},{key:"authKey",get:function(){return"members"}},{key:"name",get:function(){return"Member"}},{key:"workspace",get:function(){return this.store.data.workspace}},{key:"rowKey",get:function(){return"username"}},{key:"list",get:function(){return this.store.members}},{key:"itemActions",get:function(){return[{key:"modify",icon:"pen",text:t("Modify Member Role"),action:"edit",onClick:this.showModal("modifyModal")},{key:"delete",icon:"trash",text:t("Remove Member"),action:"delete",onClick:this.showModal("deleteModal")}]}}]),a}(w.default))||l)||l;a.default=D},3871:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i=r(n(37)),u=r(n(13)),o=r(n(14)),s=r(n(17)),d=r(n(16)),c=r(n(18)),f=r(n(0)),p=n(60),m=n(226),h=n(19),v=n(565),g=r(n(269)),b=r(n(2637)),y=r(n(2542)),_=n(49),E=r(n(2523)),k=r(n(2591)),C=r(n(2636)),S=r(n(2865)),w=(0,p.inject)("rootStore")(l=(0,p.observer)(l=function(e){function a(e){var n;return(0,u.default)(this,a),(n=(0,s.default)(this,(0,d.default)(a).call(this,e))).handleFetch=function(e,t){n.routing.query(e,t)},n.showCreate=function(){n.setState({showCreate:!0})},n.hideCreate=function(){n.setState({showCreate:!1})},n.hideDelete=function(){n.setState({showDelete:!1})},n.handleCreate=function(){n.setState({showCreate:!1,showEdit:!0}),n.handleFetch()},n.getColumns=function(){return[{title:t("Name"),dataIndex:"id",width:"24%",render:function(e){return f.default.createElement(m.Link,{className:"item-name",to:"".concat(n.prefix,"/").concat(encodeURIComponent(e))},e)}},{title:t("Type"),dataIndex:"type",width:"25%",render:function(e){return t(e)}},{title:t("Description"),dataIndex:"description",render:function(e){return e},width:"25%"},{title:t("Created Time"),dataIndex:"create_time",width:20,render:function(e){return(0,_.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}}]},n.store=new b.default,n.formTemplate={},n.state={showCreate:!1,showEdit:!1,showDelete:!1,showBranchModal:!1,configFormData:{},selectPipeline:{}},n}return(0,c.default)(a,e),(0,o.default)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.namespace;this.store.project_id=t,this.unsubscribe=this.routing.history.subscribe((function(t){var a=(0,v.parse)(t.search.slice(1));e.getData(a)}))}},{key:"componentWillUnmount",value:function(){this.unsubscribe&&this.unsubscribe()}},{key:"getData",value:function(e){var t=this.props.match.params.project_id;this.store.fetchList((0,i.default)({project_id:t},e))}},{key:"renderContent",value:function(){var e=(0,h.toJS)(this.store.list),a=e.data,n=e.filters,r=e.isLoading,l=e.total,i=e.page,u=e.limit,o=!1===r&&0===l,s=(0,g.default)(n,"page"),d=this.enabledActions.includes("create")?this.showCreate:null;if(o&&Object.keys(n).length<=0)return f.default.createElement(y.default,{desc:t("".concat(this.name.toUpperCase(),"_CREATE_DESC")),onCreate:d,createText:t("Create credentials")});var c={total:l,page:i,limit:u};return f.default.createElement(k.default,{data:a,columns:this.getColumns(),filters:s,pagination:c,rowKey:"fullName",isLoading:r,onFetch:this.handleFetch,onCreate:d})}},{key:"renderModals",value:function(){var e=this.props.match.params.project_id;return f.default.createElement(C.default,{visible:this.state.showCreate,onOk:this.handleCreate,onCancel:this.hideCreate,project_id:e})}},{key:"render",value:function(){return f.default.createElement("div",{className:S.default.wrapper},f.default.createElement(E.default,{title:t("DevOps Credentials"),icon:"key",description:t("DEVOPS_PROJECT_CREDENTIALS_DESC"),module:this.module}),this.renderContent(),this.renderModals())}},{key:"enabledActions",get:function(){return globals.app.getActions({module:"credentials",project:this.props.match.params.project_id})}},{key:"prefix",get:function(){return this.props.match.url.endsWith("/")?this.props.match.url.slice(0,-1):this.props.match.url}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"module",get:function(){return"cridentials"}},{key:"name",get:function(){return"Credentials"}}]),a}(f.default.Component))||l)||l;a.default=w},3872:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a(97)),l=a(49),i=a(564),u=n(a(2517)),o=n(a(3873)),s=a(2688),d=n(a(3902)),c=n(a(3904)),f="/devops/:project_id/pipelines/:name",p=[{name:"pipeline",title:"Pipeline",component:s.Pipeline},{name:"code-quality",title:"Code Quality",component:s.CodeQuality},{name:"activity",title:"Activity",component:s.Activity},{name:"branch",title:"Branch",component:s.Branch},{name:"pull-request",title:"PullRequest",component:s.PullRequest}],m=[].concat((0,r.default)(c.default),(0,r.default)(d.default),[{path:f,component:(0,l.withProps)(u.default,{module:"cicd",component:o.default,breadcrumbs:[{label:"Pipeline List",url:"/devops/:project_id/pipelines"}]}),routes:(0,i.getChildRoutes)(p,f)}]);t.default=m},3873:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.Component=a.default=void 0;var l=r(n(37)),i=r(n(97)),u=r(n(61)),o=r(n(62)),s=r(n(13)),d=r(n(14)),c=r(n(17)),f=r(n(16)),p=r(n(18)),m=r(n(0)),h=n(60),v=r(n(131)),g=r(n(22)),b=r(n(129)),y=n(114),_=n(564),E=n(2566),k=n(941),C=r(n(388)),S=r(n(2520)),w=r(n(2541)),D=r(n(2549)),I=r(n(2524)),N=r(n(2575)),P=r(n(2875)),j=r(n(3874)),x=r(n(3876)),L=r(n(2874)),R=r(n(2876)),O=r(n(2877)),M=function(e){function a(e){var n;return(0,s.default)(this,a),(n=(0,c.default)(this,(0,f.default)(a).call(this,e))).fetchData=(0,o.default)(u.default.mark((function e(){var t,a;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.match.params,e.next=3,n.store.fetchDetail(t).catch((function(e){404===e.status&&(n.store.notFound=!0)}));case 3:if(a=e.sent){e.next=6;break}return e.abrupt("return");case 6:a.branchNames?(t.branch="master",n.sonarqubeStore.fetchDetail(t)):n.sonarqubeStore.fetchDetail(t);case 7:case"end":return e.stop()}}),e)}))),n.getSonarqube=function(){var e=n.props.match.params;n.sonarqubeStore.fetchDetail(e)},n.getOperations=function(){var e=n.store.detail;return[{key:"edit",type:"control",text:t("EDIT"),action:"edit",onClick:n.showEditModal},{key:"editConfig",type:"control",text:t("Edit Config"),action:"edit",onClick:n.showEditConfigModal}].concat((0,i.default)(e.scmSource?[{key:"scan",text:t("Scan Repository"),action:"trigger",onClick:n.handleScanRepository},{key:"scanLogs",text:t("Scan Reponsitory Logs"),action:"trigger",onClick:n.showScanLogsModal}]:[]),[{key:"delete",text:t("Delete"),action:"delete",onClick:n.showDeleteModal}])},n.getAttrs=function(){var e=n.store.activityList,a=n.props.match.params;return[{name:t("DevOps Project"),value:a.project_id},{name:t("Status"),value:m.default.createElement(D.default,(0,k.getPipelineStatus)((0,g.default)(e.data,"[0]",{})))},{name:t("Updated Time"),value:n.updateTime}]},n.showEditModal=(0,o.default)(u.default.mark((function e(){var t,a,r;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.match.params,a=n.store.detail,e.next=4,n.store.getPipeLineConfig(a.name,t);case 4:(r=e.sent).project_id=t.project_id,n.setState({showEditBaseInfo:!0,formTemplate:r});case 7:case"end":return e.stop()}}),e)}))),n.showEditConfigModal=(0,o.default)(u.default.mark((function e(){var t,a,r;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.match.params,a=n.store.detail,e.next=4,n.store.getPipeLineConfig(a.name,t);case 4:r=e.sent,n.setState({showEditConfig:!0,formTemplate:r});case 6:case"end":return e.stop()}}),e)}))),n.hideEditModal=function(){n.setState({showEditBaseInfo:!1})},n.hideEditConfig=function(){n.setState({showEditConfig:!1})},n.hideScanLogs=function(){n.setState({showScanLogs:!1})},n.handleScanRepository=(0,o.default)(u.default.mark((function e(){var a,r;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props.match.params,r=n.store.detail,e.next=4,n.store.scanRepository({project_id:a.project_id,name:r.name});case 4:C.default.success({content:t("Scan repo success")}),n.store.fetchDetail(a);case 6:case"end":return e.stop()}}),e)}))),n.showScanLogsModal=function(){n.setState({showScanLogs:!0})},n.handleEdit=function(){var e=(0,o.default)(u.default.mark((function e(t){var a;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props.match.params,(0,E.updatePipelineParams)(t),e.next=4,n.store.updatePipeline(t,a);case 4:n.fetchData(),n.setState({showEditBaseInfo:!1,showEditConfig:!1});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.showDeleteModal=function(){n.setState({showDelete:!0})},n.hideDeleteModal=function(){n.setState({showDelete:!1})},n.handleDelete=function(){var e=n.props.match.params.project_id,t=n.store.detail;n.setState({deleteLoading:!0}),n.store.deletePipeline(t.name,e).then((function(){n.hideDeleteModal(),n.routing.push("/devops/".concat(e,"/pipelines"))}))},n.store=new N.default,n.sonarqubeStore=new P.default,n.store.project_id=(0,g.default)(e.match,"params.project_id",""),n.state={showEditConfig:!1,showDelete:!1,showEditBaseInfo:!1,deleteLoading:!1},n}return(0,p.default)(a,e),(0,d.default)(a,[{key:"renderSubView",value:function(){var e=this.props.route;return this.store.isLoading||this.sonarqubeStore.isLoading?m.default.createElement("div",{className:O.default.loading},m.default.createElement(b.default,null)):(0,_.renderRoutes)(e.routes,(0,l.default)({},this.baseProps,this.getRouteProps()))}},{key:"renderNav",value:function(){return m.default.createElement(R.default,{sonarqubeStore:this.sonarqubeStore,detailStore:this.store,route:this.props.route,match:this.props.match})}},{key:"renderSider",value:function(){var e=this,t=this.store.detail,a=this.getOperations().filter((function(t){return e.enabledActions.includes(t.action)}));return m.default.createElement(w.default,{icon:y.ICON_TYPES[this.module],name:t.name,desc:(0,g.default)(t.annotations,"desc"),operations:a,labels:t.labels,attrs:this.getAttrs()})}},{key:"renderExtraModals",value:function(){var e=this.props.match.params,a=this.store.detail,n=this.state,r=n.showDelete,l=n.formTemplate,i=n.showScanLogs,u=n.showEditBaseInfo,o=n.showEditConfig,s=n.deleteLoading;return m.default.createElement("div",null,m.default.createElement(x.default,{detail:l,visible:u,onOk:this.handleEdit,onCancel:this.hideEditModal,handleScanRepository:this.handleScanRepository}),m.default.createElement(L.default,{title:t("Edit Pipeline"),formTemplate:l,visible:o,onOk:this.handleEdit,project_id:e.project_id,onCancel:this.hideEditConfig}),m.default.createElement(I.default,{type:t("Pipeline"),resource:a.name,visible:r,onOk:this.handleDelete,onCancel:this.hideDeleteModal,isSubmitting:s}),m.default.createElement(j.default,{visible:i,onCancel:this.hideScanLogs,store:this.store,params:e,handleScanRepository:this.handleScanRepository}))}},{key:"listUrl",get:function(){var e=this.props.match.params.project_id;return"/devops/".concat(e,"/pipelines")}},{key:"name",get:function(){return"cicds"}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"application",get:function(){var e=this.store.detail;return e.labels&&e.labels.chart&&e.labels.release?"".concat(e.labels.release,"/").concat(e.labels.chart):"-"}},{key:"creator",get:function(){return(0,g.default)(this.store.detail,"creator",t("unknown"))}},{key:"createTime",get:function(){return(0,v.default)(this.store.detail.createTime).format("".concat(t("MMMM Do YYYY")," HH:mm"))}},{key:"updateTime",get:function(){var e=this.store.activityList,a=(0,g.default)(e,"data.0.startTime","");return a?(0,v.default)(a).format("".concat(t("MMMM Do YYYY")," HH:mm")):"-"}},{key:"enabledActions",get:function(){return globals.app.getActions({module:"pipelines",project:this.props.match.params.project_id})}}]),a}(S.default),T=(0,h.inject)("rootStore")((0,h.observer)(M));a.default=T;var A=M;a.Component=A},3874:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o=r(n(61)),s=r(n(62)),d=r(n(13)),c=r(n(14)),f=r(n(17)),p=r(n(16)),m=r(n(18)),h=r(n(0)),v=r(n(1)),g=r(n(38)),b=n(60),y=r(n(22)),_=r(n(387)),E=r(n(224)),k=r(n(388)),C=r(n(3875)),S=(0,b.observer)((u=i=function(e){function a(e){var n;return(0,d.default)(this,a),(n=(0,f.default)(this,(0,p.default)(a).call(this,e))).handleFetch=(0,s.default)(o.default.mark((function e(){var a;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props.params,e.next=3,n.props.handleScanRepository();case 3:n.props.store.getRepoScanLogs(a),k.default.success({content:t("Scan Logs Success")});case 5:case"end":return e.stop()}}),e)}))),n.handleDownloadLogs=function(){var e=n.props.store.reponsitorylog;n.props.store.saveAsFile(e,"log.txt")},n.formRef=h.default.createRef(),n}return(0,m.default)(a,e),(0,c.default)(a,[{key:"componentWillReceiveProps",value:function(e){if(e.visible&&!this.props.visible){var t=e.params;this.props.store.getRepoScanLogs(t)}}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel,r=this.props.store.reponsitorylog;return h.default.createElement(_.default,{width:1160,onCancel:n,visible:a,closable:!1,title:t("Scan Reponsitory Logs")},h.default.createElement("div",{className:C.default.content},h.default.createElement("div",{className:C.default.btn_group},h.default.createElement(g.default,{name:"human",size:20}),this.startBy,h.default.createElement(E.default,{onClick:this.handleDownloadLogs},t("Download Logs")),h.default.createElement(E.default,{onClick:this.handleFetch},t("Rescan"))),h.default.createElement("pre",{className:C.default.pre},r)))}},{key:"startBy",get:function(){var e=this.props.store.reponsitorylog.split("\n"),a=(0,y.default)(e,"[0]",""),n=a.match(/^Started by (user )?(.*)?/)||[],r=n[1],l=n[2];return a&&r?"".concat(t("Started By"),": ").concat(l):a&&!r?t("Started By {name}",{name:t(l)}):"".concat(t("Started By"),": -")}}]),a}(h.default.Component),i.propTypes={name:v.default.string,branches:v.default.array},i.defaultProps={branches:[],visible:!1,onOk:function(){},onCancel:function(){}},l=u))||l;a.default=S},3875:function(e,t,a){e.exports={content:"Modals__content--J2psH",btn_group:"Modals__btn_group--21hsE",pre:"Modals__pre--1rAK-"}},3876:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=r(n(30)),i=r(n(37)),u=r(n(61)),o=r(n(62)),s=r(n(13)),d=r(n(14)),c=r(n(17)),f=r(n(16)),p=r(n(18)),m=r(n(0)),h=r(n(1)),v=r(n(2453)),g=r(n(386)),b=r(n(387)),y=r(n(267)),_=n(2566),E=r(n(22)),k=r(n(2861)),C=r(n(2863)),S=function(e){function a(e){var t;return(0,s.default)(this,a),(t=(0,c.default)(this,(0,f.default)(a).call(this,e))).registerSubRoute=function(e,a){t.setState({subRoute:{onSave:e,onCancel:a}})},t.resetSubRoute=function(){t.setState({subRoute:{}})},t.hideSelectRepo=function(){t.setState({showSelectRepo:!1})},t.showSelectRepo=function(){t.setState({showSelectRepo:!0})},t.handleOk=(0,o.default)(u.default.mark((function e(){var a,n;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.props.onOk,n=t.form.current.getData(),(0,_.updatePipelineParams)(n),e.next=5,a(n);case 5:t.state.subRoute&&t.props.handleScanRepository();case 6:case"end":return e.stop()}}),e)}))),t.handleRepoChange=function(e,a){var n=t.props.detail,r=void 0===n?{}:n,u=(0,E.default)(r,"multi_branch_pipeline",{}),o="".concat((0,E.default)(r,"multi_branch_pipeline.source_type",""),"_source"),s=Object.assign((0,E.default)(r,"multi_branch_pipeline.".concat(o),{}),a[o]);t.setState({showSelectRepo:!1},(function(){t.scmRef.current.onChange((0,i.default)({source_type:e},u,a,(0,l.default)({},o,s)))}))},t.handleSaveRepo=function(){var e=t.state.subRoute;if(e.onSave)return e.onSave((function(){t.setState({subRoute:{}})}))},t.form=m.default.createRef(),t.scmRef=m.default.createRef(),t.state={showSelectRepo:!1,repo:{}},t}return(0,p.default)(a,e),(0,d.default)(a,[{key:"getChildContext",value:function(){return{registerSubRoute:this.registerSubRoute,resetSubRoute:this.resetSubRoute}}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel,r=e.detail,l=void 0===r?{}:r,i=(0,E.default)(l,"pipeline.name","")||(0,E.default)(l,"multi_branch_pipeline.name",""),u=(0,E.default)(l,"pipeline.description","")||(0,E.default)(l,"multi_branch_pipeline.description","");return this.state.showSelectRepo?m.default.createElement(b.default,{width:1e3,hideHeader:!0,onOk:this.handleSaveRepo,visible:a},m.default.createElement(C.default,{sourceData:l.multi_branch_pipeline,project_id:l.project_id,name:i,onSave:this.handleRepoChange,onCancel:this.hideSelectRepo,enableTypeChange:!1})):m.default.createElement(b.default,{width:691,title:t("Edit Info"),icon:"pen",onOk:this.handleOk,onCancel:n,visible:a},m.default.createElement(y.default,{ref:this.form,data:l},m.default.createElement(y.default.Item,{label:t("Name"),desc:t("")},m.default.createElement(g.default,{name:"name",defaultValue:i,disabled:!0})),m.default.createElement(y.default.Item,{label:t("description"),desc:t("")},m.default.createElement(v.default,{name:"description",defaultValue:u})),l.multi_branch_pipeline?m.default.createElement(y.default.Item,{label:t("Code Repository")},m.default.createElement(k.default,{name:"multi_branch_pipeline",ref:this.scmRef,onClick:this.showSelectRepo})):null))}}]),a}(m.default.Component);a.default=S,S.propTypes={detail:h.default.object,visible:h.default.bool,onOk:h.default.func,onCancel:h.default.func},S.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}},S.childContextTypes={registerSubRoute:h.default.func,resetSubRoute:h.default.func}},3877:function(e,t,a){e.exports={baseInfo:"Sider__baseInfo--1iqcE",baseInfo__item:"Sider__baseInfo__item--2UfPU",nav:"Sider__nav--I2CyB",navItem:"Sider__navItem--q8Wgq",active:"Sider__active--I1IrX",loading:"Sider__loading--iTM8V",dashboardLable:"Sider__dashboardLable--3WafM",dashboardValue:"Sider__dashboardValue--2xtkg"}},3878:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i=r(n(37)),u=r(n(61)),o=r(n(62)),s=r(n(13)),d=r(n(14)),c=r(n(17)),f=r(n(16)),p=r(n(18)),m=r(n(2477)),h=r(n(22)),v=r(n(269)),g=r(n(0)),b=n(19),y=n(60),_=n(565),E=n(226),k=n(49),C=r(n(2549)),S=n(941),w=r(n(2685)),D=r(n(224)),I=r(n(388)),N=n(2638),P=r(n(2591)),j=r(n(2613)),x=(0,y.inject)("rootStore")(l=(0,y.observer)(l=function(e){function a(e){var n;return(0,s.default)(this,a),(n=(0,c.default)(this,(0,f.default)(a).call(this,e))).handleFetch=function(e,t){n.routing.query(e,t)},n.handleScanRepository=(0,o.default)(u.default.mark((function e(){var a,r;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props.match.params,r=n.props.detailStore.detail,e.next=4,n.props.detailStore.scanRepository({project_id:a.project_id,name:r.name});case 4:n.store.fetchDetail(a),I.default.success({content:t("Scan repo success")});case 6:case"end":return e.stop()}}),e)}))),n.getColumns=function(){return[{title:t("Name"),dataIndex:"name",width:"19%",render:function(e){return g.default.createElement(E.Link,{className:"item-name",to:"".concat(n.prefix,"/").concat(e,"/activity")},g.default.createElement(N.ReactComponent,{style:{width:"20px",height:"20px"}})," ",decodeURIComponent(e))}},{title:t("Status"),dataIndex:"status",width:"10%",render:function(e,t){return g.default.createElement(C.default,(0,S.getPipelineStatus)((0,h.default)(t,"latestRun",{})))}},{title:t("WeatherScore"),dataIndex:"weatherScore",width:"15%",render:function(e){return g.default.createElement(w.default,{score:e})}},{title:t("Last message"),dataIndex:"latestRun",width:"15%",render:function(e){return(0,m.default)(e,"causes[0].shortDescription","")}},{title:t("Updated Time"),dataIndex:"updateTime",width:"15%",render:function(e,t){return(0,k.getLocalTime)(t.latestRun.startTime).format("YYYY-MM-DD HH:mm:ss")}}]},n.store=e.detailStore||{},n.name="branch",n}return(0,p.default)(a,e),(0,d.default)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params;this.unsubscribe=this.routing.history.subscribe((function(a){if(a.pathname===e.props.match.url){var n=(0,_.parse)(a.search.slice(1));e.getData((0,i.default)({},t,n))}}))}},{key:"componentWillUnmount",value:function(){this.unsubscribe&&this.unsubscribe()}},{key:"getData",value:function(e){this.store.getBranches((0,i.default)({},e))}},{key:"render",value:function(){var e=(0,b.toJS)(this.store.branchList),a=e.data,n=e.filters,r=e.isLoading,l=e.total,i=e.page,u=e.limit,o=!1===r&&0===l,s=(0,v.default)(n,"page"),d=this.enabledActions.includes("trigger");if(o&&!n.page)return g.default.createElement(j.default,{desc:t("No branches found")},d&&g.default.createElement(D.default,{type:"control",onClick:this.handleScanRepository},t("Scan Repository")));var c={total:l,page:i,limit:u};return g.default.createElement(P.default,{data:a,columns:this.getColumns(),filters:s,pagination:c,isLoading:r,onFetch:this.handleFetch,disableSearch:!0})}},{key:"enabledActions",get:function(){return globals.app.getActions({module:"pipelines",project:this.props.match.params.project_id})}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"prefix",get:function(){return this.props.match.url}}]),a}(g.default.Component))||l)||l;a.default=x},3879:function(e,t,a){e.exports={wrapper:"EmptyCard__wrapper--3PJ61",desc:"EmptyCard__desc--3ZQej"}},3880:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i=r(n(61)),u=r(n(62)),o=r(n(13)),s=r(n(14)),d=r(n(17)),c=r(n(16)),f=r(n(18)),p=r(n(0)),m=r(n(129)),h=r(n(224)),v=n(19),g=n(60),b=r(n(22)),y=r(n(58)),_=r(n(268)),E=r(n(2612)),k=r(n(2871)),C=r(n(3881)),S=r(n(2613)),w=r(n(2870)),D=r(n(2878)),I=(0,g.inject)("rootStore")(l=(0,g.observer)(l=function(e){function a(e){var t;return(0,o.default)(this,a),(t=(0,d.default)(this,(0,c.default)(a).call(this,e))).showEditPipeline=function(){t.setState({showEditPipeline:!0})},t.showEditJenkinsFile=function(){t.setState({showEditJenkinsFile:!0})},t.hideEditPipeline=function(){t.setState({showEditPipeline:!1})},t.hideEditJenkins=function(){t.setState({showEditJenkinsFile:!1})},t.getData=(0,u.default)(i.default.mark((function e(){var a;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.props.match.params,e.next=3,t.props.detailStore.getJenkinsFile(a);case 3:t.props.detailStore.getActivities(a);case 4:case"end":return e.stop()}}),e)}))),t.handleFresh=function(){var e=t.props.match.params;t.props.detailStore.getJenkinsFile(e)},t.handleEnterFullScreen=function(){t.state.isFullScreen||t.setState({isFullScreen:!0})},t.handleParamsCancel=function(){t.setState({showParamsModal:!1})},t.handleOk=function(){var e=(0,u.default)(i.default.mark((function e(a){var n,r,l;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.props.match.params,a){e.next=3;break}return e.abrupt("return");case 3:return t.setState({isSubmitting:!0}),e.next=6,t.props.detailStore.updateJenkinsFile(a,n).finally((function(){t.setState({isSubmitting:!1})}));case 6:t.setState({showEditPipeline:!1},(function(){t.handleFresh()})),r=n.project_id,l=n.name,localStorage.removeItem("".concat(globals.user.username,"-").concat(r,"-").concat(l));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.handleRun=(0,_.default)((function(){var e=t.props.detailStore.detail,a=e.branchNames,n=e.parameters&&e.parameters.length;a||n?t.setState({showParamsModal:!0}):t.handleRunOk()}),500),t.handleRunOk=function(){var e=(0,u.default)(i.default.mark((function e(a,n){var r,l;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.props.detailStore.detail,l=t.props.match.params.project_id,e.next=4,t.props.detailStore.runBranch({project_id:l,name:r.name,branch:n,parameters:a});case 4:t.props.rootStore.routing.push("./activity");case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),t.handleEditOk=function(){t.handleBranchCancel()},t.handleSaveJenkinsFile=function(){var e=(0,u.default)(i.default.mark((function e(a){var n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.props.match.params,t.setState({isSaveJenkinsLoading:!0}),e.next=4,t.props.detailStore.updateJenkinsFile(a,n).finally((function(){t.setState({isSaveJenkinsLoading:!1})}));case 4:t.setState({showEditJenkinsFile:!1}),t.handleFresh();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.state={showEditPipeline:!1,showToken:!1,showParamsModal:!1,showEditJenkinsFile:!1,isSubmitting:!1,isSaveJenkinsLoading:!1},t}return(0,f.default)(a,e),(0,s.default)(a,[{key:"componentDidMount",value:function(){!this.isMutiBranch&&this.enabledActions.includes("edit")?this.getData():this.props.rootStore.routing.push("./activity")}},{key:"renderBtnGroup",value:function(){var e=this.enabledActions.includes("edit"),a=this.enabledActions.includes("trigger");return p.default.createElement("div",{className:D.default.pipelineCard__btnGroup},e&&p.default.createElement(h.default,{onClick:this.showEditJenkinsFile},t("Edit Jenkinsfile")),e&&p.default.createElement(h.default,{onClick:this.showEditPipeline},t("Edit Pipeline")),a&&p.default.createElement(h.default,{type:"control",onClick:this.handleRun},t("Run")))}},{key:"renderPipeLineContent",value:function(){var e=this.props.detailStore.pipelineJsonData,a=e.pipelineJson,n=e.isLoading,r=this.enabledActions.includes("edit"),l=this.enabledActions.includes("trigger");return n?p.default.createElement(m.default,{spinning:!0},p.default.createElement("div",{className:D.default.pipelineCard})):(0,y.default)((0,v.toJS)(a))?p.default.createElement(S.default,{desc:t("PIPELINE_NO_CONFIG")},r&&p.default.createElement(h.default,{type:"control",onClick:this.showEditPipeline},t("Edit Pipeline")),r&&p.default.createElement(h.default,{onClick:this.showEditJenkinsFile},t("Edit Jenkinsfile"))):"failure"===a.result?p.default.createElement(S.default,{desc:t("NOT_VALID_JENKINS_FILE")},r&&p.default.createElement(h.default,{onClick:this.showEditJenkinsFile},t("Edit Jenkinsfile")),l&&p.default.createElement(h.default,{type:"control",onClick:this.handleRun},t("Run"))):p.default.createElement("div",{className:D.default.pipelineCard},p.default.createElement("div",{className:D.default.pipelineCard__toolbar},this.renderBtnGroup()),p.default.createElement("div",{className:D.default.pipelineCard__main},p.default.createElement(k.default,{jsonData:a})))}},{key:"render",value:function(){var e=this.state,t=e.showEditPipeline,a=e.isSubmitting,n=this.props.match.params,r=this.props.detailStore,l=r.pipelineJsonData,i=r.detail,u=r.jenkinsfile;return p.default.createElement(p.default.Fragment,null,this.renderPipeLineContent(),p.default.createElement(w.default,{jsonData:(0,v.toJS)(l.pipelineJson),visible:t,onOk:this.handleOk,onCancel:this.hideEditPipeline,params:n,projectName:i.name,isSubmitting:a}),p.default.createElement(C.default,{params:n,defaultValue:(0,v.toJS)(u),visible:this.state.showEditJenkinsFile,onOk:this.handleSaveJenkinsFile,onCancel:this.hideEditJenkins,isSubmitting:this.state.isSaveJenkinsLoading}),p.default.createElement(E.default,{branches:(0,v.toJS)(i.branchNames),visible:this.state.showParamsModal,parameters:(0,v.toJS)(i.parameters),onCancel:this.handleParamsCancel,onOk:this.handleRunOk,params:n}))}},{key:"enabledActions",get:function(){var e=this.props.match.params.project_id;return globals.app.getActions({module:"pipelines",project:e})}},{key:"isMutiBranch",get:function(){return Boolean((0,b.default)(this.props.detailStore.detail,"scmSource"))}},{key:"sourceBranch",get:function(){var e=this.props.detailStore.detail;return(0,b.default)(e,"branchNames",[]).length?e.branchNames.indexOf("master")?"master":e.branchNames[0]:""}}]),a}(p.default.Component))||l)||l;a.default=I},3881:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=r(n(61)),i=r(n(62)),u=r(n(13)),o=r(n(14)),s=r(n(17)),d=r(n(16)),c=r(n(18)),f=r(n(0)),p=r(n(1)),m=r(n(387)),h=r(n(951)),v=r(n(2575)),g=r(n(2878)),b=function(e){function a(e){var t;return(0,u.default)(this,a),(t=(0,s.default)(this,(0,d.default)(a).call(this,e))).handleChange=function(e){t.setState({value:e})},t.getEditorInstance=function(e){t.editor=e},t.checkScriptCompile=(0,i.default)(l.default.mark((function e(){var a,n,r,i;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.props.params,n=a.project_id,r=a.name,t.setState({isLoading:!0}),e.next=4,t.store.checkScriptCompile({value:t.newValue,pipeline:r,project_id:n}).finally((function(){t.setState({isLoading:!1})}));case 4:if("fail"!==(i=e.sent).status){e.next=9;break}return t.setState({error:{row:i.line-1,column:i.column,type:"error",text:i.message}}),t.forceUpdate(),e.abrupt("return",i);case 9:return t.setState({error:null}),e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e)}))),t.handleOk=(0,i.default)(l.default.mark((function e(){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.newValue=t.state.value.replace(/\t/g,"    "),e.next=3,t.checkScriptCompile();case 3:if(!e.sent){e.next=6;break}return e.abrupt("return");case 6:t.props.onOk(t.newValue);case 7:case"end":return e.stop()}}),e)}))),t.store=new v.default,t.state={value:e.defaultValue,isLoading:!1},t}return(0,c.default)(a,e),(0,o.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.visible&&!this.props.visible&&e.defaultValue&&this.setState({value:e.defaultValue})}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel;return f.default.createElement(m.default,{icon:"cogwheel",width:900,bodyClassName:g.default.body,isSubmitting:this.props.isSubmitting||this.state.isLoading,onCancel:n,onOk:this.handleOk,renderFooter:this.renderFooter,visible:a,closable:!1,maskClosable:!1,title:t("Jenkinsfile")},f.default.createElement(f.default.Fragment,null,f.default.createElement(h.default,{className:g.default.codeEditor,name:"script",mode:"groovy",value:this.state.value,onChange:this.handleChange,options:this.state.error&&{annotations:[this.state.error]}}),this.state.error&&f.default.createElement("div",{className:g.default.checkResult},f.default.createElement("img",{src:"/assets/error.svg"}),f.default.createElement("span",null,t("JENKINS_LINS_ERROR",{line:this.state.error.row+1})))))}}]),a}(f.default.Component);a.default=b,b.propTypes={name:p.default.string,params:p.default.object},b.defaultProps={visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}}},3882:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i=r(n(37)),u=r(n(13)),o=r(n(14)),s=r(n(17)),d=r(n(16)),c=r(n(18)),f=r(n(0)),p=n(226),m=r(n(22)),h=r(n(269)),v=n(19),g=n(60),b=n(565),y=n(49),_=r(n(2542)),E=r(n(2549)),k=n(941),C=r(n(2591)),S=(0,g.inject)("rootStore")(l=(0,g.observer)(l=function(e){function a(e){var n;return(0,u.default)(this,a),(n=(0,s.default)(this,(0,d.default)(a).call(this,e))).handleFetch=function(e,t){n.routing.query(e,t)},n.getFilteredValue=function(e){return n.store.list.filters[e]},n.getColumns=function(){return[{title:t("Status"),isHideable:!0,width:"12%",render:function(e){return f.default.createElement(E.default,(0,k.getPipelineStatus)((0,m.default)(e,"latestRun",{})))}},{title:t("Name"),dataIndex:"displayName",width:"19%",render:function(e){return f.default.createElement(p.Link,{className:"item-name",to:"".concat(n.prefix,"/branch/").concat(e,"/")},e)}},{title:t("Last message"),width:"25%",render:function(e){return e.pullRequest.title||""}},{title:t("author"),width:"15%",render:function(e){return e.pullRequest.author||""}},{title:t("Time"),dataIndex:"latestRun",isHideable:!0,width:"15%",render:function(e){return(0,y.getLocalTime)(e.startTime).format("YYYY-MM-DD HH:mm:ss")}}]},n.getRowKey=function(e){return e.enQueueTime},n.store=e.detailStore||{},n.name="PullRequest",n}return(0,c.default)(a,e),(0,o.default)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params;this.unsubscribe=this.routing.history.subscribe((function(a){if(a.pathname===e.props.match.url){var n=(0,b.parse)(a.search.slice(1));e.getData((0,i.default)({},t,n))}}))}},{key:"componentWillUnmount",value:function(){this.unsubscribe&&this.unsubscribe()}},{key:"getData",value:function(e){this.store.getPullRequest((0,i.default)({},e))}},{key:"render",value:function(){var e=this.store.pullRequestList,t=e.data,a=e.isLoading,n=e.total,r=e.page,l=e.limit,i=e.filters,u=!1===a&&0===n,o=(0,h.default)(i,"page");if(u&&!i.page)return f.default.createElement(_.default,{name:this.name,onCreate:this.showCreate});var s={total:n,page:r,limit:l};return f.default.createElement(C.default,{data:(0,v.toJS)(t),columns:this.getColumns(),rowKey:"displayName",filters:o,pagination:s,isLoading:a,onFetch:this.handleFetch,disableSearch:!0})}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"prefix",get:function(){var e=this.props.match.params,t=e.project_id,a=e.name;return"/devops/".concat(t,"/pipelines/").concat(a)}}]),a}(f.default.Component))||l)||l;a.default=S},3883:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o=r(n(97)),s=r(n(44)),d=r(n(37)),c=r(n(61)),f=r(n(62)),p=r(n(13)),m=r(n(14)),h=r(n(17)),v=r(n(16)),g=r(n(66)),b=r(n(18)),y=r(n(41)),_=(r(n(45)),r(n(0))),E=r(n(2477)),k=r(n(22)),C=r(n(269)),S=r(n(268)),w=r(n(50)),D=r(n(130)),I=n(226),N=n(19),P=n(565),j=n(60),x=n(938),L=n(49),R=r(n(2612)),O=r(n(224)),M=r(n(388)),T=r(n(2549)),A=n(941),F=n(2638),B=r(n(2591)),z=r(n(2613)),q=r(n(3884)),U=(0,j.inject)("rootStore")(l=(0,j.observer)((i=function(e){function a(e){var n;return(0,p.default)(this,a),(n=(0,h.default)(this,(0,v.default)(a).call(this,e))).hideBranchModal=function(){n.setState({showBranchModal:!1})},n.handleFetch=function(e,t){n.routing.query(e,t)},n.handleRun=(0,S.default)((0,f.default)(c.default.mark((function e(){var t,a,r,l;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.store.detail,a=n.props.match.params,r=t.branchNames,l=t.parameters&&t.parameters.length,!r&&!l){e.next=8;break}n.setState({showBranchModal:!0}),e.next=11;break;case 8:return e.next=10,n.props.detailStore.runBranch(a);case 10:n.handleFetch();case 11:case"end":return e.stop()}}),e)}))),500),n.handleRunBranch=function(){var e=(0,f.default)(c.default.mark((function e(t,a){var r;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.props.match.params,e.next=3,n.props.detailStore.runBranch((0,d.default)({branch:a,parameters:t},r));case 3:n.handleFetch(),n.setState({showBranchModal:!1});case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.rowKeys=function(e){return"".concat(e.startTime).concat(e.queueId)},n.handleReplay=function(e){return(0,f.default)(c.default.mark((function t(){var a,r;return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.props.match.params,r="devops/".concat(a.project_id,"/pipelines/").concat(a.name).concat(n.getActivityDetailLinks(e)),t.next=4,n.props.detailStore.handleActivityReplay(r);case 4:n.handleFetch();case 5:case"end":return t.stop()}}),t)})))},n.handleScanRepository=(0,f.default)(c.default.mark((function e(){var a,r;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props.match.params,r=n.props.detailStore.detail,e.next=4,n.props.detailStore.scanRepository({project_id:a.project_id,name:r.name});case 4:n.store.fetchDetail(a),M.default.success({content:t("Scan repo success")});case 6:case"end":return e.stop()}}),e)}))),(0,s.default)(n,"handleBranchSelect",u,(0,g.default)(n)),n.handleStop=function(e){return(0,f.default)(c.default.mark((function a(){var r,l;return c.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=n.props.match.params,l="devops/".concat(r.project_id,"/pipelines/").concat(r.name).concat(n.getActivityDetailLinks(e)),a.next=4,n.props.detailStore.handleActivityStop(l);case 4:M.default.success({content:t("Stop Job Successfully, Status updated later")}),n.handleFetch();case 6:case"end":return a.stop()}}),a)})))},n.getFilteredValue=function(e){return n.store.list.filters[e]},n.getActivityDetailLinks=function(e){var t=(0,k.default)(e,"_links.self.href","").match(/\/pipelines\/\S*?(?=\/)\/branches\/(\S*?(?=\/)?)\//);return(0,w.default)(t)?"/branches/".concat(encodeURIComponent(e.pipeline),"/runs/").concat(e.id):"/runs/".concat(e.id)},n.getRunhref=function(e){var t=(0,k.default)(e,"_links.self.href","").match(/\/pipelines\/\S*?(?=\/)\/branches\/(\S*?(?=\/)?)\//);return(0,w.default)(t)&&!n.isAtBranchDetailPage?"".concat(n.prefix,"/branch/").concat(e.pipeline,"/run/").concat(e.id):"".concat(n.prefix,"/run/").concat(e.id)},n.getColumns=function(){return[{title:t("Status"),width:"15%",key:"status",render:function(e){return _.default.createElement(I.Link,{className:"item-name",to:n.getRunhref(e)},_.default.createElement(T.default,(0,A.getPipelineStatus)(e)))}},{title:t("Run"),width:"10%",key:"run",render:function(e){return _.default.createElement(I.Link,{className:"item-name",to:n.getRunhref(e)},e.id)}},{title:t("Commit"),dataIndex:"commitId",width:"10%",render:function(e){return e&&e.slice(0,6)||"-"}}].concat((0,o.default)(n.props.match.params.branch?[]:[{title:t("Branch"),width:"15%",key:"branch",render:function(e){var t=(0,k.default)(e,"_links.self.href","").match(/\/pipelines\/\S*?(?=\/)\/branches\/(\S*?(?=\/)?)\//);return(0,w.default)(t)?_.default.createElement(I.Link,{className:"item-name",to:"".concat(n.prefix,"/branch/").concat(e.pipeline,"/activity")},_.default.createElement(F.ReactComponent,{style:{width:"20px",height:"20px"}})," ",decodeURIComponent(e.pipeline)):"-"}}]),[{title:t("Last message"),dataIndex:"causes",width:"25%",render:function(e){return(0,E.default)(e,"[0].shortDescription","")}},{title:t("Duration"),dataIndex:"durationInMillis",width:"10%",render:function(e){return(0,L.formatUsedTime)(e)}},{title:t("Updated Time"),dataIndex:"startTime",width:"20%",render:function(e){return(0,L.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}},{isHideable:!1,width:"10%",key:"action",render:function(e){return e.branch&&!e.commitId||!n.enabledActions.includes("trigger")?null:"FINISHED"===e.state?_.default.createElement(O.default,{onClick:n.handleReplay(e),icon:"restart",type:"flat"}):_.default.createElement(O.default,{onClick:n.handleStop(e),icon:"stop",type:"flat"})}}])},n.getRowKey=function(e){return e.enQueueTime},n.getActions=function(){return[{type:"control",key:"run",text:t("Run"),action:"trigger",onClick:n.handleRun}]},n.renderModals=function(){var e=n.store.detail,t=n.props.match.params;return _.default.createElement(R.default,{onOk:n.handleRunBranch,onBranchSelect:n.handleBranchSelect,onCancel:n.hideBranchModal,visible:n.state.showBranchModal,branches:(0,N.toJS)(e.branchNames),parameters:e.parameters,params:t||{}})},n.renderFooter=function(){var e=n.store,a=e.detail,r=e.activityList,l=r.total,i=r.limit;return!a.branchNames||n.isAtBranchDetailPage?null:l<i?null:function(){return _.default.createElement(x.Level,null,!(0,D.default)(l)&&_.default.createElement(x.LevelLeft,null,t("TOTAL_ITEMS",{num:l})),_.default.createElement(x.LevelRight,null,_.default.createElement(I.Link,{className:q.default.clickable,to:"./branch"},t("PIPELINES_FOOTER_SEE_MORE"))))}},n.name="Activity",n.store=e.detailStore||{},n.state={showBranchModal:!1},n}return(0,b.default)(a,e),(0,m.default)(a,[{key:"componentDidMount",value:function(){var e=this;this.unsubscribe=this.routing.history.subscribe((function(t){if(t.pathname===e.props.match.url){var a=(0,P.parse)(t.search.slice(1));e.getData((0,d.default)({},a))}}))}},{key:"componentWillUnmount",value:function(){this.unsubscribe&&this.unsubscribe()}},{key:"getData",value:function(e){this.store.getActivities((0,d.default)({},this.props.match.params,e))}},{key:"render",value:function(){var e=this,a=this.store,n=a.activityList,r=a.detail,l=n.data,i=n.isLoading,u=n.total,o=n.page,s=n.limit,d=n.filters,c=r.branchNames,f=!1===i&&0===l.length,p=(0,C.default)(d,"page"),m=this.enabledActions.includes("trigger");if(f&&!d.page)return c&&!r.branchNames.length?_.default.createElement(_.default.Fragment,null,_.default.createElement(z.default,{desc:t("Pipeline config file not found")},m&&_.default.createElement(O.default,{type:"control",onClick:this.handleScanRepository},t("Scan Repository"))),this.renderModals()):_.default.createElement(_.default.Fragment,null,_.default.createElement(z.default,{desc:t("ACTIVITY_EMPTY_TIP")},m&&_.default.createElement(O.default,{type:"control",onClick:this.handleRun},t("Run Pipeline"))),this.renderModals());var h={total:u,page:o,limit:s},v=this.getActions().filter((function(t){return e.enabledActions.includes(t.action)}));return _.default.createElement(_.default.Fragment,null,_.default.createElement(B.default,{data:(0,N.toJS)(l),columns:this.getColumns(),rowKey:this.rowKeys,filters:p,pagination:h,isLoading:i,onFetch:this.handleFetch,actions:v,footer:this.renderFooter(),disableSearch:!0}),this.renderModals())}},{key:"enabledActions",get:function(){return globals.app.getActions({module:"pipelines",project:this.props.match.params.project_id})}},{key:"isAtBranchDetailPage",get:function(){return this.props.match.params.branch}},{key:"prefix",get:function(){var e=this.props.match.url.split("/");return e.pop(),e.join("/")}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"isMutibranch",get:function(){return this.store.detail&&this.store.detail.scmSource}}]),a}(_.default.Component),u=(0,y.default)(i.prototype,"handleBranchSelect",[N.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return(function(){var t=(0,f.default)(c.default.mark((function t(a){var n,r;return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.props.match.params,t.next=3,e.store.getBranchDetail((0,d.default)({},n,{branch:a}));case 3:(r=t.sent).parameters&&(e.store.detail.parameters=r.parameters);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}),l=i))||l)||l;a.default=U},3884:function(e,t,a){e.exports={clickable:"Activity__clickable--ZTob_"}},3885:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o=r(n(70)),s=r(n(61)),d=r(n(37)),c=r(n(62)),f=r(n(13)),p=r(n(14)),m=r(n(17)),h=r(n(16)),v=r(n(18)),g=r(n(0)),b=r(n(1)),y=r(n(3)),_=n(60),E=n(19),k=r(n(22)),C=n(570),S=r(n(387)),w=r(n(224)),D=r(n(2549)),I=n(941),N=r(n(3886)),P=r(n(3891)),j=r(n(3894)),x=(0,_.observer)((u=i=function(e){function a(e){var n;return(0,f.default)(this,a),(n=(0,m.default)(this,(0,h.default)(a).call(this,e))).handleFetch=function(){var e=n.props.match.params,t=n.props.detailStore.runDetail;"QUEUED"!==(0,k.default)(t,"state")&&n.store.getNodesStatus(e)},n.toggleFullScreenState=function(){var e=n.state.isFullScreen;n.setState({isFullScreen:!e})},n.handleEnterFullScreen=function(){(0,C.enterFullScreen)(n.container),n.setState({isFullScreen:!0})},n.showLog=function(){n.setState({showLog:!0})},n.showErrorLog=function(){n.setState({showErrorLog:!0})},n.hideLog=function(){n.setState({showLog:!1})},n.handleDownloadLogs=function(){var e=n.props.match.params;n.props.detailStore.handleDownloadLogs(e)},n.handleProceed=function(){var e=(0,c.default)(s.default.mark((function e(t,a){var r;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=n.props.match.params,e.next=4,n.store.handleProceed((0,d.default)({},t,r));case 4:return e.next=6,n.props.detailStore.getRunDetail(r);case 6:return e.prev=6,a&&a(),e.finish(6);case 9:case"end":return e.stop()}}),e,null,[[0,,6,9]])})));return function(t,a){return e.apply(this,arguments)}}(),n.handleBreak=function(){var e=(0,c.default)(s.default.mark((function e(t,a){var r;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=n.props.match.params,e.next=4,n.store.handleBreak((0,d.default)({},t,r));case 4:return e.next=6,n.props.detailStore.getRunDetail(r);case 6:return e.prev=6,a&&a(),e.finish(6);case 9:case"end":return e.stop()}}),e,null,[[0,,6,9]])})));return function(t,a){return e.apply(this,arguments)}}(),n.renderLoadingCard=function(){return g.default.createElement("div",{className:j.default.card},g.default.createElement("div",null,g.default.createElement("span",{className:(0,y.default)(j.default.runningIcon,j.default.icon)})),g.default.createElement("div",{className:j.default.title},t("Pipeline initialization")),g.default.createElement("div",{className:j.default.desc},t("PIPELINE_DESC")),g.default.createElement("div",{className:j.default.btn},g.default.createElement(w.default,{onClick:n.showErrorLog},t("Show Logs"))))},n.renderQueuedCard=function(){return g.default.createElement("div",{className:j.default.card},g.default.createElement("div",null,g.default.createElement("span",{className:(0,y.default)(j.default.QueuedIcon,j.default.icon)})),g.default.createElement("div",{className:j.default.title},t("PIPELINE_QUEUED_TITLE")),g.default.createElement("div",{className:j.default.desc},t("PIPELINE_QUEUED_DESC")))},n.state={isFullScreen:!1,showLog:!1,showErrorLog:!1},n.store=e.detailStore||{},n.updateReaction=(0,E.reaction)((function(){return n.props.detailStore.runDetail}),n.handleFetch),n}return(0,v.default)(a,e),(0,p.default)(a,[{key:"componentDidMount",value:function(){this.handleFetch(),(0,C.addFullScreenChangeEvents)(this.toggleFullScreenState)}},{key:"componentWillUnmount",value:function(){this.updateReaction(),(0,C.removeFullScreenChangeEvents)(this.toggleFullScreenState)}},{key:"getChildContext",value:function(){return{onProceed:this.handleProceed,onBreak:this.handleBreak,result:this.store.runDetail.result}}},{key:"renderBtnGroup",value:function(){return g.default.createElement("div",{className:j.default.pipelineCard__btnGroup},g.default.createElement("span",{onClick:this.handleEnterFullScreen},g.default.createElement(w.default,{icon:"maximize",type:"flat"})),g.default.createElement(w.default,{onClick:this.showLog},t("Show Logs")))}},{key:"render",value:function(){var e=this,a=this.state,n=a.showLog,r=a.showErrorLog,l=this.store,i=l.nodesStatus,u=l.runDetailLogs,s=l.runDetail;return 0===i.length?this.isQueued?this.renderQueuedCard():this.hasRuning&&!r?this.renderLoadingCard():g.default.createElement("div",{className:j.default.pipelineCard},g.default.createElement("div",{className:j.default.pipelineCard__toolbar},this.hasRuning?g.default.createElement("span",{className:j.default.running_tips},g.default.createElement(D.default,(0,o.default)({hasLabel:!1},(0,I.getPipelineStatus)(s))),t("PIPELINE_PREPAIR_DESC")):null,g.default.createElement("div",{className:j.default.pipelineCard__btnGroup},g.default.createElement(w.default,{onClick:this.handleDownloadLogs},t("Download Logs")))),g.default.createElement("div",{className:j.default.pipelineCard__main,ref:function(t){e.container=t}},g.default.createElement("pre",null,u))):g.default.createElement(g.default.Fragment,null,g.default.createElement("div",{className:j.default.pipelineCard},g.default.createElement("div",{className:j.default.pipelineCard__toolbar},this.renderBtnGroup()),g.default.createElement("div",{className:j.default.pipelineCard__main,ref:function(t){e.container=t}},g.default.createElement(N.default,{jsonData:i}))),g.default.createElement(S.default,{width:1162,onCancel:this.hideLog,title:t("Pipeline Run Logs"),visible:n,closable:!1,cancelText:t("Close")},g.default.createElement(P.default,{handleDownloadLogs:this.handleDownloadLogs,params:this.props.match.params,nodes:i})))}},{key:"enabledActions",get:function(){var e=this.props.match.params.project_id;return globals.app.getActions({module:"pipelines",project:e})}},{key:"hasRuning",get:function(){var e=this.props.detailStore.runDetail,t=(0,k.default)(e,"state");return t&&"FINISHED"!==t&&"PAUSED"!==t}},{key:"isQueued",get:function(){var e=this.props.detailStore.runDetail;return"QUEUED"===(0,k.default)(e,"state","")}}]),a}(g.default.Component),i.childContextTypes={onProceed:b.default.func,onBreak:b.default.func,result:b.default.string},l=u))||l;a.default=x},3886:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,l,i,u,o,s,d,c,f,p=n(a(61)),m=n(a(37)),h=n(a(62)),v=n(a(63)),g=n(a(44)),b=n(a(13)),y=n(a(14)),_=n(a(17)),E=n(a(16)),k=n(a(66)),C=n(a(18)),S=n(a(41)),w=(n(a(45)),n(a(0))),D=a(60),I=n(a(58)),N=a(19),P=n(a(2612)),j=n(a(1)),x=n(a(2682)),L=n(a(3887)),R=n(a(3890)),O=(0,D.observer)((f=c=function(e){function t(e){var a;return(0,b.default)(this,t),a=(0,_.default)(this,(0,E.default)(t).call(this,e)),(0,g.default)(a,"isUserMoved",i,(0,k.default)(a)),(0,g.default)(a,"parameters",u,(0,k.default)(a)),(0,g.default)(a,"showParamsModal",o,(0,k.default)(a)),(0,g.default)(a,"handleRefresh",s,(0,k.default)(a)),(0,g.default)(a,"handleProceed",d,(0,k.default)(a)),a.handelShowProceedModal=function(e,t){var n=e.parameters,r=(0,v.default)(e,["parameters"]);a.parameters=n,a.elseParams=r,(0,I.default)(n)?a.handleProceed(n,t):a.showParamsModal=!0},a.hideProceedModal=function(){a.showParamsModal=!1},a.draggerCref=w.default.createRef(),a}return(0,C.default)(t,e),(0,y.default)(t,[{key:"componentWillReceiveProps",value:function(){this.draggerCref.current&&!this.draggerCref.current.isMoved&&this.draggerCref.current.initialComponent&&this.draggerCref.current.initialComponent()}},{key:"render",value:function(){var e=this.props,t=e.isEditMode,a=e.jsonData;return w.default.createElement(w.default.Fragment,null,w.default.createElement(x.default,{ref:this.draggerCref,className:R.default.container,enableToggleFullScreen:!0,XOffset:30,YOffset:60},w.default.createElement(L.default,{isEditMode:t,stages:a,onProceed:this.handelShowProceedModal,onBreak:this.context.onBreak})),w.default.createElement(P.default,{visible:this.showParamsModal,parameters:(0,N.toJS)(this.parameters),onCancel:this.hideProceedModal,onOk:this.handleProceed}))}}]),t}(w.default.Component),c.contextTypes={onProceed:j.default.func,onBreak:j.default.func},l=f,i=(0,S.default)(l.prototype,"isUserMoved",[N.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),u=(0,S.default)(l.prototype,"parameters",[N.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),o=(0,S.default)(l.prototype,"showParamsModal",[N.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=(0,S.default)(l.prototype,"handleRefresh",[N.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.scale=1,e.translateX=0,e.translateY=0}}}),d=(0,S.default)(l.prototype,"handleProceed",[N.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return(function(){var t=(0,h.default)(p.default.mark((function t(a,n){return p.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.context.onProceed((0,m.default)({parameters:a},e.elseParams),n);case 2:e.showParamsModal=!1;case 3:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}())}}),r=l))||r;t.default=O},3887:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,l,i,u,o=n(a(97)),s=n(a(44)),d=n(a(13)),c=n(a(14)),f=n(a(17)),p=n(a(16)),m=n(a(66)),h=n(a(18)),v=n(a(41)),g=(n(a(45)),n(a(0))),b=a(19),y=a(60),_=n(a(3888)),E=n(a(2873)),k=(0,y.observer)((l=function(e){function t(){var e,a;(0,d.default)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return a=(0,f.default)(this,(e=(0,p.default)(t)).call.apply(e,[this].concat(r))),(0,s.default)(a,"heights",i,(0,m.default)(a)),(0,s.default)(a,"setHeight",u,(0,m.default)(a)),a}return(0,h.default)(t,e),(0,c.default)(t,[{key:"render",value:function(){var e=this,t=this.props.stages;return g.default.createElement(g.default.Fragment,null,g.default.createElement(E.default,{index:-1,heights:this.sumHeights}),t.map((function(t,a){return g.default.createElement(g.default.Fragment,{key:JSON.stringify(t)},g.default.createElement(_.default,{nodes:(0,b.toJS)(t),index:a,setHeight:e.setHeight(a),onProceed:e.props.onProceed,onBreak:e.props.onBreak}),g.default.createElement(E.default,{index:a,heights:e.sumHeights}))})))}},{key:"sumHeights",get:function(){var e=this.props.stages,t=void 0===e?[]:e;return this.heights.slice(0,t.length).map((function(e){var t=0;return e.map((function(e){return t+=e}))}))}}]),t}(g.default.Component),i=(0,v.default)(l.prototype,"heights",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),(0,v.default)(l.prototype,"sumHeights",[b.computed],Object.getOwnPropertyDescriptor(l.prototype,"sumHeights"),l.prototype),u=(0,v.default)(l.prototype,"setHeight",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){return function(a){var n=(0,o.default)(e.heights);n[t]=a,e.heights=n}}}}),r=l))||r;t.default=k},3888:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=r(n(70)),i=r(n(30)),u=r(n(13)),o=r(n(14)),s=r(n(17)),d=r(n(16)),c=r(n(18)),f=r(n(0)),p=r(n(3)),m=r(n(1)),h=r(n(22)),v=r(n(224)),g=n(941),b=r(n(2549)),y=r(n(3889)),_=function(e){function a(e){var t;return(0,u.default)(this,a),(t=(0,s.default)(this,(0,d.default)(a).call(this,e))).handleProceed=function(e,a){return function(){t.setState({runLoading:!0}),t.props.onProceed({parameters:e.input.parameters,nodeId:a,stepId:e.id,inputId:e.input.id},(function(){t.setState({runLoading:!1})}))}},t.handleBreak=function(e,a){return function(){t.setState({runLoading:!0}),t.props.onBreak({nodeId:a,stepId:e.id,inputId:e.input.id},(function(){t.setState({runLoading:!1})}))}},t.domTree=[],t.state={runLoading:!1},t}return(0,c.default)(a,e),(0,o.default)(a,[{key:"componentDidMount",value:function(){this.calculateHeight()}},{key:"calculateHeight",value:function(){this.heights=this.domTree.map((function(e){return e.clientHeight})),this.props.setHeight(this.heights)}},{key:"renderCard",value:function(e){var a,n,r=e.steps,u=void 0===r?[]:r,o="",s=u.find((function(e,t){var a="FINISHED"===e.state&&"SUCCESS"!==e.result;return a||(o=t),a?e:null})),d=("ABORTED"===this.context.result||"FAILURE"===this.context.result)&&!e.result,c=!(d||e.state&&"QUEUED"!==e.state),m=e.state&&"PAUSED"===e.state;if(d)return f.default.createElement("div",{className:(0,p.default)(y.default.pipelineCard)},f.default.createElement("div",{className:y.default.pipelineCard__title},e.displayName),f.default.createElement("div",{className:y.default.pipelineCard__content},f.default.createElement("div",{className:y.default.pipelineCard__item},f.default.createElement("div",{className:(0,p.default)(y.default.content__status,y.default.content__status__quene)},t("Aborted")))));if(m){var _=e.steps.find((function(e){return e.input}));return"FAILURE"===this.context.result?f.default.createElement("div",{className:(0,p.default)(y.default.pipelineCard,y.default["pipelineCard--paused"])},f.default.createElement("div",{className:y.default.pipelineCard__title},e.displayName),f.default.createElement("div",{className:y.default.pipelineCard__content},f.default.createElement("div",{className:y.default.pipelineCard__item},f.default.createElement("p",{className:y.default.content__title__paused},t("Wait for interactive input")),f.default.createElement("div",{className:(0,p.default)(y.default.content__status,y.default.content__status__quene)},t("Task failed, not operational"))))):f.default.createElement("div",{className:(0,p.default)(y.default.pipelineCard,y.default["pipelineCard--paused"])},f.default.createElement("div",{className:y.default.pipelineCard__title},e.displayName),f.default.createElement("div",{className:y.default.pipelineCard__content},f.default.createElement("div",{className:y.default.pipelineCard__item},f.default.createElement("p",{className:y.default.content__title__paused},t("Wait for interactive input")),f.default.createElement("p",{className:y.default.content__title__paused},(0,h.default)(_,"input.message")),f.default.createElement("div",{className:(0,p.default)(y.default.content__status,y.default.content__status__quene)},f.default.createElement(f.default.Fragment,null,f.default.createElement(v.default,{size:"small",type:"primary",loading:this.state.runLoading,onClick:this.handleProceed(_,e.id)},(0,h.default)(_,"input.ok")||t("Proceed")),f.default.createElement(v.default,{size:"small",type:"danger",loading:this.state.runLoading,onClick:this.handleBreak(_,e.id)},t("Break")))))))}return f.default.createElement("div",{className:(0,p.default)(y.default.pipelineCard,(a={},(0,i.default)(a,y.default["pipelineCard--error"],s),(0,i.default)(a,y.default["pipelineCard--queue"],c),a))},f.default.createElement("div",{className:y.default.pipelineCard__title},e.displayName),f.default.createElement("div",{className:y.default.pipelineCard__content},f.default.createElement("div",{className:y.default.pipelineCard__item},c?null:f.default.createElement("div",{className:y.default.content__title},"".concat(t("Task")," (").concat(""===o?0:o+1," / ").concat(u.length,")")),c&&e.causeOfBlockage?f.default.createElement("p",{className:y.default.errorMessage},e.causeOfBlockage):null,f.default.createElement("div",{className:(0,p.default)(y.default.content__status,(n={},(0,i.default)(n,y.default.content__status__error,s),(0,i.default)(n,y.default.content__status__quene,c),n))},c?null:f.default.createElement(b.default,(0,l.default)({},(0,g.getPipelineStatus)(e),{hasLabel:!1})),this.renderStatus(e,s)))))}},{key:"renderStatus",value:function(e,a){if(!e.state||"QUEUED"===e.state)return t("Queue");if("NOT_BUILT"===e.state)return t("Not Build");if("SKIPPED"===e.state)return t("Skipped");if("PAUSED"===e.state)return t("Paused");if("ABORTED"===e.result)return t("Aborted");if(a||"FAILURE"===e.result){var n=(0,h.default)(a,"displayName","");return"Wait for interactive input"===n?f.default.createElement("span",{className:y.default.errorMessage},t("Cancelled in review")):n||f.default.createElement("span",{className:y.default.errorMessage},t("Failure"))}return"FINISHED"!==e.state?t("Running"):t("Success")}},{key:"render",value:function(){var e=this,t=this.props.nodes;return Array.isArray(t)?f.default.createElement("div",{className:y.default.pipeline_column},t.map((function(t,a){return f.default.createElement("div",{key:JSON.stringify(t),ref:function(t){a?e.domTree[a]=t:e.domTree=[t]}},e.renderCard(t,a))}))):f.default.createElement("div",{className:y.default.pipeline_column},f.default.createElement("div",{ref:function(t){e.domTree=[t]}},this.renderCard(t)))}}]),a}(f.default.Component);a.default=_,_.contextTypes={result:m.default.string}},3889:function(e,t,a){e.exports={pipelineCard:"PipelineStatus__pipelineCard--2eHBz","pipelineCard--error":"PipelineStatus__pipelineCard--error--2a6xR",pipelineCard__title:"PipelineStatus__pipelineCard__title--2jIhk",pipelineCard__content:"PipelineStatus__pipelineCard__content--2T51m","pipelineCard--queue":"PipelineStatus__pipelineCard--queue--3VZzE","pipelineCard--paused":"PipelineStatus__pipelineCard--paused--v22GI",content__title__paused:"PipelineStatus__content__title__paused--Pnq2v",pipelineCard__item:"PipelineStatus__pipelineCard__item--SR1Cp",content__title:"PipelineStatus__content__title--2cmMr",content__detail:"PipelineStatus__content__detail--iwd1h",content__status:"PipelineStatus__content__status--1lkOP",content__status__error:"PipelineStatus__content__status__error--2IiIS",content__status__quene:"PipelineStatus__content__status__quene--30zBi",errorMessage:"PipelineStatus__errorMessage--2A_dH",pipeline_column:"PipelineStatus__pipeline_column--1O8in"}},3890:function(e,t,a){e.exports={pipeline_column:"PipelineStatus__pipeline_column--20jzi",container:"PipelineStatus__container--3xW8v",controls:"PipelineStatus__controls--2jEek",control:"PipelineStatus__control--VAw4x","slider-wrapper":"PipelineStatus__slider-wrapper--2Q30N"}},3891:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o,s,d=r(n(70)),c=r(n(30)),f=r(n(44)),p=r(n(13)),m=r(n(14)),h=r(n(17)),v=r(n(16)),g=r(n(66)),b=r(n(18)),y=(r(n(45)),r(n(41))),_=r(n(0)),E=r(n(3)),k=r(n(2458)),C=r(n(58)),S=n(19),w=n(60),D=r(n(224)),I=r(n(2549)),N=n(941),P=n(49),j=r(n(2879)),x=r(n(3892)),L=r(n(2880)),R=(0,w.observer)((i=function(e){function a(e){var t;return(0,p.default)(this,a),t=(0,h.default)(this,(0,v.default)(a).call(this,e)),(0,f.default)(t,"activeNodeIndex",u,(0,g.default)(t)),(0,f.default)(t,"refreshFlag",o,(0,g.default)(t)),(0,f.default)(t,"updateActiveTabs",s,(0,g.default)(t)),t.handleDownloadLogs=function(){t.props.handleDownloadLogs()},t.handleRefresh=(0,k.default)((function(){t.refreshFlag=!t.refreshFlag}),1e3),t.store=new j.default,t.reaction=(0,S.reaction)((function(){return t.isEmptySteps}),(function(){clearInterval(t.getIndexLogInterval),t.isEmptySteps&&(t.getIndexLogInterval=setInterval(t.getRunStatusLogs,4e3))})),t}return(0,b.default)(a,e),(0,m.default)(a,[{key:"componentDidMount",value:function(){this.getPipelineIndexLog()}},{key:"getPipelineIndexLog",value:function(){var e=this.props.params;this.store.getRunStatusLogs(e)}},{key:"renderLeftTab",value:function(e,a){var n=this;return Array.isArray(e)?_.default.createElement("div",{key:e.id,className:L.default.stageContainer},_.default.createElement("div",{className:L.default.cutTitle},t("Stage")),e.map((function(e,t){return _.default.createElement("div",{key:e.id,onClick:n.updateActiveTabs(a,t),className:(0,E.default)(L.default.leftTab,(0,c.default)({},L.default.leftTab__active,n.activeNodeIndex[0]===a&&n.activeNodeIndex[1]===t))},_.default.createElement(I.default,(0,d.default)({},(0,N.getPipelineStatus)(e),{hasLabel:!1})),e.displayName)}))):_.default.createElement("div",{key:e.id,className:L.default.stageContainer},_.default.createElement("div",{className:L.default.cutTitle},t("Stage")),_.default.createElement("div",{className:(0,E.default)(L.default.leftTab,(0,c.default)({},L.default.leftTab__active,this.activeNodeIndex[0]===a)),onClick:this.updateActiveTabs(a,0)},_.default.createElement(I.default,(0,d.default)({},(0,N.getPipelineStatus)(e),{hasLabel:!1})),e.displayName))}},{key:"renderLogContent",value:function(){var e=this,t=this.props.params,a=this.store.runDetailLogs;return this.isEmptySteps?"FINISHED"!==this.activeStage.state?null:_.default.createElement("pre",{className:L.default.LogItem_content},a):this.activeStage.steps.map((function(a){return _.default.createElement(x.default,{key:a.id,step:a,nodeid:e.activeStage.id,params:t,refreshFlag:e.refreshFlag})}))}},{key:"render",value:function(){var e=this,a=this.props.nodes,n=(0,S.toJS)(a);return _.default.createElement(_.default.Fragment,null,_.default.createElement("div",{className:L.default.container},_.default.createElement("div",{className:L.default.left},n.map((function(t,a){return e.renderLeftTab(t,a)}))),_.default.createElement("div",{className:L.default.right},_.default.createElement("div",{className:L.default.header},_.default.createElement("span",null,"".concat(t("Use time")," ").concat((0,P.formatUsedTime)(this.activeStage.durationInMillis))),_.default.createElement(D.default,{onClick:this.handleDownloadLogs},t("Download Logs")),_.default.createElement(D.default,{onClick:this.handleRefresh},t("Refresh"))),_.default.createElement("div",{className:L.default.logContainer},this.renderLogContent()))))}},{key:"activeStage",get:function(){var e=this.props.nodes[this.activeNodeIndex[0]];return void 0!==e.length?e[this.activeNodeIndex[1]]:e}},{key:"isEmptySteps",get:function(){return(0,C.default)(this.activeStage.steps)}}]),a}(_.default.Component),(0,y.default)(i.prototype,"activeStage",[S.computed],Object.getOwnPropertyDescriptor(i.prototype,"activeStage"),i.prototype),(0,y.default)(i.prototype,"isEmptySteps",[S.computed],Object.getOwnPropertyDescriptor(i.prototype,"isEmptySteps"),i.prototype),u=(0,y.default)(i.prototype,"activeNodeIndex",[S.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[0,0]}}),o=(0,y.default)(i.prototype,"refreshFlag",[S.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),s=(0,y.default)(i.prototype,"updateActiveTabs",[S.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a){return function(){e.activeNodeIndex=[t,a]}}}}),(0,y.default)(i.prototype,"getPipelineIndexLog",[S.action],Object.getOwnPropertyDescriptor(i.prototype,"getPipelineIndexLog"),i.prototype),l=i))||l;a.default=R},3892:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,l,i=n(a(37)),u=n(a(13)),o=n(a(14)),s=n(a(17)),d=n(a(16)),c=n(a(18)),f=n(a(41)),p=n(a(0)),m=n(a(3)),h=n(a(38)),v=a(19),g=a(60),b=n(a(2549)),y=a(941),_=n(a(3893)),E=a(49),k=n(a(2880)),C=(0,g.observer)((l=function(e){function t(e){var a;return(0,u.default)(this,t),(a=(0,s.default)(this,(0,d.default)(t).call(this,e))).handleRefresh=function(){var e=a.props.step,t=a.store.stepLogData.hasMore;a.state.isExpand&&(t||"FINISHED"!==e.state)&&a.getLog()},a.toggleExpand=function(){var e=a.store.stepLogData.log,t=a.state.isExpand;t||e||a.getLog(),a.setState({isExpand:!t})},a.state={isExpand:!1},a.store=new _.default,a}return(0,c.default)(t,e),(0,o.default)(t,[{key:"componentDidMount",value:function(){this.timer=setInterval(this.handleRefresh,4e3)}},{key:"componentWillReceiveProps",value:function(e){this.state.isExpand&&e.refreshFlag!==this.props.refreshFlag&&(this.store.handleResetStepLog(),this.getLog())}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer)}},{key:"getLog",value:function(){var e=this.props,t=e.step,a=e.params,n=e.nodeid;this.store.getStepLog((0,i.default)({},a,{nodeid:n,stepid:t.id}))}},{key:"render",value:function(){var e=this.props.step,t=this.store.stepLogData.log;return p.default.createElement("div",{className:k.default.LogItem},p.default.createElement("div",{className:(0,m.default)(k.default.LogItem__title),onClick:this.toggleExpand},p.default.createElement(h.default,{name:this.state.isExpand?"caret-down":"caret-right",size:16}),e.displayName,p.default.createElement("span",{className:k.default.logitem_status},p.default.createElement("span",null,(0,E.formatUsedTime)(e.durationInMillis)),p.default.createElement(b.default,(0,y.getPipelineStatus)(e)))),p.default.createElement("div",null,this.state.isExpand?p.default.createElement("pre",{className:k.default.LogItem_content},t):null))}}]),t}(p.default.Component),(0,f.default)(l.prototype,"getLog",[v.action],Object.getOwnPropertyDescriptor(l.prototype,"getLog"),l.prototype),r=l))||r;t.default=C},3893:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,l,i,u=n(a(61)),o=n(a(62)),s=n(a(44)),d=n(a(13)),c=n(a(14)),f=n(a(17)),p=n(a(16)),m=n(a(66)),h=n(a(18)),v=n(a(41)),g=(n(a(45)),n(a(22))),b=a(19),y=n(a(2576)),_=(r=function(e){function t(){var e,a;(0,d.default)(this,t);for(var n=arguments.length,r=new Array(n),u=0;u<n;u++)r[u]=arguments[u];return a=(0,f.default)(this,(e=(0,p.default)(t)).call.apply(e,[this].concat(r))),(0,s.default)(a,"stepLogData",l,(0,m.default)(a)),(0,s.default)(a,"handleResetStepLog",i,(0,m.default)(a)),a}var a;return(0,h.default)(t,e),(0,c.default)(t,[{key:"getStepLog",value:(a=(0,o.default)(u.default.mark((function e(t){var a,n,r,l,i,o,s,d;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.project_id,n=t.name,r=t.branch,l=t.runid,i=t.nodeid,o=t.stepid,e.next=3,request.defaults({url:"".concat("kapis/devops.kubesphere.io/v1alpha2/devops/").concat(a,"/pipelines/").concat(decodeURIComponent(n)).concat(r?"/branches/".concat(encodeURIComponent(r)):"","/runs/").concat(l,"/nodes/").concat(i,"/steps/").concat(o,"/log/?start=").concat(this.stepLogData.start||0),handler:function(e){if(200===e.status)return e.text().then((function(t){return{data:t,headers:e.headers}}))}});case 3:s=e.sent,d=this.stepLogData.log,this.stepLogData={log:d+(0,g.default)(s,"data",""),start:s.headers.get("x-text-size"),hasMore:Boolean(s.headers.get("x-more-data"))};case 6:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})}]),t}(y.default),l=(0,v.default)(r.prototype,"stepLogData",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{log:"",start:0,hasMore:!1}}}),i=(0,v.default)(r.prototype,"handleResetStepLog",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.stepLogData={log:"",start:0,hasMore:!1}}}}),r);t.default=_},3894:function(e,t,a){e.exports={pipelineCard:"TaskStatus__pipelineCard--15Io8",pipelineCard__toolbar:"TaskStatus__pipelineCard__toolbar--2-2rg",icon:"TaskStatus__icon--3Kbhn",pipelineCard__btnGroup:"TaskStatus__pipelineCard__btnGroup--1s6pP",pipelineCard__main:"TaskStatus__pipelineCard__main--2jX4V",footer:"TaskStatus__footer--2trt1",running_tips:"TaskStatus__running_tips--2KW8x",runningIcon:"TaskStatus__runningIcon--1UVLj",rotate:"TaskStatus__rotate--Dacx0",QueuedIcon:"TaskStatus__QueuedIcon--2RuQE",breath:"TaskStatus__breath--1GD36",card:"TaskStatus__card--118Qk",title:"TaskStatus__title--CqPIR",desc:"TaskStatus__desc--2SC0d"}},3895:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i=r(n(37)),u=r(n(13)),o=r(n(14)),s=r(n(17)),d=r(n(16)),c=r(n(18)),f=r(n(0)),p=r(n(269)),m=n(19),h=n(60),v=n(565),g=n(49),b=r(n(2613)),y=r(n(2591)),_=(0,h.inject)("rootStore")(l=(0,h.observer)(l=function(e){function a(e){var n;return(0,u.default)(this,a),(n=(0,s.default)(this,(0,d.default)(a).call(this,e))).handleFetch=function(e,t){n.routing.query(e,t)},n.getFilteredValue=function(e){return n.store.list.filters[e]},n.getColumns=function(){return[{title:t("commit"),dataIndex:"commitId",width:"20%",render:function(e,t){return f.default.createElement("a",{href:t.url,target:"_blank"},e&&e.slice(0,6))}},{title:t("author"),dataIndex:"author",width:"20%",render:function(e){return e.fullName||"-"}},{title:t("message"),dataIndex:"msg",width:"40%",render:function(e){return e}},{title:t("Updated Time"),dataIndex:"timestamp",isHideable:!0,width:"15%",render:function(e){return(0,g.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}}]},n.name="Commit",n.store=e.detailStore||{},n}return(0,c.default)(a,e),(0,o.default)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params;this.unsubscribe=this.routing.history.subscribe((function(a){if(a.pathname===e.props.match.url){var n=(0,v.parse)(a.search.slice(1));e.getData((0,i.default)({},t,n))}}))}},{key:"componentWillUnmount",value:function(){this.unsubscribe&&this.unsubscribe()}},{key:"getData",value:function(e){this.store.getCommits((0,i.default)({},e))}},{key:"render",value:function(){var e=(0,m.toJS)(this.store.commitsList),a=e.data,n=e.filters,r=e.selectedRowKeys,l=e.isLoading,i=e.total,u=e.page,o=e.limit,s=!1===l&&0===i,d=(0,p.default)(n,"page");if(s&&!n.page)return f.default.createElement(b.default,{desc:t("No commit records")});var c={total:i,page:u,limit:o};return f.default.createElement(y.default,{data:a,columns:this.getColumns(),filters:d,pagination:c,isLoading:l,selectedRowKeys:r,onFetch:this.handleFetch,disableSearch:!0})}},{key:"routing",get:function(){return this.props.rootStore.routing}}]),a}(f.default.Component))||l)||l;a.default=_},3896:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i=r(n(37)),u=r(n(13)),o=r(n(14)),s=r(n(17)),d=r(n(16)),c=r(n(18)),f=r(n(0)),p=n(19),m=n(60),h=n(565),v=r(n(269)),g=r(n(38)),b=n(49),y=r(n(2613)),_=r(n(2591)),E=(0,m.inject)("rootStore")(l=(0,m.observer)(l=function(e){function a(e){var n;return(0,u.default)(this,a),(n=(0,s.default)(this,(0,d.default)(a).call(this,e))).handleFetch=function(e,t){n.routing.query(e,t)},n.getFilteredValue=function(e){return n.store.list.filters[e]},n.getColumns=function(){return[{title:t("Name"),dataIndex:"path",width:"40%",render:function(e,t){return f.default.createElement("a",{href:"/kapis/jenkins.kubesphere.io".concat(t.url),target:"_blank",download:!0},e)}},{title:t("Size"),dataIndex:"size",width:"40%",render:function(e){return(0,b.formatSize)(e)}},{title:t("Download"),width:"20%",key:"download",render:function(e){return f.default.createElement("a",{href:"/kapis/jenkins.kubesphere.io".concat(e.url),target:"_blank",download:!0},f.default.createElement(g.default,{name:"download"}))}}]},n.name="Artifacts",n.store=e.detailStore||{},n}return(0,c.default)(a,e),(0,o.default)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params;this.unsubscribe=this.routing.history.subscribe((function(a){if(a.pathname===e.props.match.url){var n=(0,h.parse)(a.search.slice(1));e.getData((0,i.default)({},t,n))}}))}},{key:"componentWillUnmount",value:function(){this.unsubscribe&&this.unsubscribe()}},{key:"getData",value:function(e){this.store.getArtifacts((0,i.default)({},e))}},{key:"render",value:function(){var e=(0,p.toJS)(this.store.artifactsList),a=e.data,n=e.filters,r=e.isLoading,l=e.total,i=e.page,u=e.limit,o=!1===r&&0===l,s=(0,v.default)(n,"page");if(o&&!n.page)return f.default.createElement(y.default,{desc:t("No artifacts records")});var d={total:l,page:i,limit:u};return f.default.createElement(_.default,{data:a,columns:this.getColumns(),filters:s,rowKey:"path",pagination:d,isLoading:r,onFetch:this.handleFetch,disableSearch:!0})}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"prefix",get:function(){return this.props.match.url}}]),a}(f.default.Component))||l)||l;a.default=E},3897:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,l=n(a(13)),i=n(a(14)),u=n(a(17)),o=n(a(16)),s=n(a(18)),d=n(a(0)),c=a(19),f=a(60),p=n(a(3898)),m=n(a(3900)),h=(0,f.inject)("rootStore")(r=(0,f.observer)(r=function(e){function t(){var e,a;(0,l.default)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=(0,u.default)(this,(e=(0,o.default)(t)).call.apply(e,[this].concat(r)))).renderResult=function(){var e=a.props.sonarqubeStore,t=e.detail,n=void 0===t?{}:t,r=e.isLoading;return d.default.createElement(p.default,{data:n,loading:r})},a.renderIssues=function(){var e=a.props.sonarqubeStore,t=e.detail,n=e.isLoading;return d.default.createElement(m.default,{detail:t,issues:(0,c.toJS)(t.issues),loading:n})},a}return(0,s.default)(t,e),(0,i.default)(t,[{key:"componentDidMount",value:function(){var e=this.props.sonarqubeStore,t=e.detail,a=e.isLoading;t.totalStatus||a||this.props.rootStore.routing.push("./activity")}},{key:"render",value:function(){return d.default.createElement("div",null,this.renderResult(),this.renderIssues())}}]),t}(d.default.Component))||r)||r;t.default=h},3898:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=r(n(30)),i=r(n(13)),u=r(n(14)),o=r(n(17)),s=r(n(16)),d=r(n(18)),c=r(n(0)),f=r(n(1)),p=r(n(3)),m=r(n(22)),h=r(n(2516)),v=r(n(38)),g=n(49),b=r(n(3899)),y=r(n(2881)),_=function(e){function a(){var e,n;(0,i.default)(this,a);for(var r=arguments.length,u=new Array(r),d=0;d<r;d++)u[d]=arguments[d];return(n=(0,o.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(u)))).goToSonarqube=function(){var e=n.props.data.sonarqubeDashboardUrl,t=(0,m.default)(globals,"config.devops.sonarqubeURL");if(t){var a=(0,g.parseUrl)(e),r=t+(0,m.default)(a,"pathname","")+(0,m.default)(a,"search","");window.open(r)}else window.open(e)},n.renderTotalResult=function(){var e,a="ERROR"!==n.props.data.totalStatus;return c.default.createElement("div",{className:(0,p.default)(y.default.totalResult,(e={},(0,l.default)(e,y.default.success,a),(0,l.default)(e,y.default.error,!a),e))},c.default.createElement(v.default,{name:a?"check":"close",className:y.default.icon,size:24,color:{primary:"#ffffff",secondary:"#ffffff"}}),c.default.createElement("p",null,t("Code Quality Check")),c.default.createElement("p",null,a?t("Passed"):t("Did't pass")))},n.renderOtherResults=function(){var e=n.props.data,a=e.bugRating,r=e.bugs,l=e.securityRating,i=e.vulnerabilities,u=e.codeSmells,o=e.coverage,s=e.key,d=e.totalCode>1e3?parseFloat(e.totalCode/1e3).toFixed(2):e.totalCode,f=e.totalCode>1e3?"K":"";return c.default.createElement("div",{className:y.default.otherCards},c.default.createElement(b.default,{title:t("Lines of code"),value:d,unit:f,url:"".concat(n.sonarqubeOrigin,"/component_measures?id=").concat(s,"&metric=ncloc")}),c.default.createElement(b.default,{hasIcon:!0,title:t("Bug"),value:r,unit:t(""),resultClass:a,url:"".concat(n.sonarqubeOrigin,"/project/issues?id=").concat(s,"&resolved=false&types=BUG")}),c.default.createElement(b.default,{hasIcon:!0,title:t("Code vulnerability"),value:i,unit:t(""),resultClass:l,url:"".concat(n.sonarqubeOrigin,"/project/issues?id=").concat(s,"&resolved=false&types=VULNERABILITY")}),c.default.createElement(b.default,{hasIcon:!0,title:t("CodeSmells"),value:u,unit:t("Line"),url:"".concat(n.sonarqubeOrigin,"/project/issues?id=").concat(s,"&resolved=false&types=CODE_SMELL")}),c.default.createElement(b.default,{hasIcon:!0,title:t("Coverage"),value:o,unit:"%",url:"".concat(n.sonarqubeOrigin,"/component_measures?id=").concat(s,"&metric=coverage")}))},n.renderLogo=function(){return c.default.createElement("span",{onClick:n.goToSonarqube,className:y.default.logo})},n}return(0,d.default)(a,e),(0,u.default)(a,[{key:"render",value:function(){return this.props.loading?null:c.default.createElement(h.default,{title:t("Test Result"),operations:this.renderLogo()},c.default.createElement("div",{className:y.default.content},this.renderTotalResult(),this.renderOtherResults()))}},{key:"sonarqubeOrigin",get:function(){var e=this.props.data.sonarqubeDashboardUrl;return(0,m.default)(globals,"config.devops.sonarqubeURL")||(0,g.parseUrl)(e).origin}}]),a}(c.default.Component);_.propTypes={data:f.default.object,loading:f.default.bool};var E=_;a.default=E},3899:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a(13)),l=n(a(14)),i=n(a(17)),u=n(a(16)),o=n(a(18)),s=n(a(0)),d=n(a(38)),c=n(a(2881)),f=["A","B","C","D"],p=function(e){function t(){return(0,r.default)(this,t),(0,i.default)(this,(0,u.default)(t).apply(this,arguments))}return(0,o.default)(t,e),(0,l.default)(t,[{key:"render",value:function(){var e=this.props,t=e.hasIcon,a=e.title,n=e.value,r=e.resultClass,l=e.unit,i=e.url,u=f[parseInt(r,10)-1];return s.default.createElement("div",{className:c.default.resultCard},s.default.createElement("p",{className:c.default.title},t?s.default.createElement(d.default,{name:"debug",size:20}):null,a,r?s.default.createElement("span",{className:c.default[u]},u):null),s.default.createElement("p",{className:c.default.value},i?s.default.createElement("a",{href:i,target:"_blank"},s.default.createElement("span",null,n)):s.default.createElement("span",null,n),s.default.createElement("span",{className:c.default.unit},l)))}}]),t}(s.default.PureComponent);t.default=p,p.defaultProps={hasIcon:!1,title:"-",value:0,url:""}},3900:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=r(n(13)),i=r(n(17)),u=r(n(16)),o=r(n(14)),s=r(n(18)),d=r(n(0)),c=r(n(1)),f=r(n(22)),p=r(n(2516)),m=n(49),h=r(n(3901)),v=r(n(2882)),g=r(n(2689)),b=function(e){function a(e){var n;(0,l.default)(this,a),(n=(0,i.default)(this,(0,u.default)(a).call(this,e))).showMore=function(){n.setState({showMore:!0})},n.renderTitle=function(){var e=n.props.detail,a=e.critical,r=e.major,l=e.minor,i=e.info,u=e.blocker;return d.default.createElement("div",{className:g.default.header},d.default.createElement("span",{className:g.default.title},t("Issues")),d.default.createElement("div",{className:g.default.details},d.default.createElement("span",null,d.default.createElement(v.default,{errorClass:"blocker"}),u||0),d.default.createElement("span",null,d.default.createElement(v.default,{errorClass:"critical"}),a||0),d.default.createElement("span",null,d.default.createElement(v.default,{errorClass:"major"}),r||0),d.default.createElement("span",null,d.default.createElement(v.default,{errorClass:"minor"}),l||0),d.default.createElement("span",null,d.default.createElement(v.default,{errorClass:"info"}),i||0)))},n.renderIssue=function(e,t){var a=n.props.issues;if(n.state.showMore&&t>10)return null;var r=0===t||e.component!==a[t-1].component;return d.default.createElement(h.default,{hasTitle:r,issue:e,origin:n.sonarqubeOrigin})},n.renderMoreBtn=function(){return n.state.showMore?null:d.default.createElement("p",{className:g.default.titleShowMore},t("Show only the last 10"),",",d.default.createElement("span",{onClick:n.showMore},t("Display All")))};var r=e.issues.length<=10;return n.state={showMore:r},n}return(0,s.default)(a,e),(0,o.default)(a,[{key:"sonarqubeOrigin",get:function(){var e=this.props.detail.sonarqubeDashboardUrl;return(0,f.default)(globals,"config.devops.sonarqubeURL")||(0,m.parseUrl)(e).origin}}]),(0,o.default)(a,[{key:"render",value:function(){var e=this,a=this.props,n=a.loading,r=a.issues;return n?null:r.length?d.default.createElement(p.default,{title:this.renderTitle(),operations:this.renderMoreBtn()},d.default.createElement("div",{className:g.default.content},r.map((function(t,a){return e.renderIssue(t,a)})),this.state.showMore?null:d.default.createElement("div",{className:g.default.displayAll,onClick:this.showMore},t("Display All")))):null}}]),a}(d.default.Component);b.propTypes={issues:c.default.array,loading:c.default.bool},b.defaultProps={issues:[]};var y=b;a.default=y},3901:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=r(n(13)),i=r(n(14)),u=r(n(17)),o=r(n(16)),s=r(n(18)),d=r(n(0)),c=r(n(1)),f=r(n(3)),p=r(n(38)),m=r(n(2882)),h=r(n(2689)),v=function(e){function a(){var e,n;(0,l.default)(this,a);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(n=(0,u.default)(this,(e=(0,o.default)(a)).call.apply(e,[this].concat(i)))).renderErrorCode=function(e){var a=n.props.origin,r=(e.severity||"").toLocaleLowerCase();return d.default.createElement("a",{key:e.line,href:"".concat(a,"/project/issues?id=").concat(e.project,"&open=").concat(e.key),target:"_blank"},d.default.createElement("div",{className:(0,f.default)(h.default.errorCard,h.default["card-".concat(r)]),onClick:n.handleGoToDetail},d.default.createElement("p",{className:h.default.message},e.message),d.default.createElement("div",{className:h.default.status},d.default.createElement(m.default,{errorClass:r}),d.default.createElement("span",{className:h.default.type},d.default.createElement(p.default,{name:"debug",size:20}),t(e.type)),d.default.createElement("span",null,t("Line number"),": "),d.default.createElement("span",null,e.line))))},n}return(0,s.default)(a,e),(0,i.default)(a,[{key:"render",value:function(){var e=this.props,t=e.issue;return e.hasTitle?d.default.createElement(d.default.Fragment,null,d.default.createElement("p",{key:t.component,className:h.default.fileTitle},t.component),this.renderErrorCode(t)):this.renderErrorCode(t)}}]),a}(d.default.PureComponent);v.propTypes={issues:c.default.array,index:c.default.number},v.defaultProps={issues:[]};var g=v;a.default=g},3902:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(49),l=a(564),i=n(a(2517)),u=n(a(3903)),o=a(2688),s="/devops/:project_id/pipelines/:name/branch/:branch",d=[{name:"activity",title:"Activity",component:o.Activity},{name:"code-quality",title:"Code Quality",component:o.CodeQuality}],c=[{path:s,component:(0,r.withProps)(i.default,{module:"cicds",component:u.default,breadcrumbs:[{label:"Pipeline List",url:"/devops/:project_id/pipelines"},{label:"Branch",url:"/devops/:project_id/pipelines/:name/branch"}]}),routes:(0,l.getChildRoutes)(d,s)}];t.default=c},3903:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.Component=a.default=void 0;var l,i,u=r(n(37)),o=r(n(61)),s=r(n(62)),d=r(n(44)),c=r(n(13)),f=r(n(14)),p=r(n(17)),m=r(n(16)),h=r(n(66)),v=r(n(18)),g=r(n(41)),b=(r(n(45)),r(n(0))),y=n(19),_=n(60),E=r(n(131)),k=r(n(22)),C=r(n(129)),S=r(n(2520)),w=r(n(2541)),D=r(n(2612)),I=r(n(2549)),N=n(2638),P=r(n(2575)),j=r(n(2875)),x=n(564),L=n(941),R=r(n(2876)),O=r(n(2877)),M=(l=function(e){function a(e){var n;return(0,c.default)(this,a),(n=(0,p.default)(this,(0,m.default)(a).call(this,e))).fetchData=function(){var e=n.props.match.params;n.store.getBranchDetail(e),n.store.fetchDetail(e),n.getSonarqube()},n.getSonarqube=function(){var e=n.props.match.params;n.sonarqubeStore.fetchDetail(e)},n.getOperations=function(){return[{key:"run",type:"control",text:t("Run"),action:"trigger",onClick:n.handleRun}]},n.getAttrs=function(){var e=n.store.detail,a=n.store.activityList;return[{name:t("DevOps Project"),value:e.displayName},{name:t("Status"),value:b.default.createElement(I.default,(0,L.getPipelineStatus)((0,k.default)(a.data,"[0]",{})))},{name:t("Updated Time"),value:n.updateTime}]},(0,d.default)(n,"handleBranchSelect",i,(0,h.default)(n)),n.handleRun=(0,s.default)(o.default.mark((function e(){var t,a,r,l;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.store.branchDetail,a=n.props.match.params,r=t.branchNames,l=t.parameters&&t.parameters.length,!r&&!l){e.next=8;break}n.setState({showBranchModal:!0}),e.next=11;break;case 8:return e.next=10,n.store.runBranch(a);case 10:n.store.getActivities(a);case 11:case"end":return e.stop()}}),e)}))),n.hideBranchModal=function(){n.setState({showBranchModal:!1})},n.handleRunBranch=function(){var e=(0,s.default)(o.default.mark((function e(t){var a,r,l,i,u;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props.match.params,r=n.props.match.params,l=r.branch,i=r.project_id,u=n.store.detail,e.next=5,n.store.runBranch({project_id:i,branch:l,name:u.name,parameters:t});case 5:n.store.getActivities(a),n.hideBranchModal();case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.store=new P.default,n.sonarqubeStore=new j.default,n.state={showBranchModal:!1},n}return(0,v.default)(a,e),(0,f.default)(a,[{key:"renderSubView",value:function(){var e=this.props.route;return this.store.isLoading||this.sonarqubeStore.isLoading?b.default.createElement("div",{className:O.default.loading},b.default.createElement(C.default,null)):(0,x.renderRoutes)(e.routes,(0,u.default)({},this.baseProps,this.getRouteProps()))}},{key:"renderNav",value:function(){return b.default.createElement(R.default,{sonarqubeStore:this.sonarqubeStore,detailStore:this.store,route:this.props.route,match:this.props.match})}},{key:"renderSider",value:function(){var e=this,t=this.props.match.params.branch,a=this.store.branchDetail,n=this.getOperations().filter((function(t){return e.enabledActions.includes(t.action)}));return b.default.createElement(b.default.Fragment,null,b.default.createElement(w.default,{icon:b.default.createElement(N.ReactComponent,{className:O.default.branchIcon}),name:decodeURIComponent(t),operations:n,attrs:this.getAttrs()}),b.default.createElement(D.default,{onOk:this.handleRunBranch,onCancel:this.hideBranchModal,visible:this.state.showBranchModal,parameters:a.parameters}))}},{key:"listUrl",get:function(){var e=this.props.match.params.project_id;return"/devops/".concat(e,"/pipelines")}},{key:"name",get:function(){return"cicds"}},{key:"createTime",get:function(){return(0,E.default)(this.store.detail.createTime).format("".concat(t("MMMM Do YYYY")," HH:mm"))}},{key:"updateTime",get:function(){var e=this.store.activityList,a=(0,k.default)(e.data,"[0].startTime","");return a?(0,E.default)(a).format("".concat(t("MMMM Do YYYY")," HH:mm")):"-"}},{key:"enabledActions",get:function(){return globals.app.getActions({module:"pipelines",project:this.props.match.params.project_id})}},{key:"prefix",get:function(){return this.props.match.url.endsWith("/")?this.props.match.url.slice(0,-1):this.props.match.url}}]),a}(S.default),i=(0,g.default)(l.prototype,"handleBranchSelect",[y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return(function(){var t=(0,s.default)(o.default.mark((function t(a){var n,r;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.props.match.params,t.next=3,e.store.getBranchDetail((0,u.default)({},n,{branch:a}));case 3:(r=t.sent).parameters&&(e.store.detail.parameters=r.parameters);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}),l),T=(0,_.inject)("rootStore")((0,_.observer)(M));a.default=T;var A=M;a.Component=A},3904:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(49),l=a(564),i=n(a(2517)),u=n(a(3905)),o=a(2688),s="/devops/:project_id/pipelines/:name/branch/:branch/run/:runid",d="/devops/:project_id/pipelines/:name/run/:runid",c=[{name:"task-status",title:"TaskStatus",component:o.TaskStatus},{name:"commit",title:"Commit",component:o.Commit},{name:"artifacts",title:"Artifacts",component:o.Artifacts}],f=[{path:s,component:(0,r.withProps)(i.default,{module:"cicds",component:u.default,breadcrumbs:[{label:"Pipeline List",url:"/devops/:project_id/pipelines"},{label:"Branch",url:"/devops/:project_id/pipelines/:name/branch"},{label:"Activity",url:"/devops/:project_id/pipelines/:name/branch/:branch/activity"}]}),routes:(0,l.getChildRoutes)(c,s)},{path:d,component:(0,r.withProps)(i.default,{module:"cicds",component:u.default,breadcrumbs:[{label:"Pipeline List",url:"/devops/:project_id/pipelines"},{label:"Activity",url:"/devops/:project_id/pipelines/:name/activity"}]}),routes:(0,l.getChildRoutes)(c,d)}];t.default=f},3905:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.Component=a.default=void 0;var l,i,u,o=r(n(61)),s=r(n(62)),d=r(n(44)),c=r(n(13)),f=r(n(14)),p=r(n(17)),m=r(n(16)),h=r(n(66)),v=r(n(18)),g=r(n(41)),b=(r(n(45)),r(n(0))),y=n(19),_=n(60),E=r(n(131)),k=r(n(22)),C=n(114),S=n(941),w=r(n(2520)),D=r(n(2541)),I=r(n(2549)),N=r(n(2879)),P=(0,_.observer)((i=function(e){function a(e){var n;return(0,c.default)(this,a),(n=(0,p.default)(this,(0,m.default)(a).call(this,e))).refreshHandler=function(){var e=n.props.match.params;n.store.runDetail.message||(n.hasRuning?n.store.getRunDetail(e):(clearInterval(n.refreshTimer),n.refreshTimer=null))},n.fetchData=function(){var e=n.props.match.params;n.store.getRunDetail(e)},(0,d.default)(n,"rePlay",u,(0,h.default)(n)),n.getOperations=function(){return[{key:"rerun",type:"control",text:t("Rerun"),action:"trigger",onClick:n.rePlay}]},n.getAttrs=function(){var e=n.store.runDetail;return[{name:t("Activity"),value:e.id},{name:t("Status"),value:b.default.createElement(I.default,(0,S.getPipelineStatus)(e))},{name:t("Updated Time"),value:n.updateTime}]},n.showEditModal=function(){n.setState({showEdit:!0})},n.hideEditModal=function(){n.setState({showEdit:!1})},n.handleEdit=function(){var e=n.store.detail;n.store.update(e).then((function(){n.hideEditModal()}))},n.store=new N.default,n.state={showEdit:!1,showYamlEdit:!1},n.refreshTimer=setInterval(n.refreshHandler,4e3),n}return(0,v.default)(a,e),(0,f.default)(a,[{key:"componentWillReceiveProps",value:function(e){var t=e.match.params,a=this.props.match.params;t.runId!==a.runid&&(clearInterval(this.refreshTimer),this.refreshTimer=setInterval(this.refreshHandler,4e3))}},{key:"componentDidUpdate",value:function(){var e=this.store.runDetail,t=this.props.match.params;e.id&&e.id!==t.runid&&this.routing.push("/devops/".concat(t.project_id,"/pipelines/").concat(t.name).concat(t.branch?"/branch/".concat(t.branch):"","/run/").concat(e.id)),!this.refreshTimer&&this.hasRuning&&(this.refreshTimer=setInterval(this.refreshHandler,4e3))}},{key:"componentWillUnmount",value:function(){clearInterval(this.refreshTimer)}},{key:"renderSider",value:function(){var e=this,t=this.store.runDetail,a=t.id,n=t.annotations,r=t.labels,l=this.getOperations().filter((function(t){return e.enabledActions.includes(t.action)}));return b.default.createElement(D.default,{icon:C.ICON_TYPES[this.module],name:a,desc:(0,k.default)(n,"desc"),operations:l,labels:r,attrs:this.getAttrs()})}},{key:"listUrl",get:function(){var e=this.props.match.params.project_id;return"/devops/".concat(e,"/pipelines")}},{key:"hasRuning",get:function(){var e=this.store.runDetail,t=(0,k.default)(e,"state");return t&&"FINISHED"!==t&&"PAUSED"!==t}},{key:"name",get:function(){return"cicds"}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"application",get:function(){var e=this.store.detail;return e.labels&&e.labels.chart&&e.labels.release?"".concat(e.labels.release,"/").concat(e.labels.chart):"-"}},{key:"creator",get:function(){return(0,k.default)(this.store.detail,"creator",t("unknown"))}},{key:"createTime",get:function(){return(0,E.default)(this.store.detail.createTime).format("".concat(t("MMMM Do YYYY")," HH:mm"))}},{key:"updateTime",get:function(){var e=this.store.runDetail,a=(0,k.default)(e,"startTime","");return a?(0,E.default)(a).format("".concat(t("MMMM Do YYYY")," HH:mm")):"-"}},{key:"enabledActions",get:function(){return globals.app.getActions({module:"pipelines",project:this.props.match.params.project_id})}}]),a}(w.default),u=(0,g.default)(i.prototype,"rePlay",[y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return((0,s.default)(o.default.mark((function t(){var a,n;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props.match.params,t.next=3,e.store.replay(a);case 3:n=t.sent,a.branch&&e.routing.push("/devops/".concat(a.project_id,"/pipelines/").concat(a.name).concat(a.branch?"/branch/".concat(a.branch):"","/activity")),n.id&&(e.store.runDetail=n);case 6:case"end":return t.stop()}}),t)}))))}}),l=i))||l,j=(0,_.inject)("rootStore")((0,_.observer)(P));a.default=j;var x=P;a.Component=x},3906:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(49),l=a(564),i=n(a(2517)),u=n(a(3907)),o=n(a(3908)),s=n(a(3909)),d="/devops/:project_id/credentials/:cridential_id",c=[{name:"detail",title:"Detail",component:o.default},{name:"activity",title:"Activity",component:s.default}],f=[{path:d,component:(0,r.withProps)(i.default,{module:"credentials",component:u.default,breadcrumbs:[{label:"Credentials",url:"/devops/:project_id/credentials"}]}),routes:(0,l.getChildRoutes)(c,d)}];t.default=f},3907:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.Component=a.default=void 0;var l=r(n(61)),i=r(n(62)),u=r(n(13)),o=r(n(14)),s=r(n(17)),d=r(n(16)),c=r(n(18)),f=r(n(0)),p=n(60),m=r(n(22)),h=n(49),v=n(114),g=r(n(2637)),b=r(n(2520)),y=r(n(2541)),_=r(n(2636)),E=function(e){function a(){var e,n;(0,u.default)(this,a);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(n=(0,s.default)(this,(e=(0,d.default)(a)).call.apply(e,[this].concat(o)))).state={showEdit:!1,showYamlEdit:!1,deleteModule:!1},n.fetchData=function(){var e=n.props.match.params;n.store.setParams(e),n.store.fetchDetail().catch(n.catch)},n.getOperations=function(){return[{key:"edit",type:"control",text:t("EDIT"),action:"edit",onClick:n.showEditModal},{key:"delete",type:"danger",text:t("Delete"),action:"delete",onClick:n.showModal("deleteModule")}]},n.getAttrs=function(){var e=n.store.detail;return[{name:t("Type"),value:t(e.type)},{name:t("description"),value:e.description},{name:t("domain"),value:e.domain}]},n.showEditModal=(0,i.default)(l.default.mark((function e(){var t;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.store.detail,n.setState({showEdit:!0,formTemplate:t});case 2:case"end":return e.stop()}}),e)}))),n.hideEditModal=function(){n.setState({showEdit:!1})},n.handleEdit=function(){n.setState({showEdit:!1}),n.store.fetchDetail()},n.handleDelete=function(){var e=n.props.match.params.project_id,t=n.store.detail;n.store.delete(t.id).then((function(){n.routing.push("/devops/".concat(e,"/").concat(n.module))}))},n}return(0,c.default)(a,e),(0,o.default)(a,[{key:"init",value:function(){this.store=new g.default(this.module)}},{key:"renderSider",value:function(){var e=this.store.detail;return f.default.createElement(y.default,{icon:v.ICON_TYPES[this.module],name:e.id||"",desc:(0,m.default)(e,"description"),operations:this.getEnabledOperations(),labels:e.labels,attrs:this.getAttrs()})}},{key:"renderExtraModals",value:function(){var e=this.state.showEdit,a=this.props.match.params.project_id;return f.default.createElement("div",null,f.default.createElement(_.default,{title:t("Edit Credential"),formTemplate:this.state.formTemplate,visible:e,onOk:this.handleEdit,onCancel:this.hideEditModal,project_id:a,isEditMode:!0}))}},{key:"name",get:function(){return"Credential"}},{key:"authKey",get:function(){return"credentials"}},{key:"updateTime",get:function(){var e=this.store.detail,t=(0,m.default)(e,"latestRun.startTime","");return t?(0,h.getLocalTime)(t).format("YYYY-MM-DD HH:mm:ss"):"-"}},{key:"listUrl",get:function(){var e=this.props.match.params.project_id;return"/devops/".concat(e,"/credentials")}}]),a}(b.default),k=(0,p.inject)("rootStore")((0,p.observer)(E));a.default=k;var C=E;a.Component=C},3908:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o=r(n(13)),s=r(n(14)),d=r(n(17)),c=r(n(16)),f=r(n(18)),p=r(n(0)),m=r(n(1)),h=n(60),v=r(n(38)),g=r(n(2516)),b=r(n(2883)),y=(0,h.observer)((u=i=function(e){function a(){var e,n;(0,o.default)(this,a);for(var r=arguments.length,l=new Array(r),i=0;i<r;i++)l[i]=arguments[i];return(n=(0,d.default)(this,(e=(0,c.default)(a)).call.apply(e,[this].concat(l)))).getColumns=function(){return[{title:t("name"),dataIndex:"name",width:"50%"},{title:t("Record"),dataIndex:"record",width:"50%"}]},n}return(0,f.default)(a,e),(0,s.default)(a,[{key:"render",value:function(){var e=this.props.detailStore.detail;return p.default.createElement(g.default,{title:t("Account")},p.default.createElement("div",{className:b.default.card_content},p.default.createElement("div",{className:b.default.icon},p.default.createElement(v.default,{name:"key",size:40})),p.default.createElement("div",{className:b.default.info},p.default.createElement("div",{className:b.default.name},e.id||"-"),p.default.createElement("div",{className:b.default.desc},"".concat(t("type"),": ").concat(t(e.type))))))}}]),a}(p.default.Component),i.propTypes={data:m.default.array,loading:m.default.bool},l=u))||l;a.default=y},3909:function(e,a,n){"use strict";var r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l,i,u,o=r(n(13)),s=r(n(14)),d=r(n(17)),c=r(n(16)),f=r(n(18)),p=r(n(0)),m=n(226),h=n(60),v=r(n(22)),g=n(19),b=r(n(1)),y=r(n(2456)),_=r(n(2516)),E=r(n(2883)),k=(0,h.observer)((u=i=function(e){function a(){var e,n;(0,o.default)(this,a);for(var r=arguments.length,l=new Array(r),i=0;i<r;i++)l[i]=arguments[i];return(n=(0,d.default)(this,(e=(0,c.default)(a)).call.apply(e,[this].concat(l)))).getColumns=function(){return[{title:t("name"),dataIndex:"name",width:"50%"},{title:t("Record"),width:"50%",render:function(e){if(e.ranges){var t=e.name.split("/"),a="/devops/".concat(t[0],"/pipelines/").concat(t[1]).concat(t[2]?"/branch/".concat(t[2]):"","/activity");return p.default.createElement("span",null,e.ranges.ranges.map((function(e){return p.default.createElement(m.Link,{to:a,key:"".concat(e.start).concat(e.end)},"#",e.start,"-#",e.end,"")})))}return"-"}}]},n}return(0,f.default)(a,e),(0,s.default)(a,[{key:"render",value:function(){var e=this.props.detailStore,a=e.detail,n=e.isLoading;return p.default.createElement(_.default,{title:t("Events")},p.default.createElement(y.default,{className:E.default.table,dataSource:(0,g.toJS)((0,v.default)(a,"fingerprint.usage",[]))||[],rowKey:"name",columns:this.getColumns(),loading:n}))}}]),a}(p.default.Component),i.propTypes={data:b.default.array,loading:b.default.bool},l=u))||l;a.default=k}}]);