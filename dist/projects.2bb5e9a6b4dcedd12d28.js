(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{2497:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(564),r=n(a(3345)),o=function(){return(0,l.renderRoutes)(r.default)};t.default=o},2537:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(61)),u=l(n(63)),i=l(n(62)),s=l(n(13)),d=l(n(14)),c=l(n(17)),f=l(n(16)),m=l(n(18)),p=l(n(41)),h=l(n(30)),v=l(n(22)),g=n(19),y=l(n(388)),E=l(n(228)),b=function(e){if(e&&"kubernetes.io/dockerconfigjson"===e.type){var t=e.data[".dockerconfigjson"],a=t.url,n=t.username,l=t.password,r=t.email;e.data[".dockerconfigjson"]=JSON.stringify({auths:(0,h.default)({},a,{username:n,password:l,email:r,auth:btoa("".concat(n,":").concat(l))})})}e.data&&Object.keys(e.data).forEach((function(t){e.data[t]=btoa(e.data[t])}))},_=(r=function(e){function a(){var e;return(0,s.default)(this,a),(e=(0,c.default)(this,(0,f.default)(a).call(this))).module="secrets",e}var n,l,r;return(0,m.default)(a,e),(0,d.default)(a,[{key:"fetchByK8s",value:(r=(0,i.default)(o.default.mark((function e(t){var a,n,l,r;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.namespace,n=(0,u.default)(t,["namespace"]),this.list.isLoading=!0,e.next=4,request.get("".concat(this.apiVersion,"/namespaces/").concat(a,"/").concat(this.module),n);case 4:return l=e.sent,r=l.items.map(this.mapper),this.list.data=r,this.list.total=l.items.length,this.list.isLoading=!1,e.abrupt("return",r);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"create",value:(l=(0,i.default)(o.default.mark((function e(t){var a;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=(0,v.default)(t,"metadata.namespace")){e.next=3;break}return e.abrupt("return");case 3:if(this.isSubmitting=!0,!t||"kubernetes.io/dockerconfigjson"!==t.type){e.next=7;break}return e.next=7,this.validateImageRegistrySecret(t);case 7:return t&&b(t),e.abrupt("return",this.submitting(request.post(this.getListUrl({namespace:a}),t)));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"update",value:function(e,t){return this.submitting(request.put(this.getDetailUrl(e),t))}},{key:"updateWithEncode",value:function(e,t){return t&&b(t),this.submitting(request.put(this.getDetailUrl(e),t))}},{key:"validateImageRegistrySecret",value:(n=(0,i.default)(o.default.mark((function e(a){var n,l,r,u,i,s,d=this;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.data[".dockerconfigjson"],l=n.url,r=n.username,u=n.password,i={username:r,password:u,serverhost:l},e.next=4,request.post("kapis/resources.kubesphere.io/v1alpha2/registry/verify",i,{},(function(e){var a=(0,v.default)(e,"message","");return a&&y.default.error({title:t("Registry verify failed"),content:t(a)}),d.isSubmitting=!1,Promise.reject(e)}));case 4:if(!(s=e.sent)||"Verified"!==s.message){e.next=7;break}return e.abrupt("return",Promise.resolve(s));case 7:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"apiVersion",get:function(){return"api/v1"}}]),a}(E.default),(0,p.default)(r.prototype,"fetchByK8s",[g.action],Object.getOwnPropertyDescriptor(r.prototype,"fetchByK8s"),r.prototype),(0,p.default)(r.prototype,"create",[g.action],Object.getOwnPropertyDescriptor(r.prototype,"create"),r.prototype),(0,p.default)(r.prototype,"update",[g.action],Object.getOwnPropertyDescriptor(r.prototype,"update"),r.prototype),(0,p.default)(r.prototype,"updateWithEncode",[g.action],Object.getOwnPropertyDescriptor(r.prototype,"updateWithEncode"),r.prototype),(0,p.default)(r.prototype,"validateImageRegistrySecret",[g.action],Object.getOwnPropertyDescriptor(r.prototype,"validateImageRegistrySecret"),r.prototype),r);a.default=_},2556:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r,o=n(a(61)),u=n(a(62)),i=n(a(44)),s=n(a(13)),d=n(a(14)),c=n(a(17)),f=n(a(16)),m=n(a(66)),p=n(a(18)),h=n(a(41)),v=(n(a(45)),a(19)),g=n(a(270)),y=(l=function(e){function t(){var e;return(0,s.default)(this,t),e=(0,c.default)(this,(0,f.default)(t).call(this)),(0,i.default)(e,"gateway",r,(0,m.default)(e)),e.getGatewayUrl=function(e){return"kapis/resources.kubesphere.io/v1alpha2/namespaces/".concat(e,"/router")},e.module="ingresses",e}var a;return(0,p.default)(t,e),(0,d.default)(t,[{key:"getGateway",value:(a=(0,u.default)(o.default.mark((function e(t){var a,n,l,r;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.namespace,this.gateway.isLoading=!0,n=this.getGatewayUrl(a),l={},e.prev=4,e.next=7,request.get(n,null,null,(function(){}));case 7:(r=e.sent)&&(l=g.default.gateway(r)),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(4);case 13:this.gateway.data=l,this.gateway.isLoading=!1;case 15:case"end":return e.stop()}}),e,this,[[4,11]])}))),function(e){return a.apply(this,arguments)})},{key:"addGateway",value:function(e,t){var a=e.namespace;return this.submitting(request.post(this.getGatewayUrl(a),t))}},{key:"updateGateway",value:function(e,t){var a=e.namespace;return this.submitting(request.put(this.getGatewayUrl(a),t))}},{key:"deleteGateway",value:function(e){var t=e.namespace;return this.submitting(request.delete(this.getGatewayUrl(t)))}},{key:"apiVersion",get:function(){return"apis/extensions/v1beta1"}}]),t}(n(a(228)).default),r=(0,h.default)(l.prototype,"gateway",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:{},isLoading:!0}}}),(0,h.default)(l.prototype,"getGateway",[v.action],Object.getOwnPropertyDescriptor(l.prototype,"getGateway"),l.prototype),(0,h.default)(l.prototype,"addGateway",[v.action],Object.getOwnPropertyDescriptor(l.prototype,"addGateway"),l.prototype),(0,h.default)(l.prototype,"updateGateway",[v.action],Object.getOwnPropertyDescriptor(l.prototype,"updateGateway"),l.prototype),(0,h.default)(l.prototype,"deleteGateway",[v.action],Object.getOwnPropertyDescriptor(l.prototype,"deleteGateway"),l.prototype),l);t.default=y},2559:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r=n(a(61)),o=n(a(62)),u=n(a(13)),i=n(a(14)),s=n(a(17)),d=n(a(16)),c=n(a(18)),f=n(a(41)),m=a(19),p=(l=function(e){function t(){var e;return(0,u.default)(this,t),(e=(0,s.default)(this,(0,d.default)(t).call(this))).module="configmaps",e}var a;return(0,c.default)(t,e),(0,i.default)(t,[{key:"fetchByK8s",value:(a=(0,o.default)(r.default.mark((function e(t){var a,n,l;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.namespace,this.list.isLoading=!0,e.next=4,request.get("".concat(this.apiVersion,"/namespaces/").concat(a,"/").concat(this.module));case 4:return n=e.sent,l=n.items.map(this.mapper),this.list.data=l,this.list.total=n.items.length,this.list.isLoading=!1,e.abrupt("return",l);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"apiVersion",get:function(){return"api/v1"}}]),t}(n(a(228)).default),(0,f.default)(l.prototype,"fetchByK8s",[m.action],Object.getOwnPropertyDescriptor(l.prototype,"fetchByK8s"),l.prototype),l);t.default=p},2564:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.Component=void 0;var r=l(n(70)),o=l(n(30)),u=l(n(37)),i=l(n(63)),s=l(n(97)),d=l(n(13)),c=l(n(14)),f=l(n(17)),m=l(n(16)),p=l(n(66)),h=l(n(18)),v=l(n(22)),g=l(n(115)),y=l(n(566)),E=l(n(130)),b=l(n(0)),_=n(60),S=l(n(943)),k=l(n(2470)),C=l(n(227)),w=l(n(38)),N=n(49),T=n(114),P=n(974),M=l(n(2544)),R=l(n(267)),D=l(n(2570)),O=l(n(3418)),x=l(n(3420)),I=l(n(3430)),A=l(n(3432)),L=l(n(3434)),j=l(n(3438)),V=function(e){function a(e){var t;return(0,d.default)(this,a),(t=(0,f.default)(this,(0,m.default)(a).call(this,e))).showVolume=function(){t.setState({state:"ShowVolume",selectVolume:{}})},t.showEditVolume=function(e){var a;a=(0,E.default)(e.configMap)&&(0,E.default)(e.secret)?"ShowVolume":"ShowConfig",t.setState({state:a,selectVolume:e})},t.showVolumeTemplate=function(){t.setState({state:"ShowVolumeTemplate"})},t.showEditVolumeTemplate=function(e){t.setState({state:"ShowVolumeTemplate",selectVolume:e})},t.resetState=function(e){t.setState({state:e||""})},t.showConfig=function(){t.setState({state:"ShowConfig",selectVolume:{}})},t.formatSpecVolume=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return(0,P.isNotPersistentVolume)(t)?t:{name:e.name||"volume-".concat((0,N.generateId)()),persistentVolumeClaim:{claimName:t.name}}},t.updateVolumes=function(e){var a=(0,v.default)(t.formTemplate,"".concat(t.prefix,"spec.volumes"),[]),n=[],l=(0,P.findVolume)(a,e),r=t.formatSpecVolume(l,e);n=l?a.map((function(t){return t.name===e.name?r:t})):[].concat((0,s.default)(a),[r]),(0,g.default)(t.formTemplate,"".concat(t.prefix,"spec.volumes"),n)},t.updateVolumeMounts=function(e){var a=(0,v.default)(t.formTemplate,"".concat(t.prefix,"spec.containers"),[]),n=(0,v.default)(t.formTemplate,"".concat(t.prefix,"spec.volumes"),[]);e.forEach((function(e){var t=e.containerName,l=e.volume,r=(0,i.default)(e,["containerName","volume"]),o=a.find((function(e){return e.name===t})),s=(0,P.findVolume)(n,l);if(s&&o){o.volumeMounts=o.volumeMounts||[];var d=(0,u.default)({name:s.name},r);o.volumeMounts.find((function(e){return e.name===s.name}))?o.volumeMounts=o.volumeMounts.map((function(e){return e.name===s.name?d:e})):o.volumeMounts.push(d),o.volumeMounts=o.volumeMounts.filter((function(e){return"null"!==e.readOnly})).map((function(e){e.logPath;var t=(0,i.default)(e,["logPath"]);return(0,u.default)({},t,{readOnly:"true"===t.readOnly})}))}})),(0,g.default)(t.formTemplate,"".concat(t.prefix,"spec.containers"),a)},t.updateLogConfigs=function(e){var a=(0,N.safeParseJSON)((0,v.default)(t.formTemplate,t.logPathPrefix,""),{}),n=(0,v.default)(t.formTemplate,"".concat(t.prefix,"spec.volumes"),[]);e.forEach((function(e){var t=(0,P.findVolume)(n,e.volume),l="containerLogConfigs.".concat(e.containerName,".").concat(e.name||t.name);e.logPath?(0,g.default)(a,l,e.logPath.split(",")):(0,y.default)(a,l)})),(0,g.default)(t.formTemplate,t.logPathPrefix,JSON.stringify(a))},t.updateVolumeTemplate=function(e){var a=(0,v.default)(t.formTemplate,"metadata.namespace"),n=(0,v.default)(t.formTemplate,"spec.volumeClaimTemplates",[]);(0,g.default)(e,"metadata.namespace",a);var l=[];l=n.find((function(t){return t.metadata.name===e.metadata.name}))?n.map((function(t){return t.metadata.name===e.metadata.name?e:t})):[].concat((0,s.default)(n),[e]),(0,g.default)(t.formTemplate,"spec.volumeClaimTemplates",l)},t.updateVolumeTemplateMounts=function(e){var a=(0,v.default)(t.formTemplate,"".concat(t.prefix,"spec.containers"),[]);e.forEach((function(e){var t=e.containerName,n=(0,i.default)(e,["containerName"]),l=a.find((function(e){return e.name===t}));if(l){l.volumeMounts=l.volumeMounts||[];var r=n;l.volumeMounts.find((function(e){return e.name===r.name}))?l.volumeMounts=l.volumeMounts.map((function(e){return e.name===r.name?r:e})):l.volumeMounts.push(r),l.volumeMounts=l.volumeMounts.filter((function(e){return"null"!==e.readOnly})).map((function(e){return(0,u.default)({},e,{readOnly:"true"===e.readOnly})}))}})),(0,g.default)(t.formTemplate,"".concat(t.prefix,"spec.containers"),a)},t.checkVolumeNameExist=function(e){var a=(0,v.default)(t.formTemplate,"".concat(t.prefix,"spec.volumes"),[]),n=(0,v.default)(t.formTemplate,"spec.volumeClaimTemplates",[]);return a.some((function(t){return t.name===e}))||n.some((function(t){return t.name===e}))},t.state={state:"",selectVolume:{},collectSavedLog:(0,v.default)(t.formTemplate,t.collectSavedLogPath)},t.store=new D.default,t.store.fetchList({namespace:t.namespace,limit:-1}),t.handleVolume=t.handleVolume.bind((0,p.default)(t)),t.handleVolumeTemplate=t.handleVolumeTemplate.bind((0,p.default)(t)),t.handleLogToggle=t.handleLogToggle.bind((0,p.default)(t)),t}return(0,h.default)(a,e),(0,c.default)(a,[{key:"componentWillReceiveProps",value:function(e){if(!(0,S.default)(e.formTemplate,this.props.formTemplate)){var t=e.formTemplate,a=e.module,n=(0,v.default)(t,T.MODULE_KIND_MAP[a],t);this.setState({collectSavedLog:(0,v.default)(n,this.collectSavedLogPath)})}}},{key:"handleVolume",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.updateVolumes(e),this.updateVolumeMounts(t),this.updateLogConfigs(t),this.resetState()}},{key:"handleVolumeTemplate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.updateVolumeTemplate(e),this.updateVolumeTemplateMounts(t),this.updateLogConfigs(t),this.resetState()}},{key:"renderVolume",value:function(){var e=this.state.collectSavedLog,t=this.store.list.data,a=this.store.list.isLoading,n=(0,v.default)(this.formTemplate,"".concat(this.prefix,"spec.containers"),[]);return b.default.createElement(x.default,{volumes:t,volume:this.selectVolume,namespace:this.namespace,module:this.props.module,containers:n,onSave:this.handleVolume,onCancel:this.resetState,isLoading:a,checkVolumeNameExist:this.checkVolumeNameExist,collectSavedLog:e})}},{key:"renderConfig",value:function(){var e,t=(0,v.default)(this.formTemplate,"".concat(this.prefix,"spec.containers"),[]);return b.default.createElement(I.default,(e={volume:this.selectVolume,containers:t,namespace:this.namespace},(0,o.default)(e,"containers",t),(0,o.default)(e,"onSave",this.handleVolume),(0,o.default)(e,"onCancel",this.resetState),(0,o.default)(e,"checkVolumeNameExist",this.checkVolumeNameExist),e))}},{key:"renderVolumeTemplate",value:function(){var e=this.state.collectSavedLog,t=(0,v.default)(this.formTemplate,"".concat(this.prefix,"spec.containers"),[]),a=(0,v.default)(this.formTemplate,"metadata.namespace","");return b.default.createElement(L.default,{volume:this.selectVolume,containers:t,namepsace:a,onSave:this.handleVolumeTemplate,onCancel:this.resetState,checkVolumeNameExist:this.checkVolumeNameExist,collectSavedLog:e})}},{key:"handleLogToggle",value:function(){var e=this;this.setState((function(e){return{collectSavedLog:"true"===e.collectSavedLog?"false":"true"}}),(function(){(0,g.default)(e.formTemplate,e.collectSavedLogPath,e.state.collectSavedLog),"false"===e.state.collectSavedLog&&(0,y.default)(e.formTemplate,e.logPathPrefix)}))}},{key:"renderToolTipContent",value:function(){return b.default.createElement("div",null,b.default.createElement("div",{className:"tooltip-title"},t("What is collecting file log ?")),b.default.createElement("p",null,t("COLLECT_FILE_LOG_TIP")))}},{key:"renderToggle",value:function(e){var t=this.state.collectSavedLog;return b.default.createElement("span",null,b.default.createElement(k.default,{disabled:e,checked:"true"===t,onChange:this.handleLogToggle}))}},{key:"renderTitle",value:function(){return b.default.createElement("div",{className:"font-bold margin-b8 relative"},b.default.createElement("span",null,t("Mount Volumes")),globals.app.hasKSModule("logging")&&b.default.createElement("div",{className:j.default.toggle},this.projectEnableCollectingFileLog?this.renderToggle():b.default.createElement(C.default,{content:t("PROJECT_COLLECT_SAVED_DISABLED_DESC")},this.renderToggle(!0)),b.default.createElement("span",{className:"text-secondary align-middle"}," ",t("Collecting file log")," "),b.default.createElement(C.default,{content:this.renderToolTipContent()},b.default.createElement(w.default,{name:"question"}))))}},{key:"renderList",value:function(){var e=this.props,a=e.formRef,n=e.formProps,l=void 0===n?{}:n,o=e.module,u=this.state.collectSavedLog,i=this.store.list.data,s=this.store.list.isLoading,d=(0,v.default)(this.formTemplate,"".concat(this.prefix,"spec.containers"),[]),c=0===(0,v.default)(this.formTemplate,"".concat(this.prefix,"spec.volumes"),[]).length&&0===(0,v.default)(this.formTemplate,"spec.volumeClaimTemplates",[]).length,f=(0,N.safeParseJSON)((0,v.default)(this.formTemplate,this.logPathPrefix,[])),m="statefulsets"===o;return b.default.createElement(R.default,(0,r.default)({data:this.formTemplate,ref:a},l),this.renderTitle(),"true"===u&&c&&b.default.createElement(M.default,{className:"margin-b12",icon:"information",type:"warning",title:t(m?"Please add at least one volume or volume template":"Please add at least one volume"),message:t("COLLECT_SAVED_LOG_DESC")}),b.default.createElement("div",{className:j.default.volumes},m&&b.default.createElement(R.default.Item,{label:t("Volume Templates")},b.default.createElement(A.default,{prefix:this.prefix,name:"spec.volumeClaimTemplates",containers:d,onShowAddVolume:this.showVolumeTemplate,onShowEdit:this.showEditVolumeTemplate,collectSavedLog:u,logPath:f})),b.default.createElement(R.default.Item,{label:t("Volumes")},b.default.createElement(O.default,{prefix:this.prefix,name:"".concat(this.prefix,"spec.volumes"),volumes:i,containers:d,loading:s,onShowVolume:this.showVolume,onShowConfig:this.showConfig,onShowEdit:this.showEditVolume,collectSavedLog:u,logPath:f}))))}},{key:"render",value:function(){var e=null;switch(this.state.state){case"ShowVolume":e=this.renderVolume();break;case"ShowConfig":e=this.renderConfig();break;case"ShowVolumeTemplate":e=this.renderVolumeTemplate();break;default:e=this.renderList()}return e}},{key:"prefix",get:function(){return this.props.prefix||"spec.template."}},{key:"namespace",get:function(){return this.props.namespace||(0,v.default)(this.formTemplate,"metadata.namespace","")}},{key:"collectSavedLogPath",get:function(){return"".concat(this.prefix,'metadata.annotations["kubesphere.io/collectSavedLog"]')}},{key:"logPathPrefix",get:function(){return"".concat(this.prefix,'metadata.annotations["logging.kubesphere.io/logsidecar-config"]')}},{key:"projectEnableCollectingFileLog",get:function(){return"enabled"===(0,v.default)(this.props.rootStore.project.data,'labels["logging.kubesphere.io/logsidecar-injection"]')}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,v.default)(t,T.MODULE_KIND_MAP[a],t)}},{key:"selectVolume",get:function(){return this.state.selectVolume}}]),a}(b.default.Component),F=V;a.Component=F;var U=(0,_.inject)("rootStore")((0,_.observer)(V));a.default=U},2565:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=l(n(22)),m=l(n(268)),p=n(60),h=n(49),v=n(114),g=n(938),y=l(n(386)),E=l(n(2453)),b=l(n(267)),_=(0,p.observer)(r=function(e){function a(){var e,n;(0,o.default)(this,a);for(var l=arguments.length,r=new Array(l),u=0;u<l;u++)r[u]=arguments[u];return(n=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(r)))).nameValidator=function(e,a,l){if(!a)return l();n.props.store.checkName({name:a,namespace:n.namespace}).then((function(a){if(a.exist)return l({message:t("Name exists"),field:e.field});l()}))},n.handleNameChange=(0,m.default)((function(e){var t=n.props,a=t.module,l=t.formTemplate,r=(0,f.default)(n.formTemplate,"metadata.labels",{});r.app=e,(0,h.updateLabels)(l,a,r)}),200),n}return(0,d.default)(a,e),(0,u.default)(a,[{key:"render",value:function(){var e=this.props,a=e.formRef,n=e.maxNameLength,l=void 0===n?253:n,r=253===l?t("LONG_NAME_DESC"):t("NAME_DESC");return c.default.createElement(b.default,{data:this.formTemplate,ref:a},c.default.createElement(g.Columns,null,c.default.createElement(g.Column,null,c.default.createElement(b.default.Item,{label:t("Name"),desc:r,rules:[{required:!0,message:t("Please input name")},{pattern:v.PATTERN_NAME,message:"".concat(t("Invalid name"),", ").concat(r)},this.nameLengthRules[l]||{},{validator:this.nameValidator}]},c.default.createElement(y.default,{name:"metadata.name",onChange:this.handleNameChange,autoFocus:!0}))),c.default.createElement(g.Column,null,c.default.createElement(b.default.Item,{label:t("Alias"),desc:t("ALIAS_DESC")},c.default.createElement(y.default,{name:"metadata.annotations['kubesphere.io/alias-name']"})))),c.default.createElement(g.Columns,null,c.default.createElement(g.Column,null,c.default.createElement(b.default.Item,{label:t("Description")},c.default.createElement(E.default,{name:"metadata.annotations['kubesphere.io/description']"}))),c.default.createElement(g.Column,null)))}},{key:"namespace",get:function(){return(0,f.default)(this.formTemplate,"metadata.namespace")}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,f.default)(t,v.MODULE_KIND_MAP[a],t)}},{key:"nameLengthRules",get:function(){return{63:{pattern:v.PATTERN_LENGTH_63,message:t("NAME_TOO_LONG")},253:{pattern:v.PATTERN_LENGTH_253,message:t("LONG_NAME_TOO_LONG")}}}}]),a}(c.default.Component))||r;a.default=_},2573:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.COORD_COUNT=t.renderIntoCanvas=t.createViewedBoundsFunc=t.formatDuration=t.formatRelativeDate=t.isErrorSpan=t.isServerSpan=t.isClientSpan=t.spanHasTag=t.transformTraces=t.transformTraceItem=void 0;var l=n(a(13)),r=n(a(14)),o=n(a(966)),u=n(a(131)),i=a(114),s=function(){function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];(0,l.default)(this,e),this.value=t,this.children=a}return(0,r.default)(e,null,[{key:"iterFunction",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(a){return e(a.value,a,t)}}},{key:"searchFunction",value:function(t){return"function"==typeof t?t:function(a,n){return t instanceof e?n===t:a===t}}}]),(0,r.default)(e,[{key:"addChild",value:function(t){return this.children.push(t instanceof e?t:new e(t)),this}},{key:"find",value:function(t){if(e.iterFunction(e.searchFunction(t))(this))return this;for(var a=0;a<this.children.length;a++){var n=this.children[a].find(t);if(n)return n}return null}},{key:"getPath",value:function(t){var a=e.iterFunction(e.searchFunction(t));return function e(t,n){var l=n.concat([t]);if(a(t))return l;for(var r=0;r<t.children.length;r++){var o=e(t.children[r],l);if(o)return o}return null}(this,[])}},{key:"walk",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=[],n=t;for(a.push({node:this,depth:n});a.length;){var l=a.pop(),r=l.node,o=l.depth;e(r.value,r,o),n=o+1;for(var u=r.children.length-1;u>=0;)a.push({node:r.children[u],depth:n}),u--}}},{key:"depth",get:function(){return this.children.reduce((function(e,t){return Math.max(t.depth+1,e)}),1)}},{key:"size",get:function(){var e=0;return this.walk((function(){return e++})),e}}]),e}(),d=function(e){var t=e.traceID;if(!t)return null;t=t.toLowerCase();var a=0,n=Number.MAX_SAFE_INTEGER,l=new Map,r=new Map;e.spans=e.spans.filter((function(e){return Boolean(e.startTime)}));for(var o=e.spans.length,u=0;u<o;u++){var i=e.spans[u],d=i.startTime,c=i.duration,f=i.processID,m=i.spanID;d<n&&(n=d),d+c>a&&(a=d+c);var p=l.get(m);null!=p?(l.set(m,p+1),m="".concat(m,"_").concat(p),i.spanID=m):l.set(m,1),i.process=e.processes[f],r.set(m,i)}var h=function(e){var t=new Map(e.spans.map((function(e){return[e.spanID,new s(e.spanID)]}))),a=new Map(e.spans.map((function(e){return[e.spanID,e]}))),n=new s("__root__");e.spans.forEach((function(e){var a=t.get(e.spanID);if(Array.isArray(e.references)&&e.references.length){var l=e.references[0],r=l.refType,o=l.spanID;if("CHILD_OF"!==r&&"FOLLOWS_FROM"!==r)throw new Error("Unrecognized ref type: ".concat(r));(t.get(o)||n).children.push(a)}else n.children.push(a)}));var l=function(e,t){var n=a.get(e.value),l=a.get(t.value);return+(n.startTime>l.startTime)||+(n.startTime===l.startTime)-1};return e.spans.forEach((function(e){var a=t.get(e.spanID);a.children.length>1&&a.children.sort(l)})),n.children.sort(l),n}(e),v=[],g={},y="";return h.walk((function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if("__root__"!==e){var l=r.get(e);if(l){var o=l.process.serviceName;g[o]=(g[o]||0)+1,l.references&&l.references.length||(y="".concat(o,": ").concat(l.operationName)),l.relativeStartTime=l.startTime-n,l.depth=a-1,l.hasChildren=t.children.length>0,l.references.forEach((function(e){var t=r.get(e.spanID);t&&(e.span=t)})),v.push(l)}}})),{services:Object.keys(g).map((function(e){return{name:e,numberOfSpans:g[e]}})),spans:v,traceID:t,traceName:y,processes:e.processes,duration:a-n,startTime:n,endTime:a}};t.transformTraceItem=d;t.transformTraces=function(e){var t=e.map(d),a=0,n=0,l={};return t.forEach((function(e){e.duration&&(a=Math.max(a,e.duration)),e.services.forEach((function(e){l[e.name]||(l[e.name]=i.TRACING_COLORS_HEX[n++])}))})),t.forEach((function(e){a&&(e.durationPercent=100*e.duration/a),e.serviceColorMap=l})),(0,o.default)(t,"startTime").reverse()};var c=function(e,t,a){return!(!Array.isArray(a.tags)||!a.tags.length)&&a.tags.some((function(a){return a.key===e&&a.value===t}))};t.spanHasTag=c;var f=c.bind(null,"span.kind","client");t.isClientSpan=f;var m=c.bind(null,"span.kind","server");t.isServerSpan=m;var p=c.bind(null,"error",!0),h=c.bind(null,"error","true");t.isErrorSpan=function(e){return p(e)||h(e)};t.formatRelativeDate=function(e,t){var a=u.default.isMoment(e)?e:(0,u.default)(e),n=t?"MMMM":"MMM",l=new Date;if(l.getFullYear()!==a.year())return a.format("".concat(n," D, YYYY"));var r=a.month(),o=a.date(),i=l.getDate();return r===l.getMonth()&&o===i?"Today":(l.setDate(i-1),r===l.getMonth()&&o===l.getDate()?"Yesterday":a.format("".concat(n," D")))};t.formatDuration=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"microseconds",a=e;"microseconds"===t&&(a=e/1e3);var n="ms";return a>=1e3&&(n="s",a/=1e3),a.toFixed(2)+n};t.createViewedBoundsFunc=function(e){var t=e.min,a=e.max,n=e.viewStart,l=e.viewEnd,r=a-t,o=t+n*r,u=a-(1-l)*r-o;return function(e,t){return{start:(e-o)/u,end:(t-o)/u}}};t.renderIntoCanvas=function(e,t,a,n){var l=new Map,r=(t.length<60?60:Math.min(t.length,200))-1,o=2*window.innerWidth;e.width=o,e.height=r;var u=Math.min(Math.max(2,(r-(1*t.length-1))/t.length),4),i=r/t.length,s=e.getContext("2d",{alpha:!1});s.fillStyle="#fff",s.fillRect(0,0,o,r);for(var d=0;d<t.length;d++){var c=t[d],f=c.valueWidth,m=c.valueOffset,p=c.serviceName,h=m/a*o,v=f/a*o;v<10&&(v=10);var g=l.get(p);g||(g="".concat(n(p)).concat("a0"),l.set(p,g)),s.fillStyle=g,s.fillRect(h,d*i,v,u)}};t.COORD_COUNT=4},2574:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(37)),o=l(n(82)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(66)),f=l(n(18)),m=l(n(2498)),p=l(n(22)),h=l(n(115)),v=l(n(566)),g=l(n(58)),y=l(n(2465)),E=l(n(569)),b=l(n(2462)),_=l(n(0)),S=n(49),k=n(114),C=l(n(2559)),w=l(n(2537)),N=l(n(267)),T=l(n(2811)),P=l(n(2669)),M=l(n(2667)),R=l(n(2787)),D=l(n(3475)),O=function(e){function a(e){var n;return(0,u.default)(this,a),(n=(0,s.default)(this,(0,d.default)(a).call(this,e))).getReplicas=function(){return(0,p.default)(n.formTemplate,"spec.replicas")||1},n.handleReplicaChange=function(e){n.setState({replicas:e})},n.showContainer=function(e){n.setState({showContainer:!0,selectContainer:e||{}})},n.hideContainer=function(){n.setState({showContainer:!1,selectContainer:{}})},n.updatePullSecrets=function(e){var t={},a={},l=n.containerSecretPath,r="".concat(n.prefix,"spec.imagePullSecrets"),o=(0,p.default)(e,"".concat(n.prefix,"spec.containers"),[]),u=(0,p.default)(e,"".concat(n.prefix,"spec.initContainers"),[]);(0,m.default)(o,u).forEach((function(e){e.pullSecret&&(t[e.pullSecret]="",a[e.name]=e.pullSecret)})),(0,g.default)(t)?((0,h.default)(e,r,null),(0,h.default)(e,l,null)):((0,h.default)(e,r,Object.keys(t).map((function(e){return{name:e}}))),(0,h.default)(e,l,JSON.stringify(a)))},n.updateService=function(e){var t=n.props,a=t.formTemplate,l=t.module,r=(0,p.default)(e,"".concat(n.prefix,"spec.containers"),[]),o=[];r.forEach((function(e){e.ports&&e.ports.forEach((function(e){e.servicePort&&o.push({name:e.name,protocol:e.protocol,port:e.servicePort,targetPort:e.containerPort})}))})),(0,h.default)(a,"Service.spec.ports",o);var u=(0,p.default)(e,"metadata.labels",{}),i=(0,p.default)(e,"".concat(n.prefix,"metadata.labels"),{});(0,h.default)(a,"Service.metadata.labels",u),(0,h.default)(a,"Service.spec.selector",i),"statefulsets"===l?(0,h.default)(a,"Service.spec.clusterIP","None"):(0,v.default)(a,"Service.spec.clusterIP")},n.handleDelete=function(){n.updatePullSecrets(n.formTemplate),n.props.withService&&n.updateService(n.formTemplate)},n.containersValidator=function(e,a,n){if((0,g.default)(a))return n({message:t("Please add at least one container")});n()},n.state={showContainer:!1,selectContainer:{},configMaps:[],secrets:[],replicas:n.getReplicas()},n.module=e.module,n.configMapStore=new C.default,n.secretStore=new w.default,n.handleContainer=n.handleContainer.bind((0,c.default)(n)),n}return(0,f.default)(a,e),(0,i.default)(a,[{key:"componentDidMount",value:function(){this.fetchData(),this.checkPullSecret(),this.props.withService&&this.initService(this.formTemplate)}},{key:"checkPullSecret",value:function(){var e=(0,p.default)(this.formTemplate,"".concat(this.prefix,"spec.containers"),[]),t=(0,p.default)(this.formTemplate,"".concat(this.prefix,"spec.initContainers"),[]),a=(0,S.safeParseJSON)((0,p.default)(this.formTemplate,this.containerSecretPath,""));(0,g.default)(a)||(0,m.default)(e,t).forEach((function(e){a[e.name]&&(e.pullSecret=a[e.name])}))}},{key:"initService",value:function(){var e=(0,p.default)(this.formTemplate,"metadata.name"),t=(0,p.default)(this.props.formTemplate,"Service.metadata.name");e&&!t&&(t="".concat(e,"-").concat((0,S.generateId)()),(0,h.default)(this.props.formTemplate,"Service.metadata.name",t),(0,h.default)(this.props.formTemplate,'Service.metadata.annotations["kubesphere.io/alias-name"]',e),(0,h.default)(this.props.formTemplate,'Service.metadata.annotations["kubesphere.io/serviceType"]',"statefulservice"),(0,h.default)(this.formTemplate,"spec.serviceName",t))}},{key:"fetchData",value:function(){var e=this,t=(0,p.default)(this.formTemplate,"metadata.namespace");Promise.all([this.configMapStore.fetchByK8s({namespace:t}),this.secretStore.fetchByK8s({namespace:t})]).then((function(t){var a=(0,o.default)(t,2),n=a[0],l=a[1];e.setState({configMaps:n,secrets:l})}))}},{key:"handleContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,E.default)(e,"resources.limits")&&(e.resources.limits=(0,y.default)(e.resources.limits,g.default)),e.type=e.type||"worker";var t=(0,p.default)(this.formTemplate,"".concat(this.prefix,"spec.containers"),[]).map((function(e){return(0,r.default)({},e,{type:"worker"})})),a=(0,p.default)(this.formTemplate,"".concat(this.prefix,"spec.initContainers"),[]).map((function(e){return(0,r.default)({},e,{type:"init"})})),n=(0,m.default)(t,a),l=n.find((function(t){return t.name===e.name}));(0,g.default)(l)?n.push(e):Object.assign(l,e);var o=(0,b.default)(n,"type");(0,h.default)(this.formTemplate,"".concat(this.prefix,"spec.containers"),o.worker),(0,h.default)(this.formTemplate,"".concat(this.prefix,"spec.initContainers"),o.init||[]),this.updatePullSecrets(this.formTemplate),this.props.withService&&this.updateService(this.formTemplate),this.hideContainer()}},{key:"renderContainerForm",value:function(e){var t=this.props.withService,a=this.state,n=a.configMaps,l=a.secrets,r=e.image?"Edit":"Add";return _.default.createElement(R.default,{type:r,module:this.module,namespace:this.namespace,data:e,onSave:this.handleContainer,onCancel:this.hideContainer,configMaps:n,secrets:l,withService:t})}},{key:"renderReplicasControl",value:function(){return"daemonsets"===this.module?null:_.default.createElement("div",{className:"margin-b12"},_.default.createElement(T.default,{module:this.module,replicas:this.state.replicas,template:this.formTemplate,onChange:this.handleReplicaChange}))}},{key:"renderContainerList",value:function(){var e=(0,p.default)(this.formTemplate,"".concat(this.prefix,"spec.initContainers"),[]);return _.default.createElement(N.default.Item,{label:t("Container Image"),rules:[{validator:this.containersValidator}]},_.default.createElement(M.default,{name:"".concat(this.prefix,"spec.containers"),onShow:this.showContainer,onDelete:this.handleDelete,initContainers:e}))}},{key:"renderUpdateStrategy",value:function(){var e=this.props,t=e.formRef,a=e.module,n=this.state.replicas;return _.default.createElement("div",{className:"margin-t12"},_.default.createElement(P.default,{formRef:t,module:a,data:this.formTemplate,replicas:n}))}},{key:"renderPodSecurityContext",value:function(){return _.default.createElement("div",{className:"margin-t12"},_.default.createElement(D.default,{prefix:"".concat(this.prefix,"spec.securityContext")}))}},{key:"render",value:function(){var e=this.props.formRef,t=this.state,a=t.showContainer,n=t.selectContainer;return a?this.renderContainerForm(n):_.default.createElement(N.default,{data:this.formTemplate,ref:e},this.renderReplicasControl(),this.renderContainerList(),this.renderUpdateStrategy(),this.renderPodSecurityContext())}},{key:"prefix",get:function(){return this.props.prefix||"spec.template."}},{key:"namespace",get:function(){return(0,p.default)(this.formTemplate,"metadata.namespace")}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,p.default)(t,k.MODULE_KIND_MAP[a],t)}},{key:"containerSecretPath",get:function(){return"".concat(this.prefix,'metadata.annotations["kubesphere.io/containerSecrets"]')}}]),a}(_.default.Component);a.default=O},2590:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(30)),o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=n(1),m=l(n(3)),p=l(n(38)),h=l(n(3398)),v=function(e){function a(){var e,t;(0,o.default)(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(t=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(l)))).state={show:!1},t.toggle=function(){t.setState((function(e){return{show:!e.show}}))},t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"render",value:function(){var e=this.props,a=e.label,n=e.children,l=this.state.show;return c.default.createElement(c.default.Fragment,null,c.default.createElement("div",{className:h.default.toggle,onClick:this.toggle},c.default.createElement("a",null,c.default.createElement("span",{className:"align-middle"},t(a)," "),c.default.createElement(p.default,{name:l?"chevron-up":"chevron-down"}))),c.default.createElement("div",{className:(0,m.default)((0,r.default)({},h.default.children,!l))},n))}}]),a}(c.default.Component);a.default=v,v.propTypes={label:f.PropTypes.string},v.defaultProps={label:"Advanced Settings"}},2608:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r,o,u,i,s,d,c,f=n(a(30)),m=n(a(37)),p=n(a(82)),h=n(a(61)),v=n(a(63)),g=n(a(62)),y=n(a(44)),E=n(a(13)),b=n(a(14)),_=n(a(41)),S=(n(a(45)),n(a(22))),k=n(a(115)),C=n(a(58)),w=n(a(979)),N=n(a(950)),T=n(a(2472)),P=a(19),M=a(49),R=a(114),D=a(2573),O=n(a(270)),x=n(a(947)),I=n(a(2556)),A=n(a(2632)),L=n(a(961)),j=n(a(957)),V=(l=function(){function e(){var t=this;(0,E.default)(this,e),this.list=new j.default,(0,y.default)(this,"components",r,this),(0,y.default)(this,"isTracingLoading",o,this),this.tracing={data:[],total:0},this.graph={data:{},health:{}},(0,y.default)(this,"detail",u,this),(0,y.default)(this,"isLoading",i,this),(0,y.default)(this,"isSubmitting",s,this),(0,y.default)(this,"env",d,this),(0,y.default)(this,"submitting",c,this),this.getResourceUrl=function(e){var t=e.namespace;return"kapis/resources.kubesphere.io/v1alpha2/namespaces/".concat(t,"/applications")},this.getListUrl=function(e){var t=e.namespace;return"apis/app.k8s.io/v1beta1/namespaces/".concat(t,"/applications")},this.getDetailUrl=function(e){var a=e.name,n=e.namespace;return"".concat(t.getListUrl({namespace:n}),"/").concat(a)},this.getGraphUrl=function(e){var t=e.namespace;return"kapis/servicemesh.kubesphere.io/v1alpha2/namespaces/".concat(t,"/graph?duration=60s&graphType=versionedApp&injectServiceNodes=true&groupBy=app&appenders=deadNode,sidecarsCheck,serviceEntry,istio,responseTime")},this.getHealthUrl=function(e){var t=e.namespace,a=e.type;return"kapis/servicemesh.kubesphere.io/v1alpha2/namespaces/".concat(t,"/health?rateInterval=60s&type=").concat(a)},this.serviceStore=new x.default,this.routerStore=new I.default,this.grayReleaseStore=new A.default,this.podStore=new L.default}var t,a,n,l,_;return(0,b.default)(e,[{key:"fetchList",value:(_=(0,g.default)(h.default.mark((function e(){var t,a,n,l,r,o,u,i,s,d=arguments;return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.length>0&&void 0!==d[0]?d[0]:{},a=t.limit,n=t.page,l=t.order,r=t.reverse,o=t.namespace,t.runtime_id,t.workspace,u=(0,v.default)(t,["limit","page","order","reverse","namespace","runtime_id","workspace"]),this.list.isLoading=!0,i={},l||void 0!==r||(l="createTime",r=!0),(0,C.default)(u)||(i.conditions=(0,M.getFilterString)(u)),a!==1/0&&(i.paging="limit=".concat(a||10,",page=").concat(n||1)),l&&(i.orderBy=l),r&&(i.reverse=!0),e.next=10,request.get(this.getResourceUrl({namespace:o}),i);case 10:s=e.sent,this.list.update({data:(0,S.default)(s,"items",[]).map(O.default.applications),total:s.total_count||0,limit:Number(a)||10,page:Number(n)||1,order:l,reverse:r,filters:u,isLoading:!1,selectedRowKeys:[]});case 12:case"end":return e.stop()}}),e,this)}))),function(){return _.apply(this,arguments)})},{key:"fetchDetail",value:(l=(0,g.default)(h.default.mark((function e(){var t,a,n,l,r=arguments;return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:{},a=t.name,n=t.namespace,this.isLoading=!0,e.next=4,request.get(this.getDetailUrl({name:a,namespace:n}));case 4:l=e.sent,this.detail=O.default.applications(l),this.isLoading=!1;case 7:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"fetchComponents",value:(n=(0,g.default)(h.default.mark((function e(t){var a,n,l,r;return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.components.isLoading=!0,e.next=3,Promise.all([this.serviceStore.fetchListByK8s(t),this.podStore.fetchListByK8s(t),this.grayReleaseStore.fetchList(t)]);case 3:a=this.serviceStore.list.data,n=this.podStore.list.data,l=this.grayReleaseStore.list.data,a&&(r=(0,N.default)(a,"name"),n&&n.forEach((function(e){var t=e.labels.app;t&&r[t]&&(r[t].podNums=r[t].podNums||0,r[t].podNums+=1)})),l&&l.forEach((function(e){var t=e.labels.app;t&&r[t]&&(r[t].grayRelease={newVersion:e.newVersion,oldVersion:e.oldVersion})})),this.components.data=a,this.components.total=a.length),this.components.isLoading=!1;case 8:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"fetchGraph",value:(a=(0,g.default)(h.default.mark((function e(){var t,a,n,l,r,o,u,i,s,d,c,v,g=arguments;return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g.length>0&&void 0!==g[0]?g[0]:{},a=t.namespace,n=t.selector,e.next=3,Promise.all([request.get("api/v1/namespaces/".concat(a,"/services"),{labelSelector:(0,M.joinSelector)(n)}),request.get(this.getGraphUrl({namespace:a})),request.get(this.getHealthUrl({namespace:a,type:"app"})),request.get(this.getHealthUrl({namespace:a,type:"service"})),request.get(this.getHealthUrl({namespace:a,type:"workload"}))]);case 3:l=e.sent,r=(0,p.default)(l,5),o=r[0],u=r[1],i=r[2],s=r[3],d=r[4],c=o&&o.items?o.items.map((function(e){return(0,S.default)(e,"metadata.name")})):[],u&&u.elements&&(v=[],u.elements.nodes.forEach((function(e){c.includes(e.data.app)&&v.push(e),e.data.isRoot&&e.data.namespace!==a&&(e.data.targetNamespace=a,v.push(e))})),this.graph.data={nodes:v,edges:u.elements.edges}),i&&s&&d&&(this.graph.health=c.reduce((function(e,t){return(0,m.default)({},e,(0,f.default)({},t,(0,m.default)({},i[t],{service:s[t],workloads:(0,w.default)(d,(function(e,a){return a.split("-")[0]===t}))})))}),{}));case 13:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"fetchAppMetrics",value:function(e){var t=e.name,a=e.namespace,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=Math.floor((new Date).getTime()/1e3),r=(0,m.default)({queryTime:l,duration:60,step:20,rateInterval:"20s","filters[]":["request_count","request_duration","request_error_count","tcp_sent","tcp_received"],"quantiles[]":[.95],direction:"inbound",reporter:"destination"},n);return request.get("kapis/servicemesh.kubesphere.io/v1alpha2/namespaces/".concat(a,"/apps/").concat(t,"/metrics"),r)}},{key:"fetchServiceMetrics",value:function(e){var t=e.name,a=e.namespace,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=Math.floor((new Date).getTime()/1e3),r=(0,m.default)({queryTime:l,duration:60,step:20,rateInterval:"20s","filters[]":["request_count","request_duration","request_error_count"],"quantiles[]":[.95],direction:"inbound",reporter:"destination",requestProtocol:"http"},n);return request.get("kapis/servicemesh.kubesphere.io/v1alpha2/namespaces/".concat(a,"/services/").concat(t,"/metrics"),r)}},{key:"fetchWorkloadMetrics",value:function(e){var t=e.name,a=e.namespace,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=(0,m.default)({duration:60,step:20,rateInterval:"20s","quantiles[]":[.95],direction:"inbound",reporter:"source",requestProtocol:"http"},n);return request.get("kapis/servicemesh.kubesphere.io/v1alpha2/namespaces/".concat(a,"/workloads/").concat(t,"/metrics"),l)}},{key:"fetchTracing",value:(t=(0,g.default)(h.default.mark((function e(t){var a,n,l,r,o,u;return h.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.service,n=t.namespace,l=(0,v.default)(t,["service","namespace"]),this.isTracingLoading=!0,r=(0,m.default)({limit:5,lookback:"2d"},l),o=(new Date).getTime(),r.start=r.start||"".concat(o-R.TIME_MICROSECOND_MAP[r.lookback],"000"),r.end=r.end||"".concat(o,"000"),e.prev=6,e.next=9,request.get("kapis/servicemesh.kubesphere.io/v1alpha2/namespaces/".concat(n,"/services/").concat(a,"/traces"),r);case 9:(u=e.sent)&&u.data&&(this.tracing.data=(0,D.transformTraces)(u.data)),e.next=15;break;case 13:e.prev=13,e.t0=e.catch(6);case 15:this.isTracingLoading=!1;case 16:case"end":return e.stop()}}),e,this,[[6,13]])}))),function(e){return t.apply(this,arguments)})},{key:"setSelectRowKeys",value:function(e){this.list.selectedRowKeys.replace(e)}},{key:"create",value:function(e){var t=e.application,a=e.ingress,n=(0,v.default)(e,["application","ingress"]),l=(0,S.default)(t,"metadata.namespace");if(l){var r="true"===(0,S.default)(t,'metadata.annotations["servicemesh.kubesphere.io/enabled"]'),o=[{url:this.getListUrl({namespace:l}),data:t}];if((0,S.default)(a,"spec.rules",[]).length>0){var u=(0,S.default)(t,"metadata.name");if((0,S.default)(a,"metadata.name")||(0,k.default)(a,"metadata.name","".concat(u,"-ingress-").concat((0,M.generateId)())),r){var i=(0,S.default)(a,"spec.rules[0].http.paths[0].backend.serviceName");i&&(0,k.default)(a,'metadata.annotations["nginx.ingress.kubernetes.io/upstream-vhost"]',"".concat(i,".").concat(l,".svc.cluster.local"))}o.push({url:"apis/extensions/v1beta1/namespaces/".concat(l,"/ingresses"),data:a})}return Object.values(n).forEach((function(e){if(e.workload&&e.service){var t=(0,T.default)(R.MODULE_KIND_MAP,(function(t){return t===e.workload.kind}))||"deployments";o.push({url:"apis/apps/v1/namespaces/".concat(l,"/").concat(t),data:e.workload},{url:"api/v1/namespaces/".concat(l,"/services"),data:e.service})}})),this.submitting((0,M.withDryRun)(o))}}},{key:"addComponent",value:function(e,t){var a=t.namespace,n=[];if(a){if(e.workload&&e.service){var l=(0,T.default)(R.MODULE_KIND_MAP,(function(t){return t===e.workload.kind}))||"deployments";n.push({url:"apis/apps/v1/namespaces/".concat(a,"/").concat(l),data:e.workload},{url:"api/v1/namespaces/".concat(a,"/services"),data:e.service})}return this.submitting((0,M.withDryRun)(n))}}},{key:"patch",value:function(e,t){var a=e.namespace,n=e.name;return this.submitting(request.patch(this.getDetailUrl({name:n,namespace:a}),t))}},{key:"delete",value:function(e){var t=e.name,a=e.namespace;return this.submitting(request.delete(this.getDetailUrl({name:t,namespace:a})))}},{key:"checkName",value:function(e){var t=e.name,a=e.namespace;return request.get(this.getDetailUrl({name:t,namespace:a}),{},{headers:{"x-check-exist":!0}})}},{key:"fetchSampleData",value:function(e){return request.get("sample/".concat(e))}}]),e}(),r=(0,_.default)(l.prototype,"components",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:[],total:0,isLoading:!0}}}),o=(0,_.default)(l.prototype,"isTracingLoading",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),u=(0,_.default)(l.prototype,"detail",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),i=(0,_.default)(l.prototype,"isLoading",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=(0,_.default)(l.prototype,"isSubmitting",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=(0,_.default)(l.prototype,"env",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:{},isLoading:!1}}}),c=(0,_.default)(l.prototype,"submitting",[P.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){return e.isSubmitting=!0,setTimeout((function(){t.finally((function(){e.isSubmitting=!1}))}),500),t}}}),(0,_.default)(l.prototype,"fetchList",[P.action],Object.getOwnPropertyDescriptor(l.prototype,"fetchList"),l.prototype),(0,_.default)(l.prototype,"fetchDetail",[P.action],Object.getOwnPropertyDescriptor(l.prototype,"fetchDetail"),l.prototype),(0,_.default)(l.prototype,"fetchComponents",[P.action],Object.getOwnPropertyDescriptor(l.prototype,"fetchComponents"),l.prototype),(0,_.default)(l.prototype,"fetchGraph",[P.action],Object.getOwnPropertyDescriptor(l.prototype,"fetchGraph"),l.prototype),(0,_.default)(l.prototype,"fetchAppMetrics",[P.action],Object.getOwnPropertyDescriptor(l.prototype,"fetchAppMetrics"),l.prototype),(0,_.default)(l.prototype,"fetchServiceMetrics",[P.action],Object.getOwnPropertyDescriptor(l.prototype,"fetchServiceMetrics"),l.prototype),(0,_.default)(l.prototype,"fetchWorkloadMetrics",[P.action],Object.getOwnPropertyDescriptor(l.prototype,"fetchWorkloadMetrics"),l.prototype),(0,_.default)(l.prototype,"fetchTracing",[P.action],Object.getOwnPropertyDescriptor(l.prototype,"fetchTracing"),l.prototype),(0,_.default)(l.prototype,"setSelectRowKeys",[P.action],Object.getOwnPropertyDescriptor(l.prototype,"setSelectRowKeys"),l.prototype),(0,_.default)(l.prototype,"create",[P.action],Object.getOwnPropertyDescriptor(l.prototype,"create"),l.prototype),(0,_.default)(l.prototype,"addComponent",[P.action],Object.getOwnPropertyDescriptor(l.prototype,"addComponent"),l.prototype),(0,_.default)(l.prototype,"patch",[P.action],Object.getOwnPropertyDescriptor(l.prototype,"patch"),l.prototype),(0,_.default)(l.prototype,"delete",[P.action],Object.getOwnPropertyDescriptor(l.prototype,"delete"),l.prototype),(0,_.default)(l.prototype,"checkName",[P.action],Object.getOwnPropertyDescriptor(l.prototype,"checkName"),l.prototype),(0,_.default)(l.prototype,"fetchSampleData",[P.action],Object.getOwnPropertyDescriptor(l.prototype,"fetchSampleData"),l.prototype),l);t.default=V},2609:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(97)),r=n(a(37)),o=n(a(63)),u=n(a(13)),i=n(a(14)),s=n(a(17)),d=n(a(16)),c=n(a(18)),f=n(a(0)),m=n(a(1)),p=n(a(3422)),h=function(e){function t(){var e,a;(0,u.default)(this,t);for(var n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return(a=(0,s.default)(this,(e=(0,d.default)(t)).call.apply(e,[this].concat(i)))).getReadOny=function(e){return"true"===e||"null"===e?e:"false"},a.getFormatValue=function(){var e=a.props,t=e.value;return e.containers.map((function(e){var n=t.find((function(t){return t.containerName===e.name}));if(!n)return{readOnly:"null",mountPath:""};n.containerName;var l=n.readOnly,u=(0,o.default)(n,["containerName","readOnly"]);return(0,r.default)({},u,{readOnly:a.getReadOny(String(l))})}))},a.handleItemChange=function(e,t){var n=a.props,o=n.value,u=n.onChange,i=o.find((function(t){return t.containerName===e}));u(i?o.map((function(a){return a.containerName===e?(0,r.default)({},i,t):a})):[].concat((0,l.default)(o),[t]))},a}return(0,c.default)(t,e),(0,i.default)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.containers,n=t.collectSavedLog,l=this.getFormatValue();return f.default.createElement("div",null,a.map((function(t,a){return f.default.createElement(p.default,{key:t.name,value:l[a],container:t.name,onChange:e.handleItemChange.bind(e,t.name),collectSavedLog:n})})))}}]),t}(f.default.Component);t.default=h,h.propTypes={name:m.default.string,containers:m.default.array,value:m.default.array,onChange:m.default.func},h.defaultProps={name:"",value:[],containers:[],onChange:function(){}}},2610:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(22)),f=n(114),m=l(n(267)),p=l(n(3476)),h=l(n(3477)),v=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props,a=e.formRef,n=e.store,l=e.module;return d.default.createElement(m.default,{data:this.formTemplate,ref:a},"daemonsets"!==l&&d.default.createElement(m.default.Group,{label:t("Setting node schedule policy"),desc:t("Running pods on the specified nodes"),keepDataWhenUnCheck:!0,checkable:!0},d.default.createElement(h.default,{prefix:this.props.prefix,namespace:this.namespace,formTemplate:this.formTemplate})),d.default.createElement(m.default.Group,{label:t("Add metadata"),desc:t("Additional metadata settings for resources such as Label and Annotation"),keepDataWhenUnCheck:!0,checkable:!0},d.default.createElement(p.default,{store:n,namespace:this.namespace,formTemplate:this.formTemplate})))}},{key:"namespace",get:function(){return(0,c.default)(this.formTemplate,"metadata.namespace")}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,c.default)(t,f.MODULE_KIND_MAP[a],t)}}]),a}(d.default.Component);a.default=v},2611:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.Component=a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=n(19),f=n(60),m=l(n(58)),p=l(n(22)),h=l(n(572)),v=l(n(973)),g=l(n(2630)),y=l(n(2634)),E=l(n(2588)),b=l(n(2601)),_=l(n(3598)),S=l(n(3600)),k=l(n(3602)),C=l(n(3607)),w=l(n(3613)),N=function(e){function a(e){var t;return(0,r.default)(this,a),(t=(0,u.default)(this,(0,i.default)(a).call(this,e))).fetchData=function(){var e=t.store.detail,a=e.namespace,n=e.name;if("deployments"===t.module){var l=t.store.detail.annotations,r={namespace:a,name:(void 0===l?{}:l)["kubesphere.io/relatedHPA"]||n};t.hpaStore.checkName(r).then((function(e){e.exist&&t.hpaStore.fetchDetail(r)}))}},t.handleScale=function(e){var a=t.store.detail,n=a.namespace,l=a.name;t.store.scale({name:l,namespace:n},e)},t.handlePodUpdate=function(){var e=t.store.detail,a=e.namespace,n=e.name;t.store.fetchDetail({namespace:a,name:n,silent:!0},!1)},t.handleDeleteHpa=function(){t.store.patch(t.store.detail,{metadata:{annotations:{"kubesphere.io/relatedHPA":null}}}).then((function(){t.hpaStore.reset()}))},t.renderS2IBuilder=function(){var e=t.props.match.params.namespace,a=t.store.detail;return(0,m.default)(a.builderNames)?null:d.default.createElement(C.default,{builderNames:a.builderNames,namespace:e,className:w.default.deployment_codeResource})},t.resourceStore=e.resourceStore||new y.default(t.module),t.hpaStore=e.hpaStore||new g.default,t.state={},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"renderReplicaInfo",value:function(){var e=(0,c.toJS)(this.store.detail);return d.default.createElement(k.default,{module:this.module,detail:e,onScale:this.handleScale,enableScale:this.enableScaleReplica})}},{key:"renderHpaConfig",value:function(){var e=(0,c.toJS)(this.hpaStore.detail);return e.name?d.default.createElement(S.default,{store:this.hpaStore,detail:e,loading:this.hpaStore.isLoading,onDeleted:this.handleDeleteHpa}):null}},{key:"renderContainerPorts",value:function(){var e=this.store.isLoading,t=(0,c.toJS)(this.store.detail).containers,a=void 0===t?[]:t,n=(0,v.default)((0,h.default)(a.map((function(e){return(0,m.default)(e.ports)?[]:e.ports}))),"name");return(0,m.default)(n)?null:d.default.createElement(_.default,{ports:n,loading:e})}},{key:"renderPods",value:function(){var e=this.props.match.params,t=void 0===e?{}:e,a=t.namespace,n=t.name;return d.default.createElement(E.default,{prefix:"/projects/".concat(a,"/").concat(this.module,"/").concat(n),detail:this.store.detail,onUpdate:this.handlePodUpdate})}},{key:"renderVolumes",value:function(){var e=this.store.isLoading,t=(0,c.toJS)(this.store.detail),a=t.volumes,n=t.containers,l=this.props.match.params.namespace;return(0,m.default)(a)?null:d.default.createElement(b.default,{title:this.volumesTitle,volumes:a,containers:n,loading:e,prefix:"/projects/".concat(l)})}},{key:"renderContent",value:function(){return d.default.createElement("div",null,this.renderReplicaInfo(),this.renderHpaConfig(),this.renderContainerPorts(),this.renderS2IBuilder(),this.renderPods(),this.renderVolumes())}},{key:"render",value:function(){return d.default.createElement("div",{className:w.default.main},this.renderContent())}},{key:"module",get:function(){return this.props.module}},{key:"store",get:function(){return this.props.detailStore}},{key:"enabledActions",get:function(){return globals.app.getActions({module:this.module,project:this.props.match.params.namespace})}},{key:"volumesTitle",get:function(){return t("Storage Device")}},{key:"enableScaleReplica",get:function(){return this.enabledActions.includes("edit")&&!(0,p.default)(this.hpaStore.detail,"name")}}]),a}(d.default.Component),T=(0,f.observer)(N);a.default=T;var P=N;a.Component=P},2632:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r,o,u=n(a(30)),i=n(a(37)),s=n(a(61)),d=n(a(63)),c=n(a(62)),f=n(a(44)),m=n(a(13)),p=n(a(14)),h=n(a(17)),v=n(a(16)),g=n(a(66)),y=n(a(18)),E=n(a(41)),b=(n(a(45)),n(a(22))),_=n(a(115)),S=n(a(569)),k=n(a(58)),C=n(a(2462)),w=n(a(2472)),N=a(19),T=a(49),P=a(114),M=n(a(270)),R=(l=function(e){function t(){var e;return(0,m.default)(this,t),e=(0,h.default)(this,(0,v.default)(t).call(this)),(0,f.default)(e,"isComponentsLoading",r,(0,g.default)(e)),(0,f.default)(e,"components",o,(0,g.default)(e)),e.module="strategies",e}var a,n;return(0,y.default)(t,e),(0,p.default)(t,[{key:"fetchList",value:(n=(0,c.default)(s.default.mark((function e(t){var a,n,l,r,o;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.namespace,n=t.selector,l=(0,d.default)(t,["namespace","selector"]),this.list.isLoading=!0,a){e.next=5;break}return this.list.isLoading=!1,e.abrupt("return");case 5:return r=l,(0,k.default)(n)||(r.labelSelector=(0,T.joinSelector)(n)),e.next=9,request.get(this.getListUrl({namespace:a}),r);case 9:o=e.sent,this.list.update({data:o.items.map(this.mapper),total:o.items.length,isLoading:!1});case 11:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"fetchMetrics",value:function(e){var t=e.namespace,a=e.hosts,n=e.newVersion,l=e.oldVersion,r=e.protocol,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=Math.floor((new Date).getTime()/1e3),s=(0,i.default)({queryTime:u,duration:300,step:30,rateInterval:"30s","filters[]":["request_count","request_duration","request_error_count","tcp_sent","tcp_received"],"quantiles[]":[.95],direction:"inbound",reporter:"destination"},o);return"http"===r&&(s.requestProtocol="http"),Promise.all([request.get("kapis/servicemesh.kubesphere.io/v1alpha2/namespaces/".concat(t,"/workloads/").concat(a,"-").concat(n,"/metrics"),s),request.get("kapis/servicemesh.kubesphere.io/v1alpha2/namespaces/".concat(t,"/workloads/").concat(a,"-").concat(l,"/metrics"),s)])}},{key:"fetchHealth",value:function(e){var t=e.namespace,a=e.hosts,n=e.newVersion,l=e.oldVersion,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=(0,i.default)({rateInterval:"30s"},r);return Promise.all([request.get("kapis/servicemesh.kubesphere.io/v1alpha2/namespaces/".concat(t,"/workloads/").concat(a,"-").concat(n,"/health"),o),request.get("kapis/servicemesh.kubesphere.io/v1alpha2/namespaces/".concat(t,"/workloads/").concat(a,"-").concat(l,"/health"),o)])}},{key:"fetchComponents",value:(a=(0,c.default)(s.default.mark((function e(t){var a,n,l,r,o,i,c,f,m,p,h,v,g,y;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.namespace,l=t.labelSelector,r=t.newVersion,o=t.oldVersion,i=t.service,c=t.silent,f=(0,d.default)(t,["namespace","labelSelector","newVersion","oldVersion","service","silent"]),!c&&(this.isComponentsLoading=!0),n){e.next=5;break}return this.isComponentsLoading=!1,e.abrupt("return");case 5:return m=f,(0,k.default)(l)||(m.labelSelector=l),e.next=9,request.get("api/v1/namespaces/".concat(n,"/pods"),m);case 9:p=e.sent,h=p.items.map(M.default.pods),v=(0,C.default)(h,"labels.version"),g=v[r]||[],y=v[o]||[],this.components.data=(a={},(0,u.default)(a,r,{name:i,version:r,pods:g,desire:g.length,available:g.filter((function(e){return"Running"===e.status.phase})).length}),(0,u.default)(a,o,{name:i,version:o,pods:y,desire:y.length,available:y.filter((function(e){return"Running"===e.status.phase})).length}),a),this.isComponentsLoading=!1;case 16:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"create",value:function(e,t){var a,n=t.namespace;if((0,S.default)(e,"strategy")&&(a=request.post(this.getListUrl({namespace:n}),e.strategy)),(0,S.default)(e,"workload")){var l=(0,b.default)(e,"workload.kind","Deployment"),r=(0,w.default)(P.MODULE_KIND_MAP,(function(e){return e===l}))||"deployments";a.then(request.post("apis/apps/v1/namespaces/".concat(n,"/").concat(r),e.workload))}return this.submitting(a)}},{key:"update",value:function(e,t){var a=e.name,n=e.namespace,l=e.hosts,r=e.newVersion,o=e.resourceVersion,u=[],i="";if((0,S.default)(t,"workload")){var s=(0,b.default)(t,"workload.kind","Deployment"),d=(0,w.default)(P.MODULE_KIND_MAP,(function(e){return e===s}))||"deployments";if((i=(0,b.default)(t.workload,"metadata.labels.version"))===r){var c=(0,b.default)(t.workload,"metadata.name");u.push(request.put("apis/apps/v1/namespaces/".concat(n,"/").concat(d,"/").concat(c),t.workload))}else u.push(request.delete("apis/apps/v1/namespaces/".concat(n,"/").concat(d,"/").concat(l,"-").concat(r)),request.post("apis/apps/v1/namespaces/".concat(n,"/").concat(d),t.workload))}if((0,S.default)(t,"strategy")){if((0,_.default)(t.strategy,"metadata.resourceVersion",o),i&&i!==r)(0,b.default)(t.strategy,"spec.governor")===r&&(0,_.default)(t.strategy,"spec.governor",i),((0,b.default)(t.strategy,"spec.template.spec.http")||(0,b.default)(t.strategy,"spec.template.spec.tcp",[])).forEach((function(e){e.route&&e.route.length>0&&e.route.forEach((function(e){(0,b.default)(e,"destination.subset")===r&&(0,_.default)(e,"destination.subset",i)})),e.mirror&&e.mirror.subset===r&&(e.mirror.subset=i)}));u.push(request.put(this.getDetailUrl({name:a,namespace:n}),t.strategy))}return this.submitting(Promise.all(u))}},{key:"apiVersion",get:function(){return"apis/servicemesh.kubesphere.io/v1alpha2"}}]),t}(n(a(228)).default),r=(0,E.default)(l.prototype,"isComponentsLoading",[N.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),o=(0,E.default)(l.prototype,"components",[N.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:{}}}}),(0,E.default)(l.prototype,"fetchList",[N.action],Object.getOwnPropertyDescriptor(l.prototype,"fetchList"),l.prototype),(0,E.default)(l.prototype,"fetchMetrics",[N.action],Object.getOwnPropertyDescriptor(l.prototype,"fetchMetrics"),l.prototype),(0,E.default)(l.prototype,"fetchHealth",[N.action],Object.getOwnPropertyDescriptor(l.prototype,"fetchHealth"),l.prototype),(0,E.default)(l.prototype,"fetchComponents",[N.action],Object.getOwnPropertyDescriptor(l.prototype,"fetchComponents"),l.prototype),(0,E.default)(l.prototype,"create",[N.action],Object.getOwnPropertyDescriptor(l.prototype,"create"),l.prototype),(0,E.default)(l.prototype,"update",[N.action],Object.getOwnPropertyDescriptor(l.prototype,"update"),l.prototype),l);t.default=R},2633:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(30)),o=l(n(61)),u=l(n(62)),i=l(n(13)),s=l(n(14)),d=l(n(17)),c=l(n(16)),f=l(n(18)),m=l(n(0)),p=l(n(1)),h=l(n(22)),v=l(n(115)),g=l(n(3)),y=l(n(386)),E=l(n(225)),b=l(n(942)),_=l(n(129)),S=l(n(267)),k=n(49),C=l(n(2537)),w=l(n(948)),N=l(n(2817)),T=l(n(2590)),P=l(n(2818)),M=l(n(3495)),R=function(e){function a(e){var n;return(0,i.default)(this,a),(n=(0,d.default)(this,(0,c.default)(a).call(this,e))).fetchData=(0,u.default)(o.default.mark((function e(){var t,a;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.secretStore.fetchByK8s({namespace:n.namespace,fieldSelector:"type=kubernetes.io/basic-auth"});case 2:t=e.sent,a=t.map((function(e){return{label:(0,k.getDisplayName)(e),value:e.name,type:"basic-auth"}})),n.setState({basicSecretOptions:a});case 5:case"end":return e.stop()}}),e)}))),n.fetchImageSecrets=(0,u.default)(o.default.mark((function e(){var t,a;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.secretStore.fetchByK8s({namespace:n.namespace,fieldSelector:"type=kubernetes.io/dockerconfigjson"});case 2:t=e.sent,a=t.map((function(e){var t=(0,h.default)(e,'data[".dockerconfigjson"].auths',{}),a=Object.keys(t)[0]||"";return{label:(0,k.getDisplayName)(e),value:e.name,repoUrl:a,type:"dockerconfigjson"}})),n.setState({imageSecretOptions:a});case 5:case"end":return e.stop()}}),e)}))),n.getTemplateList=(0,u.default)(o.default.mark((function e(){var t;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isGetTemplateListLoading:!0}),e.next=3,n.builderStore.getBuilderTemplate();case 3:t=e.sent,n.setState({builderTemplateLists:(0,h.default)(t,"items",[]),isGetTemplateListLoading:!1});case 5:case"end":return e.stop()}}),e)}))),n.handleImageTemplateChange=function(e){var t=e.environment,a=e.docUrl,l=(0,h.default)(globals,"user.lang","zh"),r=(t||[]).map((function(e){var t=(e.description||"").split(". "),a="zh"===l?(0,h.default)(t,"1",e.description):(0,h.default)(t,"0",e.description);return e.label="".concat(e.key,"  (").concat(a,")"),e.value=e.key,e}));n.setState({environment:r,docUrl:a})},n.handleSecretChange=function(){n.handleRepoReadableCheck()},n.handleImageSecretChange=function(e,t){var a=n.props.formTemplate,l=(0,h.default)(t,"[0]repoUrl","");(0,v.default)(a,"".concat(n.prefix,'metadata.annotations["kubesphere.io/repoUrl"]'),l)},n.handleRepoReadableCheck=(0,u.default)(o.default.mark((function e(){var a,l,r,u,i;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.props.formTemplate,l=(0,h.default)(a,"".concat(n.prefix,"spec.config.sourceUrl"),"")){e.next=4;break}return e.abrupt("return");case 4:return n.setState({readRepoLoading:!0}),r=(0,h.default)(a,"".concat(n.prefix,"spec.config.gitSecretRef.name"),""),e.next=8,n.builderStore.verifyRepoReadable(l,r,n.namespace).finally((function(){n.setState({readRepoLoading:!1})}));case 8:if(u=e.sent,"success"!==(i=(0,h.default)(u,"message",""))){e.next=14;break}return n.setState({repoReadError:null}),r||n.setState({repoNeedSecret:!1}),e.abrupt("return");case 14:n.setState({repoReadError:{message:t(i)},repoNeedSecret:!0});case 15:case"end":return e.stop()}}),e)}))),n.secretStore=new C.default,n.builderStore=new w.default,n.state={isGetTemplateListLoading:!0,environment:[],basicSecretOptions:[],imageSecretOptions:[],repoReadError:null,repoNeedSecret:!0,readRepoLoading:!1,docUrl:""},n}return(0,f.default)(a,e),(0,s.default)(a,[{key:"componentDidMount",value:function(){this.fetchData(),this.fetchImageSecrets(),this.getTemplateList(),this.handleRepoReadableCheck()}},{key:"renderAdvancedSetting",value:function(){return m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{className:M.default.margin_b_10},m.default.createElement(S.default.Item,{label:t("S2I_RELATIVE_PATH"),desc:t("Specify a relative directory inside the application. (defaultvalue /)")},m.default.createElement(y.default,{name:"".concat(this.prefix,"spec.config.contextDir"),defaultValue:"/"}))),m.default.createElement(b.default,{className:M.default.margin_b_10,message:t.html("S2I_ENVIROMENT_DESC",{link:this.state.docUrl||(0,k.getDocsUrl)("s2i_template")}),type:"info"}),m.default.createElement(S.default.Item,null,m.default.createElement(N.default,{name:"".concat(this.prefix,"spec.config.environment"),options:this.state.environment})))}},{key:"render",value:function(){var e=this.props,a=e.formTemplate,n=e.formRef,l=e.mode,o=e.prefix;return m.default.createElement(S.default,{ref:n,data:a},m.default.createElement(P.default,{loading:this.state.isGetTemplateListLoading,formTemplate:o?a[o]:a,builderTemplate:this.state.builderTemplateLists,onEnvironmentChange:this.handleImageTemplateChange}),m.default.createElement("div",{className:(0,g.default)(M.default.columns,(0,r.default)({},M.default.columsEdit,"edit"===l))},m.default.createElement("div",{className:M.default.column},m.default.createElement(_.default,{spinning:this.state.readRepoLoading,size:18},m.default.createElement(S.default.Item,{label:t("Code URL"),desc:t("S2I_IMAGE_REPONSITRY_DESC"),error:this.state.repoReadError,rules:[{required:!0,message:t("This param is required")}]},m.default.createElement(y.default,{name:"".concat(this.prefix,"spec.config.sourceUrl"),onBlur:this.handleRepoReadableCheck})))),m.default.createElement("div",{className:"is-2"},m.default.createElement(S.default.Item,{label:t("Branch"),rules:[{required:!0,message:t("This param is required")}]},m.default.createElement(y.default,{name:"".concat(this.prefix,"spec.config.revisionId"),defaultValue:"master"}))),m.default.createElement("div",{className:"is-half"},m.default.createElement(_.default,{spinning:this.state.readRepoLoading,size:18},m.default.createElement(S.default.Item,{className:this.state.repoNeedSecret?"":M.default.disabled,label:t("secret"),desc:this.state.repoNeedSecret?t("S2I_SECRET_DESC"):t("Current code repository does not require a key")},m.default.createElement(E.default,{onChange:this.handleSecretChange,options:this.state.basicSecretOptions,name:"".concat(this.prefix,"spec.config.gitSecretRef.name")}))))),m.default.createElement("div",{className:(0,g.default)(M.default.columns,(0,r.default)({},M.default.columsEdit,"edit"===l))},m.default.createElement("div",{className:M.default.column},m.default.createElement(S.default.Item,{label:t("imageName"),desc:t("S2I_IMAGENAME_DESC"),rules:[{required:!0,message:t("This param is required")}]},m.default.createElement(y.default,{name:"".concat(this.prefix,"spec.config.imageName")}))),m.default.createElement("div",{className:"is-2"},m.default.createElement(S.default.Item,{label:t("tag"),rules:[{required:!0,message:t("This param is required")}]},m.default.createElement(y.default,{name:"".concat(this.prefix,"spec.config.tag"),defaultValue:"latest"}))),m.default.createElement("div",{className:"is-half"},m.default.createElement(S.default.Item,{label:t("Target image repository"),desc:t.html("S2I_TARGET_IMAGE_REPONSTRY_DESC",{link:(0,k.getDocsUrl)("secrets")}),rules:[{required:!0,message:t("This param is required")}]},m.default.createElement(E.default,{name:"".concat(this.prefix,"spec.config.pushAuthentication.secretRef.name"),options:this.state.imageSecretOptions,onChange:this.handleImageSecretChange})))),m.default.createElement(T.default,null,this.renderAdvancedSetting()))}},{key:"prefix",get:function(){var e=this.props.prefix;return e?"".concat(e,"."):""}},{key:"namespace",get:function(){var e=this.props.formTemplate;return(0,h.default)(e,"".concat(this.prefix,"metadata.namespace"))}}]),a}(m.default.Component);a.default=R,R.defaultProps={mode:"create",prefix:""},R.contextTypes={formData:p.default.object}},2634:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r,o,u,i=n(a(61)),s=n(a(62)),d=n(a(44)),c=n(a(13)),f=n(a(14)),m=n(a(41)),p=(n(a(45)),a(19)),h=a(49),v=n(a(270)),g=(l=function(){function e(){(0,c.default)(this,e),(0,d.default)(this,"isExistService",r,this),(0,d.default)(this,"service",o,this),(0,d.default)(this,"isLoading",u,this),this.getServiceUrl=function(e){var t=e.name,a=e.namespace;return"api/v1/namespaces/".concat(a,"/services/").concat(t)}}var t,a;return(0,f.default)(e,[{key:"checkService",value:(a=(0,s.default)(i.default.mark((function e(t){var a,n,l;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.name,n=t.namespace,a&&n){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,request.get(this.getServiceUrl({name:a,namespace:n}),{},{headers:{"x-check-exist":!0}});case 5:l=e.sent,this.isExistService=l.exist;case 7:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"fetchService",value:(t=(0,s.default)(i.default.mark((function e(t){var a,n,l;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.name,n=t.namespace,this.isLoading=!0,e.next=4,(0,h.to)(request.get(this.getServiceUrl({name:a,namespace:n})));case 4:l=e.sent,this.service=v.default.services(l),this.isLoading=!1;case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}(),r=(0,m.default)(l.prototype,"isExistService",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),o=(0,m.default)(l.prototype,"service",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),u=(0,m.default)(l.prototype,"isLoading",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),(0,m.default)(l.prototype,"checkService",[p.action],Object.getOwnPropertyDescriptor(l.prototype,"checkService"),l.prototype),(0,m.default)(l.prototype,"fetchService",[p.action],Object.getOwnPropertyDescriptor(l.prototype,"fetchService"),l.prototype),l);t.default=g},2635:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r,o,u=n(a(61)),i=n(a(62)),s=n(a(44)),d=n(a(13)),c=n(a(14)),f=n(a(17)),m=n(a(16)),p=n(a(66)),h=n(a(18)),v=n(a(41)),g=(n(a(45)),a(19)),y=n(a(22)),E=a(49),b=a(568),_=n(a(270)),S=(l=function(e){function t(e){var a;return(0,d.default)(this,t),a=(0,f.default)(this,(0,m.default)(t).call(this)),(0,s.default)(a,"workloadDetail",r,(0,p.default)(a)),(0,s.default)(a,"currentRevision",o,(0,p.default)(a)),a.getDetailUrl=function(e){var t=e.name,n=e.namespace,l=e.revision;return"kapis/resources.kubesphere.io/v1alpha2/namespaces/".concat(n,"/").concat(a.module,"/").concat(t,"/revisions/").concat(l)},a.module=e,a}var a,n,l,v,S,k;return(0,h.default)(t,e),(0,c.default)(t,[{key:"fetchList",value:(k=(0,i.default)(u.default.mark((function e(t){var a,n,l,r,o,i,s;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.namespace,n=t.name,l=t.selector,this.list.isLoading=!0,r=(0,E.joinSelector)(l),o="deployments"===this.module?"apis/apps/v1/namespaces/".concat(a,"/replicasets"):"apis/apps/v1/namespaces/".concat(a,"/controllerrevisions"),e.next=6,request.get("".concat(o,"?labelSelector=").concat(r));case 6:i=e.sent,s=i.items.map(_.default.revisions),"deployments"===this.module&&(s=s.filter((function(e){return(0,y.default)(e,"ownerName","")===n}))),this.list.update({data:s,isLoading:!1});case 10:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"fetchDetail",value:(S=(0,i.default)(u.default.mark((function e(t){var a,n,l,r,o;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.name,n=t.namespace,l=t.revision,this.isLoading=!0,e.next=4,request.get(this.getDetailUrl({name:a,namespace:n,revision:l}));case 4:return r=e.sent,o=_.default.revisions(r),e.next=8,(0,b.getWorkloadVolumes)(o);case 8:o.volumes=e.sent,this.detail=o,this.isLoading=!1;case 11:case"end":return e.stop()}}),e,this)}))),function(e){return S.apply(this,arguments)})},{key:"fetchWorkloadDetail",value:(v=(0,i.default)(u.default.mark((function e(t){var a,n,l;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.name,n=t.namespace,e.next=3,request.get("apis/apps/v1/namespaces/".concat(n,"/").concat(this.module,"/").concat(a));case 3:l=e.sent,this.workloadDetail=_.default[this.module](l);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"fetchCurrentRevision",value:(l=(0,i.default)(u.default.mark((function e(){var t,a=arguments;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},e.next=3,this.fetchList(t);case 3:this.currentRevision=(0,b.getCurrentRevision)((0,g.toJS)(t),(0,g.toJS)(this.list.data),this.module);case 4:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"scale",value:(n=(0,i.default)(u.default.mark((function e(t,a){var n,l,r;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,l=t.namespace,r={spec:{replicas:a}},e.next=4,request.patch("apis/apps/v1/namespaces/".concat(l,"/").concat(this.module,"/").concat(n),r);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"rollBack",value:(a=(0,i.default)(u.default.mark((function e(t){var a,n,l,r,o;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.name,n=t.namespace,l=t.revision,this.isSubmitting=!0,e.t0=this.module,e.next="deployments"===e.t0?5:"statefulsets"===e.t0?9:"daemonsets"===e.t0?9:5;break;case 5:return r={kind:"DeploymentRollback",apiVersion:"apps/v1",name:a,namespace:n,rollbackTo:{revision:l}},e.next=8,request.post("apis/apps/v1/namespaces/".concat(n,"/").concat(this.module,"/").concat(a,"/rollback"),r);case 8:return e.abrupt("break",15);case 9:return e.next=11,request.get(this.getDetailUrl({name:a,namespace:n,revision:l}));case 11:return o=e.sent,e.next=14,request.patch("apis/apps/v1/namespaces/".concat(n,"/").concat(this.module,"/").concat(a),o.data);case 14:return e.abrupt("break",15);case 15:this.isSubmitting=!1;case 16:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})}]),t}(n(a(228)).default),r=(0,v.default)(l.prototype,"workloadDetail",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),o=(0,v.default)(l.prototype,"currentRevision",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),(0,v.default)(l.prototype,"fetchList",[g.action],Object.getOwnPropertyDescriptor(l.prototype,"fetchList"),l.prototype),(0,v.default)(l.prototype,"fetchDetail",[g.action],Object.getOwnPropertyDescriptor(l.prototype,"fetchDetail"),l.prototype),(0,v.default)(l.prototype,"fetchWorkloadDetail",[g.action],Object.getOwnPropertyDescriptor(l.prototype,"fetchWorkloadDetail"),l.prototype),(0,v.default)(l.prototype,"fetchCurrentRevision",[g.action],Object.getOwnPropertyDescriptor(l.prototype,"fetchCurrentRevision"),l.prototype),(0,v.default)(l.prototype,"scale",[g.action],Object.getOwnPropertyDescriptor(l.prototype,"scale"),l.prototype),(0,v.default)(l.prototype,"rollBack",[g.action],Object.getOwnPropertyDescriptor(l.prototype,"rollBack"),l.prototype),l);t.default=S},2665:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r,o,u,i,s,d,c,f,m=n(a(61)),p=n(a(97)),h=n(a(37)),v=n(a(63)),g=n(a(62)),y=n(a(44)),E=n(a(13)),b=n(a(14)),_=n(a(17)),S=n(a(16)),k=n(a(66)),C=n(a(18)),w=n(a(41)),N=(n(a(45)),n(a(58))),T=n(a(22)),P=n(a(269)),M=a(19),R=a(49),D=n(a(270)),O=a(2531),x=(l=function(e){function t(){var e,a;(0,E.default)(this,t);for(var n=arguments.length,l=new Array(n),m=0;m<n;m++)l[m]=arguments[m];return(a=(0,_.default)(this,(e=(0,S.default)(t)).call.apply(e,[this].concat(l)))).resourceName="applications",a.defaultStatus=O.CLUSTER_QUERY_STATUS,a.getUrl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.namespace,n=e.cluster_id;return n?"".concat(a.baseUrl,"namespaces/").concat(t,"/applications/").concat(n):"".concat(a.baseUrl,"namespaces/").concat(t,"/applications")},(0,y.default)(a,"env",r,(0,k.default)(a)),(0,y.default)(a,"fetchList",o,(0,k.default)(a)),(0,y.default)(a,"fetchDetail",u,(0,k.default)(a)),(0,y.default)(a,"update",i,(0,k.default)(a)),(0,y.default)(a,"patch",s,(0,k.default)(a)),(0,y.default)(a,"delete",d,(0,k.default)(a)),(0,y.default)(a,"batchDelete",c,(0,k.default)(a)),(0,y.default)(a,"upgrade",f,(0,k.default)(a)),a}return(0,C.default)(t,e),(0,b.default)(t,[{key:"baseUrl",get:function(){return"kapis/openpitrix.io/v1/"}}]),t}(n(a(2554)).default),r=(0,w.default)(l.prototype,"env",[M.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:{},isLoading:!1}}}),o=(0,w.default)(l.prototype,"fetchList",[M.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return((0,g.default)(m.default.mark((function t(){var a,n,l,r,o,u,i,s,d,c,f,g,y=arguments;return m.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=y.length>0&&void 0!==y[0]?y[0]:{},n=a.limit,l=a.page,r=a.namespace,a.workspace,o=a.more,u=a.status,i=a.order,s=a.reverse,d=(0,v.default)(a,["limit","page","namespace","workspace","more","status","order","reverse"]),e.list.isLoading=!0,d.runtime_id){t.next=5;break}return e.list.isLoading=!1,t.abrupt("return");case 5:return c={conditions:(0,R.getFilterString)({status:u||e.defaultStatus})},i||void 0!==s||(i="status_time",s=!0),(0,N.default)(d)||(c.conditions+=",".concat((0,R.getFilterString)(d))),n!==1/0&&(c.paging="limit=".concat(n||10,",page=").concat(l||1)),i&&(c.orderBy=i),s&&(c.reverse=!0),t.next=13,request.get("".concat(e.baseUrl,"namespaces/").concat(r,"/applications"),c);case 13:f=t.sent,g=(f.items||[]).map((function(e){var t=e.cluster,a=(0,v.default)(e,["cluster"]);return(0,h.default)({},t,a)})),e.list={data:o?[].concat((0,p.default)(e.list.data),(0,p.default)(g)):g,total:f.total_count||0,limit:Number(n)||10,page:Number(l)||1,order:i,reverse:s,filters:(0,P.default)(d,"runtime_id"),isLoading:!1,selectedRowKeys:[]};case 16:case"end":return t.stop()}}),t)}))))}}),u=(0,w.default)(l.prototype,"fetchDetail",[M.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return(function(){var t=(0,g.default)(m.default.mark((function t(a){var n,l,r,o,u,i;return m.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.namespace,l=a.id,e.isLoading=!0,t.next=4,request.get(e.getUrl({namespace:n,cluster_id:l}));case 4:(r=t.sent).services&&(r.services=r.services.map(D.default.services)),r.workloads&&Object.keys(r.workloads).forEach((function(e){D.default[e]&&(r.workloads[e]=r.workloads[e].map(D.default[e]))})),o=r.cluster,u=(0,v.default)(r,["cluster"]),e.detail=(0,h.default)({},u,o);try{i=(0,T.default)(r,"cluster.env",""),e.env.data=JSON.parse(i)}catch(e){}e.isLoading=!1;case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}),i=(0,w.default)(l.prototype,"update",[M.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=t.cluster_id,n=t.zone,l=(0,v.default)(t,["cluster_id","zone"]);return e.submitting(request.patch(e.getUrl({namespace:n,cluster_id:a}),l))}}}),s=(0,w.default)(l.prototype,"patch",[M.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a){var n=t.cluster_id,l=t.zone;return e.submitting(request.patch(e.getUrl({namespace:l,cluster_id:n}),a))}}}),d=(0,w.default)(l.prototype,"delete",[M.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=t.cluster_id,n=t.zone;return e.submitting(request.delete(e.getUrl({namespace:n,cluster_id:a})))}}}),c=(0,w.default)(l.prototype,"batchDelete",[M.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a){var n=a.namespace;return e.submitting(Promise.all(t.map((function(t){return request.delete(e.getUrl({namespace:n,cluster_id:t}))}))))}}}),f=(0,w.default)(l.prototype,"upgrade",[M.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=t.cluster_id,n=t.version_id;return e.submitting(request.post("".concat(e.baseUrl,"clusters/upgrade"),{cluster_id:a,version_id:n}))}}}),l);t.default=x},2666:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(37)),r=n(a(63)),o=n(a(13)),u=n(a(14)),i=n(a(17)),s=n(a(16)),d=n(a(18)),c=n(a(0)),f=n(a(1)),m=n(a(3)),p=n(a(3385)),h=function(e){function t(){return(0,o.default)(this,t),(0,i.default)(this,(0,s.default)(t).apply(this,arguments))}return(0,d.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e=this.props,t=e.prefix,a=e.suffix,n=e.children,o=(0,r.default)(e,["prefix","suffix","children"]),u=c.default.cloneElement(n,(0,l.default)({},n.props,{className:(0,m.default)({"ks-input-addons-prefix":!!t,"ks-input-addons-suffix":!!a},n.props.className)},o));return c.default.createElement("div",{className:(0,m.default)(p.default.wrapper,"ks-input-addons")},t&&c.default.createElement("div",{className:p.default.text},t),u,a&&c.default.createElement("div",{className:p.default.text},a))}}]),t}(c.default.Component);t.default=h,h.propTypes={prefix:f.default.any,suffix:f.default.any,name:f.default.string,value:f.default.any,onChange:f.default.func}},2667:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(3)),f=l(n(1)),m=l(n(2535)),p=l(n(3416)),h=l(n(2798)),v=function(e){function a(){var e,t;(0,r.default)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(t=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(l)))).handleAdd=function(){t.props.onShow()},t.handleEdit=function(e){t.props.onShow(e)},t.handleDelete=function(e){var a=t.props,n=a.value,l=a.onChange,r=a.onDelete;l(n.filter((function(t){return t.name!==e}))),r&&r(e)},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"renderContainers",value:function(){var e=this,t=this.props,a=t.value,n=t.readOnlyList;return a.map((function(t){return d.default.createElement(p.default,{container:t,key:t.name,onEdit:e.handleEdit,onDelete:e.handleDelete,readOnly:n.includes(t.name)})}))}},{key:"renderInitContainers",value:function(){var e=this;return this.props.initContainers.map((function(t){return d.default.createElement(p.default,{container:t,key:t.name,type:"init",onEdit:e.handleEdit,onDelete:e.handleDelete})}))}},{key:"render",value:function(){var e=this.props,a=e.value,n=e.initContainers,l=e.className;return d.default.createElement("div",{className:(0,c.default)(h.default.wrapper,l)},this.renderInitContainers(),this.renderContainers(),d.default.createElement(m.default.Add,{type:a.length<=0&&n.length<=0&&"empty",onClick:this.handleAdd,icon:"docker",title:"".concat(t("Add ")).concat(t("Container Image")),description:t("KubeSphere supports pulling images from the Image Registries and creating new images through source code (Source to Image).")}))}}]),a}(d.default.Component);a.default=v,v.propTypes={className:f.default.string,name:f.default.string,value:f.default.array,onChange:f.default.func,onDelete:f.default.func,onShow:f.default.func,readOnlyList:f.default.array,initContainers:f.default.array},v.defaultProps={className:"",name:"",value:[],readOnlyList:[],initContainers:[],onChange:function(){},onShow:function(){},onDelete:function(){}}},2669:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o,u,i=l(n(70)),s=l(n(82)),d=l(n(13)),c=l(n(14)),f=l(n(17)),m=l(n(16)),p=l(n(18)),h=l(n(0)),v=n(60),g=l(n(1)),y=l(n(58)),E=l(n(22)),b=l(n(115)),_=n(114),S=l(n(386)),k=n(938),C=l(n(38)),w=l(n(942)),N=l(n(227)),T=l(n(267)),P=l(n(952)),M=l(n(2530)),R=l(n(3474)),D=(0,v.observer)((u=o=function(e){function a(e){var n;return(0,d.default)(this,a),(n=(0,f.default)(this,(0,m.default)(a).call(this,e))).getStrategy=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,E.default)(e.data,"".concat(_.STRATEGIES_PREFIX[e.module],".type"))},n.getPodValue=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"25%",n=t||1,l=parseFloat(a)/100,r=1;return"minAvailablePod"===e&&(r=n-n*l),"maxSurgePod"===e&&(r=n*(1+l)),Math.ceil(r)},n.getPercentageValue=function(e,t,a){if(a<=0)return"25%";var n=t||1,l=0;return"maxUnavailable"===e&&(l=n-a),"maxSurge"===e&&(l=a-n)>n?"100%":l<=0?"0%":"".concat(Math.ceil(l/n*100),"%")},n.setStrategyValidator=function(){var e=n.props.formRef;e&&e.current&&!e.current.customValidator&&e.current.setCustomValidator(n.validator)},n.validator=function(e){n.strategyFormRef.current.validate(e)},n.strategyValidator=function(e,t,a){var l=n.props.data,r=(0,E.default)(l,"metadata.annotations");if(!(0,y.default)(r)){var o={};Object.entries(r).forEach((function(e){var t=(0,s.default)(e,2),a=t[0],n=t[1];o[a]=String(n)})),(0,b.default)(l,"metadata.annotations",o)}a()},n.minAvailablePodValidator=function(e,a,l){var r=n.props.replicas;return a<1?l({message:t("MIN_AVAILABLE_POD_VALIDATOR_MIN")}):a>r?l({message:t("MIN_AVAILABLE_POD_VALIDATOR_MAX")}):void l()},n.maxSurgePodValidator=function(e,a,l){var r=n.props.replicas;return a<r?l({message:t("MAX_SURGE_POD_VALIDATOR_MIN")}):a>2*r?l({message:t("MAX_SURGE_POD_VALIDATOR_MAX")}):void l()},n.handleStrategyChange=function(e){n.setState({strategy:e},(function(){n.init()}))},n.handleInputChange=function(e){return function(t){var a=n.props,l=a.data,r=a.replicas,o=n.getPercentageValue(e,r,t);(0,b.default)(l,"".concat(n.rollingUpdatePrefix,"[").concat(e,"]"),o)}},n.state={strategy:n.getStrategy(e)||"RollingUpdate"},n.strategyFormRef=e.ownRef||h.default.createRef(),n.init(e),n}return(0,p.default)(a,e),(0,c.default)(a,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=e.data,a=e.replicas,n=e.module,l=this.getStrategy(e);if("deployments"===n){var r="",o="";"RollingUpdate"===l?(r=String(this.getPodValue("minAvailablePod",a,(0,E.default)(t,"".concat(this.rollingUpdatePrefix,".maxUnavailable")))),o=String(this.getPodValue("maxSurgePod",a,(0,E.default)(t,"".concat(this.rollingUpdatePrefix,".maxSurge"))))):(0,b.default)(t,this.rollingUpdatePrefix,null),(0,b.default)(t,'metadata.annotations["kubesphere.io/minAvailablePod"]',r),(0,b.default)(t,'metadata.annotations["kubesphere.io/maxSurgePod"]',o)}}},{key:"componentWillReceiveProps",value:function(e){e.data===this.props.data&&e.replicas===this.props.replicas||(this.init(e),this.setState({strategy:this.getStrategy(e)}))}},{key:"componentDidMount",value:function(){this.setStrategyValidator()}},{key:"renderAlert",value:function(){var e=this.state.strategy,a=void 0===e?"":e,n=this.isRollingUpdate?"info":"warning";return h.default.createElement(k.Columns,null,h.default.createElement(k.Column,null,h.default.createElement(w.default,{type:n,description:t("".concat(a.toUpperCase(),"_ALERT_TIP"))})))}},{key:"renderRollingUpdateParams",value:function(){return"statefulsets"===this.props.module?h.default.createElement(k.Columns,{className:R.default.wrapper},h.default.createElement(k.Column,null,h.default.createElement(T.default.Item,{label:t("Partition"),desc:t("STATEFULSET_PARTITION_DESC"),rules:[{required:!0,message:t("Please input value")}]},h.default.createElement(M.default,{name:"".concat(this.rollingUpdatePrefix,".partition"),placeholder:t("STATEFULSET_PARTITION_PLACEHOLDER"),min:0,integer:!0})))):"daemonsets"===this.props.module?h.default.createElement(k.Columns,{className:R.default.wrapper},h.default.createElement(k.Column,null,h.default.createElement(T.default.Item,{label:t("MaxUnavailable (%)"),desc:t("MAX_UNAVAILABLE_DESC"),rules:[{required:!0,message:t("Please input value")}]},h.default.createElement(M.default,{name:"".concat(this.rollingUpdatePrefix,".maxUnavailable"),unit:"%",min:1,max:100,integer:!0}))),h.default.createElement(k.Column,null,h.default.createElement(T.default.Item,{label:t("MinReadySeconds"),desc:t("MIN_READY_SECONDS_DESC"),rules:[{required:!0,message:t("Please input value")}]},h.default.createElement(S.default,{name:"spec.minReadySeconds"})))):h.default.createElement(k.Columns,{className:R.default.wrapper},h.default.createElement(k.Column,null,h.default.createElement(T.default.Item,{label:t("MIN_AVAILABLE_POD_LABEL"),desc:t("MIN_AVAILABLE_POD_DESC"),rules:[{validator:this.minAvailablePodValidator}]},h.default.createElement(M.default,{name:"metadata.annotations['kubesphere.io/minAvailablePod']",min:1,onChange:this.handleInputChange("maxUnavailable"),integer:!0}))),h.default.createElement(k.Column,null,h.default.createElement(T.default.Item,{label:t("MAX_SURGE_POD_LABEL"),desc:t("MAX_SURGE_POD_DESC"),rules:[{validator:this.maxSurgePodValidator}]},h.default.createElement(M.default,{name:"metadata.annotations['kubesphere.io/maxSurgePod']",onChange:this.handleInputChange("maxSurge"),integer:!0}))))}},{key:"render",value:function(){var e=this.props,a=e.className,n=e.module,l=e.data,r=e.formProps,o=void 0===r?{}:r,u=h.default.createElement("span",null,h.default.createElement("span",{className:"align-middle"},t("POD_SETTING_TIP")),"deployments"===n&&h.default.createElement(N.default,{content:t("ROLLING_UPDATE_POD_TIP")},h.default.createElement(C.default,{name:"information"})));return h.default.createElement(T.default,(0,i.default)({className:a,type:"inner",data:l,ref:this.strategyFormRef},o),h.default.createElement(T.default.Item,{label:t("Update Strategy"),rules:[{validator:this.strategyValidator}]},h.default.createElement(P.default,{name:"".concat(_.STRATEGIES_PREFIX[n],".type"),onChange:this.handleStrategyChange,defaultValue:"RollingUpdate",options:this.strategyOptions})),h.default.createElement(T.default.Group,{label:u,checkable:!0,keepDataWhenUnCheck:!0},this.isRollingUpdate&&this.renderRollingUpdateParams()))}},{key:"isRollingUpdate",get:function(){return"RollingUpdate"===this.state.strategy}},{key:"rollingUpdatePrefix",get:function(){return"".concat(_.STRATEGIES_PREFIX[this.props.module],".rollingUpdate")}},{key:"maxUnavailable",get:function(){return(0,E.default)(this.props.data,"".concat(this.rollingUpdatePrefix,".maxUnavailable"))}},{key:"maxSurge",get:function(){return(0,E.default)(this.props.data,"".concat(this.rollingUpdatePrefix,".maxSurge"))}},{key:"strategyOptions",get:function(){var e=this.props.module;return _.STRATEGIES[e].map((function(e){var a=e.label,n=e.value,l=e.description;return{label:t(a),description:t(l),icon:"update",value:n}}))}}]),a}(h.default.Component),o.propTypes={ownRef:g.default.object,formRef:g.default.object,module:g.default.string,data:g.default.object,replicas:g.default.number,onChange:g.default.func},o.defaultProps={formRef:{},module:"",data:{},replicas:1,onChange:function(){}},r=u))||r;a.default=D},2670:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(70)),o=l(n(63)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(0)),m=l(n(1)),p=l(n(38)),h=l(n(387)),v=l(n(3481)),g=function(e){function a(){return(0,u.default)(this,a),(0,s.default)(this,(0,d.default)(a).apply(this,arguments))}return(0,c.default)(a,e),(0,i.default)(a,[{key:"render",value:function(){var e=this.props,a=e.detail,n=e.type,l=(0,o.default)(e,["detail","type"]);return f.default.createElement(h.default,(0,r.default)({width:520,hideHeader:!0},l),f.default.createElement("div",{className:v.default.wrapper},f.default.createElement(p.default,{name:"question",size:40}),f.default.createElement("div",{className:v.default.text},f.default.createElement("div",null,t("Sure to redeploy")," ?"),f.default.createElement("p",null,t("REDEPLOY_CONFIRM_DESC",{resource:a.name,type:t(n)})))))}}]),a}(f.default.Component);a.default=g,g.propTypes={detail:m.default.object,visible:m.default.bool,onOk:m.default.func,onCancel:m.default.func,isSubmitting:m.default.bool},g.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1}},2671:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(30)),o=l(n(61)),u=l(n(62)),i=l(n(13)),s=l(n(14)),d=l(n(17)),c=l(n(16)),f=l(n(18)),m=l(n(0)),p=l(n(22)),h=l(n(115)),v=l(n(3)),g=l(n(386)),y=l(n(225)),E=l(n(942)),b=l(n(267)),_=n(49),S=l(n(2537)),k=l(n(948)),C=l(n(2817)),w=l(n(2818)),N=l(n(2590)),T=l(n(3496)),P=l(n(3498)),M=function(e){function a(e){var t;return(0,i.default)(this,a),(t=(0,d.default)(this,(0,c.default)(a).call(this,e))).fetchData=(0,u.default)(o.default.mark((function e(){var a,n;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.secretStore.fetchByK8s({namespace:t.namespace,fieldSelector:"type=kubernetes.io/basic-auth"});case 2:a=e.sent,n=a.map((function(e){return{label:(0,_.getDisplayName)(e),value:e.name,type:"basic-auth"}})),t.setState({basicSecretOptions:n});case 5:case"end":return e.stop()}}),e)}))),t.fetchImageSecrets=(0,u.default)(o.default.mark((function e(){var a,n;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.secretStore.fetchByK8s({namespace:t.namespace,fieldSelector:"type=kubernetes.io/dockerconfigjson"});case 2:a=e.sent,n=a.map((function(e){var t=(0,p.default)(e,'data[".dockerconfigjson"].auths',{}),a=Object.keys(t)[0]||"";return{label:(0,_.getDisplayName)(e),value:e.name,repoUrl:a,type:"dockerconfigjson"}})),t.setState({imageSecretOptions:n});case 5:case"end":return e.stop()}}),e)}))),t.getTemplateList=(0,u.default)(o.default.mark((function e(){var a;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setState({isGetTemplateListLoading:!0}),e.next=3,t.builderStore.getBuilderTemplate();case 3:a=e.sent,t.setState({builderTemplateLists:(0,p.default)(a,"items",[]),isGetTemplateListLoading:!1});case 5:case"end":return e.stop()}}),e)}))),t.handleImageSecretChange=function(e,a){var n=t.props.formTemplate,l=(0,p.default)(a,"[0]repoUrl","");(0,h.default)(n,"".concat(t.prefix,'metadata.annotations["kubesphere.io/repoUrl"]'),l)},t.handleImageTemplateChange=function(e){var a=e.environment,n=e.docUrl,l=(0,p.default)(globals,"user.lang","zh"),r=(a||[]).map((function(e){e.label=e.key;var t=(e.description||"").split(". "),a="zh"===l?(0,p.default)(t,"1",e.description):(0,p.default)(t,"0",e.description);return e.label="".concat(e.key,"  (").concat(a,")"),e.value=e.key,e}));t.setState({environment:r,docUrl:n})},t.secretStore=new S.default,t.builderStore=new k.default,t.state={isGetTemplateListLoading:!0,environment:[],basicSecretOptions:[],imageSecretOptions:[],docUrl:""},t}return(0,f.default)(a,e),(0,s.default)(a,[{key:"componentDidMount",value:function(){this.fetchData(),this.fetchImageSecrets(),this.getTemplateList()}},{key:"renderAdvancedSetting",value:function(){return m.default.createElement(m.default.Fragment,null,m.default.createElement(E.default,{className:P.default.environment_info,message:t.html("S2I_ENVIROMENT_DESC",{link:this.state.docUrl||(0,_.getDocsUrl)("s2i_template")}),type:"info"}),m.default.createElement(b.default.Item,null,m.default.createElement(C.default,{name:"".concat(this.prefix,"spec.config.environment"),options:this.state.environment})))}},{key:"render",value:function(){var e=this.props,a=e.formTemplate,n=e.formRef,l=e.mode,o=e.prefix;return m.default.createElement(b.default,{ref:n,data:a},m.default.createElement(b.default.Item,{label:t("Upload Artifacts"),rules:[{required:!0,message:t("file has not uploaded")}]},m.default.createElement(T.default,{name:"".concat(this.prefix,"spec.config.sourceUrl"),namespace:this.namespace,formTemplate:o?a[o]:a})),m.default.createElement(w.default,{loading:this.state.isGetTemplateListLoading,formTemplate:o?a[o]:a,builderTemplate:this.state.builderTemplateLists,onEnvironmentChange:this.handleImageTemplateChange}),m.default.createElement("div",{className:(0,v.default)(P.default.columns,(0,r.default)({},P.default.columsEdit,"edit"===l))},m.default.createElement("div",{className:P.default.column},m.default.createElement(b.default.Item,{label:t("imageName"),desc:t("S2I_IMAGENAME_DESC"),rules:[{required:!0,message:t("This param is required")}]},m.default.createElement(g.default,{name:"".concat(this.prefix,"spec.config.imageName")}))),m.default.createElement("div",{className:"is-2"},m.default.createElement(b.default.Item,{label:t("tag"),rules:[{required:!0,message:t("This param is required")}]},m.default.createElement(g.default,{name:"".concat(this.prefix,"spec.config.tag"),defaultValue:"latest"}))),m.default.createElement("div",{className:"is-half"},m.default.createElement(b.default.Item,{label:t("Target image repository"),desc:t.html("S2I_TARGET_IMAGE_REPONSTRY_DESC",{link:(0,_.getDocsUrl)("secrets")}),rules:[{required:!0,message:t("This param is required")}]},m.default.createElement(y.default,{name:"".concat(this.prefix,"spec.config.pushAuthentication.secretRef.name"),options:this.state.imageSecretOptions,onChange:this.handleImageSecretChange})))),m.default.createElement(N.default,null,this.renderAdvancedSetting()))}},{key:"prefix",get:function(){var e=this.props.prefix;return e?"".concat(e,"."):""}},{key:"namespace",get:function(){var e=this.props.formTemplate;return(0,p.default)(e,"".concat(this.prefix,"metadata.namespace"))}}]),a}(m.default.Component);a.default=M,M.defaultProps={mode:"create",prefix:""}},2672:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(22)),c=l(n(115)),f=l(n(566)),m=l(n(0)),p=l(n(267)),h=l(n(952)),v=l(n(2546)),g=l(n(3514)),y=n(49),E=n(114),b=l(n(3516)),_=l(n(3520)),S=function(e){function a(){var e,n;(0,r.default)(this,a);for(var l=arguments.length,o=new Array(l),s=0;s<l;s++)o[s]=arguments[s];return(n=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(o)))).state={serviceType:"virtualIP"},n.handleTypeChange=function(e){n.setState({serviceType:e},(function(){"virtualIP"===e?(0,f.default)(n.formTemplate,"spec.clusterIP"):(0,c.default)(n.formTemplate,"spec.clusterIP","None")}))},n.portsValidator=function(e,a,n){if(!a)return n();if(a.length>0){var l=[];a.forEach((function(e){return e.name&&e.port?l.includes(e.name)?n({message:t("PORT_INPUT_DESC")}):e.name&&(e.name.length>63||!E.PATTERN_PORT_NAME.test(e.name))?n({message:t("PORT_NAME_DESC")}):void l.push(e.name):n({message:t("Invalid port")})}))}n()},n.labelsValidator=function(e,a,n){return a?(0,y.isValidLabel)(a)?n():n({message:t("LABEL_FORMAT_DESC")}):n()},n}return(0,s.default)(a,e),(0,o.default)(a,[{key:"renderTypeSelect",value:function(){return m.default.createElement(p.default.Item,{label:t("Access Type")},m.default.createElement(h.default,{className:"margin-b12",value:this.state.serviceType,onChange:this.handleTypeChange,options:this.types}))}},{key:"renderLabelSelector",value:function(){return m.default.createElement(p.default.Item,{label:t("LabelSelector"),rules:[{required:!0,message:t("Please input selector")},{validator:this.labelsValidator}]},m.default.createElement(b.default,{name:"spec.selector",namespace:this.namespace,addText:"".concat(t("Add")," LabelSelector")}))}},{key:"renderPorts",value:function(){return m.default.createElement(p.default.Group,{label:t("Ports"),desc:t("SERVICE_PORTS_DESC")},m.default.createElement(p.default.Item,{rules:[{required:!0,message:t("Please input ports")},{validator:this.portsValidator,checkOnSubmit:!0}]},m.default.createElement(v.default,{name:"spec.ports",itemType:"object",addText:t("Add Port")},m.default.createElement(g.default,null))))}},{key:"render",value:function(){var e=this.props.formRef;return m.default.createElement("div",{className:_.default.wrapper},m.default.createElement(p.default,{data:this.formTemplate,ref:e},this.renderTypeSelect(),this.renderLabelSelector(),this.renderPorts()))}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,d.default)(t,E.MODULE_KIND_MAP[a],t)}},{key:"namespace",get:function(){return(0,d.default)(this.formTemplate,"metadata.namespace")}},{key:"types",get:function(){return[{icon:"cluster",label:t("VIRTUAL_IP_TITLE"),description:t("VIRTUAL_IP_DESC"),value:"virtualIP"},{icon:"blockchain",label:t("HEADLESS_SELECTOR_TITLE"),description:t("HEADLESS_SELECTOR_DESC"),value:"headlessSelector"}]}}]),a}(m.default.Component);a.default=S},2673:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.Component=a.default=void 0;var r=l(n(37)),o=l(n(63)),u=l(n(61)),i=l(n(62)),s=l(n(97)),d=l(n(13)),c=l(n(14)),f=l(n(17)),m=l(n(16)),p=l(n(18)),h=l(n(0)),v=n(19),g=n(60),y=l(n(22)),E=l(n(2536)),b=l(n(2634)),_=l(n(2635)),S=l(n(2630)),k=l(n(2559)),C=l(n(2537)),w=l(n(948)),N=l(n(388)),T=l(n(2520)),P=l(n(2527)),M=l(n(2835)),R=l(n(2526)),D=l(n(2674)),O=l(n(3593)),x=l(n(3595)),I=l(n(2670)),A=l(n(2812)),L=n(114),j=function(e){function a(){var e,n;(0,d.default)(this,a);for(var l=arguments.length,c=new Array(l),p=0;p<l;p++)c[p]=arguments[p];return(n=(0,f.default)(this,(e=(0,m.default)(a)).call.apply(e,[this].concat(c)))).state={editBaseInfo:!1,rollBack:!1,editHpa:!1,editConfigTemplate:!1,editYaml:!1,deleteModule:!1},n.getOperations=function(){return[{key:"edit",type:"control",text:t("EDIT"),action:"edit",onClick:n.showModal("editBaseInfo")},{key:"rollBack",icon:"timed-task",text:t("Revision Rollback"),action:"edit",onClick:n.showModal("rollBack")},{show:"deployments"===n.module,key:"editHpa",icon:"firewall",text:t("Horizontal Pod Autoscaling"),action:"edit",onClick:n.showModal("editHpa")}].concat((0,s.default)(n.builderNames.length?[{key:"rebuild",icon:"refresh",text:t("Rebuild Image"),action:"edit",onClick:n.showModal("rebuild")}]:[]),[{key:"editConfigTemplate",icon:"storage",text:t("Edit Config Template"),action:"edit",onClick:n.showModal("editConfigTemplate")},{key:"editYaml",icon:"pen",text:t("Edit YAML"),action:"edit",onClick:n.showModal("editYaml")},{key:"redeploy",icon:"restart",text:t("Redeploy"),action:"edit",onClick:n.showModal("redeploy")},{key:"delete",icon:"trash",text:t("Delete"),action:"delete",onClick:n.showModal("deleteModal")}])},n.getAttrs=function(){return[{name:t("Project"),value:n.namespace},{name:t("Application"),value:n.application},{name:t("Created Time"),value:n.createTime},{name:t("Updated Time"),value:n.updateTime},{name:t("Creator"),value:n.creator}]},n.handleRollBack=function(e){n.revisionStore.rollBack(e).then((function(){n.hideModal("rollBack")(),n.fetchData()}))},n.handleUpdateHpa=function(e,t){t?n.hpaStore.patch(n.store.detail,e).then((function(){n.hideModal("editHpa")(),n.fetchData()})):n.hpaStore.create(e).then((0,i.default)(u.default.mark((function t(){var a;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.hideModal("editHpa")(),a=n.store.detail,t.next=4,n.store.patch(a,{metadata:{annotations:{"kubesphere.io/relatedHPA":(0,y.default)(e,"metadata.name",a.name)}}});case 4:return t.next=6,n.fetchData();case 6:case"end":return t.stop()}}),t)}))))},n.handleRebuild=function(){var e=(0,i.default)(u.default.mark((function e(a){var l,i,s;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=a.isUpdateWorkload,i=a.builderName,s=(0,o.default)(a,["isUpdateWorkload","builderName"]),e.next=3,n.builderStore.rerun((0,r.default)({},s,{name:i,namespace:n.namespace,isUpdateWorkload:l}));case 3:N.default.success({content:t("Rebuild successful, the image status will be refreshed soon")}),setTimeout(n.fetchData,1e3),n.hideModal("rebuild")();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleRedeploy=function(){var e=n.store.detail;n.store.patch(e,{spec:{template:{metadata:{annotations:{"kubesphere.io/restartedAt":new Date}}}}}).then((function(){n.hideModal("redeploy")(),N.default.success({content:"".concat(t("Redeploy Successfully"),"!")})}))},n}return(0,p.default)(a,e),(0,c.default)(a,[{key:"init",value:function(){this.store=new E.default(this.module),this.store.configMapStore=new k.default,this.store.secretStore=new C.default,this.store.projectStore=this.props.rootStore.project,this.resourceStore=new b.default(this.module),this.revisionStore=new _.default(this.module),this.builderStore=new w.default,this.hpaStore=new S.default}},{key:"renderModals",value:function(){var e=this.store,t=e.detail,a=void 0===t?{}:t,n=e.isSubmitting,l=this.state.deleteModal;return h.default.createElement("div",null,h.default.createElement(A.default,{resource:a,visible:l,onOk:this.handleDelete,onCancel:this.hideModal("deleteModal"),isSubmitting:n}),this.renderExtraModals())}},{key:"renderExtraModals",value:function(){var e=this.store,t=e.detail,a=void 0===t?{}:t,n=e.isSubmitting,l=this.state,r=l.editBaseInfo,o=l.rollBack,u=l.redeploy,i=l.editHpa,s=l.editConfigTemplate,d=l.editYaml,c=l.rebuild,f=(0,v.toJS)(a._originData);return h.default.createElement("div",null,h.default.createElement(P.default,{visible:r,detail:f,onOk:this.handleEdit("editBaseInfo"),onCancel:this.hideModal("editBaseInfo"),isSubmitting:n}),h.default.createElement(M.default,{visible:s,store:this.store,module:this.module,detail:f,onOk:this.handleEdit("editConfigTemplate","update"),onCancel:this.hideModal("editConfigTemplate"),isSubmitting:n}),h.default.createElement(R.default,{visible:d,detail:f,onOk:this.handleEdit("editYaml","update"),onCancel:this.hideModal("editYaml"),isSubmitting:n}),h.default.createElement(I.default,{visible:u,detail:a,type:L.MODULE_KIND_MAP[this.module],onOk:this.handleRedeploy,onCancel:this.hideModal("redeploy"),isSubmitting:n}),h.default.createElement(D.default,{visible:o,module:this.module,detail:a,onOk:this.handleRollBack,onCancel:this.hideModal("rollBack"),isSubmitting:this.revisionStore.isSubmitting}),h.default.createElement(O.default,{visible:i,store:this.hpaStore,detail:a,onOk:this.handleUpdateHpa,onCancel:this.hideModal("editHpa"),isSubmitting:this.hpaStore.isSubmitting}),h.default.createElement(x.default,{visible:c,namespace:this.namespace,builderNames:this.builderNames,onOk:this.handleRebuild,onCancel:this.hideModal("rebuild")}))}},{key:"name",get:function(){return"Deployment"}},{key:"builderNames",get:function(){return(0,y.default)(this.store.detail,"builderNames",[])}}]),a}(T.default),V=(0,g.inject)("rootStore")((0,g.observer)(j));a.default=V;var F=j;a.Component=F},2674:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o,u,i=l(n(13)),s=l(n(14)),d=l(n(17)),c=l(n(16)),f=l(n(18)),m=l(n(0)),p=n(60),h=l(n(1)),v=l(n(966)),g=n(568),y=l(n(2635)),E=l(n(386)),b=l(n(225)),_=l(n(387)),S=l(n(267)),k=(0,p.observer)((u=o=function(e){function a(e){var t;return(0,i.default)(this,a),(t=(0,d.default)(this,(0,c.default)(a).call(this,e))).fetchData=function(e){var a=e.detail;t.revisionStore.fetchList(a)},t.getFormData=function(){return{name:t.props.detail.name,currentRevision:"#".concat(t.curRevision)}},t.getRevisionOps=function(){return(0,v.default)(t.revisions,(function(e){return parseInt(e.revision,10)})).map((function(e){var t=e.revision;return{label:"#".concat(t),value:Number(t)}})).filter((function(e){return e.value!==t.curRevision}))},t.handleOk=function(){var e=t.props,a=e.detail,n=e.onOk;if(t.form){var l=t.form.current;l&&l.validate((function(){var e=l.getData();e.namespace=a.namespace,n(e)}))}},t.revisionStore=new y.default(e.module),t.form=m.default.createRef(),t}return(0,f.default)(a,e),(0,s.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.visible&&e.visible!==this.props.visible&&this.fetchData(e)}},{key:"componentDidMount",value:function(){this.props.visible&&this.fetchData(this.props)}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel,l=e.isSubmitting,r=this.getFormData();return m.default.createElement(_.default.Form,{formRef:this.form,data:r,width:691,title:t("Revision Rollback"),icon:"timed-task",onOk:this.handleOk,onCancel:n,visible:a,isSubmitting:l},m.default.createElement(S.default.Item,{label:t("Resource Name")},m.default.createElement(E.default,{name:"name",disabled:!0})),m.default.createElement(S.default.Item,{label:t("Current Revision")},m.default.createElement(E.default,{name:"currentRevision",disabled:!0})),m.default.createElement(S.default.Item,{label:t("Rollback Revisions"),rules:[{required:!0,message:t("Please select rollback revision")}]},m.default.createElement(b.default,{name:"revision",placeholder:t("REVISION_ROLLBACK_SELECT"),options:this.getRevisionOps()})))}},{key:"revisions",get:function(){var e=this.revisionStore.list,t=e.data;return e.isLoading?[]:t}},{key:"curRevision",get:function(){var e=this.props,t=e.module,a=e.detail;return(0,g.getCurrentRevision)(a,this.revisions,t)}}]),a}(m.default.Component),o.propTypes={visible:h.default.bool,module:h.default.string,detail:h.default.object,onOk:h.default.func,onCancel:h.default.func},o.defaultProps={visible:!1,module:"",detail:{},onOk:function(){},onCancel:function(){}},r=u))||r;a.default=k},2675:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.Component=a.default=void 0;var r,o=l(n(30)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(66)),f=l(n(18)),m=l(n(41)),p=l(n(0)),h=n(19),v=n(60),g=n(226),y=l(n(3)),E=l(n(131)),b=l(n(22)),_=l(n(966)),S=l(n(130)),k=n(49),C=n(568),w=l(n(2635)),N=l(n(38)),T=l(n(224)),P=l(n(2516)),M=l(n(2526)),R=l(n(3597)),D=(r=function(e){function a(e){var n;return(0,u.default)(this,a),(n=(0,s.default)(this,(0,d.default)(a).call(this,e))).state={showViewYaml:!1,selectItem:{}},n.getDetailLink=function(e){var t=n.props.match.params,a=t.name,l=t.namespace;return"/projects/".concat(l,"/").concat(n.module,"/").concat(a,"/revisions/").concat(e)},n.fetchData=function(){n.revisionStore.fetchList(n.store.detail)},n.handleClick=function(e){e.persist();var t=e.target.dataset.revision;(0,S.default)(t)||n.routing.push(n.getDetailLink(t))},n.hideViewYaml=function(){n.setState({showViewYaml:!1})},n.handleViewYaml=function(e){return(0,k.cacheFunc)("_view_".concat(e.revision),(function(){n.setState({showViewYaml:!0,selectItem:e._originData})}),(0,c.default)(n))},n.renderRevisionItem=function(e){var a=e.revision,l=e.createTime,r=parseInt(a,10)===n.curRevision;return p.default.createElement("div",{key:a,className:R.default.item,"data-revision":a},p.default.createElement("div",{className:(0,y.default)(R.default.icon,(0,o.default)({},R.default.checked,r))},r&&p.default.createElement(N.default,{name:"check",type:"light"})),p.default.createElement("div",null,p.default.createElement("div",{className:R.default.title},"#",a),p.default.createElement("p",{className:R.default.text},t("CREATE_TIME",{diff:(0,E.default)(l).format("".concat(t("MMMM Do YYYY")," HH:mm:ss"))}))),p.default.createElement("div",{className:R.default.operations},p.default.createElement(T.default,{type:"ghost",icon:"eye",onClick:n.handleViewYaml(e)})))},n.revisionStore=e.revisionStore||new w.default(n.module),n}return(0,f.default)(a,e),(0,i.default)(a,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"renderModals",value:function(){var e=this.state,t=e.showViewYaml,a=e.selectItem;return p.default.createElement(M.default,{visible:t,detail:a,onCancel:this.hideViewYaml,readOnly:!0})}},{key:"render",value:function(){var e=(0,h.toJS)(this.revisionStore.list),a=e.data,n=e.isLoading,l=(0,_.default)(a,(function(e){return parseInt(e.revision,10)})).reverse(),r=this.diffDate?t("UPDATE_TIME",{diff:this.diffDate}):t("Updated just now");return p.default.createElement("div",null,p.default.createElement(P.default,{className:R.default.main,loading:n},p.default.createElement("div",{className:R.default.header},p.default.createElement(N.default,{name:"timed-task",size:40}),p.default.createElement("div",null,p.default.createElement("div",{className:R.default.title},t("Revision"),p.default.createElement(g.Link,{to:this.getDetailLink(this.curRevision)},"#",this.curRevision),t("is running")),p.default.createElement("p",{className:R.default.text},r))),p.default.createElement("div",{className:R.default.list,onClick:this.handleClick},l.map(this.renderRevisionItem))),this.renderModals())}},{key:"module",get:function(){return this.props.module}},{key:"store",get:function(){return this.props.detailStore}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"name",get:function(){return"Deployments"}},{key:"curRevision",get:function(){var e=(0,h.toJS)(this.revisionStore.list).data;return(0,C.getCurrentRevision)(this.store.detail,e,this.module)}},{key:"diffDate",get:function(){var e=this,t=(0,h.toJS)(this.revisionStore.list).data,a=(0,b.default)(t.find((function(t){return t.revision===e.curRevision})),"createTime");return(0,k.getLocalTime)(a).fromNow()}}]),a}(p.default.Component),(0,m.default)(r.prototype,"curRevision",[h.computed],Object.getOwnPropertyDescriptor(r.prototype,"curRevision"),r.prototype),(0,m.default)(r.prototype,"diffDate",[h.computed],Object.getOwnPropertyDescriptor(r.prototype,"diffDate"),r.prototype),r),O=(0,v.inject)("rootStore")((0,v.observer)(D));a.default=O;var x=D;a.Component=x},2677:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.Component=a.default=void 0;var r=l(n(70)),o=l(n(37)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(66)),f=l(n(18)),m=l(n(0)),p=n(19),h=n(60),v=l(n(3)),g=l(n(58)),y=l(n(22)),E=n(49),b=n(939),_=l(n(2587)),S=l(n(942)),k=n(2522),C=n(2532),w=n(3614),N=l(n(3619)),T={cpu_usage:"pod_cpu_usage",memory_usage:"pod_memory_usage_wo_cache",net_transmitted:"pod_net_bytes_transmitted",net_received:"pod_net_bytes_received"},P=function(e){function a(e){var t;return(0,u.default)(this,a),(t=(0,s.default)(this,(0,d.default)(a).call(this,e))).fetchData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.state.pods;(0,g.default)(a)?t.resourceStore.fetchSortedMetrics((0,o.default)({},t.resourceParams,{metrics:[T.cpu_usage],limit:6})).then((function(a){var n=((0,y.default)(a[T.cpu_usage],"data.result")||[]).map((function(e){return(0,y.default)(e,"metric.resource_name")}));t.setState({pods:n},(function(){t.fetchMetrics((0,o.default)({resources:n},e))}))})):t.fetchMetrics((0,o.default)({resources:a},e))},t.fetchMetrics=function(e){t.monitorStore.fetchMetrics((0,o.default)({resources:[],metrics:Object.values(T)},t.resourceParams,e))},t.getMonitoringCfgs=function(){return[{type:"cpu",title:"CPU Usage",unitType:"cpu",metricType:T.cpu_usage},{type:"memory",title:"Memory Usage",unitType:"memory",metricType:T.memory_usage},{type:"bandwidth",title:"Network Outbound",unitType:"bandwidth",metricType:T.net_transmitted},{type:"bandwidth",title:"Network Inbound",unitType:"bandwidth",metricType:T.net_received}]},t.showMultipleModal=function(e){return(0,E.cacheFunc)("_showMultipleModal_".concat(e.title),(function(){t.setState({showMultipleModal:!0,selectItem:(0,o.default)({},e,{legend:["Usage"]})})}),(0,c.default)(t))},t.hideMultipleModal=function(){t.setState({showMultipleModal:!1,selectItem:{}})},t.state={showMultipleModal:!1,selectItem:{},pods:[]},t.monitorStore=new _.default,t.resourceStore=new _.default,t}return(0,f.default)(a,e),(0,i.default)(a,[{key:"renderCard",value:function(){var e=this,a=this.store.detail.createTime,n=this.monitorStore,l=n.isLoading,o=n.isRefreshing,u=this.getMonitoringCfgs(),i=this.isMore;return m.default.createElement(C.Controller,{createTime:a,onFetch:this.fetchData,loading:l,refreshing:o,isEmpty:(0,g.default)(this.metrics)},i&&m.default.createElement(S.default,{description:t("MONITORING_ALERT_DESC"),type:"info"}),u.map((function(a){a.data=(0,y.default)(e.metrics,"".concat(a.metricType,".data.result"))||[],a.legend=a.data.map((function(e,t){return(0,y.default)(e,"metric.resource_name","pod".concat(t))}));var n=(0,b.getAreaChartOps)(a);return(0,g.default)(n.data)?null:m.default.createElement("div",{key:a.title,className:(0,v.default)(N.default.item)},i&&m.default.createElement("div",{className:N.default.more,onClick:e.showMultipleModal(a)},t("View all replicas")),m.default.createElement(k.MultiArea,(0,r.default)({width:"100%"},n)))})))}},{key:"renderModal",value:function(){var e=this.state,t=e.showMultipleModal,a=e.selectItem,n=this.store.detail,l=n.name,r=n.namespace;return m.default.createElement("div",null,m.default.createElement(w.PodsMonitoring,{visible:t,module:this.monitoringModule,name:l,namespace:r,config:a,onCancel:this.hideMultipleModal}))}},{key:"render",value:function(){return m.default.createElement("div",null,this.renderCard(),this.renderModal())}},{key:"store",get:function(){return this.props.detailStore}},{key:"monitoringModule",get:function(){return"deployment"}},{key:"metrics",get:function(){return this.monitorStore.data}},{key:"resourceParams",get:function(){var e=this.store.detail,t=e.namespace,a=e.name;return{namespace:t,workloadKind:this.monitoringModule,workloadName:a}}},{key:"isMore",get:function(){return((0,y.default)((0,p.toJS)(this.resourceStore.sort),"data[".concat(T.cpu_usage,"].data.result"))||[]).length>5}}]),a}(m.default.Component),M=(0,h.inject)("rootStore")((0,h.observer)(P));a.default=M;var R=P;a.Component=R},2678:function(e,t,a){e.exports={content:"Base__content--qytxQ",resources:"Base__resources--2s1tJ",title:"Base__title--2AEfi",list:"Base__list--ZWGjz",hide:"Base__hide--32JJU",item:"Base__item--1hsEe",itemCheck:"Base__itemCheck--2nf3K",itemInfo:"Base__itemInfo--3LapF",charts:"Base__charts--2wlG_"}},2679:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.Component=a.default=void 0;var r=l(n(82)),o=l(n(61)),u=l(n(62)),i=l(n(13)),s=l(n(14)),d=l(n(17)),c=l(n(16)),f=l(n(18)),m=l(n(0)),p=n(19),h=n(60),v=l(n(131)),g=l(n(58)),y=l(n(22)),E=n(941),b=l(n(2635)),_=l(n(2520)),S=l(n(2526)),k=l(n(2674)),C=function(e){function a(){var e,n;(0,i.default)(this,a);for(var l=arguments.length,r=new Array(l),s=0;s<l;s++)r[s]=arguments[s];return(n=(0,d.default)(this,(e=(0,c.default)(a)).call.apply(e,[this].concat(r)))).state={viewYaml:!1,rollBack:!1},n.fetchData=(0,u.default)(o.default.mark((function e(){var t;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.match.params,e.next=3,n.store.fetchWorkloadDetail(t);case 3:return e.next=5,n.store.fetchCurrentRevision(n.store.workloadDetail);case 5:n.store.fetchDetail(t);case 6:case"end":return e.stop()}}),e)}))),n.getOperations=function(){return[{key:"editYaml",type:"control",text:t("View YAML"),action:"view",onClick:n.showModal("viewYaml")},{key:"rollBack",icon:"timed-task",text:t("Revision Rollback"),action:"edit",onClick:n.showModal("rollBack")}]},n.getAttrs=function(){return[{name:t("Project"),value:n.namespace},{name:t("Application"),value:n.application},{name:t("Replica Status"),value:n.replicaStatus},{name:t("Status"),value:n.revisionStatus},{name:t("Selector"),value:n.selectors},{name:t("Strategy Type"),value:n.strategyType},{show:n.rollingUpdate,name:t("RollingUpdate"),value:n.rollingUpdate},{name:t("Created Time"),value:n.createTime},{name:t("Updated Time"),value:n.updateTime},{name:t("Creator"),value:n.creator}]},n.handleRollBack=function(e){n.store.rollBack(e).then((function(){n.hideModal("rollBack")();var e=n.params,t=e.namespace,a=e.name,l=n.props.module;n.routing.push("/projects/".concat(t,"/").concat(l,"/").concat(a,"/revision-control"))}))},n}return(0,f.default)(a,e),(0,s.default)(a,[{key:"init",value:function(){this.store=new b.default(this.module)}},{key:"renderExtraModals",value:function(){var e=(0,p.toJS)(this.store),t=e.workloadDetail,a=e.detail,n=e.isSubmitting,l=this.state,r=l.viewYaml,o=l.rollBack;return m.default.createElement("div",null,m.default.createElement(S.default,{visible:r,detail:(0,p.toJS)(a._originData),onCancel:this.hideModal("viewYaml"),readOnly:!0}),m.default.createElement(k.default,{visible:o,module:this.module,detail:t,onOk:this.handleRollBack,onCancel:this.hideModal("rollBack"),isSubmitting:n}))}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"params",get:function(){return(0,y.default)(this.props,"match.params",{})}},{key:"revision",get:function(){return Number((0,y.default)(this.props,"match.params.revision"))}},{key:"detailName",get:function(){var e=this.store.workloadDetail.name;return"".concat(e||""," #").concat(this.revision)}},{key:"replicaStatus",get:function(){var e=this.store.detail,t=e.spec,a=void 0===t?{}:t,n=e.status,l=void 0===n?{}:n;return"".concat(a.replicas||0," desired |\n      ").concat(l.replicas||0," total |\n      ").concat(l.updatedReplicas||0," updated |\n      ").concat(l.availableReplicas||0," available |\n      ").concat(l.unavailableReplicas||0," unavailable")}},{key:"revisionStatus",get:function(){return t((0,E.getDeployStatus)(this.store.detail))}},{key:"selectors",get:function(){var e=this.store.detail.spec,t=void 0===e?{}:e,a=(0,y.default)(t,"selector.matchLabels",{});return(0,g.default)(a)?"-":m.default.createElement("span",null,Object.keys(a).map((function(e){return"".concat(e," = ").concat(a[e])})).join(", "))}},{key:"strategyType",get:function(){return t((0,y.default)(this.store.workloadDetail,"strategy.type"))}},{key:"rollingUpdate",get:function(){var e=this.store.detail.strategy,a=void 0===e?{}:e;return"RollingUpdate"===a.type?Object.entries(a.rollingUpdate).map((function(e){var a=(0,r.default)(e,2),n=a[0],l=a[1];return"".concat(t(n),"=").concat(l)})).join(", "):""}},{key:"createTime",get:function(){return(0,v.default)(this.store.workloadDetail.createTime).format("".concat(t("MMMM Do YYYY")," HH:mm"))}}]),a}(_.default),w=(0,h.inject)("rootStore")((0,h.observer)(C));a.default=w;var N=C;a.Component=N},2680:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.Component=a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=n(19),f=n(60),m=l(n(22)),p=l(n(58)),h=l(n(942)),v=l(n(2516)),g=l(n(2841)),y=l(n(2601)),E=l(n(3621)),b=l(n(3623)),_=function(e){function a(){var e,t;(0,r.default)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(t=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(l)))).handleReplicaChange=function(e){var a=t.store.workloadDetail,n={name:a.name,namespace:a.namespace};t.store.scale(n,e).then((function(){t.store.fetchWorkloadDetail(n)}))},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"renderReplicaInfo",value:function(){return d.default.createElement(v.default,{className:b.default.replica},d.default.createElement("div",{className:b.default.replicaCount},d.default.createElement(g.default,this.replicaStatus)),d.default.createElement(h.default,{type:"info",message:this.replicaMsg}))}},{key:"renderContainerConfig",value:function(){var e=(0,c.toJS)(this.store.detail),t=e.containers,a=void 0===t?[]:t,n=e.initContainers,l=void 0===n?[]:n;return a.forEach((function(e){e.ready&&delete e.ready})),d.default.createElement(E.default,{containers:a,initContainers:l})}},{key:"renderVolumes",value:function(){var e=this.store.isLoading,t=(0,c.toJS)(this.store.detail),a=t.volumes,n=t.containers,l=this.props.match.params.namespace;return(0,p.default)(a)?null:d.default.createElement(y.default,{title:this.volumesTitle,volumes:a,containers:n,loading:e,prefix:"/projects/".concat(l)})}},{key:"renderContent",value:function(){return d.default.createElement("div",null,this.renderReplicaInfo(),this.renderContainerConfig(),this.renderVolumes())}},{key:"render",value:function(){return d.default.createElement("div",{className:b.default.main},this.renderContent())}},{key:"module",get:function(){return this.props.module}},{key:"enabledActions",get:function(){return globals.app.getActions({module:this.module,project:this.props.match.params.namespace})}},{key:"store",get:function(){return this.props.detailStore}},{key:"revision",get:function(){return Number((0,m.default)(this.props,"match.params.revision"))}},{key:"isCurRevision",get:function(){return this.revision===this.store.currentRevision}},{key:"replicaMsg",get:function(){return t("WORKLOAD_REPLICA_MSG")}},{key:"replicaStatus",get:function(){return{value:this.store.workloadDetail.podNums||0,onChange:this.enabledActions.includes("edit")&&this.isCurRevision&&this.handleReplicaChange}}},{key:"volumesTitle",get:function(){return t("Volumes")}}]),a}(d.default.Component),S=(0,f.inject)("rootStore")((0,f.observer)(_));a.default=S;var k=_;a.Component=k},2681:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r,o=n(a(37)),u=n(a(82)),i=n(a(61)),s=n(a(63)),d=n(a(62)),c=n(a(44)),f=n(a(13)),m=n(a(14)),p=n(a(17)),h=n(a(16)),v=n(a(66)),g=n(a(18)),y=n(a(41)),E=(n(a(45)),a(19)),b=n(a(58)),_=n(a(22)),S=a(49),k=(l=function(e){function t(){var e;return(0,f.default)(this,t),e=(0,p.default)(this,(0,h.default)(t).call(this)),(0,c.default)(e,"excute",r,(0,v.default)(e)),e.module="jobs",e}var a,n;return(0,g.default)(t,e),(0,m.default)(t,[{key:"fetchListByK8s",value:(n=(0,d.default)(i.default.mark((function e(t){var a,n,l,r,o;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.namespace,n=t.selector,l=(0,s.default)(t,["namespace","selector"]),this.list.isLoading=!0,(0,b.default)(n)||(l.labelSelector=(0,S.joinSelector)(n)),e.next=5,request.get("apis/batch/v1/namespaces/".concat(a,"/").concat(this.module),l);case 5:return r=e.sent,o=r.items||[],this.list.update({data:o.map(this.mapper),total:o.length,isLoading:!1,selectedRowKeys:[]}),e.abrupt("return",o);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"fetchExcuteRecords",value:(a=(0,d.default)(i.default.mark((function e(t){var a,n,l,r,s,d;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.name,n=t.namespace,this.excute.isLoading=!0,e.next=4,request.get("apis/batch/v1/namespaces/".concat(n,"/").concat(this.module,"/").concat(a));case 4:l=e.sent,r=this.mapper(l),s=[];try{d=JSON.parse((0,_.default)(r,"annotations.revisions",{})),s=Object.entries(d).map((function(e){var t=(0,u.default)(e,2),a=t[0],n=t[1];return(0,o.default)({},n,{id:a})}))}catch(e){}this.excute={data:s,total:s.length||0,isLoading:!1};case 9:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"apiVersion",get:function(){return"apis/kubesphere.io/v1alpha1"}}]),t}(n(a(228)).default),r=(0,y.default)(l.prototype,"excute",[E.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{data:[],page:1,limit:10,total:0,isLoading:!0}}}),(0,y.default)(l.prototype,"fetchListByK8s",[E.action],Object.getOwnPropertyDescriptor(l.prototype,"fetchListByK8s"),l.prototype),(0,y.default)(l.prototype,"fetchExcuteRecords",[E.action],Object.getOwnPropertyDescriptor(l.prototype,"fetchExcuteRecords"),l.prototype),l);t.default=k},2683:function(e,t,a){e.exports={tag:"Monitor__tag--3TU-A",title:"Monitor__title--369ph",chart:"Monitor__chart--277fR",chartDetail:"Monitor__chartDetail--U6o8u",circle:"Monitor__circle--1xjLL",leftPane:"Monitor__leftPane--3De3d",selected:"Monitor__selected--1Rq06",tip:"Monitor__tip--2_wSs"}},2684:function(e,t,a){e.exports={wrapper:"Jobs__wrapper--NIYOp",image:"Jobs__image--12zpg",footer:"Jobs__footer--2R2Jn",items:"Jobs__items--3HAAk",item:"Jobs__item--3ap2A",icon:"Jobs__icon--1dvmR",iconExtra:"Jobs__iconExtra---pMYs",title:"Jobs__title--33LJI",left:"Jobs__left--3u7se",right:"Jobs__right--1CV-q",versions:"Jobs__versions--1N38n",tag:"Jobs__tag--10BSp",loading:"Jobs__loading--3oncm",chart:"Jobs__chart--20slD",chartDetail:"Jobs__chartDetail--bGmKW",circle:"Jobs__circle--2au74",tip:"Jobs__tip--6o9I9"}},2784:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(82)),o=l(n(61)),u=l(n(62)),i=l(n(13)),s=l(n(14)),d=l(n(17)),c=l(n(16)),f=l(n(66)),m=l(n(18)),p=l(n(22)),h=l(n(115)),v=l(n(566)),g=l(n(132)),y=l(n(0)),E=n(19),b=l(n(1)),_=n(938),S=l(n(388)),k=l(n(387)),C=l(n(2651)),w=n(49),N=l(n(940)),T=l(n(2559)),P=l(n(2537)),M=l(n(2543)),R=l(n(2556)),D=l(n(3375)),O=l(n(3379)),x=l(n(3381)),I=l(n(3450)),A=function(e){function a(e){var n;return(0,i.default)(this,a),(n=(0,d.default)(this,(0,c.default)(a).call(this,e))).handleAppLabelsChange=function(e){n.setState({appLabels:e},(function(){(0,h.default)(n.state.formData.ingress,"metadata.labels",e)}))},n.handleGovernanceChange=function(e){n.setState({isGovernance:e})},n.handleOk=(0,u.default)(o.default.mark((function e(){var t,a,l;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.state.isCodeMode||!(0,g.default)((0,p.default)((0,f.default)(n),"codeRef.current.getData"))){e.next=6;break}t=n.codeRef.current.getData(),n.props.onOk(t),e.next=15;break;case 6:if(a=n.baseInfoFormRef.current,l=n.resourcesFormRef.current,!a){e.next=11;break}return e.next=11,(0,w.toPromise)(a.validate.bind(a));case 11:if(!l){e.next=14;break}return e.next=14,(0,w.toPromise)(l.validate.bind(l));case 14:n.props.onOk(n.state.formData);case 15:case"end":return e.stop()}}),e)}))),n.handleModeChange=function(){n.setState((function(e){var a=e.isCodeMode,l=e.formData;return!a&&(0,g.default)((0,p.default)((0,f.default)(n),"resourcesFormRef.current.hasSubRoute"))&&n.resourcesFormRef.current.hasSubRoute()?S.default.warning(t("Please save the current form first")):(a&&(0,g.default)((0,p.default)((0,f.default)(n),"codeRef.current.getData"))&&(l=n.codeRef.current.getData()),{isCodeMode:!a,formData:l})}))},n.renderResources=function(){var e=n.props.namespace,t=n.state,a=t.formData,l=t.limitRange,r=t.configMaps,o=t.secrets,u=t.imageRegistries,i=t.gateway,s=t.appLabels,d=t.isGovernance;return y.default.createElement(x.default,{ref:n.resourcesFormRef,formData:a,namespace:e,limitRange:l,configMaps:r,secrets:o,imageRegistries:u,gateway:i,appLabels:s,isGovernance:d})},n.state={formData:{application:N.default.applications({namespace:e.namespace}),ingress:N.default.ingresses({namespace:e.namespace})},isCodeMode:!1,isGovernance:n.serviceMeshEnable?"true":"false"},n.codeRef=y.default.createRef(),n.baseInfoFormRef=y.default.createRef(),n.resourcesFormRef=y.default.createRef(),n.configMapStore=new T.default,n.secretStore=new P.default,n.projectStore=new M.default,n.routerStore=new R.default,n}return(0,m.default)(a,e),(0,s.default)(a,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"componentWillReceiveProps",value:function(e){e.sampleApp!==this.props.sampleApp&&(e.sampleApp?this.fecthSampleData(e.sampleApp):this.setState({formData:{application:N.default.applications({namespace:e.namespace}),ingress:N.default.ingresses({namespace:e.namespace})},isGovernance:this.serviceMeshEnable?"true":"false"}))}},{key:"fecthSampleData",value:function(e){var t=this,a=this.props,n=a.namespace,l=a.store,r=this.state.gateway;l.fetchSampleData(e).then((function(e){var a={};e.forEach((function(e){if((0,h.default)(e,"metadata.namespace",n),t.serviceMeshEnable||(0,v.default)(e,'metadata.annotations["servicemesh.kubesphere.io/enabled"]'),"Application"===e.kind)a.application=e;else if("Service"===e.kind){var l=(0,p.default)(e,"metadata.labels.app");(0,h.default)(a,"".concat(l,".service"),e)}else if("Ingress"===e.kind)(0,h.default)(e,'metadata.annotations["nginx.ingress.kubernetes.io/upstream-vhost"]',"productpage.".concat(n,".svc.cluster.local")),(0,h.default)(e,"spec.rules[0].host","productpage.".concat(n,".").concat(r.loadBalancerIngress,".nip.io")),a.ingress=e;else{var o=(0,p.default)(e,"metadata.labels.app");(0,h.default)(a,"".concat(o,".workload"),e)}})),t.setState({formData:a})}))}},{key:"fetchData",value:function(){var e=this,t=this.props.namespace;Promise.all([this.configMapStore.fetchByK8s({namespace:t}),this.secretStore.fetchByK8s({namespace:t}),this.secretStore.fetchByK8s({namespace:t,fieldSelector:"type=kubernetes.io/dockerconfigjson"}),this.projectStore.fetchLimitRanges({namespace:t}),this.routerStore.getGateway({namespace:t})]).then((function(t){var a=(0,r.default)(t,4),n=a[0],l=a[1],o=a[2],u=a[3],i=(0,E.toJS)(e.routerStore.gateway.data);e.setState({configMaps:n,secrets:l,imageRegistries:o,limitRange:(0,p.default)(u,"[0].limit"),gateway:i,isGovernance:e.serviceMeshEnable?"true":"false"})}))}},{key:"renderTitle",value:function(){var e=this.state.isCodeMode;return y.default.createElement("div",null,y.default.createElement("div",null,t("Create Application by Service")),y.default.createElement(C.default,{className:I.default.switch,text:t("Edit Mode"),onChange:this.handleModeChange,checked:e}))}},{key:"renderCode",value:function(){var e=this.props.onOk,t=this.state.formData;return y.default.createElement(D.default,{ref:this.codeRef,formTemplate:t,onOk:e})}},{key:"renderForm",value:function(){return y.default.createElement(_.Columns,{className:"height-full is-gapless"},y.default.createElement(_.Column,{className:"is-narrow"},y.default.createElement(O.default,{store:this.props.store,namespace:this.props.namespace,formData:this.state.formData.application,formRef:this.baseInfoFormRef,serviceMeshEnable:this.serviceMeshEnable,onLabelsChange:this.handleAppLabelsChange,onGovernanceChange:this.handleGovernanceChange})),y.default.createElement(_.Column,null,this.renderResources()))}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.isSubmitting,l=e.onCancel;return y.default.createElement(k.default,{className:I.default.modal,bodyClassName:I.default.body,headerClassName:I.default.header,footerClassName:I.default.footer,title:this.renderTitle(),onOk:this.handleOk,okText:t("Create"),onCancel:l,visible:a,isSubmitting:n,fullScreen:!0},this.state.isCodeMode?this.renderCode():this.renderForm())}},{key:"serviceMeshEnable",get:function(){return globals.app.hasKSModule("servicemesh")&&(0,p.default)(this.routerStore,"gateway.data.serviceMeshEnable")}}]),a}(y.default.Component);a.default=A,A.propTypes={namespace:b.default.string,visible:b.default.bool,onOk:b.default.func,onCancel:b.default.func,sampleApp:b.default.string},A.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}}},2785:function(e,t,a){e.exports={wrapper:"ComponentList__wrapper--2J7Oq",empty:"ComponentList__empty--2JDrG",item:"ComponentList__item--3wByb",operations:"ComponentList__operations--ExyOu",block:"ComponentList__block--3vtDq",tip:"ComponentList__tip--3vWNU",more:"ComponentList__more--Ou2gF",error:"ComponentList__error--2mp5G"}},2786:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(37)),o=l(n(97)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(22)),m=l(n(115)),p=l(n(566)),h=l(n(268)),v=l(n(58)),g=l(n(0)),y=l(n(1)),E=l(n(386)),b=n(938),_=l(n(225)),S=l(n(947)),k=l(n(2536)),C=n(49),w=n(114),N=l(n(940)),T=l(n(267)),P=n(945),M=l(n(2787)),R=l(n(3415)),D=l(n(3417)),O=l(n(3440)),x=l(n(3442)),I=function(e){function a(e){var n;(0,u.default)(this,a),(n=(0,s.default)(this,(0,d.default)(a).call(this,e))).registerForm=function(){var e=n.context.registerSubRoute,t=n.props.onCancel;e&&e(n.handleSubmit,t)},n.checkPullSecret=function(){var e=(0,f.default)(n.state.formData,"workload.spec.template.spec.containers",[]),t=(0,C.safeParseJSON)((0,f.default)(n.state.formData,n.containerSecretPath,""));(0,v.default)(t)||e.forEach((function(e){t[e.name]&&(e.pullSecret=t[e.name])}))},n.showContainerForm=function(e){n.setState({state:"ShowContainerForm",selectContainer:e||{}})},n.handleSubmit=function(){var e=n.props,t=e.onOk,a=e.componentKey,l=n.formRef.current;l&&l.validate((function(){var e=l.getData(),n=(0,f.default)(e,"workload.spec.template.spec.containers",[]),r=[];n.forEach((function(e){e.ports&&e.ports.forEach((function(e){e.servicePort&&r.push({name:e.name,protocol:e.protocol,port:e.servicePort,targetPort:e.containerPort})}))})),(0,m.default)(e,"service.spec.ports",r),"StatefulSet"===(0,f.default)(e,"workload.kind")?(0,m.default)(e,"service.spec.clusterIP","None"):(0,p.default)(e,"service.spec.clusterIP"),t(a||(0,f.default)(e,"service.metadata.name"),e)}))},n.updatePullSecrets=function(e){var t={},a={},l=n.containerSecretPath;(0,f.default)(e,"workload.spec.template.spec.containers",[]).forEach((function(e){e.pullSecret&&(t[e.pullSecret]="",a[e.name]=e.pullSecret)})),(0,v.default)(t)?((0,m.default)(e,"workload.spec.template.spec.imagePullSecrets",null),(0,m.default)(e,l,null)):((0,m.default)(e,"workload.spec.template.spec.imagePullSecrets",Object.keys(t).map((function(e){return{name:e}}))),(0,m.default)(e,l,JSON.stringify(a)))},n.handleAddContainer=function(e){n.setState((function(t){var a=t.formData,l=(0,f.default)(a,"workload.spec.template.spec.containers",[]),u=l.find((function(t){return t.name===e.name}));return(0,v.default)(u)?(0,m.default)(a,"workload.spec.template.spec.containers",[].concat((0,o.default)(l),[e])):Object.assign(u,e),n.updatePullSecrets(a),{formData:(0,r.default)({},a)}}),(function(){n.hideAddContainer()}))},n.handleDelete=function(){n.updatePullSecrets(n.state.formData)},n.hideAddContainer=function(){n.setState({state:"",selectContainer:{}},(function(){n.registerForm()}))},n.handleVolumeUpdateState=function(e){n.setState(e,(function(){""===e.state&&n.registerForm()}))},n.handleWorkloadTypeChange=function(e){var t="StatefulSet"===e?"statefulsets":"deployments";(0,m.default)(n.state.formData,"workload.kind",e),(0,m.default)(n.state.formData,"workload.spec.template.spec.containers",[]),(0,p.default)(n.state.formData,"workload.spec.template.spec.volumes"),(0,p.default)(n.state.formData,"workload.spec.volumeClaimTemplates"),(0,p.default)(n.state.formData,"workload.spec.updateStrategy"),(0,p.default)(n.state.formData,"workload.spec.strategy"),"StatefulSet"===e?(0,m.default)(n.state.formData,"workload.spec.updateStrategy",{type:"RollingUpdate",rollingUpdate:{partition:0}}):(0,m.default)(n.state.formData,"workload.spec.strategy",{type:"RollingUpdate",rollingUpdate:{maxUnavailable:"25%",maxSurge:"25%"}}),n.setState({module:t,workloadType:e})},n.handleNameChange=(0,h.default)((function(e){var t=n.state.formData,a=(0,f.default)(t,"workload.metadata.labels.version","");(0,m.default)(t,"workload.metadata.name","".concat(e,"-").concat(a)),(0,C.mergeLabels)(t.workload,{app:e}),(0,C.mergeLabels)(t.service,{app:e})}),200),n.handleVersionChange=(0,h.default)((function(e){var t=n.state.formData,a=(0,f.default)(t,"service.metadata.name","");(0,m.default)(t,"workload.metadata.name","".concat(a,"-").concat(e)),(0,C.mergeLabels)(t.workload,{version:e})}),200),n.handleDisplayNameChange=(0,h.default)((function(e){var t=n.state.formData;(0,m.default)(t,'service.metadata.annotations["kubesphere.io/alias-name"]',e)}),200),n.nameValidator=function(e,a,l){if(!a)return l();var r=n.props.namespace;n.serviceStore.checkName({name:a,namespace:r}).then((function(a){if(a.exist)return l({message:t("Name exists"),field:e.field});l()}))},n.versionValidator=function(e,a,l){if(!a)return l();var r=n.props.namespace,o=(0,f.default)(n.state.formData,"workload.metadata.labels.app","");n.workloadStore.setModule("StatefulSet"===n.state.workloadType?"statefulsets":"deployments");var u="".concat(o,"-").concat(a);n.workloadStore.checkName({name:u,namespace:r}).then((function(a){if(a.exist)return l({message:t("WORKLOAD_NAME_EXIST",{name:u}),field:e.field});l()}))},n.formRef=g.default.createRef();return n.state={formData:(0,v.default)(e.detail)?n.getInitialFormData("deployments"):e.detail,state:"",selectContainer:{},selectVolume:{},workloadType:"Deployment",module:"deployments"},n.serviceStore=new S.default,n.workloadStore=new k.default,n.workloadTypes=[{label:t("SERVICE_DEPLOYMENT"),value:"Deployment"},{label:t("SERVICE_STATEFULSET"),value:"StatefulSet"}],n}return(0,c.default)(a,e),(0,i.default)(a,[{key:"getInitialFormData",value:function(e){var t=this.props.namespace;return{workload:N.default[e]({namespace:t}),service:N.default.services({namespace:t})}}},{key:"componentWillReceiveProps",value:function(e){var t=this;(0,v.default)(e.detail)||e.detail===this.state.formData||this.setState({formData:e.detail},(function(){t.checkPullSecret()}))}},{key:"componentDidMount",value:function(){this.registerForm(),this.checkPullSecret()}},{key:"renderContainerForm",value:function(){var e=this.props,t=e.configMaps,a=e.secrets,n=e.namespace,l=this.state,r=l.selectContainer,o=l.module,u=r.image?"Edit":"Add",i="".concat(this.title," > ");return g.default.createElement(M.default,{className:x.default.containerForm,type:u,module:o,titlePrefix:i,data:r,onSave:this.handleAddContainer,onCancel:this.hideAddContainer,namespace:n,configMaps:t,secrets:a,withService:!0})}},{key:"renderContainerList",value:function(){var e=this.props.isGovernance;return g.default.createElement(b.Columns,null,g.default.createElement(b.Column,null,g.default.createElement(T.default.Item,{label:t("Pod Template"),rules:[{required:!0,message:t("Please add at least one container")}]},g.default.createElement(R.default,{name:"workload.spec.template.spec.containers",className:x.default.containers,onShow:this.showContainerForm,onDelete:this.handleDelete,isGovernance:e}))))}},{key:"renderBaseInfo",value:function(){var e=this.props.appName,a=this.state.workloadType;return g.default.createElement(g.default.Fragment,null,g.default.createElement(b.Columns,null,g.default.createElement(b.Column,null,g.default.createElement(T.default.Item,{label:t("Name"),desc:t("LONG_NAME_DESC"),rules:[{required:!0,message:t("Please input name")},{pattern:w.PATTERN_NAME,message:"".concat(t("Invalid name"),", ").concat(t("LONG_NAME_DESC"))},{validator:this.nameValidator}]},g.default.createElement(E.default,{name:"service.metadata.name",onChange:this.handleNameChange,placeholder:e?"".concat(e,"-component"):""}))),g.default.createElement(b.Column,null,g.default.createElement(T.default.Item,{label:t("Component Version"),desc:t("COMPONENT_VERSION_DESC"),rules:[{required:!0,message:t("Please input component version")},{pattern:w.PATTERN_COMPONENT_VERSION,message:t("Invalid component version")},{validator:this.versionValidator}]},g.default.createElement(E.default,{name:"workload.metadata.labels.version",onChange:this.handleVersionChange,maxLength:16})))),g.default.createElement(b.Columns,null,g.default.createElement(b.Column,null,g.default.createElement(T.default.Item,{label:t("Alias"),desc:t("ALIAS_DESC")},g.default.createElement(E.default,{name:"workload.metadata.annotations['kubesphere.io/alias-name']",onChange:this.handleDisplayNameChange}))),g.default.createElement(b.Column,null,g.default.createElement(T.default.Item,{label:t("Workload Type"),desc:t("APP_WORKLOAD_TYPE_DESC")},g.default.createElement(_.default,{name:"service.metadata.annotations['kubesphere.io/workloadType']",defaultValue:a,options:this.workloadTypes,onChange:this.handleWorkloadTypeChange})))),g.default.createElement(b.Columns,null,g.default.createElement(b.Column,null,g.default.createElement(T.default.Item,null,g.default.createElement(O.default,{name:"workload.spec.replicas",defaultValue:1})))))}},{key:"renderVolumeSettings",value:function(){var e=this.state,t=e.state,a=e.formData,n=e.selectVolume,l="StatefulSet"===e.workloadType?"statefulsets":"deployments";return g.default.createElement(D.default,{state:t,module:l,formData:a,formProps:{type:"inner"},selectVolume:n,onUpdateState:this.handleVolumeUpdateState})}},{key:"renderContent",value:function(){var e=this.props.onCancel,t=this.state.formData;return g.default.createElement("div",{className:x.default.wrapper},g.default.createElement("div",{className:"h5"},g.default.createElement("a",{className:"custom-icon",onClick:e},g.default.createElement(P.ReactComponent,null)),this.title),g.default.createElement("div",{className:x.default.formWrapper},g.default.createElement(T.default,{ref:this.formRef,data:t},this.renderBaseInfo(),this.renderContainerList(),this.renderVolumeSettings())))}},{key:"render",value:function(){var e=null;switch(this.state.state){case"ShowContainerForm":e=this.renderContainerForm();break;case"ShowVolume":case"ShowConfig":case"ShowVolumeTemplate":e=this.renderVolumeSettings();break;default:e=this.renderContent()}return e}},{key:"title",get:function(){var e=this.props.componentKey,a=(0,v.default)(e)?"Add New":"Edit";return"".concat(t("Application Component")," > ").concat(t("".concat(a," Component")))}},{key:"containerSecretPath",get:function(){return'workload.spec.template.metadata.annotations["kubesphere.io/containerSecrets"]'}}]),a}(g.default.Component);a.default=I,I.propTypes={detail:y.default.object,componentKey:y.default.string,onOk:y.default.func,onCancel:y.default.func,onAdd:y.default.func},I.defaultProps={detail:null,onOk:function(){},onCancel:function(){}},I.contextTypes={registerSubRoute:y.default.func,resetSubRoute:y.default.func}},2787:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(17)),u=l(n(16)),i=l(n(14)),s=l(n(18)),d=l(n(58)),c=l(n(0)),f=l(n(1)),m=l(n(3)),p=n(945),h=l(n(267)),v=l(n(2788)),g=l(n(2789)),y=l(n(2791)),E=l(n(2792)),b=l(n(2793)),_=l(n(3397)),S=l(n(3406)),k=l(n(3414)),C=function(e){function a(e){var t;return(0,r.default)(this,a),(t=(0,o.default)(this,(0,u.default)(a).call(this,e))).registerForm=function(){var e=t.context.registerSubRoute,a=t.props.onCancel;e&&e(t.handleSubmit,a)},t.handleGoBack=function(){var e=t.context.resetSubRoute;e&&e(),t.props.onCancel()},t.handleSubmit=function(e){var a=t.props.onSave,n=t.formRef.current;n&&n.validate((function(){var t=n.getData();t.args&&(t.args=t.args.filter((function(e){return!(0,d.default)(e)}))),t.command&&(t.command=t.command.filter((function(e){return!(0,d.default)(e)}))),t.env&&(t.env=t.env.filter((function(e){var t=e.name;return!(0,d.default)(t)}))),t.ports&&(t.ports=t.ports.filter((function(e){return!(!e.name&&!e.containerPort&&!e.hostPort)}))),a(t),e&&e()}))},t.handleContainerTypeChange=function(e){t.setState({containerType:e})},t.formRef=c.default.createRef(),t.state={containerType:e.data.type||"worker"},t}return(0,s.default)(a,e),(0,i.default)(a,[{key:"getChildContext",value:function(){var e=this;return{forceUpdate:function(){e.forceUpdate()}}}}]),(0,i.default)(a,[{key:"componentDidMount",value:function(){this.registerForm()}},{key:"render",value:function(){var e=this.props,t=e.className,a=e.data,n=e.configMaps,l=e.secrets,r=e.namespace,o=e.withService,u=this.state.containerType;return c.default.createElement("div",{className:(0,m.default)(k.default.wrapper,t)},c.default.createElement("div",{className:"h5"},c.default.createElement("a",{className:"custom-icon",onClick:this.handleGoBack},c.default.createElement(p.ReactComponent,null)),this.title),c.default.createElement(h.default,{ref:this.formRef,data:a},c.default.createElement(_.default,{data:a,namespace:r,defaultContainerType:u,onContainerTypeChange:this.handleContainerTypeChange}),c.default.createElement(v.default,{withService:"init"!==u&&o}),c.default.createElement(E.default,null),"init"!==u&&c.default.createElement(b.default,null),c.default.createElement(g.default,null),c.default.createElement(y.default,{configMaps:n,secrets:l}),c.default.createElement(S.default,null)))}},{key:"title",get:function(){var e=this.props,a=e.type,n=e.titlePrefix,l=t("".concat(a," Container"));return"".concat(n).concat(l)}}]),a}(c.default.Component);a.default=C,C.propTypes={className:f.default.string,type:f.default.string,titlePrefix:f.default.string,namespace:f.default.string,module:f.default.string,data:f.default.object,onSave:f.default.func,onCancel:f.default.func,configMaps:f.default.array,secrets:f.default.array},C.defaultProps={className:"",type:"Add",titlePrefix:"",namespace:"",module:"",data:{},onSave:function(){},onCancel:function(){},configMaps:[],secrets:[]},C.childContextTypes={forceUpdate:f.default.func},C.contextTypes={registerSubRoute:f.default.func,resetSubRoute:f.default.func}},2788:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=n(114),f=l(n(267)),m=l(n(3384)),p=l(n(3387)),h=l(n(2546)),v=function(e){function a(){var e,n;(0,r.default)(this,a);for(var l=arguments.length,o=new Array(l),s=0;s<l;s++)o[s]=arguments[s];return(n=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(o)))).portsValidator=function(e,a,n){if(!a)return n();if(a.length>0){var l=[];a.forEach((function(e){return e.name&&e.containerPort?l.includes(e.name)?n({message:t("PORT_INPUT_DESC")}):e.name&&(e.name.length>15||!c.PATTERN_PORT_NAME.test(e.name))?n({message:t("WORKLOAD_PORT_NAME_DESC")}):void l.push(e.name):n({message:t("Invalid port")})}))}n()},n.checkContainerPortValid=function(e){return e&&e.name&&e.containerPort},n}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props.withService;return d.default.createElement(f.default.Group,{label:e?t("Service Settings"):t("Port Settings"),desc:t("Setting for container access strategy")},d.default.createElement(f.default.Item,{rules:[{required:e,message:t("Please input ports")},{validator:this.portsValidator,checkOnSubmit:!0}]},d.default.createElement(h.default,{name:"".concat(this.prefix,"ports"),itemType:"object",addText:t("Add Port"),checkItemValid:this.checkContainerPortValid},e?d.default.createElement(p.default,null):d.default.createElement(m.default,null))))}},{key:"prefix",get:function(){var e=this.props.prefix;return e?"".concat(e,"."):""}}]),a}(d.default.Component);a.default=v,v.defaultProps={prefix:""}},2789:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(267)),f=l(n(2790)),m=l(n(3389)),p=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){return d.default.createElement(c.default.Group,{label:t("Start command"),desc:t("START_COMMAND_DESC"),checkable:!0},d.default.createElement(c.default.Item,{label:t("Run cammand"),desc:t("RUN_COMMAND_DESC")},d.default.createElement(f.default,{className:m.default.input,name:"".concat(this.prefix,"command"),placeholder:t("Command")})),d.default.createElement(c.default.Item,{label:t("Parameters"),desc:t("CONTAINER_PARAMS_DESC")},d.default.createElement(f.default,{className:m.default.input,name:"".concat(this.prefix,"args"),placeholder:t("Argument")})))}},{key:"prefix",get:function(){var e=this.props.prefix;return e?"".concat(e,"."):""}}]),a}(d.default.Component);a.default=p,p.defaultProps={prefix:""}},2790:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(70)),r=n(a(63)),o=n(a(13)),u=n(a(14)),i=n(a(17)),s=n(a(16)),d=n(a(18)),c=n(a(0)),f=n(a(1)),m=n(a(2475)),p=n(a(133)),h=n(a(50)),v=n(a(2453)),g=function(e){function t(e){var a;return(0,o.default)(this,t),(a=(0,i.default)(this,(0,s.default)(t).call(this,e))).handleChange=function(e,t){var n=a.props,l=n.onChange,r=n.parser;a.setState({value:t}),l(r(t))},a.state={value:e.stringify(e.value)},a}return(0,d.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e=this.props,t=(e.value,e.onChange,e.parser,e.stringify,(0,r.default)(e,["value","onChange","parser","stringify"]));return c.default.createElement(v.default,(0,l.default)({value:this.state.value},t,{onChange:this.handleChange,rows:2}))}}]),t}(c.default.Component);t.default=g,g.propTypes={value:f.default.oneOfType([f.default.string,f.default.array]),stringify:f.default.func,parser:f.default.func,onChange:f.default.func},g.defaultProps={value:"",stringify:function(e){return(0,h.default)(e)?e.join(","):""},parser:function(e){return(0,p.default)(e)?e.split(",").map((function(e){return e=(0,m.default)(e),/^["'].*["']$/.test(e)&&(e=e.slice(1,e.length-1)),e})):[]},onChange:function(){}}},2791:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(267)),f=l(n(3390)),m=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props,a=e.configMaps,n=e.secrets;return d.default.createElement(c.default.Group,{label:t("Environment Variables"),desc:t("CONTAINER_ENVIROMENT_DESC"),checkable:!0},d.default.createElement(c.default.Item,null,d.default.createElement(f.default,{name:"".concat(this.prefix,"env"),configMaps:a,secrets:n})))}},{key:"prefix",get:function(){var e=this.props.prefix;return e?"".concat(e,"."):""}}]),a}(d.default.Component);a.default=m,m.defaultProps={prefix:""}},2792:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(267)),f=l(n(952)),m=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"getImagePullPolicyOptions",value:function(){return[{icon:"timed-task",label:t("IMAGE_PULL_POLICY_ALWAYS"),value:"Always",description:t("IMAGE_PULL_POLICY_ALWAYS_DESC")},{icon:"timed-task",label:t("IMAGE_PULL_POLICY_IFNOTPRESENT"),value:"IfNotPresent",description:t("IMAGE_PULL_POLICY_IFNOTPRESENT_DESC")},{icon:"timed-task",label:t("IMAGE_PULL_POLICY_NEVER"),value:"Never",description:t("IMAGE_PULL_POLICY_NEVER_DESC")}]}},{key:"render",value:function(){return d.default.createElement(c.default.Item,null,d.default.createElement(f.default,{name:"".concat(this.prefix,"imagePullPolicy"),defaultValue:"IfNotPresent",options:this.getImagePullPolicyOptions()}))}},{key:"prefix",get:function(){var e=this.props.prefix;return e?"".concat(e,"."):""}}]),a}(d.default.Component);a.default=m,m.defaultProps={prefix:""}},2793:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(267)),f=l(n(3392)),m=l(n(3396)),p=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){return d.default.createElement(c.default.Group,{label:t("Health Checker"),desc:t("Check the health of the container regularly according to the needs of the user."),checkable:!0},d.default.createElement(c.default.Item,{className:m.default.item,label:t("Container liveness check")},d.default.createElement(f.default,{name:"".concat(this.prefix,"livenessProbe"),type:t("Container liveness check"),description:t("LIVENESS_PROBE_DESC")})),d.default.createElement(c.default.Item,{className:m.default.item,label:t("Container ready check")},d.default.createElement(f.default,{name:"".concat(this.prefix,"readinessProbe"),type:t("Container ready check"),description:t("READINESS_PROBE_DESC")})),d.default.createElement(c.default.Item,{className:m.default.item,label:t("Container start check")},d.default.createElement(f.default,{name:"".concat(this.prefix,"startupProbe"),type:t("Container start check"),description:t("STARTUP_PROBE_DESC")})))}},{key:"prefix",get:function(){var e=this.props.prefix;return e?"".concat(e,"."):""}}]),a}(d.default.Component);a.default=p,p.defaultProps={prefix:""}},2794:function(e,t,a){e.exports={dropContent:"ImageSearch__dropContent--2FRei",header:"ImageSearch__header--17aI0",listContent:"ImageSearch__listContent--2WWuk",starContainer:"ImageSearch__starContainer--1VNrl",actions:"ImageSearch__actions--2z7i4",info:"ImageSearch__info--2ILQh",tabs:"ImageSearch__tabs--2YoJ-",tab:"ImageSearch__tab--2hkjD",selected:"ImageSearch__selected--11Dwh",search:"ImageSearch__search--skmuR",defaultPortButtons:"ImageSearch__defaultPortButtons--fC9od",selectedInfo:"ImageSearch__selectedInfo--k9mCj",icon:"ImageSearch__icon--1Hkei",imageInfo:"ImageSearch__imageInfo--1wb0F",message:"ImageSearch__message--1KtAx",selectedContent:"ImageSearch__selectedContent--2wvs4",config:"ImageSearch__config--1jwAC",secretInfo:"ImageSearch__secretInfo--36Evv",emptyContent:"ImageSearch__emptyContent--oflJp",desc:"ImageSearch__desc--3tO8d",registryFooter:"ImageSearch__registryFooter--25RnS",selectOption:"ImageSearch__selectOption--1P4hK",dropContent_hide:"ImageSearch__dropContent_hide--1oooU",dropDownIcon:"ImageSearch__dropDownIcon--jbw8S",clickable:"ImageSearch__clickable--m-8w1",star:"ImageSearch__star--3115W",imageInput:"ImageSearch__imageInput--1oi6d"}},2795:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(13)),r=n(a(14)),o=n(a(17)),u=n(a(16)),i=n(a(18)),s=n(a(0)),d=n(a(1)),c=n(a(2470)),f=n(a(2586)),m=n(a(3408)),p=function(e){function t(){var e,a;(0,l.default)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=(0,o.default)(this,(e=(0,u.default)(t)).call.apply(e,[this].concat(r)))).handleChange=function(){var e=a.props,t=e.value;(0,e.onChange)(!t)},a}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props,t=e.value,a=e.title,n=e.description;return s.default.createElement("div",{className:m.default.wrapper,onClick:this.handleChange},s.default.createElement(c.default,{checked:t}),s.default.createElement(f.default,{className:m.default.text,title:a,description:n}))}}]),t}(s.default.PureComponent);t.default=p,p.propTypes={value:d.default.bool,onChange:d.default.func},p.defaultProps={onChange:function(){}}},2796:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=n(938),f=l(n(267)),m=l(n(2795)),p=l(n(2530)),h=l(n(3410)),v=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){return d.default.createElement("div",{className:"margin-b12"},d.default.createElement("div",{className:h.default.title},t("User and User Group")),d.default.createElement("div",{className:h.default.content},d.default.createElement(f.default.Item,null,d.default.createElement(m.default,{name:"".concat(this.prefix,".runAsNonRoot"),title:t("RUN_AS_NON_ROOT"),description:t("RUN_AS_NON_ROOT_DESC")})),d.default.createElement("div",{className:"padding-12"},d.default.createElement(c.Columns,null,d.default.createElement(c.Column,null,d.default.createElement(f.default.Item,{label:t("User"),desc:t("RUN_AS_USER_DESC")},d.default.createElement(p.default,{name:"".concat(this.prefix,".runAsUser"),integer:!0}))),d.default.createElement(c.Column,null,d.default.createElement(f.default.Item,{label:t("User Group"),desc:t("RUN_AS_USER_GROUP_DESC")},d.default.createElement(p.default,{name:"".concat(this.prefix,".runAsGroup"),integer:!0})))))))}},{key:"prefix",get:function(){return this.props.prefix||"securityContext"}}]),a}(d.default.Component);a.default=v},2797:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(13)),r=n(a(14)),o=n(a(17)),u=n(a(16)),i=n(a(18)),s=n(a(0)),d=a(938),c=n(a(386)),f=n(a(267)),m=n(a(3411)),p=function(e){function t(){return(0,l.default)(this,t),(0,o.default)(this,(0,u.default)(t).apply(this,arguments))}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){return s.default.createElement("div",{className:"margin-b12"},s.default.createElement("div",{className:m.default.title},"seLinuxOptions"),s.default.createElement("div",{className:m.default.content},s.default.createElement(d.Columns,null,s.default.createElement(d.Column,null,s.default.createElement(f.default.Item,{label:"Level"},s.default.createElement(c.default,{name:"".concat(this.prefix,".seLinuxOptions.level")}))),s.default.createElement(d.Column,null,s.default.createElement(f.default.Item,{label:"Role"},s.default.createElement(c.default,{name:"".concat(this.prefix,".seLinuxOptions.role")})))),s.default.createElement(d.Columns,null,s.default.createElement(d.Column,null,s.default.createElement(f.default.Item,{label:"Type"},s.default.createElement(c.default,{name:"".concat(this.prefix,".seLinuxOptions.type")}))),s.default.createElement(d.Column,null,s.default.createElement(f.default.Item,{label:"User"},s.default.createElement(c.default,{name:"".concat(this.prefix,".seLinuxOptions.user")}))))))}},{key:"prefix",get:function(){return this.props.prefix||"securityContext"}}]),t}(s.default.Component);t.default=p},2798:function(e,t,a){e.exports={wrapper:"ContainerList__wrapper--2xSH4",limits:"ContainerList__limits--2UajG",limit:"ContainerList__limit--3ybje"}},2799:function(e,t,a){e.exports={wrapper:"VolumeList__wrapper---XBu4",add:"VolumeList__add--39NWT",list:"VolumeList__list--uWCXl",mount:"VolumeList__mount--22--q"}},2800:function(e,t,a){e.exports={wrapper:"VolumeTemplateList__wrapper--19UhK",add:"VolumeTemplateList__add--h5mIL",list:"VolumeTemplateList__list--11RSc",mount:"VolumeTemplateList__mount--1M1f1"}},2801:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(70)),o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(22)),f=l(n(969)),m=l(n(0)),p=n(19),h=n(1),v=n(49),g=l(n(267)),y=l(n(2650)),E=l(n(2592)),b=l(n(3435)),_=l(n(2626)),S="spec.storageClassName",k="spec.accessModes[0]",C=function(e){function a(e){var t;return(0,o.default)(this,a),(t=(0,i.default)(this,(0,s.default)(a).call(this,e))).updateStorageClass=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.setState({isLoading:!0});var a=t.context.formData,n=(0,c.default)(a,S);return t.store.fetchList(e).then((function(){var e=(0,p.toJS)(t.store.list.data);t.setState({storageClasses:(0,p.toJS)(t.store.list.data),storageClass:e.find((function(e){return n===e.name}))||e.find((function(e){return e.default}))||{},isLoading:!1})}))},t.getStorageClasses=function(){return t.state.storageClasses.map((function(e){return{label:e.name,value:e.name}}))},t.getSupportedAccessModes=function(){var e=t.state.storageClass;return e?(0,v.safeParseJSON)((0,c.default)(e,'annotations["storageclass.kubesphere.io/supported_access_modes"]',"")):null},t.handleStorageClassChange=function(e){var a=t.state.storageClasses.find((function(t){return t.name===e}))||{};t.context.formData[k]=void 0,t.setState({storageClass:a})},t.store=new _.default,t.state={storageClasses:[],storageClass:{},isLoading:!1},t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"componentDidMount",value:function(){this.updateStorageClass()}},{key:"getSliderProps",value:function(e){var t={min:0,max:2048,defaultValue:"10Gi",step:1,unit:"Gi"},a=Number((0,c.default)(e,"parameters.minSize")),n=Number((0,c.default)(e,"parameters.maxSize")),l=Number((0,c.default)(e,"parameters.stepSize"));(0,f.default)(a)||(t.min=a),(0,f.default)(n)||(t.max=n),(0,f.default)(l)||(t.step=l);for(var r=(t.max/t.step-t.min/t.step)/4,o={},u=0;u<4;u++){var i=Math.floor(r*u)*t.step+t.min;o[i]=0===i?"0":"".concat(i,"Gi")}return o[t.max]="".concat(t.max,"Gi"),t.marks=o,t}},{key:"render",value:function(){var e=this.state,a=e.storageClass,n=e.isLoading,l=this.getStorageClasses(),o=this.getSupportedAccessModes(),u=this.store.list||{};return m.default.createElement(m.default.Fragment,null,m.default.createElement(g.default.Item,{label:t("Storage Class"),desc:t("VOLUME_STORAGE_CLASS_DESC"),rules:[{required:!0,message:t("This param is required")}]},m.default.createElement(E.default,{name:S,defaultValue:a.name,page:u.page,total:u.total,isLoading:u.isLoading,onChange:this.handleStorageClassChange,options:l,currentLength:u.data.length,onFetch:this.updateStorageClass})),m.default.createElement(g.default.Item,{label:t("Access Mode")},m.default.createElement(b.default,{name:k,defaultValue:(0,c.default)(o,"[0]",""),supportedAccessModes:o,loading:n})),m.default.createElement(g.default.Item,{label:t("Volume Capacity")},m.default.createElement(y.default,(0,r.default)({name:"spec.resources.requests.storage"},this.getSliderProps(a)))))}}]),a}(m.default.Component);a.default=C,C.contextTypes={formData:h.PropTypes.object}},2802:function(e,t,a){e.exports={wrapper:"RuleList__wrapper--2_uFL",empty:"RuleList__empty--2Y8sX",card:"RuleList__card--3lAQE",content:"RuleList__content--19BkR",title:"RuleList__title--2jmXq",path:"RuleList__path--1BVqk",error:"RuleList__error--25WPV"}},2803:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(37)),o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(22)),f=l(n(0)),m=l(n(3)),p=l(n(1)),h=l(n(225)),v=l(n(386)),g=l(n(942)),y=l(n(2455)),E=l(n(2454)),b=l(n(267)),_=l(n(2546)),S=l(n(3446)),k=n(945),C=n(114),w=l(n(3447)),N=function(e){function a(e){var n;return(0,o.default)(this,a),(n=(0,i.default)(this,(0,s.default)(a).call(this,e))).checkItemValid=function(e){return e.path&&e.backend&&e.backend.serviceName&&e.backend.servicePort},n.pathValidator=function(e,a,l){return a?a.some((function(e){return!n.checkItemValid(e)}))?l({message:t("Invalid paths"),field:e.field}):void l():l()},n.handleGoBack=function(){var e=n.context.resetSubRoute;e&&e(),n.props.onCancel()},n.handleProtocolChange=function(e){n.setState({protocol:e})},n.handleModeChange=function(e){n.setState({type:e})},n.handleSubmit=function(e){var t=n.props.onSave,a=n.formRef.current;a&&a.validate((function(){var l=a.getData();if("auto"===n.state.type){var o=n.props.gateway,u=(0,c.default)(l,"http.paths[0].backend.serviceName"),i=o.loadBalancerIngress,s=o.namespace;t((0,r.default)({},l,{protocol:"http",host:"".concat(u,".").concat(s,".").concat(i,".nip.io")}))}else t(l);e&&e()}))},n.state={type:n.getType(e.data),service:"",protocol:(0,c.default)(e,"data.protocol","http")},n.formRef=f.default.createRef(),n}return(0,d.default)(a,e),(0,u.default)(a,[{key:"componentDidMount",value:function(){var e=this.context.registerSubRoute,t=this.props.onCancel;e&&e(this.handleSubmit,t)}},{key:"getType",value:function(e){var t=(0,c.default)(e,"host");if(!t)return"auto";var a=this.props.gateway,n=(0,c.default)(e,"http.paths[0].backend.serviceName"),l=a.loadBalancerIngress,r=a.namespace;return t==="".concat(n,".").concat(r,".").concat(l,".nip.io")?"auto":"specify"}},{key:"renderForm",value:function(){var e=this.state,a=e.type,n=e.protocol;return f.default.createElement(f.default.Fragment,null,"specify"===a&&f.default.createElement(f.default.Fragment,null,f.default.createElement(b.default.Item,{label:t("HostName"),rules:[{required:!0,message:t("Please input Hostname")},{pattern:C.PATTERN_HOST,message:t("Invalid host")}]},f.default.createElement(v.default,{name:"host",autoFocus:!0})),f.default.createElement(b.default.Item,{label:t("Protocol")},f.default.createElement(h.default,{name:"protocol",defaultValue:"http",onChange:this.handleProtocolChange,options:this.protocols})),"https"===n&&f.default.createElement(b.default.Item,{label:t("Secret Name")},f.default.createElement(h.default,{name:"secretName",options:this.secrets}))),f.default.createElement(b.default.Item,{label:t("Paths"),rules:[{required:!0,message:t("Please add a path")},{validator:this.pathValidator,checkOnSubmit:!0}]},f.default.createElement(_.default,{name:"http.paths",itemType:"object",addText:t("Add Path"),checkItemValid:this.checkItemValid},f.default.createElement(S.default,{services:this.props.services}))))}},{key:"render",value:function(){var e=this.props,a=e.data,n=e.className,l=this.state.type;return f.default.createElement("div",{className:(0,m.default)(w.default.wrapper,n)},f.default.createElement("div",{className:"h4"},f.default.createElement("a",{className:"custom-icon",onClick:this.handleGoBack},f.default.createElement(k.ReactComponent,null)),t("Set Route Rule")),f.default.createElement("div",{className:w.default.formWrapper},f.default.createElement("div",{className:w.default.form},f.default.createElement(b.default,{ref:this.formRef,data:a},f.default.createElement(b.default.Item,{label:t("Mode")},f.default.createElement(E.default,{wrapClassName:"radio-default",buttonWidth:155,value:l,onChange:this.handleModeChange,size:"small"},f.default.createElement(y.default,{value:"auto"},t("Auto Generate")),f.default.createElement(y.default,{value:"specify"},t("Specify Domain")))),f.default.createElement(g.default,{className:"margin-t12 margin-b12",description:t.html("RULE_SETTING_MODE_".concat(l.toUpperCase())),type:"info"}),this.renderForm()))))}},{key:"protocols",get:function(){return[{label:t("http"),value:"http"},{label:t("https"),value:"https"}]}},{key:"secrets",get:function(){return this.props.secrets.map((function(e){return{label:e.name,value:e.name}}))}}]),a}(f.default.Component);a.default=N,N.propTypes={data:p.default.object,secrets:p.default.array,services:p.default.array,gateway:p.default.object,onSave:p.default.func,onCancel:p.default.func},N.defaultProps={data:{},secrets:[],services:[],gateway:{},onSave:function(){},onCancel:function(){}},N.contextTypes={registerSubRoute:p.default.func,resetSubRoute:p.default.func}},2804:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(63)),r=n(a(13)),o=n(a(14)),u=n(a(17)),i=n(a(16)),s=n(a(18)),d=n(a(0)),c=n(a(1)),f=n(a(190)),m=n(a(271)),p=n(a(386)),h=function(e){function t(){var e,a;(0,r.default)(this,t);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(a=(0,u.default)(this,(e=(0,i.default)(t)).call.apply(e,[this].concat(l)))).handleOptionsClick=function(e,t){a.props.onChange(t)},a}return(0,s.default)(t,e),(0,o.default)(t,[{key:"renderOptions",value:function(){var e=this.props.options;return d.default.createElement(m.default,{onClick:this.handleOptionsClick},e.map((function(e){return d.default.createElement(m.default.MenuItem,{key:e.value},e.label)})))}},{key:"render",value:function(){var e=this.props,t=(e.options,(0,l.default)(e,["options"]));return d.default.createElement(f.default,{content:this.renderOptions()},d.default.createElement(p.default,t))}}]),t}(d.default.Component);t.default=h,h.propTypes={name:c.default.string,value:c.default.any,onChange:c.default.func,options:c.default.array},h.defaultProps={onChange:function(){},options:[]}},2810:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(1)),f=l(n(386)),m=l(n(2453)),p=l(n(387)),h=l(n(267)),v=function(e){function a(){var e,t;(0,r.default)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(t=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(l)))).handleOk=function(e){(0,t.props.onOk)(e)},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props,a=e.detail,n=e.visible,l=e.isSubmitting,r=e.onCancel;return d.default.createElement(p.default.Form,{data:a,width:691,title:t("Edit Info"),icon:"pen",onOk:this.handleOk,okText:t("Update"),onCancel:r,visible:n,isSubmitting:l},d.default.createElement(h.default.Item,{label:t("Name"),desc:t("LONG_NAME_DESC")},d.default.createElement(f.default,{name:"name",disabled:!0})),d.default.createElement(h.default.Item,{label:t("Description"),desc:t("DESCRIPTION_DESC")},d.default.createElement(m.default,{name:"description"})))}}]),a}(d.default.Component);a.default=v,v.propTypes={detail:c.default.object,visible:c.default.bool,onOk:c.default.func,onCancel:c.default.func,isSubmitting:c.default.bool},v.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1}},2811:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(1)),f=l(n(22)),m=l(n(115)),p=l(n(268)),h=n(938),v=l(n(952)),g=l(n(224)),y=l(n(267)),E=l(n(2530)),b=l(n(3473)),_=function(e){function a(){var e,t;(0,r.default)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(t=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(l)))).state={replicas:t.props.replicas||1},t.triggerChange=(0,p.default)((function(){var e=t.props,a=e.template,n=e.onChange,l=t.state.replicas;(0,m.default)(a,"spec.replicas",l),n&&n(l)}),200),t.handleSubStract=function(){t.setState((function(e){var t=e.replicas;return{replicas:Math.max(t-1,1)}}),(function(){t.triggerChange()}))},t.handleAdd=function(){t.setState((function(e){return{replicas:e.replicas+1}}),(function(){t.triggerChange()}))},t.handleChange=function(e){t.setState({replicas:e},(function(){t.triggerChange()}))},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"renderReplicas",value:function(){var e=this.state.replicas;return d.default.createElement("div",{className:b.default.replicas},d.default.createElement("div",{className:"margin-b8"},t("Pod Replicas")),d.default.createElement(h.Addons,null,d.default.createElement(g.default,{type:"flat",icon:"substract",onClick:this.handleSubStract}),d.default.createElement(E.default,{value:e,onChange:this.handleChange}),d.default.createElement(g.default,{type:"flat",icon:"add",onClick:this.handleAdd})))}},{key:"renderPolicy",value:function(){var e=this.replicasPolicyOptions;return d.default.createElement(y.default.Item,null,d.default.createElement(v.default,{name:"spec.template.spec.affinity",options:e,defaultValue:e[0].value}))}},{key:"render",value:function(){return d.default.createElement("div",{className:b.default.wrapper},d.default.createElement(h.Columns,{className:"is-vcentered is-2"},d.default.createElement(h.Column,{className:"is-narrow"},this.renderReplicas()),d.default.createElement(h.Column,null,this.renderPolicy())))}},{key:"replicasPolicyOptions",get:function(){var e={preferredDuringSchedulingIgnoredDuringExecution:[{weight:100,podAffinityTerm:{labelSelector:{matchLabels:(0,f.default)(this.props.template,"spec.template.metadata.labels",{})},topologyKey:"kubernetes.io/hostname"}}]};return[{uid:"default",label:t("Pod's default deployment"),value:{},description:t("Pod will be deployed by default policy")},{uid:"decentralized",label:t("Pod's decentralized deployment"),value:{podAntiAffinity:e},description:t("Pod will be deployed at scattered nodes")},{uid:"aggregation",label:t("Pod's aggregation deployment"),value:{podAffinity:e},description:t("Pod will be deployed at the same node")}]}}]),a}(d.default.Component);a.default=_,_.propTypes={template:c.default.object}},2812:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(70)),o=l(n(63)),u=l(n(30)),i=l(n(61)),s=l(n(37)),d=l(n(62)),c=l(n(97)),f=l(n(13)),m=l(n(14)),p=l(n(17)),h=l(n(16)),v=l(n(18)),g=l(n(0)),y=l(n(1)),E=l(n(3)),b=l(n(572)),_=l(n(50)),S=l(n(58)),k=l(n(38)),C=l(n(229)),w=n(49),N=n(114),T=l(n(224)),P=l(n(387)),M=l(n(2552)),R=l(n(947)),D=l(n(2570)),O=l(n(3482)),x=function(e){function a(e){var t;return(0,f.default)(this,a),(t=(0,p.default)(this,(0,h.default)(a).call(this,e))).stopPropagation=function(e){return e.stopPropagation()},t.handleOk=function(){var e=t.props.onOk,a=t.state,n=a.selectedRelatedResourceIds,l=a.relatedResources,r=[];l.forEach((function(e){n.includes(e.uid)&&("services"===e.type?r.push(t.serviceStore.delete(e)):"volumes"===e.type&&r.push(t.volumeStore.delete(e)))})),Promise.all(r),e()},t.handleItemClick=function(e){var a=e.currentTarget.dataset.uid;t.setState((function(e){var t=e.selectedRelatedResourceIds;return{selectedRelatedResourceIds:t.includes(a)?t.filter((function(e){return e!==a})):[].concat((0,c.default)(t),[a])}}))},t.serviceStore=new R.default,t.volumeStore=new D.default,t.state={relatedResources:[],selectedRelatedResourceIds:[],enableConfirm:!1,timer:3},t}var n;return(0,v.default)(a,e),(0,m.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.visible?e.visible!==this.props.visible&&(this.setState({enableConfirm:!1,relatedResources:[],timer:3}),this.fetchRelatedResources(e.resource),this.startTimer()):this.timer&&clearInterval(this.timer)}},{key:"componentDidMount",value:function(){this.props.visible&&(this.fetchRelatedResources(this.props.resource),this.startTimer())}},{key:"componentWillUnmount",value:function(){this.timer&&clearInterval(this.timer)}},{key:"startTimer",value:function(){var e=this;this.timer&&clearInterval(this.timer),this.timer=setInterval((function(){e.setState((function(e){var t=e.timer;return{timer:Math.max(t-1,0),enableConfirm:t<=1}}),(function(){e.state.enableConfirm&&e.timer&&clearInterval(e.timer)}))}),1e3)}},{key:"fetchRelatedResources",value:(n=(0,d.default)(i.default.mark((function e(t){var a,n,l,r,o=this;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({isLoading:!0}),a=[],(0,_.default)(t)?(n=t[0].namespace,a=t.map((function(e){return e.selector}))):(n=t.namespace,a.push(t.selector)),l=[],a.forEach((function(e){if(!(0,S.default)(e)){var t=(0,w.joinSelector)(e);l.push(o.volumeStore.fetchListByK8s({namespace:n,labelSelector:t}),o.serviceStore.fetchListByK8s({namespace:n,labelSelector:t}))}})),e.next=7,Promise.all(l);case 7:r=e.sent,this.setState({relatedResources:(0,b.default)(r.map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){return e.storageClassName?(0,s.default)({},e,{type:"volumes"}):(0,s.default)({},e,{type:"services"})}))}))),isLoading:!1});case 9:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"renderContent",value:function(){var e=this,a=this.state,n=a.isLoading,l=a.relatedResources,r=a.selectedRelatedResourceIds;return!1===n&&(0,S.default)(l)?g.default.createElement(M.default,{icon:"appcenter",className:O.default.empty,title:t("No related resources"),desc:t("No related resources found with current workload(s)")}):g.default.createElement("div",{className:O.default.resources},l.map((function(a){return g.default.createElement("div",{key:a.uid,"data-uid":a.uid,className:(0,E.default)(O.default.resource,(0,u.default)({},O.default.selected,r.includes(a.uid))),onClick:e.handleItemClick},g.default.createElement(C.default,{checked:r.includes(a.uid),onClick:e.stopPropagation}),g.default.createElement(k.default,{name:N.ICON_TYPES[a.type],size:20,type:r.includes(a.uid)?"light":"dark"}),g.default.createElement("span",{className:O.default.resourceName},a.name),g.default.createElement("span",{className:O.default.resourceType},t(N.MODULE_KIND_MAP[a.type])))})))}},{key:"render",value:function(){var e=this.state,a=e.enableConfirm,n=e.timer,l=this.props,u=l.resource,i=(l.onOk,l.onCancel),s=l.isSubmitting,d=(0,o.default)(l,["resource","onOk","onCancel","isSubmitting"]),c="".concat(t("Sure to delete the workload(s)?")),f=t("DELETE_WORKLOAD_DESC",{resource:u.length>1?u.map((function(e){return e.name})).join(", "):u.name});return g.default.createElement(P.default,(0,r.default)({width:520,icon:"question",title:c,description:f,closable:!1,headerClassName:O.default.modalHeader,bodyClassName:O.default.modalBody,hideFooter:!0},d),g.default.createElement("div",{className:O.default.body},this.renderContent()),g.default.createElement("div",{className:O.default.footer},g.default.createElement(T.default,{onClick:i,"data-test":"modal-cancel"},t("Cancel")),g.default.createElement(T.default,{type:"danger",loading:s,disabled:!a||s,onClick:this.handleOk,"data-test":"modal-ok"},t("OK"),!a&&"(".concat(n,"s)"))))}}]),a}(g.default.Component);a.default=x,x.propTypes={resource:y.default.any,visible:y.default.bool,onOk:y.default.func,onCancel:y.default.func,isSubmitting:y.default.bool},x.defaultProps={visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}}},2813:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){var a=e.data,n=e.module,l=((0,f.getWorkloadStatus)(a,n)||"").status;if(l.startsWith("S2I")){var p=l.slice(4);return u.default.createElement("div",{className:m.default.status},u.default.createElement(d.default,{type:p,name:t(c.S2I_STATUS_DESC[p]),flicker:!0}))}if("daemonsets"===n)return u.default.createElement("div",{className:m.default.status},u.default.createElement(d.default,{type:l,name:t(l),total:(0,r.default)(a,"status.desiredNumberScheduled",0),ready:(0,r.default)(a,"status.numberAvailable",0),flicker:!0}));return u.default.createElement("div",{className:m.default.status},u.default.createElement(d.default,{type:l,name:t(l),total:a.podNums,ready:a.readyPodNums,flicker:!0}),!(0,o.default)((0,r.default)(a,'annotations["kubesphere.io/relatedHPA"]'))&&u.default.createElement(i.default,{content:t("Horizontal Pod Autoscaling has been set"),trigger:"hover"},u.default.createElement(s.default,{name:"timed-task"})))};var r=l(n(22)),o=l(n(58)),u=l(n(0)),i=l(n(227)),s=l(n(38)),d=l(n(2521)),c=n(114),f=n(941),m=l(n(3483))},2814:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(22)),f=n(938),m=l(n(267)),p=l(n(2530)),h=n(114),v=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props.formRef;return d.default.createElement(m.default,{data:this.formTemplate,ref:e},d.default.createElement(f.Columns,null,d.default.createElement(f.Column,null,d.default.createElement(m.default.Item,{label:t("JOB_BACK_OFF_LIMIT_LABEL"),desc:t("JOB_BACK_OFF_LIMIT_DESC")},d.default.createElement(p.default,{min:0,name:"".concat(this.prefix,"backoffLimit"),integer:!0})),d.default.createElement(m.default.Item,{label:t("JOB_PARALLELISM_LABEL"),desc:t("JOB_PARALLELISM_DESC")},d.default.createElement(p.default,{min:0,name:"".concat(this.prefix,"parallelism"),integer:!0}))),d.default.createElement(f.Column,null,d.default.createElement(m.default.Item,{label:t("JOB_COMPLETION_LABEL"),desc:t("JOB_COMPLETION_DESC")},d.default.createElement(p.default,{min:0,name:"".concat(this.prefix,"completions"),integer:!0})),d.default.createElement(m.default.Item,{label:t("JOB_ACTIVE_DL_SECONDS_LABEL"),desc:t("JOB_ACTIVE_DL_SECONDS")},d.default.createElement(p.default,{min:0,name:"".concat(this.prefix,"activeDeadlineSeconds"),integer:!0})))))}},{key:"prefix",get:function(){return this.props.prefix||"spec."}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,c.default)(t,h.MODULE_KIND_MAP[a],t)}}]),a}(d.default.Component);a.default=v},2815:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=n(60),m=l(n(225)),p=l(n(267)),h=l(n(2574)),v=(0,f.observer)(r=function(e){function a(){return(0,o.default)(this,a),(0,i.default)(this,(0,s.default)(a).apply(this,arguments))}return(0,d.default)(a,e),(0,u.default)(a,[{key:"getRestartPolicyOptions",value:function(){return[{label:"Never (".concat(t("RESTART_POLICY_NEVER_DESC"),")"),value:"Never"},{label:"OnFailure (".concat(t("RESTART_POLICY_ONFAILURE_DESC"),")"),value:"OnFailure"}]}},{key:"renderRestartPolicy",value:function(){return c.default.createElement(p.default.Item,{label:t("Restart Policy"),tip:t.html("RESTART_POLICY_TIP"),desc:"".concat(t("Restart Policy")," (Never/OnFailure)")},c.default.createElement(m.default,{name:"".concat(this.prefix,"spec.restartPolicy"),options:this.getRestartPolicyOptions()}))}},{key:"render",value:function(){var e=this.props.formRef,t=this.state,a=t.showContainer,n=t.selectContainer;return a?this.renderContainerForm(n):c.default.createElement(p.default,{data:this.formTemplate,ref:e},this.renderRestartPolicy(),this.renderContainerList())}}]),a}(h.default))||r;a.default=v},2816:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=l(n(22)),m=n(60),p=n(114),h=l(n(2523)),v=(0,m.inject)("rootStore")(r=(0,m.observer)(r=function(e){function a(){var e,t;(0,o.default)(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(t=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(l)))).handleTabChange=function(e){var a=t.props.namespace;t.routing.push("/projects/".concat(a,"/").concat(e))},t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"getCount",value:function(e){return e!==this.props.module||isNaN(this.props.total)?(0,f.default)(this.quota.data,'used["'.concat(p.QUOTAS_MAP[e].name,'"]'),0):this.props.total}},{key:"render",value:function(){return c.default.createElement(h.default,{className:"margin-b12",title:t("Jobs"),description:t("JOB_DESC"),module:this.props.module,tabs:this.tabs})}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"quota",get:function(){return this.props.rootStore.quota}},{key:"tabs",get:function(){return{value:this.props.module,onChange:this.handleTabChange,options:[{value:"jobs",label:t("Jobs"),count:this.getCount("jobs")},{value:"cronjobs",label:t("CronJobs"),count:this.getCount("cronjobs")}]}}}]),a}(c.default.Component))||r)||r;a.default=v},2817:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(70)),o=l(n(63)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(0)),m=l(n(1)),p=l(n(2546)),h=l(n(3492)),v=function(e){function a(){return(0,u.default)(this,a),(0,s.default)(this,(0,d.default)(a).apply(this,arguments))}return(0,c.default)(a,e),(0,i.default)(a,[{key:"render",value:function(){var e=this.props,a=e.value,n=void 0===a?[]:a,l=e.onChange,u=e.options,i=(0,o.default)(e,["value","onChange","options"]);return f.default.createElement(p.default,(0,r.default)({value:n,onChange:l,addText:t("Add Enviroment Params")},i),f.default.createElement(h.default,{options:u}))}}]),a}(f.default.Component);a.default=v,v.propTypes={value:m.default.array,onChange:m.default.func},v.defaultProps={name:"",value:[],onChange:function(){}}},2818:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(37)),o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=l(n(22)),m=l(n(115)),p=l(n(267)),h=l(n(952)),v=l(n(129)),g=l(n(230)),y=l(n(3494)),E=function(e){function a(){var e,t;(0,o.default)(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(t=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(l)))).getDefaultValue=function(){var e=t.props.builderTemplate;return t.isB2i?(0,f.default)(t.containerList[0],"builderImage",""):(0,f.default)(e.find((function(e){return(0,f.default)(e,"spec.codeFramework")===t.languageType})),"spec.defaultBaseImage","")},t.handleTemplateChange=function(e){var a=t.props.formTemplate,n=t.containerList.find((function(t){return t.builderImage===e}))||{};Object.keys(n).forEach((function(e){["environment","docUrl","description"].includes(e)||(0,m.default)(a,"spec.config.".concat(e),n[e])})),t.props.onEnvironmentChange(n)},t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"componentDidUpdate",value:function(){var e=this.getDefaultValue();e&&this.handleTemplateChange(e)}},{key:"getOptions",value:function(e){var t="en"===(0,g.default)("lang")?"EN":"CN";return(0,f.default)(e,"spec.containerInfo",[]).map((function(a){return(0,r.default)({},a,{type:(0,f.default)(e,"spec.codeFramework",""),description:(0,f.default)(e,"metadata.annotations.description".concat(t),"")||(0,f.default)(e,"spec.description",""),environment:(0,f.default)(e,"spec.environment"),docUrl:(0,f.default)(e,'metadata.annotations["devops.kubesphere.io/s2i-template-url"]',"")})}))}},{key:"getTemplateOptions",value:function(){return this.containerList.map((function(e){return{icon:e.type,value:e.builderImage,label:e.builderImage,description:e.description}}))}},{key:"render",value:function(){return this.props.loading?c.default.createElement(p.default.Item,null,c.default.createElement(v.default,{className:y.default.loading})):c.default.createElement(p.default.Item,{rules:[{required:!0,message:t("This param is required")}],label:t("Build Environment"),className:y.default.form},c.default.createElement(h.default,{name:"spec.config.builderImage",defaultValue:this.getDefaultValue(),options:this.getTemplateOptions(),onChange:this.handleTemplateChange}))}},{key:"isB2i",get:function(){return"b2i"===(0,f.default)(this.props.formTemplate,'metadata.labels["s2i-type.kubesphere.io"]')}},{key:"languageType",get:function(){return(0,f.default)(this.props.formTemplate,"metadata.annotations.languageType")}},{key:"containerList",get:function(){var e=this,t=this.props.builderTemplate;return this.isB2i?t.reduce((function(t,a){return(0,f.default)(a,'metadata.labels["binary-type.kubesphere.io"]')===e.languageType?t.concat(e.getOptions(a)):t}),[]):t.reduce((function(t,a){return(0,f.default)(a,"spec.codeFramework")===e.languageType?t.concat(e.getOptions(a)):t}),[])}}]),a}(c.default.PureComponent);a.default=E,E.defaultProps={builderTemplate:[],onEnvironmentChange:function(){}}},2819:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(22)),c=l(n(115)),f=l(n(566)),m=l(n(575)),p=l(n(269)),h=l(n(0)),v=l(n(1)),g=l(n(225)),y=l(n(387)),E=l(n(267)),b=l(n(2538)),_=l(n(2578)),S=l(n(3504)),k=function(e){function a(e){var t;return(0,r.default)(this,a),(t=(0,u.default)(this,(0,i.default)(a).call(this,e))).handleTypeChange=function(e){var a=t.props.detail;if("LoadBalancer"===e){var n=(0,d.default)(a._originData,"metadata.annotations",{});n=(0,m.default)(globals.config.loadBalancerDefaultAnnotations,n),(0,c.default)(t.state.formTemplate,"metadata.annotations",n)}else if(Object.keys(globals.config.loadBalancerDefaultAnnotations).forEach((function(e){(0,f.default)(t.state.formTemplate,'metadata.annotations["'.concat(e,'"]'))})),"ClusterIP"===e){var l=(0,d.default)(t.state.formTemplate,"spec.ports",[]).map((function(e){return(0,p.default)(e,["nodePort"])}));(0,c.default)(t.state.formTemplate,"spec.ports",l)}t.setState({type:e})},t.optionRenderer=function(e){return h.default.createElement("div",{className:S.default.option},h.default.createElement("div",null,e.label),h.default.createElement("p",null,e.desc))},t.handleOk=function(e){(0,t.props.onOk)(e)},t.state={type:(0,d.default)(e.detail,"spec.type"),formTemplate:e.detail},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.detail!==this.state.formTemplate&&this.setState({type:(0,d.default)(e.detail,"spec.type"),formTemplate:e.detail})}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel,l=e.isSubmitting,r=this.state,o=r.type,u=r.formTemplate;return h.default.createElement(y.default.Form,{width:1162,title:t("Edit Internet Access"),data:u,onOk:this.handleOk,onCancel:n,visible:a,isSubmitting:l},h.default.createElement("div",null,h.default.createElement(_.default,{title:t("Internet Access"),desc:t("SERVICES_INTERNET_ACCESS_DESC")}),h.default.createElement("div",{className:S.default.wrapper},h.default.createElement("div",{className:S.default.contentWrapper},h.default.createElement(E.default.Item,{label:t("Access Method"),className:S.default.types},h.default.createElement(g.default,{name:"spec.type",options:this.accessModes,onChange:this.handleTypeChange,optionRenderer:this.optionRenderer})),"LoadBalancer"===o&&h.default.createElement(E.default.Item,{label:t("Annotations")},h.default.createElement(b.default,{name:"metadata.annotations",hiddenKeys:globals.config.preservedAnnotations,addText:t("Add Annotation")}))))))}},{key:"accessModes",get:function(){return[{label:"None",desc:t("ACCESS_NONE_TIP"),value:"ClusterIP"},{label:"NodePort",desc:t("ACCESS_NODEPORT_TIP"),value:"NodePort"},{label:"LoadBalancer",desc:t("ACCESS_LOADBALANCER_TIP"),value:"LoadBalancer"}]}}]),a}(h.default.Component);a.default=k,k.propTypes={visible:v.default.bool,detail:v.default.object,onOk:v.default.func,onCancel:v.default.func,isSubmitting:v.default.bool},k.defaultProps={visible:!1,isSubmitting:!1,detail:{},onOk:function(){},onCancel:function(){}}},2820:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(22)),c=l(n(115)),f=l(n(0)),m=l(n(386)),p=l(n(267)),h=n(114),v=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"componentDidMount",value:function(){"ExternalName"!==(0,d.default)(this.formTemplate,"spec.type")&&(0,c.default)(this.formTemplate,"spec",{type:"ExternalName"})}},{key:"render",value:function(){var e=this.props.formRef;return f.default.createElement(p.default,{data:this.formTemplate,ref:e},f.default.createElement(p.default.Item,{label:t("ExternalName"),desc:t("SERVICE_EXTERNAL_NAME_DESC"),rules:[{required:!0,message:t("Please input ExternalName")}]},f.default.createElement(m.default,{name:"spec.externalName",placeholder:"".concat(t("Example"),"：foo.bar.example.com")})))}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,d.default)(t,h.MODULE_KIND_MAP[a],t)}}]),a}(f.default.Component);a.default=v},2821:function(e,t,a){e.exports={body:"WorkloadSelect__body--2MhD2",footer:"WorkloadSelect__footer--2V8DB",workloads:"WorkloadSelect__workloads--1hcCN",item:"WorkloadSelect__item--3-pkn",selected:"WorkloadSelect__selected--1j4HT",ring:"WorkloadSelect__ring--1DMV7",name:"WorkloadSelect__name--3VnHS"}},2822:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(1)),f=l(n(387)),m=l(n(2820)),p=n(114),h=l(n(3529)),v=l(n(3530)),g=function(e){function a(e){var t;return(0,r.default)(this,a),(t=(0,u.default)(this,(0,i.default)(a).call(this,e))).handleOk=function(){var e=t.props.onOk,a=t.formRef.current;a&&a.validate((function(){e(a.getData())}))},t.handleCancel=function(){(0,t.props.onCancel)()},t.formRef=d.default.createRef(),t.state={formTemplate:e.detail},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.detail!==this.state.formTemplate&&this.setState({formTemplate:e.detail})}},{key:"renderServiceSettings",value:function(){return d.default.createElement(h.default,{formRef:this.formRef,formTemplate:this.state.formTemplate,onCancel:this.resetState})}},{key:"renderExternalName",value:function(){return d.default.createElement(m.default,{formRef:this.formRef,formTemplate:this.state.formTemplate,onCancel:this.resetState})}},{key:"renderEmpty",value:function(){return d.default.createElement("p",{className:v.default.empty},t("Unknown service type"))}},{key:"renderForm",value:function(){var e=null;switch(this.props.type){case p.SERVICE_TYPES.VirtualIP:case p.SERVICE_TYPES.Headless:e=this.renderServiceSettings();break;case p.SERVICE_TYPES.ExternalName:e=this.renderExternalName();break;default:e=this.renderEmpty()}return e}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.isSubmitting,l=e.type;return d.default.createElement(f.default,{width:1162,title:t("Edit Service"),onOk:l!==p.SERVICE_TYPES.Unknown?this.handleOk:null,onCancel:this.handleCancel,visible:a,isSubmitting:n},this.renderForm())}}]),a}(d.default.Component);a.default=g,g.propTypes={visible:c.default.bool,type:c.default.string,detail:c.default.object,onOk:c.default.func,onCancel:c.default.func,isSubmitting:c.default.bool},g.defaultProps={visible:!1,type:"",detail:{},onOk:function(){},onCancel:function(){},isSubmitting:!1}},2823:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(70)),o=l(n(63)),u=l(n(30)),i=l(n(61)),s=l(n(37)),d=l(n(62)),c=l(n(97)),f=l(n(13)),m=l(n(14)),p=l(n(17)),h=l(n(16)),v=l(n(18)),g=l(n(0)),y=l(n(1)),E=l(n(3)),b=l(n(22)),_=l(n(572)),S=l(n(50)),k=l(n(58)),C=l(n(38)),w=l(n(229)),N=n(49),T=n(114),P=l(n(270)),M=l(n(224)),R=l(n(387)),D=l(n(2552)),O=l(n(2536)),x=l(n(2570)),I=l(n(948)),A=l(n(3531)),L=["deployments","daemonsets","statefulsets"],j=function(e){function a(e){var t;return(0,f.default)(this,a),(t=(0,p.default)(this,(0,h.default)(a).call(this,e))).stopPropagation=function(e){return e.stopPropagation()},t.handleOk=function(){var e=t.props.onOk,a=t.state,n=a.selectedRelatedResourceIds,l=a.relatedResources,r=[];l.forEach((function(e){n.includes(e.uid)&&("volumes"===e.type?r.push(t.volumeStore.delete(e)):L.includes(e.type)?(t.workloadStore.setModule(e.type),r.push(t.workloadStore.delete(e))):"s2ibuilders"===e.type&&r.push(t.builderStore.delete(e)))})),Promise.all(r),e()},t.handleItemClick=function(e){var a=e.currentTarget.dataset.id;t.setState((function(e){var t=e.selectedRelatedResourceIds;return{selectedRelatedResourceIds:t.includes(a)?t.filter((function(e){return e!==a})):[].concat((0,c.default)(t),[a])}}))},t.state={relatedResources:[],selectedRelatedResourceIds:[],enableConfirm:!1,timer:3},t.workloadStore=new O.default,t.volumeStore=new x.default,t.builderStore=new I.default,t}var n;return(0,v.default)(a,e),(0,m.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.visible&&e.visible!==this.props.visible?(this.setState({enableConfirm:!1,relatedResources:[],timer:3}),this.fetchRelatedResources(e.resource),this.startTimer()):this.timer&&clearInterval(this.timer)}},{key:"componentDidMount",value:function(){this.props.visible&&(this.fetchRelatedResources(this.props.resource),this.startTimer())}},{key:"componentWillUnmount",value:function(){this.timer&&clearInterval(this.timer)}},{key:"startTimer",value:function(){var e=this;this.timer&&clearInterval(this.timer),this.timer=setInterval((function(){e.setState((function(e){var t=e.timer;return{timer:Math.max(t-1,0),enableConfirm:t<=1}}),(function(){e.state.enableConfirm&&e.timer&&clearInterval(e.timer)}))}),1e3)}},{key:"fetchRelatedResources",value:(n=(0,d.default)(i.default.mark((function e(t){var a,n,l,r,o,u=this;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({isLoading:!0}),a=[],(0,S.default)(t)?(a=t.map((function(e){return e.selector})),n=t[0].namespace):(a.push(t.selector),n=t.namespace),l=[],a.forEach((function(e){if(!(0,k.default)(e)){var t=(0,N.joinSelector)(e);l.push.apply(l,[u.volumeStore.fetchListByK8s({namespace:n,labelSelector:t})].concat((0,c.default)(L.map((function(e){return u.workloadStore.fetchListByK8s({namespace:n,labelSelector:t},e)}))))),e.s2ibuilder&&l.push(u.builderStore.fetchDetail({namespace:n,name:e.s2ibuilder}).then((function(e){return[e]})))}})),e.next=7,Promise.all(l);case 7:r=e.sent,o=new RegExp("\\/namespaces\\/".concat(n,"\\/(.*)\\/.*")),this.setState({relatedResources:(0,_.default)(r.map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){var t=e._originData?"_originData.":"";if((0,b.default)(e,"".concat(t,"spec.storageClassName")))return(0,s.default)({},e,{type:"volumes"});var a=(0,b.default)((0,b.default)(e,"".concat(t,"metadata.selfLink"),"").match(o),"[1]","deployments");return(0,s.default)({},P.default[a](e),{type:a})}))}))),isLoading:!1});case 10:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"renderContent",value:function(){var e=this,a=this.state,n=a.isLoading,l=a.relatedResources,r=a.selectedRelatedResourceIds;return!1===n&&(0,k.default)(l)?g.default.createElement(D.default,{icon:"appcenter",className:A.default.empty,title:t("No related resources"),desc:t("No related resources found with current service(s)")}):g.default.createElement("div",{className:A.default.resources},l.map((function(a){return g.default.createElement("div",{key:a.uid,"data-id":a.uid,className:(0,E.default)(A.default.resource,(0,u.default)({},A.default.selected,r.includes(a.uid))),onClick:e.handleItemClick},g.default.createElement(w.default,{checked:r.includes(a.uid),onClick:e.stopPropagation}),g.default.createElement(C.default,{name:T.ICON_TYPES[a.type],size:20,type:r.includes(a.uid)?"light":"dark"}),g.default.createElement("span",{className:A.default.resourceName},(0,N.getDisplayName)(a)),g.default.createElement("span",{className:A.default.resourceType},t(T.MODULE_KIND_MAP[a.type])))})))}},{key:"render",value:function(){var e=this.state,a=e.enableConfirm,n=e.timer,l=this.props,u=l.resource,i=(l.onOk,l.onCancel),s=l.isSubmitting,d=(0,o.default)(l,["resource","onOk","onCancel","isSubmitting"]),c="".concat(t("Sure to delete the service(s)?")),f=t("DELETE_SERVICE_DESC",{resource:u.length>1?u.map((function(e){return e.name})).join(", "):u.name});return g.default.createElement(R.default,(0,r.default)({width:520,icon:"question",title:c,description:f,closable:!1,headerClassName:A.default.modalHeader,bodyClassName:A.default.modalBody,hideFooter:!0},d),g.default.createElement("div",{className:A.default.body},this.renderContent()),g.default.createElement("div",{className:A.default.footer},g.default.createElement(M.default,{onClick:i},t("Cancel")),g.default.createElement(M.default,{type:"danger",loading:s,disabled:!a||s,onClick:this.handleOk},t("OK"),!a&&"(".concat(n,"s)"))))}}]),a}(g.default.Component);a.default=j,j.propTypes={resource:y.default.any,visible:y.default.bool,onOk:y.default.func,onCancel:y.default.func,isSubmitting:y.default.bool},j.defaultProps={visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}}},2824:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(22)),f=l(n(0)),m=n(60),p=n(49),h=n(564),v=l(n(2608)),g=l(n(2523)),y=l(n(2784)),E=(0,m.inject)("rootStore")(r=(0,m.observer)(r=function(e){function a(){var e,t;(0,o.default)(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(t=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(l)))).state={showDeployApp:!1,sampleApp:""},t.store=new v.default,t.hideDeployAppModal=function(){t.setState({showDeployApp:!1,sampleApp:""})},t.handleDeployApp=function(e){var a=t.props.match.params.namespace;t.store.create(e).then((function(){t.hideDeployAppModal(),t.routing.push("/projects/".concat(a,"/applications/composing/").concat((0,c.default)(e,"application.metadata.name")))}))},t.showDeploySampleApp=function(){t.setState({showDeployApp:!0,sampleApp:"bookinfo"})},t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"render",value:function(){var e=this.props.route,a=this.state,n=a.showDeployApp,l=a.sampleApp,r=this.props.match.params.namespace;return f.default.createElement("div",null,f.default.createElement(g.default,{icon:"bird",module:"grayrelease",title:t("Grayscale Release"),description:t("GRAY_RELEASE_DESC"),tips:this.tips,routes:e.routes}),(0,h.renderRoutes)(e.routes),f.default.createElement(y.default,{store:this.store,visible:n,namespace:r,sampleApp:l,onOk:this.handleDeployApp,onCancel:this.hideDeployAppModal,isSubmitting:this.store.isSubmitting}))}},{key:"tips",get:function(){return[{title:t("PREREQUEST_FOR_USE_GRAYRELEASE_Q"),description:t("PREREQUEST_FOR_USE_GRAYRELEASE_A"),more:(0,p.getDocsUrl)("composingapps")}]}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"canDeployComposingApp",get:function(){var e=this.props.match.params.namespace,t=globals.app.getActions({module:"deployments",project:e}).includes("create"),a=globals.app.getActions({module:"services",project:e}).includes("create");return globals.app.getActions({module:"applications",project:e}).includes("edit")&&t&&a}}]),a}(f.default.Component))||r)||r;a.default=E},2825:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o,u,i=l(n(13)),s=l(n(14)),d=l(n(17)),c=l(n(16)),f=l(n(18)),m=l(n(0)),p=l(n(1)),h=n(60),v=l(n(387)),g=l(n(267)),y=l(n(2826)),E=l(n(3534)),b=(0,h.observer)((u=o=function(e){function a(e){var t;return(0,i.default)(this,a),(t=(0,d.default)(this,(0,c.default)(a).call(this,e))).handleOk=function(e){(0,t.props.onOk)(e)},t.state={formTemplate:e.detail},t}return(0,f.default)(a,e),(0,s.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.detail!==this.state.formTemplate&&this.setState({formTemplate:e.detail})}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel,l=e.isSubmitting;return m.default.createElement(v.default.Form,{title:t("Edit Annotations"),icon:"firewall",visible:a,width:960,data:this.state.formTemplate,onOk:this.handleOk,onCancel:n,isSubmitting:l},m.default.createElement("div",{className:E.default.wrapper},m.default.createElement("div",{className:E.default.formWrapper},m.default.createElement(g.default.Item,null,m.default.createElement(y.default,{name:"metadata.annotations",hiddenKeys:globals.config.preservedAnnotations,addText:t("Add Annotation")})))))}}]),a}(m.default.Component),o.propTypes={detail:p.default.object,onOk:p.default.func,onCancel:p.default.func,isSubmitting:p.default.bool},o.defaultProps={detail:{},isSubmitting:!1,onOk:function(){},onCancel:function(){}},r=u))||r;a.default=b},2826:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(70)),o=l(n(63)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(0)),m=l(n(386)),p=l(n(2500)),h=l(n(2546)),v=l(n(2545)),g=l(n(2538)),y=n(114),E=l(n(3533)),b=function(e){function t(){var e,a;(0,u.default)(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(a=(0,s.default)(this,(e=(0,d.default)(t)).call.apply(e,[this].concat(l)))).handleSelect=function(e){(0,a.props.onChange)(e)},a}return(0,c.default)(t,e),(0,i.default)(t,[{key:"render",value:function(){var e=this.props,t=(e.onSelected,(0,o.default)(e,["onSelected"]));return f.default.createElement(p.default,(0,r.default)({onSelected:this.handleSelect},t))}}]),t}(f.default.Component),_=function(e){function a(){return(0,u.default)(this,a),(0,s.default)(this,(0,d.default)(a).apply(this,arguments))}return(0,c.default)(a,e),(0,i.default)(a,[{key:"render",value:function(){var e=this.props,a=(e.value,e.onChange,e.valueType,(0,o.default)(e,["value","onChange","valueType"])),n=this.state.arrayValue;return f.default.createElement(h.default,(0,r.default)({value:n,itemType:"object",onChange:this.handleChange,checkItemValid:this.checkItemValid},a),f.default.createElement(v.default,null,f.default.createElement(b,{className:E.default.dropdown,name:"key",placeholder:t("key"),options:y.INGRESS_ANNOTATIONS}),f.default.createElement(m.default,{name:"value",rows:"1",placeholder:t("value")})))}}]),a}(g.default);a.default=_},2827:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(17)),u=l(n(16)),i=l(n(14)),s=l(n(18)),d=l(n(0)),c=l(n(1)),f=l(n(58)),m=l(n(387)),p=l(n(2828)),h=l(n(3537)),v=function(e){function a(e){var t;return(0,r.default)(this,a),(t=(0,o.default)(this,(0,u.default)(a).call(this,e))).registerSubRoute=function(e,a){t.setState({subRoute:{onSave:e,onCancel:a}})},t.resetSubRoute=function(){t.setState({subRoute:{}})},t.handleOk=function(){var e=t.state.subRoute;if(e.onSave)return e.onSave((function(){t.setState({subRoute:{}})}));(0,t.props.onOk)(t.state.formTemplate.Ingress)},t.handleCancel=function(){var e=t.state.subRoute;if(e.onCancel)return e.onCancel(),void t.setState({subRoute:{}});(0,t.props.onCancel)()},t.form=d.default.createRef(),t.state={subRoute:{},formTemplate:{Ingress:e.detail}},t}return(0,s.default)(a,e),(0,i.default)(a,[{key:"getChildContext",value:function(){return{registerSubRoute:this.registerSubRoute,resetSubRoute:this.resetSubRoute}}}]),(0,i.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.detail!==this.state.formTemplate.Ingress&&this.setState({formTemplate:{Ingress:e.detail}})}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.isSubmitting,l=this.state,r=l.subRoute,o=l.formTemplate;return d.default.createElement(m.default,{width:960,title:t("Edit Rules"),icon:"firewall",onOk:this.handleOk,okText:(0,f.default)(r)?t("Update"):t("Save"),cancelText:(0,f.default)(r)?null:t("Previous"),onCancel:this.handleCancel,visible:a,isSubmitting:n},d.default.createElement("div",{className:h.default.wrapper},d.default.createElement(p.default,{module:"ingresses",formRef:this.form,formTemplate:o})))}}]),a}(d.default.Component);v.propTypes={detail:c.default.object,visible:c.default.bool,onOk:c.default.func,onCancel:c.default.func,isSubmitting:c.default.bool},v.defaultProps={detail:{},visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1},v.childContextTypes={registerSubRoute:c.default.func,resetSubRoute:c.default.func};var g=v;a.default=g},2828:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.Component=a.default=void 0;var r=l(n(97)),o=l(n(63)),u=l(n(37)),i=l(n(13)),s=l(n(14)),d=l(n(17)),c=l(n(16)),f=l(n(18)),m=l(n(22)),p=l(n(115)),h=l(n(959)),v=l(n(58)),g=l(n(0)),y=n(19),E=n(60),b=l(n(942)),_=l(n(267)),S=n(114),k=l(n(2537)),C=l(n(947)),w=l(n(2556)),N=l(n(3535)),T=l(n(2803)),P=function(e){function a(e){var n;return(0,i.default)(this,a),(n=(0,d.default)(this,(0,c.default)(a).call(this,e))).showRule=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n.setState({showRule:!0,selectRule:(0,u.default)({},e,{_host:e.host})})},n.hideRule=function(){n.setState({showRule:!1,selectRule:{}})},n.handleRule=function(e){var t=e.protocol,a=e.secretName,l=e._host,u=(0,o.default)(e,["protocol","secretName","_host"]),i=l||u.host,s=(0,m.default)(n.formTemplate,"spec.rules"),d=[];d=s.find((function(e){return e.host===i}))?s.map((function(e){return e.host===i?u:e})):[].concat((0,r.default)(s),[u]),(0,p.default)(n.formTemplate,"spec.rules",d);var c=(0,m.default)(n.formTemplate,"spec.tls[0]",{});c.hosts&&c.hosts.includes(i)?"http"===t?(c.hosts=c.hosts.filter((function(e){return e!==i})),(0,v.default)(c.hosts)?(0,p.default)(n.formTemplate,"spec.tls",[]):(0,p.default)(n.formTemplate,"spec.tl[0]",c)):"https"===t&&(c.secretName=a,(0,p.default)(n.formTemplate,"spec.tls[0]",c)):"https"===t&&(c.secretName=a,c.hosts=(0,h.default)([].concat((0,r.default)(c.hosts||[]),[i])),(0,p.default)(n.formTemplate,"spec.tls[0]",c)),n.hideRule()},n.rulesValidator=function(e,a,l){var r=(0,y.toJS)(n.routerStore.gateway),o=r.data,u=r.isLoading;return(0,v.default)(o)&&!u?l({message:t("UNABLE_CREATE_ROUTE_TIP")}):(0,v.default)(a)?l({message:t("Please add at least one routing rule")}):void l()},n.state={showRule:!1,selectRule:{}},n.secretStore=new k.default,n.serviceStore=new C.default,n.routerStore=new w.default,n.secretStore.fetchList({namespace:n.namespace}),n.serviceStore.fetchList({namespace:n.namespace,limit:1/0}),n.routerStore.getGateway({namespace:n.namespace}).then((function(){(0,y.toJS)(n.routerStore.gateway).data.serviceMeshEnable&&(0,p.default)(n.formTemplate,'metadata.annotations["nginx.ingress.kubernetes.io/service-upstream"]',"true")})),n}return(0,f.default)(a,e),(0,s.default)(a,[{key:"renderRuleForm",value:function(e){var t=(0,y.toJS)(this.secretStore.list).data,a=(0,y.toJS)(this.serviceStore.list).data,n=(0,y.toJS)(this.routerStore.gateway).data;return g.default.createElement(T.default,{data:e,gateway:n,secrets:t,services:a,onSave:this.handleRule,onCancel:this.hideRule})}},{key:"render",value:function(){var e=this.props.formRef,a=this.state,n=a.showRule,l=a.selectRule,r=(0,y.toJS)(this.routerStore.gateway),o=r.data,u=r.isLoading;if(n)return this.renderRuleForm(l);var i=(0,v.default)(o)&&!u;return g.default.createElement(_.default,{data:this.formTemplate,ref:e},i&&g.default.createElement(b.default,{className:"margin-b12",description:t.html("NO_INTERNET_ACCESS_TIP"),type:"warning"}),g.default.createElement(_.default.Item,{rules:[{validator:this.rulesValidator}]},g.default.createElement(N.default,{name:"spec.rules",onShow:this.showRule,disabled:i})))}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,m.default)(t,S.MODULE_KIND_MAP[a],t)}},{key:"namespace",get:function(){return(0,m.default)(this.formTemplate,"metadata.namespace")}}]),a}(g.default.Component),M=(0,E.observer)(P);a.default=M;var R=P;a.Component=R},2829:function(e,t,a){e.exports={wrapper:"RuleList__wrapper--284aG",add:"RuleList__add--2rqJg",empty:"RuleList__empty--1HN_-",card:"RuleList__card--2grXj",content:"RuleList__content--1iqID",title:"RuleList__title--1gOz0",path:"RuleList__path--3yf0E"}},2830:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(37)),o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(115)),f=l(n(58)),m=l(n(2466)),p=l(n(0)),h=l(n(1)),v=l(n(2455)),g=l(n(2454)),y=l(n(942)),E=l(n(2470)),b=l(n(387)),_=l(n(267)),S=l(n(224)),k=l(n(2538)),C=l(n(2578)),w=l(n(3538)),N=function(e){function a(e){var t;return(0,o.default)(this,a),(t=(0,i.default)(this,(0,s.default)(a).call(this,e))).getTypeOptions=function(){return[{label:"NodePort",value:"NodePort"},{label:"LoadBalancer",value:"LoadBalancer"}]},t.handleOk=function(){var e=t.props.onOk,a=t.state.isChecked,n=t.form.current,l=(0,m.default)(n.getData(),["type","annotations"]);(0,c.default)(l,'annotations["servicemesh.kubesphere.io/enabled"]',a?"true":"false"),e((0,r.default)({},l))},t.handleTypeChange=function(e){var a=t.form.current.getData();"LoadBalancer"===e&&(0,f.default)(a.annotations)?(0,c.default)(a,"annotations",t.anonotationsDefault):a.annotations&&(t.setState({annotations:a.annotations}),delete a.annotations),t.setState({type:e})},t.handleToggleChange=function(e){t.setState({isChecked:e})},t.form=p.default.createRef(),t.state={type:e.detail.type||"NodePort",annotations:e.detail.annotations||{},isChecked:e.detail.serviceMeshEnable||!1},t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.visible&&e.visible!==this.props.visible&&this.setState({type:e.detail.type||"NodePort",isChecked:e.detail.serviceMeshEnable||!1,annotations:e.detail.annotations||{}})}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel,l=e.detail,r=void 0===l?{}:l,o=e.isSubmitting,u=this.state,i=u.type,s=u.isChecked;return p.default.createElement(b.default,{width:1162,title:t("Set Gateway"),onCancel:n,visible:a,bodyClassName:w.default.modalBody,closable:!1,hideFooter:!0},p.default.createElement("div",{className:w.default.body},p.default.createElement(C.default,{title:t("Set Gateway"),desc:t("PROJECT_INTERNET_ACCESS_DESC")}),p.default.createElement("div",{className:w.default.wrapper},p.default.createElement("div",{className:w.default.content},p.default.createElement(_.default,{ref:this.form,data:r},p.default.createElement(_.default.Item,{label:t("Access Method"),className:w.default.types},p.default.createElement(g.default,{name:"type",wrapClassName:"radio-default",buttonWidth:155,defaultValue:i,onChange:this.handleTypeChange,size:"small"},p.default.createElement(v.default,{value:"NodePort"},"NodePort"),p.default.createElement(v.default,{value:"LoadBalancer"},"LoadBalancer"))),p.default.createElement(y.default,{className:"margin-t12",type:"info",description:t("INGRESS_CONTROLLER_".concat(i.toUpperCase(),"_DESC"))}),globals.app.hasKSModule("servicemesh")&&p.default.createElement(p.default.Fragment,null,p.default.createElement("div",{className:w.default.toggle},t("Application Governance"),p.default.createElement(E.default,{checked:s,onChange:this.handleToggleChange,onText:t("On"),offText:t("Off")})),p.default.createElement("div",{className:w.default.toggleTip},t("GATEWAY_APPLICATION_GOVERNANCE_TIP"))),"LoadBalancer"===i&&p.default.createElement(_.default.Item,{label:t("Annotations")},p.default.createElement(k.default,{name:"annotations",addText:t("Add Annotation"),defaultValue:this.anonotationsDefault})))))),p.default.createElement("div",{className:w.default.footer},p.default.createElement(S.default,{type:"control",onClick:this.handleOk,loading:o,disabled:o},t("Save"))))}},{key:"anonotationsDefault",get:function(){return(0,f.default)(this.state.annotations)?globals.config.loadBalancerDefaultAnnotations:this.state.annotations}}]),a}(p.default.Component);a.default=N,N.propTypes={detail:h.default.object,visible:h.default.bool,onOk:h.default.func,onCancel:h.default.func,isSubmitting:h.default.bool},N.defaultProps={detail:{},visible:!1,isSubmitting:!1,onOk:function(){},onCancel:function(){}}},2831:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(17)),u=l(n(16)),i=l(n(14)),s=l(n(18)),d=l(n(0)),c=l(n(1)),f=l(n(58)),m=l(n(387)),p=l(n(954)),h=l(n(2832)),v=l(n(3564)),g=function(e){function a(e){var t;return(0,r.default)(this,a),(t=(0,o.default)(this,(0,u.default)(a).call(this,e))).registerSubRoute=function(e,a){t.setState({subRoute:{onSave:e,onCancel:a}})},t.resetSubRoute=function(){t.setState({subRoute:{}})},t.handleSubFormSave=function(){var e=t.state.subRoute;e&&e.onSave&&e.onSave((function(){t.setState({subRoute:{}})}))},t.handleSubFormCancel=function(){var e=t.state.subRoute;e&&e.onCancel&&(e.onCancel(),t.setState({subRoute:{}}))},t.handleOk=function(){(0,t.props.onOk)(t.state.formTemplate)},t.state={formTemplate:e.detail,subRoute:{}},t}return(0,s.default)(a,e),(0,i.default)(a,[{key:"getChildContext",value:function(){return{registerSubRoute:this.registerSubRoute,resetSubRoute:this.resetSubRoute}}}]),(0,i.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.detail&&e.detail!==this.props.detail&&this.setState({formTemplate:e.detail}),e.visible&&e.visible!==this.props.visible&&this.setState({subRoute:{}})}},{key:"renderSaveBar",value:function(){var e=this.state.subRoute;return(0,f.default)(e)?null:d.default.createElement(p.default,{className:v.default.confirm,onOk:this.handleSubFormSave,onCancel:this.handleSubFormCancel})}},{key:"render",value:function(){var e=this.state.subRoute,a=this.props,n=a.visible,l=a.isSubmitting,r=a.onCancel;return d.default.createElement(m.default,{width:960,title:t("Modify Config"),icon:"pen",bodyClassName:v.default.body,onOk:this.handleOk,okText:t("Update"),onCancel:r,visible:n,disableSubmit:!(0,f.default)(e),isSubmitting:l},d.default.createElement(h.default,{formTemplate:this.state.formTemplate}),this.renderSaveBar())}}]),a}(d.default.Component);a.default=g,g.propTypes={detail:c.default.object,visible:c.default.bool,onOk:c.default.func,onCancel:c.default.func,isSubmitting:c.default.bool},g.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1},g.childContextTypes={registerSubRoute:c.default.func,resetSubRoute:c.default.func}},2832:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(37)),o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=l(n(22)),m=l(n(115)),p=n(114),h=l(n(267)),v=l(n(3560)),g=l(n(3562)),y=function(e){function a(){var e,t;(0,o.default)(this,a);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(t=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(l)))).state={state:"",selectDataKey:""},t.handleData=function(e){var a=t.state.selectDataKey,n=(0,f.default)(t.formTemplate,"data",{});a&&delete n[a],(0,m.default)(t.formTemplate,"data",(0,r.default)({},n,e)),t.hideDataForm()},t.showDataForm=function(){t.setState({state:"data",selectDataKey:""})},t.hideDataForm=function(){t.setState({state:"",selectDataKey:""})},t.handleDataItemEdit=function(e){t.setState({state:"data",selectDataKey:e})},t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"renderDataForm",value:function(){var e=this.state.selectDataKey,t=(0,f.default)(this.formTemplate,"data",{});return c.default.createElement(g.default,{detail:t,selectKey:e,onOk:this.handleData,onCancel:this.hideDataForm})}},{key:"render",value:function(){var e=this.props.formRef;return"data"===this.state.state?this.renderDataForm():c.default.createElement(h.default,{data:this.formTemplate,ref:e},c.default.createElement(h.default.Item,{label:t("Config Value")},c.default.createElement(v.default,{name:"data",onEdit:this.handleDataItemEdit,onAdd:this.showDataForm})))}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,f.default)(t,p.MODULE_KIND_MAP[a],t)}}]),a}(c.default.Component);a.default=y},2833:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(37)),o=l(n(13)),u=l(n(17)),i=l(n(16)),s=l(n(14)),d=l(n(18)),c=l(n(0)),f=l(n(1)),m=n(19),p=l(n(58)),h=l(n(387)),v=l(n(954)),g=l(n(2834)),y=l(n(3575)),E=function(e){function a(e){var t;return(0,o.default)(this,a),(t=(0,u.default)(this,(0,i.default)(a).call(this,e))).registerSubRoute=function(e,a){t.setState({subRoute:{onSave:e,onCancel:a}})},t.resetSubRoute=function(){t.setState({subRoute:{}})},t.handleSubFormSave=function(){var e=t.state.subRoute;e&&e.onSave&&e.onSave((function(){t.setState({subRoute:{}})}))},t.handleSubFormCancel=function(){var e=t.state.subRoute;e&&e.onCancel&&(e.onCancel(),t.setState({subRoute:{}}))},t.handleOk=function(){(0,t.props.onOk)(t.state.formTemplate)},t.state={formTemplate:t.getFormTemplate(e.detail),subRoute:{}},t}return(0,d.default)(a,e),(0,s.default)(a,[{key:"getChildContext",value:function(){return{registerSubRoute:this.registerSubRoute,resetSubRoute:this.resetSubRoute}}}]),(0,s.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.detail!==this.props.detail&&this.setState({formTemplate:this.getFormTemplate(e.detail)}),e.visible&&e.visible!==this.props.visible&&this.setState({subRoute:{}})}},{key:"getFormTemplate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,m.toJS)(e._originData);if("kubernetes.io/dockerconfigjson"===e.type){var a=e.data,n=Object.keys(a[".dockerconfigjson"].auths)[0];return(0,r.default)({},t,{data:{".dockerconfigjson":(0,r.default)({url:n},a[".dockerconfigjson"].auths[n])}})}return(0,r.default)({},t,{data:e.data})}},{key:"renderSaveBar",value:function(){var e=this.state.subRoute;return(0,p.default)(e)?null:c.default.createElement(v.default,{className:y.default.confirm,onOk:this.handleSubFormSave,onCancel:this.handleSubFormCancel})}},{key:"render",value:function(){var e=this.state.subRoute,a=this.props,n=a.visible,l=a.isSubmitting,r=a.onCancel;return c.default.createElement(h.default,{width:960,title:t("Edit Secret"),icon:"pen",bodyClassName:y.default.body,onOk:this.handleOk,okText:t("Update"),onCancel:r,visible:n,disableSubmit:!(0,p.default)(e),isSubmitting:l},c.default.createElement(g.default,{formTemplate:this.state.formTemplate,mode:"edit"}),this.renderSaveBar())}}]),a}(c.default.Component);a.default=E,E.propTypes={detail:f.default.object,visible:f.default.bool,onOk:f.default.func,onCancel:f.default.func,isSubmitting:f.default.bool},E.defaultProps={detail:{},visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1},E.childContextTypes={registerSubRoute:f.default.func,resetSubRoute:f.default.func}},2834:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(37)),o=l(n(82)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(22)),m=l(n(115)),p=l(n(130)),h=l(n(0)),v=n(938),g=l(n(386)),y=l(n(982)),E=l(n(2453)),b=l(n(267)),_=l(n(3567)),S=l(n(3569)),k=n(49),C=n(114),w=l(n(3571)),N=l(n(3573)),T=["Opaque","kubernetes.io/tls","kubernetes.io/dockerconfigjson","kubernetes.io/basic-auth"],P=function(e){function a(){var e,n;(0,u.default)(this,a);for(var l=arguments.length,i=new Array(l),c=0;c<l;c++)i[c]=arguments[c];return(n=(0,s.default)(this,(e=(0,d.default)(a)).call.apply(e,[this].concat(i)))).state={type:(0,f.default)(n.formTemplate,"type",""),state:"",selectDataKey:""},n.getTypeOptions=function(){return[{label:t("Default"),value:"Opaque"},{label:t("TLS"),value:"kubernetes.io/tls"},{label:t("Image Repository Secret"),value:"kubernetes.io/dockerconfigjson"},{label:t("Account Password Secret"),value:"kubernetes.io/basic-auth"}]},n.handleTypeChange=function(e){e&&!T.includes(e)||(0,m.default)(n.formTemplate,"data",{}),n.setState({type:e})},n.dataValidator=function(e,a,n){return(0,p.default)(a)?n():Object.entries(a).some((function(e){var t=(0,o.default)(e,2),a=t[0],n=t[1];return(0,k.hasChinese)(a)||(0,k.hasChinese)(n)}))?n({message:t("SECRET_NO_CHINESE_CODE_DESC")}):void n()},n.handleData=function(e){var t=n.state.selectDataKey,a=(0,f.default)(n.formTemplate,"data",{});t&&delete a[t],(0,m.default)(n.formTemplate,"data",(0,r.default)({},a,e)),n.hideDataForm()},n.showDataForm=function(){n.setState({state:"data",selectDataKey:""})},n.hideDataForm=function(){n.setState({state:"",selectDataKey:""})},n.handleDataItemEdit=function(e){n.setState({state:"data",selectDataKey:e})},n}return(0,c.default)(a,e),(0,i.default)(a,[{key:"renderDataForm",value:function(){var e=this.state.selectDataKey,t=(0,f.default)(this.formTemplate,"data",{});return h.default.createElement(N.default,{detail:t,selectKey:e,onOk:this.handleData,onCancel:this.hideDataForm})}},{key:"renderDefault",value:function(){return h.default.createElement(b.default.Item,{label:t("Data"),rules:[{required:!0,message:t("Please input data")},{validator:this.dataValidator}]},h.default.createElement(w.default,{name:"data",onEdit:this.handleDataItemEdit,onAdd:this.showDataForm}))}},{key:"renderTLS",value:function(){return h.default.createElement("div",{className:"margin-t8"},h.default.createElement(b.default.Item,{label:t("Credential"),rules:[{required:!0,message:t("Please input credential")},{validator:this.dataValidator}]},h.default.createElement(E.default,{name:"data['tls.crt']",rows:"6",resize:!0})),h.default.createElement(b.default.Item,{label:t("Private Key"),rules:[{required:!0,message:t("Please input private key")},{validator:this.dataValidator}]},h.default.createElement(E.default,{name:"data['tls.key']",rows:"6",resize:!0})))}},{key:"renderImage",value:function(){return h.default.createElement("div",{className:"margin-t8"},h.default.createElement("input",{name:"username",className:"hidden-input",type:"text",disabled:!0}),h.default.createElement("input",{name:"password",className:"hidden-input",type:"password",disabled:!0}),h.default.createElement(v.Columns,null,h.default.createElement(v.Column,null,h.default.createElement(b.default.Item,{label:t("Registry Address"),desc:t("Example: docker.io"),rules:[{required:!0,message:t("Please input registry address")},{validator:this.dataValidator}]},h.default.createElement(S.default,{name:"data['.dockerconfigjson'].url"}))),h.default.createElement(v.Column,null,h.default.createElement(b.default.Item,{label:t("User Name"),rules:[{required:!0,message:t("Please input user name")},{validator:this.dataValidator}]},h.default.createElement(g.default,{name:"data['.dockerconfigjson'].username",autoComplete:"nope"})))),h.default.createElement(v.Columns,null,h.default.createElement(v.Column,null,h.default.createElement(b.default.Item,{label:t("Email")},h.default.createElement(g.default,{name:"data['.dockerconfigjson'].email"}))),h.default.createElement(v.Column,null,h.default.createElement(b.default.Item,{label:t("Password"),rules:[{required:!0,message:t("Please input password")},{validator:this.dataValidator}]},h.default.createElement(y.default,{type:"password",name:"data['.dockerconfigjson'].password",autoComplete:"new-password"})))))}},{key:"renderBasicAuth",value:function(){return h.default.createElement("div",{className:"margin-t8"},h.default.createElement(b.default.Item,{label:t("User Name"),rules:[{required:!0,message:t("Please input user name")},{validator:this.dataValidator}]},h.default.createElement(g.default,{name:"data.username",autoComplete:"nope"})),h.default.createElement(b.default.Item,{label:t("Password"),rules:[{required:!0,message:t("Please input password")},{validator:this.dataValidator}]},h.default.createElement(y.default,{type:"password",name:"data.password",autoComplete:"new-password"})))}},{key:"renderContent",value:function(){var e=null;switch(this.state.type){case"Opaque":e=this.renderDefault();break;case"kubernetes.io/tls":e=this.renderTLS();break;case"kubernetes.io/dockerconfigjson":e=this.renderImage();break;case"kubernetes.io/basic-auth":e=this.renderBasicAuth();break;default:e=this.renderDefault()}return e}},{key:"render",value:function(){var e=this.props,a=e.formRef,n=e.mode;return"data"===this.state.state?this.renderDataForm():h.default.createElement(b.default,{data:this.formTemplate,ref:a},"edit"!==n?h.default.createElement(b.default.Item,{label:t("Type"),desc:t("SECRET_TYPE_DESC")},h.default.createElement(_.default,{name:"type",options:this.getTypeOptions(),onChange:this.handleTypeChange,placeholder:t("Please Select")})):h.default.createElement(b.default.Item,{label:t("Type")},h.default.createElement(g.default,{name:"type",disabled:!0})),this.renderContent())}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,f.default)(t,C.MODULE_KIND_MAP[a],t)}}]),a}(h.default.Component);a.default=P},2835:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(70)),r=n(a(63)),o=n(a(13)),u=n(a(14)),i=n(a(17)),s=n(a(16)),d=n(a(18)),c=n(a(0)),f=n(a(1)),m=n(a(2836)),p=n(a(3589)),h=function(e){function t(){return(0,o.default)(this,t),(0,i.default)(this,(0,s.default)(t).apply(this,arguments))}return(0,d.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e=this.props,t=e.module,a=(0,r.default)(e,["module"]);return c.default.createElement(m.default,(0,l.default)({title:"Edit Config Template",icon:"storage",module:t,forms:this.forms},a))}},{key:"forms",get:function(){return p.default[this.props.module]}}]),t}(c.default.Component);t.default=h,h.propTypes={module:f.default.string},h.defaultProps={module:"deployments"}},2836:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(70)),o=l(n(63)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(0)),m=l(n(1)),p=l(n(58)),h=l(n(387)),v=l(n(3586)),g=l(n(3588)),y=function(e){function a(){return(0,u.default)(this,a),(0,s.default)(this,(0,d.default)(a).apply(this,arguments))}return(0,c.default)(a,e),(0,i.default)(a,[{key:"render",value:function(){var e=this.props,a=e.visible,n=e.title,l=e.module,u=e.store,i=e.forms,s=e.onOk,d=e.onCancel,c=(0,o.default)(e,["visible","title","module","store","forms","onOk","onCancel"]);return f.default.createElement(h.default,(0,r.default)({width:1162,bodyClassName:g.default.body,title:t(n),visible:a,onCancel:d,hideFooter:!0},c),f.default.createElement(v.default,{module:l,store:u,forms:i,data:this.formData,onSubmit:s,onCancel:d}))}},{key:"formData",get:function(){var e=this.props,t=e.detail,a=e.formData;return(0,p.default)(a)?t:a}}]),a}(f.default.Component);a.default=y,y.propTypes={visible:m.default.bool,title:m.default.string,module:m.default.string,store:m.default.object,forms:m.default.array,formData:m.default.object,detail:m.default.object,onOk:m.default.func,onCancel:m.default.func},y.defaultProps={visible:!1,title:"Edit",store:{},forms:[],formData:{},detail:{},onOk:function(){},onCancel:function(){}}},2837:function(e,t,a){e.exports={content:"Form__content--33UAj",container:"Form__container--39DHz",tabs:"Form__tabs--1In4W",active:"Form__active--vbsTP",icon:"Form__icon--3hCsl",updated:"Form__updated--5AdLQ",form:"Form__form--3fv66",formActions:"Form__formActions--3b9pa",formWrapper:"Form__formWrapper--3XmPp",footer:"Form__footer--VsyyY",confirm:"Form__confirm--_3s_V"}},2838:function(e,t,a){e.exports={builderItem:"RebuildS2i__builderItem--21Qbt",checkboxCard:"RebuildS2i__checkboxCard--12Qsj",title:"RebuildS2i__title--3XkvU",desc:"RebuildS2i__desc--3us1-",builderSelector:"RebuildS2i__builderSelector--7yo-q"}},2839:function(e,t,a){e.exports={card:"Status__card--1c8ZZ",cardImg:"Status__cardImg--2qWxZ",dark:"Status__dark--TGr9G",status:"Status__status--3XPNv",title:"Status__title--1Pjqe",detail:"Status__detail--1XLvv",scale:"Status__scale--1d_O-",control:"Status__control--nB11J"}},2840:function(e,t,a){e.exports={logContainer:"S2iBuilder__logContainer--2bPpJ",title:"S2iBuilder__title--1e1_E",builderSelector:"S2iBuilder__builderSelector--2qowc",icon:"S2iBuilder__icon--3swHD",noneLogDesc:"S2iBuilder__noneLogDesc--2USfi",running:"S2iBuilder__running--1QDO-",rotate:"S2iBuilder__rotate--1Ut0A",failed:"S2iBuilder__failed--2PhKa",unknow:"S2iBuilder__unknow--1U7K-",successful:"S2iBuilder__successful--3Fqsc"}},2841:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(38)),f=l(n(3620)),m=function(e){function a(){var e,t;(0,r.default)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(t=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(l)))).handleUp=function(){var e=t.props,a=e.value,n=e.onChange;n&&n(a+1)},t.handleDown=function(){var e=t.props,a=e.value,n=e.onChange;n&&n(Math.max(a-1,1))},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props,a=e.value,n=e.onChange;return d.default.createElement("div",{className:f.default.wrapper},d.default.createElement("span",{className:f.default.value},a),d.default.createElement("span",{className:f.default.text},d.default.createElement("p",null,d.default.createElement("strong",null,t("Replicas"))),d.default.createElement("p",null,t("Specify Replicas Number"))),n&&d.default.createElement("span",{className:f.default.buttons},d.default.createElement(c.default,{name:"chevron-up",size:24,onClick:this.handleUp}),d.default.createElement(c.default,{name:"chevron-down",size:24,onClick:this.handleDown})))}}]),a}(d.default.Component);a.default=m},2842:function(e,t,a){e.exports={item:"ContainerTemplate__item--3YLXL",icon:"ContainerTemplate__icon--2LqI2",indicator:"ContainerTemplate__indicator--Ab5df",text:"ContainerTemplate__text--13Gwi",name:"ContainerTemplate__name--3Xfy-",probeItem:"ContainerTemplate__probeItem--GCQ0s",probeType:"ContainerTemplate__probeType--1POvC",probeTime:"ContainerTemplate__probeTime--FBG6a",limits:"ContainerTemplate__limits--11Y1y",limit:"ContainerTemplate__limit--1MSvv"}},2843:function(e,t,a){"use strict";var n=a(81),l=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(a(70)),o=l(a(63)),u=l(a(13)),i=l(a(14)),s=l(a(17)),d=l(a(16)),c=l(a(18)),f=n(a(0)),m=l(a(1)),p=l(a(3)),h=l(a(3628)),v=function(e){function t(){return(0,u.default)(this,t),(0,s.default)(this,(0,d.default)(t).apply(this,arguments))}return(0,c.default)(t,e),(0,i.default)(t,[{key:"render",value:function(){var e=this.props,t=e.className,a=e.name,n=e.value,l=(0,o.default)(e,["className","name","value"]);return f.default.createElement("div",(0,r.default)({className:(0,p.default)(h.default.label,t)},l),f.default.createElement("span",{className:h.default.name},a),n)}}]),t}(f.PureComponent);t.default=v,v.propTypes={className:m.default.string,name:m.default.string,value:m.default.string},v.defaultProps={name:"",value:""}},2844:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(1)),f=l(n(3)),m=l(n(58)),p=l(n(2525)),h=l(n(2535)),v=l(n(3655)),g=l(n(2845)),y=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"renderContent",value:function(){var e=this.props,a=e.data,n=e.isLoading,l=e.prefix;return(0,m.default)(a)&&!n?d.default.createElement("div",{className:g.default.empty},t("NOT_AVAILABLE",{resource:t("Workload")})):d.default.createElement(h.default,{className:g.default.list},a.map((function(e){return d.default.createElement(v.default,{key:"".concat(e.type,"-").concat(e.name),prefix:l,detail:e})})))}},{key:"render",value:function(){var e=this.props.className;return d.default.createElement(p.default,{className:(0,f.default)(g.default.main,e),title:t("Workloads")},this.renderContent())}}]),a}(d.default.Component);a.default=y,y.propTypes={className:c.default.string,prefix:c.default.string,data:c.default.array,isLoading:c.default.bool},y.defaultProps={prefix:"",data:[],isLoading:!1}},2845:function(e,t,a){e.exports={list:"Workloads__list--1Bl9k",item:"Workloads__item--1Obwv",empty:"Workloads__empty--KMh3P"}},2846:function(e,t,a){e.exports={ports:"ResourceStatus__ports--z2EiK",card:"ResourceStatus__card--3Q35Z",content:"ResourceStatus__content--1YLdx",title:"ResourceStatus__title--1Smdy",path:"ResourceStatus__path--xGHTW",access:"ResourceStatus__access--YE_7n",tip:"ResourceStatus__tip--Tjbb2"}},2847:function(e,t,a){e.exports={icon:"Detail__icon--eaku6"}},2848:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(1)),f=l(n(58)),m=l(n(2516)),p=l(n(3679)),h=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"renderContent",value:function(){var e=this.props,t=e.gateway,a=e.data,n=e.prefix;return(0,f.default)(a)?null:a.map((function(e){return d.default.createElement(p.default,{key:e.name,prefix:n,detail:e,gateway:t})}))}},{key:"render",value:function(){var e=this.props,a=e.className,n=e.loading,l=this.props.title||t("Routes");return d.default.createElement(m.default,{className:a,title:l,loading:n,empty:t("NOT_AVAILABLE",{resource:t("Routes")})},this.renderContent())}}]),a}(d.default.Component);a.default=h,h.propTypes={className:c.default.string,prefix:c.default.string,title:c.default.string,data:c.default.array,loading:c.default.bool},h.defaultProps={prefix:"",data:[],loading:!0}},2849:function(e,t,a){e.exports={title:"Monitors__title--23ICm",trafficCard:"Monitors__trafficCard--1IK6l"}},2850:function(e,t,a){e.exports={title:"Pods__title--3S8MQ",version:"Pods__version--2JU6q",pods:"Pods__pods--1V_HS",podItem:"Pods__podItem--3LZMf",text:"Pods__text--2ENvj",icon:"Pods__icon--9VjTr",status:"Pods__status--3FU1Q",running:"Pods__running--3VnQp",updating:"Pods__updating--aqJNY"}},2851:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.Component=a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(58)),c=l(n(0)),f=l(n(129)),m=n(60),p=l(n(224)),h=l(n(388)),v=l(n(2552)),g=l(n(3716)),y=l(n(2632)),E=l(n(2556)),b=l(n(3748)),_=l(n(2684)),S=function(e){function a(e){var n;return(0,r.default)(this,a),(n=(0,u.default)(this,(0,i.default)(a).call(this,e))).showDetail=function(e){n.setState({showDetailModal:!0,selectItem:e})},n.hideDetail=function(){n.setState({showDetailModal:!1,selectItem:{}},(function(){n.getData()}))},n.handleDelete=function(){n.store.delete(n.state.selectItem).then((function(){h.default.success({content:"".concat(t("Job offline Successfully"),"!")}),n.hideDetail()}))},n.showCreateGrayReleaseJob=function(){var e=n.props.match.params.namespace;n.props.rootStore.routing.push("/projects/".concat(e,"/grayrelease/cates"))},n.state={showDetailModal:!1,selectItem:{}},n.store=new y.default,n.routerStore=new E.default,n}return(0,s.default)(a,e),(0,o.default)(a,[{key:"componentDidMount",value:function(){this.getData(),this.routerStore.getGateway(this.props.match.params)}},{key:"getData",value:function(){this.store.fetchList({namespace:this.namespace})}},{key:"renderHeader",value:function(){return null}},{key:"renderEmpty",value:function(){return c.default.createElement(v.default,{icon:"istio",title:t("NO_GRAY_RELEASE_JOBS_TIP"),desc:t("NO_GRAY_RELEASE_JOBS_TIP_2"),actions:this.canCreate?c.default.createElement(p.default,{type:"control",onClick:this.showCreateGrayReleaseJob},t("Create Grayscale Release Job")):null})}},{key:"renderContent",value:function(){var e=this,t=this.store.list,a=t.data;return t.isLoading?c.default.createElement(f.default,{className:_.default.loading}):(0,d.default)(a)?this.renderEmpty():c.default.createElement("div",{className:_.default.items},a.map((function(t){return c.default.createElement(b.default,{key:t.name,data:t,onClick:e.showDetail,store:e.store})})))}},{key:"renderFooter",value:function(){var e=this.store.list.total;return c.default.createElement("div",{className:_.default.footer},c.default.createElement("p",null,t("TOTAL_GRAY_RELEASE_JOBS",{num:e})))}},{key:"render",value:function(){return c.default.createElement("div",null,this.renderHeader(),this.renderContent(),this.renderFooter(),c.default.createElement(g.default,{detail:this.state.selectItem,visible:this.state.showDetailModal,onCancel:this.hideDetail,onDelete:this.handleDelete}))}},{key:"namespace",get:function(){return this.props.match.params.namespace}},{key:"canCreate",get:function(){var e=this.props.match.params.namespace;return globals.app.getActions({module:"applications",project:e}).includes("edit")&&this.serviceMeshEnable}},{key:"serviceMeshEnable",get:function(){return globals.app.hasKSModule("servicemesh")&&this.routerStore.gateway.data.serviceMeshEnable}}]),a}(c.default.Component),k=(0,m.inject)("rootStore")((0,m.observer)(S));a.default=k;var C=S;a.Component=C},2852:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(70)),r=n(a(63)),o=n(a(13)),u=n(a(14)),i=n(a(17)),s=n(a(16)),d=n(a(18)),c=n(a(130)),f=n(a(0)),m=n(a(2471)),p=n(a(3717)),h={className:p.default.slider,railStyle:{height:30,backgroundColor:"#7eb8dc",borderRadius:2},handleStyle:{width:14,height:30,marginTop:0,backgroundColor:"#fff",borderRadius:0,border:"none"},trackStyle:{height:30,borderRadius:2,backgroundColor:"#329dce"}},v=function(e){function t(){return(0,o.default)(this,t),(0,i.default)(this,(0,s.default)(t).apply(this,arguments))}return(0,d.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e=this.props,t=e.leftContent,a=e.rightContent,n=e.defaultValue,o=(0,r.default)(e,["leftContent","rightContent","defaultValue"]),u=(0,c.default)(o.value)?n:o.value;return f.default.createElement("div",{className:p.default.wrapper},f.default.createElement(m.default,(0,l.default)({min:0,max:100,defaultValue:u},o,h)),f.default.createElement("span",{className:p.default.floatContent,style:{left:"".concat(Math.floor(u/2),"%"),maxWidth:"".concat(u,"%")}},"".concat(t," ").concat(u,"%")),f.default.createElement("span",{className:p.default.floatContent,style:{left:"".concat(Math.floor(u/2)+50,"%"),maxWidth:"".concat(100-u,"%")}},"".concat(a," ").concat(100-u,"%")))}}]),t}(f.default.PureComponent);t.default=v,v.defaultProps={defaultValue:50}},2853:function(e,t,a){e.exports={wrapper:"Component__wrapper--1FRrr",header:"Component__header--17yDb",title:"Component__title--1ND4C",right:"Component__right--3DW67",pods:"Component__pods--2dJag",metric:"Component__metric--3MWAA",icon:"Component__icon--22V6M",status:"Component__status--22doJ",running:"Component__running--3UPN8",updating:"Component__updating--S6AbH",offline:"Component__offline--15G7m"}},2854:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(70)),u=l(n(82)),i=l(n(13)),s=l(n(14)),d=l(n(17)),c=l(n(16)),f=l(n(18)),m=l(n(22)),p=l(n(115)),h=l(n(268)),v=l(n(0)),g=n(60),y=n(938),E=l(n(386)),b=l(n(267)),_=l(n(2841)),S=l(n(2574)),k=l(n(2559)),C=l(n(2537)),w=l(n(2536)),N=n(49),T=n(114),P=l(n(3726)),M=l(n(3728)),R=(0,g.observer)(r=function(e){function a(e){var n;return(0,i.default)(this,a),(n=(0,d.default)(this,(0,c.default)(a).call(this,e))).versionValidator=function(e,a,l){if(!a)return l();var r=(0,m.default)(n.formTemplate,"metadata.labels.app",""),o="".concat(r,"-").concat(a);n.workloadStore.checkName({name:o,namespace:n.namespace}).then((function(a){if(a.exist)return l({message:t("".concat(t("Deployments")," ").concat(o," ").concat(t("exists"),", ").concat(t("version number is invalid"))),field:e.field});l()}))},n.handleVersionChange=(0,h.default)((function(e){var t=(0,m.default)(n.formTemplate,"metadata.labels.app","");(0,p.default)(n.formTemplate,"metadata.name","".concat(t,"-").concat(e)),(0,N.mergeLabels)(n.formTemplate,{version:e})}),200),n.configMapStore=new k.default,n.secretStore=new C.default,n.module=(0,m.default)(e.formTemplate,'strategy.metadata.annotations["servicemesh.kubesphere.io/workloadType"]',"deployments"),n.workloadStore=new w.default(n.module),n.state={configMaps:[],secrets:[]},n}return(0,f.default)(a,e),(0,s.default)(a,[{key:"fetchData",value:function(){var e=this,t=(0,m.default)(this.formTemplate,"metadata.namespace");Promise.all([this.configMapStore.fetchByK8s({namespace:t}),this.secretStore.fetchByK8s({namespace:t})]).then((function(t){var a=(0,u.default)(t,2),n=a[0],l=a[1];e.setState({configMaps:n,secrets:l})}))}},{key:"renderReplicasControl",value:function(){return v.default.createElement(y.Column,{className:"is-narrow"},v.default.createElement(b.default.Item,{className:M.default.narrow,label:t("Grayscale Release Version Number"),desc:t("GRAY_RELEASE_VERSION_FORMAT_DESC"),rules:[{required:!0,message:t("Please input grayscale release version")},{pattern:T.PATTERN_COMPONENT_VERSION,message:t("Invalid version")},{validator:this.versionValidator}]},v.default.createElement(E.default,{name:"metadata.labels.version",onChange:this.handleVersionChange,disabled:this.isEdit})),v.default.createElement("div",{className:M.default.specify},v.default.createElement(b.default.Item,null,v.default.createElement(_.default,{name:"spec.replicas"}))))}},{key:"renderContainerList",value:function(){return v.default.createElement(y.Column,null,v.default.createElement(b.default.Item,{rules:[{validator:this.containersValidator}]},v.default.createElement(P.default,{name:"".concat(this.prefix,"spec.containers"),onShow:this.showContainer,disabled:this.isEdit})))}},{key:"render",value:function(){var e=this.props,t=e.formRef,a=e.formProps,n=this.state,l=n.showContainer,r=n.selectContainer;return l?this.renderContainerForm(r):v.default.createElement(b.default,(0,o.default)({data:this.formTemplate,ref:t},a),v.default.createElement(y.Columns,null,this.renderReplicasControl(),this.renderContainerList()))}},{key:"formTemplate",get:function(){return this.props.formTemplate.workload||{}}},{key:"namespace",get:function(){return(0,m.default)(this.formTemplate,"metadata.namespace")}}]),a}(S.default))||r;a.default=R},2855:function(e,t,a){e.exports={list:"ContainerList__list--1y7sr",card:"ContainerList__card--1CNnv",text:"ContainerList__text--apRGS",inputs:"ContainerList__inputs--3JM-K"}},2856:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r=n(a(70)),o=n(a(13)),u=n(a(14)),i=n(a(17)),s=n(a(16)),d=n(a(18)),c=n(a(0)),f=a(60),m=n(a(22)),p=n(a(3729)),h=n(a(3742)),v=n(a(3746)),g={Canary:p.default,Bluegreen:h.default,Mirror:v.default},y=(0,f.observer)(l=function(e){function t(){return(0,o.default)(this,t),(0,i.default)(this,(0,s.default)(t).apply(this,arguments))}return(0,d.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e=this.props,t=e.formRef,a=e.formProps,n=g[this.strategyType];return n?c.default.createElement(n,(0,r.default)({formRef:t,formTemplate:this.formTemplate},a)):null}},{key:"strategyType",get:function(){return(0,m.default)(this.formTemplate,"strategy.spec.type","")}},{key:"formTemplate",get:function(){return this.props.formTemplate}}]),t}(c.default.Component))||l;t.default=y},2857:function(e,t,a){e.exports={tracing:"Tracing__tracing--2_q0D",cardHeader:"Tracing__cardHeader--2p8zO",operations:"Tracing__operations--2us2j",cardContent:"Tracing__cardContent--bLd4-",item:"Tracing__item--21M_0",header:"Tracing__header--30mNl",title:"Tracing__title--1uRSf",duration:"Tracing__duration--2L_QS",durationBar:"Tracing__durationBar--11R8V",content:"Tracing__content--2q0NQ",spanWrapper:"Tracing__spanWrapper--2fWwh",spans:"Tracing__spans--IrkUr",errorSpans:"Tracing__errorSpans--1oP4n",services:"Tracing__services--Chnaw",tag:"Tracing__tag--1x47C",startTime:"Tracing__startTime--ywM5J",empty:"Tracing__empty--1dvYF",icon:"Tracing__icon--3dAwF"}},2858:function(e,t,a){e.exports={graph:"SpanGraph__graph--2QbHX",cursorGuide:"SpanGraph__cursorGuide--1lrCe",scrubber:"SpanGraph__scrubber--iItn2",scrubberLine:"SpanGraph__scrubberLine--3dtf1",coord:"SpanGraph__coord--1BgtG",coordLine:"SpanGraph__coordLine--2aJZB",range:"SpanGraph__range--1GZb6",hoverBlock:"SpanGraph__hoverBlock--cJtJ8",clearBlock:"SpanGraph__clearBlock--2ljlM"}},2859:function(e,t,a){e.exports={select:"ServiceSelect__select--LQq8g",control:"ServiceSelect__control--RY0du",rightIcon:"ServiceSelect__rightIcon--Qr5OA",selected:"ServiceSelect__selected--2jaiT",options:"ServiceSelect__options--38p77",item:"ServiceSelect__item--lqe-P",icon:"ServiceSelect__icon--3DG4Q",name:"ServiceSelect__name--7F-nO",empty:"ServiceSelect__empty--1u6Sg"}},2860:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o,u,i=l(n(61)),s=l(n(37)),d=l(n(62)),c=l(n(13)),f=l(n(14)),m=l(n(17)),p=l(n(16)),h=l(n(18)),v=l(n(0)),g=n(60),y=l(n(1)),E=l(n(3)),b=l(n(58)),_=l(n(967)),S=n(938),k=l(n(949)),C=l(n(129)),w=l(n(2534)),N=l(n(224)),T=l(n(3801)),P=l(n(3803)),M=(0,g.observer)((u=o=function(e){function a(e){var n;return(0,c.default)(this,a),(n=(0,m.default)(this,(0,p.default)(a).call(this,e))).setAutoRefresh=function(){var e=n.store.list.data;clearInterval(n.timer),e.some((function(e){return!["successful","failed"].includes(e.status)||(0,b.default)(e.status)}))&&(n.timer=setInterval(n.fetchData,4e3))},n.fetchData=(0,d.default)(i.default.mark((function e(){var t,a,l,r,o=arguments;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},a=n.props,l=a.limit,r=a.params,e.next=4,n.store.fetchS2IRunRecords((0,s.default)({limit:l},r,t));case 4:n.setAutoRefresh();case 5:case"end":return e.stop()}}),e)}))),n.getPagination=function(){var e=n.store.list;return{page:e.page,limit:e.limit,total:e.total}},n.handleSearch=function(e){n.searchValue=e,n.fetchData({name:e}).then((function(){n.props.onSearch(e)}))},n.handleRefresh=function(){var e=n.searchValue?{name:n.searchValue}:{};n.fetchData(e).then((function(){var t=n.props,a=t.onSearch,l=t.onRefresh;(0,b.default)(e)?l():a(n.searchValue)}))},n.handlePage=function(e){n.fetchData({page:e}).then((function(){n.props.onPage(e)}))},n.renderHeader=function(){return v.default.createElement("div",{className:P.default.header},v.default.createElement(w.default,{className:P.default.search,name:"search",placeholder:t("Please input a keyword to filter"),onSearch:n.handleSearch}),v.default.createElement("div",{className:P.default.actions},v.default.createElement(N.default,{type:"flat",icon:"refresh",onClick:n.handleRefresh})))},n.renderFooter=function(){var e=n.getPagination(),a=e.total,l=e.page,r=e.limit;return v.default.createElement(S.Level,{className:P.default.footer},v.default.createElement(S.LevelLeft,null,t("TOTAL_ITEMS",{num:a})),v.default.createElement(S.LevelRight,null,v.default.createElement(k.default,{current:l,total:a,pageSize:r,onChange:n.handlePage})))},n.store=new _.default,n}return(0,h.default)(a,e),(0,f.default)(a,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer)}},{key:"renderContent",value:function(){var e=this,a=this.store.list,n=a.data,l=a.isLoading,r=v.default.createElement("div",{className:P.default.body},(0,b.default)(n)?v.default.createElement("div",{className:P.default.empty},t("RESOURCE_NOT_FOUND")):n.map((function(t){return e.renderItem(t)})));return this.isTable?v.default.createElement(C.default,{spinning:l},r):r}},{key:"renderItem",value:function(e){var t=this.store.list.isLoading;return v.default.createElement(T.default,{key:e.name,runDetail:e,loading:t,store:this.store,isB2i:this.props.isB2i})}},{key:"render",value:function(){var e=this.props,t=e.className,a=e.hideHeader,n=e.hideFooter;return v.default.createElement("div",{className:(0,E.default)(t,P.default.content)},!a&&this.renderHeader(),this.renderContent(),!n&&this.renderFooter())}},{key:"isTable",get:function(){var e=this.props,t=e.hideHeader,a=e.hideFooter;return!t||!a}}]),a}(v.default.Component),o.propTypes={prefix:y.default.string,title:y.default.string,detail:y.default.object,hideHeader:y.default.bool,hideFooter:y.default.bool,onSearch:y.default.func,onRefresh:y.default.func,onPage:y.default.func,limit:y.default.number},o.defaultProps={isB2i:!1,detail:{},hideHeader:!1,hideFooter:!1,onSearch:function(){},onRefresh:function(){},onPage:function(){}},r=u))||r;a.default=M},3345:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(97)),r=a(564),o=n(a(3346)),u=n(a(3352)),i=n(a(3372)),s=n(a(3469)),d=n(a(3484)),c=n(a(3486)),f=n(a(3489)),m=n(a(3500)),p=n(a(3503)),h=n(a(2824)),v=n(a(3532)),g=n(a(3543)),y=n(a(3549)),E=n(a(3559)),b=n(a(3566)),_=n(a(3577)),S=n(a(3578)),k=n(a(3579)),C=n(a(3584)),w=n(a(3652)),N=n(a(3657)),T=n(a(3663)),P=n(a(3667)),M=n(a(3668)),R=n(a(3766)),D=n(a(3770)),O=n(a(2547)),x=n(a(3774)),I=n(a(3776)),A=n(a(3778)),L=n(a(3781)),j=n(a(3792)),V="/projects/:namespace",F=[].concat((0,l.default)(C.default),(0,l.default)(w.default),(0,l.default)(N.default),(0,l.default)(T.default),(0,l.default)(P.default),(0,l.default)(M.default),(0,l.default)(R.default),(0,l.default)(D.default),(0,l.default)(O.default),(0,l.default)(x.default),(0,l.default)(I.default),(0,l.default)(j.default),[{path:V,component:o.default,routes:[].concat((0,l.default)(A.default),(0,l.default)(L.default),[{path:"".concat(V,"/overview"),component:u.default,exact:!0},{path:"".concat(V,"/applications"),component:i.default,exact:!0},{path:"".concat(V,"/applications/:type"),component:i.default,exact:!0},{path:"".concat(V,"/:module(deployments|statefulsets|daemonsets)"),component:s.default,exact:!0},{path:"".concat(V,"/pods"),component:d.default,exact:!0},{path:"".concat(V,"/jobs"),component:c.default,exact:!0},{path:"".concat(V,"/s2ibuilders"),component:f.default,ksModule:"devops",exact:!0},{path:"".concat(V,"/cronjobs"),component:m.default,exact:!0},{path:"".concat(V,"/services"),component:p.default,exact:!0},{path:"".concat(V,"/grayreleases"),component:h.default,ksModule:"servicemesh"},{path:"".concat(V,"/routes"),component:v.default,exact:!0},{path:"".concat(V,"/volumes"),component:g.default,exact:!0},{path:"".concat(V,"/base-info"),component:y.default,exact:!0},{path:"".concat(V,"/configmaps"),component:E.default,exact:!0},{path:"".concat(V,"/secrets"),component:b.default,exact:!0},{path:"".concat(V,"/roles"),component:_.default,exact:!0},{path:"".concat(V,"/members"),component:S.default,exact:!0},{path:"".concat(V,"/advanced"),component:k.default,exact:!0},(0,r.getIndexRoute)({path:"".concat(V,"/workloads"),to:"".concat(V,"/deployments"),exact:!0}),(0,r.getIndexRoute)({path:V,to:"".concat(V,"/overview"),exact:!0}),(0,r.getIndexRoute)({path:"*",to:"/404",exact:!0})])}]);t.default=F},3346:function(e,a,n){"use strict";var l=n(4),r=n(81);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o,u=l(n(61)),i=l(n(62)),s=l(n(13)),d=l(n(14)),c=l(n(17)),f=l(n(16)),m=l(n(18)),p=l(n(22)),h=r(n(0)),v=n(60),g=l(n(129)),y=n(564),E=n(955),b=l(n(2783)),_=l(n(2533)),S=l(n(2543)),k=l(n(2604)),C=(0,v.inject)("rootStore")(o=(0,v.observer)(o=function(e){function a(e){var t;if((0,s.default)(this,a),(t=(0,c.default)(this,(0,f.default)(a).call(this,e))).handleChange=function(e){return t.routing.push(e)},!t.props.rootStore.workspace){var n=new _.default;t.props.rootStore.register("workspace",n)}if(!t.props.rootStore.project){var l=new S.default;t.props.rootStore.register("project",l)}if(!t.props.rootStore.quota){var r=new k.default;t.props.rootStore.register("quota",r)}return t.init(e.match.params),t}var n,l;return(0,m.default)(a,e),(0,d.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.match.params.namespace!==this.project&&this.init(e.match.params)}},{key:"init",value:(l=(0,i.default)(u.default.mark((function e(t){var a,n,l;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.props.rootStore,n=a.quota,l=a.project,n.fetch(t),l.initializing=!0,e.next=5,this.fetchProject(t.namespace);case 5:return e.next=7,this.fetchWorkspace(l.data.workspace);case 7:l.initializing=!1;case 8:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"fetchProject",value:(n=(0,i.default)(u.default.mark((function e(t){var a;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.props.rootStore.project,e.next=3,a.fetchDetail({namespace:t});case 3:if(void 0!==(0,p.default)(globals.user,"rules[".concat(t,"]"))){e.next=7;break}return e.next=7,a.fetchRules({namespace:t,workspace:a.data.workspace});case 7:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"fetchWorkspace",value:function(e){var t=[],a=this.props.rootStore.workspace;return t.push(a.fetchDetail({workspace:e})),void 0===(0,p.default)(globals.user,"workspace_rules[".concat(e,"]"))&&t.push(a.fetchRules({workspace:e})),Promise.all(t)}},{key:"render",value:function(){var e=this.props,a=e.match,n=e.route,l=e.location,r=this.props.rootStore.project.initializing,o=this.props.rootStore.workspace.detail;return r?h.default.createElement(g.default,{className:"ks-page-loading"}):h.default.createElement("div",null,h.default.createElement("div",{className:"ks-page-side"},h.default.createElement(b.default,{title:t("Projects"),value:this.project,onChange:this.handleChange,workspace:o}),h.default.createElement(E.Nav,{className:"ks-page-nav",navs:globals.app.getProjectNavs(this.project),location:l,match:a})),h.default.createElement("div",{className:"ks-page-main"},(0,y.renderRoutes)(n.routes)))}},{key:"project",get:function(){return this.props.match.params.namespace}},{key:"routing",get:function(){return this.props.rootStore.routing}}]),a}(h.Component))||o)||o;a.default=C},3352:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=n(60),m=n(938),p=l(n(22)),h=l(n(3353)),v=l(n(3355)),g=l(n(3357)),y=l(n(3367)),E=l(n(3370)),b=(0,f.inject)("rootStore")(r=(0,f.observer)(r=function(e){function a(){return(0,o.default)(this,a),(0,i.default)(this,(0,s.default)(a).apply(this,arguments))}return(0,d.default)(a,e),(0,u.default)(a,[{key:"render",value:function(){var e=this.project.data;return c.default.createElement("div",null,c.default.createElement("div",{className:"h3 margin-b12"},t("Overview")),c.default.createElement(m.Columns,null,c.default.createElement(m.Column,{className:"is-8"},c.default.createElement(h.default,{className:"margin-b12",detail:e}),globals.app.enableAppStore&&c.default.createElement(v.default,{className:"margin-b12",match:this.props.match}),c.default.createElement(g.default,{match:this.props.match})),c.default.createElement(m.Column,{className:"is-4"},c.default.createElement(E.default,{className:"margin-b12"}),c.default.createElement(y.default,{match:this.props.match}))))}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"namespace",get:function(){return(0,p.default)(this.props.match,"params.namespace")}},{key:"project",get:function(){return this.props.rootStore.project}}]),a}(c.default.Component))||r)||r;a.default=b},3353:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(3)),f=n(226),m=l(n(38)),p=n(49),h=l(n(3354)),v=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"getWorkspaceUrl",value:function(){var e=this.props.detail.workspace;return globals.app.hasPermission({module:"workspaces",action:"manage"})||globals.app.hasPermission({module:"workspaces",action:"view",workspace:e})?"/workspaces/".concat(e,"/overview"):"/"}},{key:"render",value:function(){var e=this.props,a=e.className,n=e.detail;return d.default.createElement("div",{className:(0,c.default)(h.default.wrapper,a)},d.default.createElement("div",{className:h.default.header},d.default.createElement(m.default,{name:"project",size:40}),d.default.createElement("div",{className:h.default.text},d.default.createElement("div",null,(0,p.getDisplayName)(n)),d.default.createElement("p",null,n.description||"-"))),d.default.createElement("div",{className:h.default.content},d.default.createElement("div",{className:h.default.text},d.default.createElement("div",null,n.workspace?d.default.createElement(f.Link,{to:this.getWorkspaceUrl()},n.workspace):"-"),d.default.createElement("p",null,t("Workspace"))),d.default.createElement("div",{className:h.default.text},d.default.createElement("div",null,n.creator||"-"),d.default.createElement("p",null,t("Creator")))),d.default.createElement("img",{className:h.default.background,src:"/assets/project-overview.svg"}))}}]),a}(d.default.Component);a.default=v},3354:function(e,t,a){e.exports={wrapper:"BaseInfo__wrapper--3krx7",header:"BaseInfo__header--1yX2Z",text:"BaseInfo__text--j5DVV",content:"BaseInfo__content--JgySa",background:"BaseInfo__background--27rJH"}},3355:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(66)),c=l(n(18)),f=l(n(0)),m=n(19),p=n(60),h=n(226),v=l(n(22)),g=l(n(58)),y=n(938),E=l(n(2525)),b=l(n(944)),_=l(n(2665)),S=l(n(3356)),k=(0,p.inject)("rootStore")(r=(0,p.observer)(r=function(e){function a(e){var t;return(0,o.default)(this,a),(t=(0,i.default)(this,(0,s.default)(a).call(this,e))).handleClickApp=function(e){var a=e.currentTarget.dataset.app;t.routing.push("/projects/".concat(t.namespace,"/applications/template/").concat(a))},t.handleImageOnError=function(e){"/assets/default-app.svg"!==e.target.src&&(e.target.src="/assets/default-app.svg")},t.store=new _.default,t.disposer=(0,m.when)((function(){return t.project.data.name===t.namespace}),t.fetchData.bind((0,d.default)(t))),t}return(0,c.default)(a,e),(0,u.default)(a,[{key:"componentWillUnmount",value:function(){this.disposer&&this.disposer()}},{key:"fetchData",value:function(){this.store.fetchList({namespace:this.namespace,runtime_id:(0,v.default)(this.project,'data.annotations["openpitrix_runtime"]'),limit:3})}},{key:"renderExtras",value:function(){return f.default.createElement(h.Link,{className:S.default.more,to:"/projects/".concat(this.namespace,"/applications/template")},t("View All"))}},{key:"render",value:function(){var e=this,a=(0,m.toJS)(this.store.list).data;return(0,g.default)(a)?null:f.default.createElement(E.default,{className:S.default.apps,title:"".concat(t("Deployed Applications"),"(Helm)"),extras:this.renderExtras()},f.default.createElement(y.Columns,{className:"is-variable is-1"},a.map((function(t){var a=(0,v.default)(t,"app.icon"),n=(0,v.default)(t,"app.name");return f.default.createElement(y.Column,{key:t.cluster_id,className:"is-4"},f.default.createElement("div",{className:S.default.app,"data-app":t.cluster_id,onClick:e.handleClickApp},f.default.createElement("label",{className:S.default.icon},f.default.createElement(b.default,{iconLetter:n,iconSize:40,src:a,onError:e.handleImageOnError})),f.default.createElement("div",{className:S.default.title},f.default.createElement("div",null,t.name),f.default.createElement("p",{title:t.description},t.description||"-"))))}))))}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"namespace",get:function(){return(0,v.default)(this.props.match,"params.namespace")}},{key:"project",get:function(){return this.props.rootStore.project}}]),a}(f.default.Component))||r)||r;a.default=k},3356:function(e,t,a){e.exports={apps:"Applications__apps--1_49Q",app:"Applications__app--1y-1r",icon:"Applications__icon--2lmmI",title:"Applications__title--1ai8R",more:"Applications__more--3ewq7"}},3357:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(70)),u=l(n(37)),i=l(n(13)),s=l(n(14)),d=l(n(17)),c=l(n(16)),f=l(n(18)),m=l(n(0)),p=n(60),h=l(n(22)),v=n(19),g=n(114),y=n(939),E=l(n(3358)),b=l(n(3359)),_=l(n(225)),S=l(n(129)),k=l(n(2454)),C=l(n(2455)),w=l(n(2525)),N=l(n(3360)),T=l(n(3363)),P=l(n(3366)),M=["namespace_pod_count","namespace_deployment_count","namespace_statefulset_count","namespace_daemonset_count","namespace_job_count","namespace_cronjob_count","namespace_pvc_count","namespace_service_count","namespace_secret_count","namespace_configmap_count","namespace_ingresses_extensions_count","namespace_s2ibuilder_count"],R=["namespace_cpu_usage","namespace_memory_usage_wo_cache"],D=(0,p.inject)("rootStore")(r=(0,p.observer)(r=function(e){function a(e){var t;return(0,i.default)(this,a),(t=(0,d.default)(this,(0,c.default)(a).call(this,e))).fetchData=function(e){var a={namespace:e};t.fetchMetrics(),t.dashboardStore.fetchResourceStatus(a)},t.fetchMetrics=function(e){var a=t.state,n=a.resourceType,l=a.range;"application"===n?t.appResourceMonitorStore.fetchMetrics((0,u.default)({namespace:t.namespace,metrics:M,step:"".concat(Math.floor(l/10),"s"),times:10,fillZero:!0},e,{autoRefresh:!1})):t.physicalResourceMonitorStore.fetchMetrics((0,u.default)({namespace:t.namespace,metrics:R,step:"".concat(Math.floor(l/40),"s"),times:40,fillZero:!0},e,{autoRefresh:!1}))},t.getResourceData=function(){var e=(0,v.toJS)(t.dashboardStore.resource),a=e.quota,n=void 0===a?{}:a,l=e.status,r=void 0===l?{}:l,o=n.used||{};return[{key:"pods",icon:g.ICON_TYPES.pods,name:"Pods",routeName:"pods",num:o["count/pods"],warnNum:r.pods,metric:"namespace_pod_count"},{key:"deployments",icon:g.ICON_TYPES.deployments,name:"Deployments",routeName:"deployments",num:o["count/deployments.apps"],warnNum:r.deployments,metric:"namespace_deployment_count"},{key:"statefulsets",icon:g.ICON_TYPES.statefulsets,name:"StatefulSets",routeName:"statefulsets",num:o["count/statefulsets.apps"],warnNum:r.statefulsets,metric:"namespace_statefulset_count"},{key:"daemonsets",icon:g.ICON_TYPES.daemonsets,name:"DaemonSets",routeName:"daemonsets",num:o["count/daemonsets.apps"],warnNum:r.daemonsets,metric:"namespace_daemonset_count"},{key:"s2ibuilders",icon:g.ICON_TYPES.s2ibuilders,name:"Image Builders",routeName:"s2ibuilders",num:o["count/s2ibuilders.devops.kubesphere.io"],metric:"namespace_s2ibuilder_count",disabled:!globals.app.hasKSModule("devops")},{key:"jobs",icon:g.ICON_TYPES.jobs,name:"Jobs",routeName:"jobs",num:o["count/jobs.batch"],metric:"namespace_job_count"},{key:"cronjobs",icon:g.ICON_TYPES.cronjobs,name:"CronJobs",routeName:"cronjobs",num:o["count/cronjobs.batch"],metric:"namespace_cronjob_count"},{key:"volumes",icon:g.ICON_TYPES.volumes,name:"Volumes",routeName:"volumes",num:o.persistentvolumeclaims||o["count/persistentvolumeclaims"],warnNum:r["persistent-volume-claims"],metric:"namespace_pvc_count"},{key:"services",icon:g.ICON_TYPES.services,name:"Services",routeName:"services",num:o["count/services"],metric:"namespace_service_count"},{key:"routes",icon:g.ICON_TYPES.ingresses,name:"Routes",routeName:"routes",num:o["count/ingresses.extensions"],metric:"namespace_ingresses_extensions_count"}]},t.handleResouceTypeChange=function(e){t.setState({resourceType:e},(function(){t.fetchMetrics()}))},t.handleRangeChange=function(e){t.setState({range:e},(function(){t.fetchMetrics()}))},t.state={resourceType:"application",range:43200},t.dashboardStore=new E.default,t.projectStore=e.rootStore.project,t.appResourceMonitorStore=new b.default,t.physicalResourceMonitorStore=new b.default,t.fetchData(t.namespace),t}return(0,f.default)(a,e),(0,s.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.match.params.namespace!==this.namespace&&this.fetchData(e.match.params.namespace)}},{key:"componentDidMount",value:function(){(0,y.startAutoRefresh)(this,{method:"fetchMetrics",interval:1e4,leading:!1})}},{key:"componentWillUnmount",value:function(){(0,y.stopAutoRefresh)(this)}},{key:"renderApplicationResource",value:function(){var e=this,t=(0,v.toJS)(this.dashboardStore.resource).isLoading,a=this.appResourceMonitorStore,n=a.data,l=a.isLoading,r=a.isRefreshing,u=this.getResourceData();return m.default.createElement(S.default,{spinning:t},m.default.createElement("div",{className:P.default.resources},u.filter((function(e){return!e.disabled})).map((function(t){return m.default.createElement(N.default,(0,o.default)({namespace:e.namespace},t,{metrics:(0,h.default)(n,"".concat(t.metric,".data.result")),isMetricsLoading:l||r}))}))))}},{key:"renderPhysicalResource",value:function(){var e=this,a=this.physicalResourceMonitorStore,n=a.data,l=a.isLoading,r=a.isRefreshing,o=this.timeOptions.find((function(t){return t.value===e.state.range}))||{};return m.default.createElement("div",null,m.default.createElement(T.default,{type:"cpu",title:"".concat(t("CPU Usage")," (").concat(o.label,")"),metrics:(0,h.default)(n,"namespace_cpu_usage.data.result"),isLoading:l||r,showDay:o.value>=172800}),m.default.createElement(T.default,{type:"memory",title:"".concat(t("Memory Usage")," (").concat(o.label,")"),metrics:(0,h.default)(n,"namespace_memory_usage_wo_cache.data.result"),isLoading:l||r,showDay:o.value>=172800}))}},{key:"renderHeader",value:function(){return m.default.createElement("div",{className:P.default.header},m.default.createElement(k.default,{wrapClassName:"radio-default",value:this.state.resourceType,onChange:this.handleResouceTypeChange,size:"small"},m.default.createElement(C.default,{value:"application"},t("Application Resources")),m.default.createElement(C.default,{value:"physical"},t("Physical Resources"))),m.default.createElement(_.default,{className:P.default.timeSelect,value:this.state.range,options:this.timeOptions,onChange:this.handleRangeChange}))}},{key:"render",value:function(){var e=this.state.resourceType;return m.default.createElement(w.default,{className:P.default.wrapper,title:t("Resource Status")},this.renderHeader(),"application"===e?this.renderApplicationResource():this.renderPhysicalResource())}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"namespace",get:function(){return(0,h.default)(this.props.match,"params.namespace")}},{key:"project",get:function(){return(0,v.toJS)(this.props.rootStore.project)}},{key:"timeOptions",get:function(){return[{label:"".concat(t("Last")," ").concat(t("TIME_H",{num:1})),value:3600},{label:"".concat(t("Last")," ").concat(t("TIME_H",{num:2})),value:7200},{label:"".concat(t("Last")," ").concat(t("TIME_H",{num:5})),value:18e3},{label:"".concat(t("Last")," ").concat(t("TIME_H",{num:12})),value:43200},{label:"".concat(t("Last")," ").concat(t("TIME_D",{num:1})),value:86400},{label:"".concat(t("Last")," ").concat(t("TIME_D",{num:2})),value:172800},{label:"".concat(t("Last")," ").concat(t("TIME_D",{num:3})),value:259200},{label:"".concat(t("Last")," ").concat(t("TIME_D",{num:7})),value:604800}]}}]),a}(m.default.Component))||r)||r;a.default=D},3358:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r,o=n(a(61)),u=n(a(82)),i=n(a(62)),s=n(a(44)),d=n(a(13)),c=n(a(14)),f=n(a(41)),m=(n(a(45)),a(19)),p=a(49),h=(l=function(){function e(){(0,d.default)(this,e),(0,s.default)(this,"resource",r,this)}var t;return(0,c.default)(e,[{key:"fetchResourceStatus",value:(t=(0,i.default)(o.default.mark((function e(t){var a,n,l,r,i,s;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.namespace,this.resource.isLoading=!0,n=a?"/namespaces/".concat(a):"",e.next=5,Promise.all([(0,p.to)(request.get("kapis/resources.kubesphere.io/v1alpha2".concat(n,"/quotas"))),(0,p.to)(request.get("kapis/resources.kubesphere.io/v1alpha2".concat(n,"/abnormalworkloads")))]);case 5:l=e.sent,r=(0,u.default)(l,2),i=r[0],s=r[1],this.resource={quota:i.data,status:s.data,isLoading:!1};case 10:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}(),r=(0,f.default)(l.prototype,"resource",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{quota:{},status:{},isLoading:!0}}}),(0,f.default)(l.prototype,"fetchResourceStatus",[m.action],Object.getOwnPropertyDescriptor(l.prototype,"fetchResourceStatus"),l.prototype),l);t.default=h},3359:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(13)),r=n(a(17)),o=n(a(16)),u=n(a(18)),i=function(e){function t(){var e,a;(0,l.default)(this,t);for(var n=arguments.length,u=new Array(n),i=0;i<n;i++)u[i]=arguments[i];return(a=(0,r.default)(this,(e=(0,o.default)(t)).call.apply(e,[this].concat(u)))).getApi=function(e){var t=e.namespace,n=t?"/".concat(t):"";return"".concat(a.apiVersion,"/namespaces").concat(n)},a}return(0,u.default)(t,e),t}(n(a(2551)).default);t.default=i},3360:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o,u,i=l(n(70)),s=l(n(30)),d=l(n(13)),c=l(n(14)),f=l(n(17)),m=l(n(16)),p=l(n(18)),h=l(n(0)),v=n(60),g=l(n(1)),y=l(n(3)),E=l(n(132)),b=l(n(38)),_=l(n(227)),S=n(939),k=l(n(3361)),C=l(n(3362)),w=(0,v.inject)("rootStore")(r=(0,v.observer)((u=o=function(e){function a(){var e,t;(0,d.default)(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(t=(0,f.default)(this,(e=(0,m.default)(a)).call.apply(e,[this].concat(l)))).handleClick=function(){var e=t.props,a=e.onClick,n=e.name,l=e.namespace,r=e.routeName;(0,E.default)(a)?a(n):r&&t.routing.push("/projects/".concat(l,"/").concat(r))},t.handleWarnClick=function(e){e.stopPropagation();var a=t.props,n=a.namespace,l=a.routeName,r=a.onClick,o=a.name,u="volumes"===l?"pending":"updating";(0,E.default)(r)?r(o,u):l&&t.routing.push("/projects/".concat(n,"/").concat(l,"?status=").concat(u))},t}return(0,p.default)(a,e),(0,c.default)(a,[{key:"renderWarn",value:function(){var e=this.props,a=e.warnNum,n=e.name,l=a>99?h.default.createElement("div",{className:C.default.skip},"..."):a;return a>0?h.default.createElement("div",{className:C.default.warn},h.default.createElement(_.default,{className:C.default.tips,content:t("RESOURCE_WARNING_TIPS",{warnNum:a,tipName:t(n)})},h.default.createElement("div",{onClick:this.handleWarnClick},l))):null}},{key:"render",value:function(){var e=this.props,a=e.className,n=e.icon,l=e.iconSize,r=e.name,o=e.routeName,u=e.num,d=e.metrics,c=e.onClick,f=(0,S.getAreaChartOps)({title:"",unit:"",legend:["Count"],data:d});return h.default.createElement("div",{"data-name":r,className:(0,y.default)(C.default.card,a)},h.default.createElement("div",{className:C.default.icon},h.default.createElement(b.default,{name:n,size:l}),this.renderWarn()),h.default.createElement("div",{className:(0,y.default)(C.default.info,(0,s.default)({},C.default.cursor,o||c)),onClick:this.handleClick},h.default.createElement("strong",null,u),h.default.createElement("span",null,t(r))),h.default.createElement(k.default,(0,i.default)({width:330,height:44,bgColor:"transparent"},f)))}},{key:"routing",get:function(){return this.props.rootStore.routing}}]),a}(h.default.Component),o.propTypes={className:g.default.string,icon:g.default.string,iconSize:g.default.number,name:g.default.string,namespace:g.default.string,routeName:g.default.string,num:g.default.oneOfType([g.default.number,g.default.string]),warnNum:g.default.number,onClick:g.default.func},o.defaultProps={icon:"appcenter",iconSize:40,name:"deployment",namespace:"default",routeName:"",num:0,warnNum:0},r=u))||r)||r;a.default=w},3361:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(13)),r=n(a(14)),o=n(a(17)),u=n(a(16)),i=n(a(18)),s=n(a(0)),d=n(a(1)),c=a(114);a(2467);var f=n(a(956)),m=n(a(567)),p=n(a(389)),h=n(a(2460)),v=n(a(2461)),g=n(a(946)),y=n(a(2540)),E=function(e){function t(){return(0,l.default)(this,t),(0,o.default)(this,(0,u.default)(t).apply(this,arguments))}return(0,i.default)(t,e),(0,r.default)(t,[{key:"getVeticalPoints",value:function(){var e=this.props.width,t=(e-10)/10;return Array(10).fill("").map((function(e,a){return 5+t*a}))}},{key:"renderArea",value:function(){var e=this.props,t=e.unit,a=e.areaColors,n={stroke:"#55bc8a",strokeWidth:1,fill:"#fff",fillOpacity:1};return this.series.map((function(e,l){var r=c.COLORS_MAP[a[l]];return s.default.createElement(f.default,{key:e,dataKey:e,stroke:r,fillOpacity:"0.1",fill:r,unit:t,dot:n})}))}},{key:"render",value:function(){var e=this.props,t=e.width,a=e.height,n=e.xKey,l=e.data;return s.default.createElement(g.default,{width:t,height:a,debounce:1},s.default.createElement(h.default,{data:l},s.default.createElement(p.default,{dataKey:n,hide:!0}),s.default.createElement(m.default,{wrapperStyle:{zIndex:1e3},content:s.default.createElement(y.default,null)}),s.default.createElement(v.default,{strokeDasharray:"3 6",horizontal:!1,verticalPoints:this.getVeticalPoints()}),this.renderArea()))}},{key:"series",get:function(){var e=this.props,t=e.xKey,a=e.data;return Object.keys(a[0]||{}).filter((function(e){return e!==t}))}}]),t}(s.default.Component);t.default=E,E.propTypes={width:d.default.oneOfType([d.default.string,d.default.number]),height:d.default.oneOfType([d.default.string,d.default.number]),xKey:d.default.string,unit:d.default.string,data:d.default.array,bgColor:d.default.string,areaColors:d.default.array},E.defaultProps={width:180,height:56,xKey:"time",unit:"",bgColor:c.COLORS_MAP.lightest,areaColors:["green","blue","yellow","red"],data:[]}},3362:function(e,t,a){e.exports={card:"AppResourceItem__card--2EqCY",icon:"AppResourceItem__icon--36Hfc",warn:"AppResourceItem__warn--1ntTH",tips:"AppResourceItem__tips---w63J",skip:"AppResourceItem__skip--2kxI8",info:"AppResourceItem__info--1u4G7",cursor:"AppResourceItem__cursor--1gP2n"}},3363:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(70)),o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=n(49),m=n(939),p=l(n(3364)),h=l(n(3365)),v=function(e){function a(){return(0,o.default)(this,a),(0,i.default)(this,(0,s.default)(a).apply(this,arguments))}return(0,d.default)(a,e),(0,u.default)(a,[{key:"render",value:function(){var e=this.props,a=e.type,n=e.title,l=e.metrics,o=e.showDay,u=(0,m.getAreaChartOps)({title:n,unitType:a,legend:["Count"],data:l,xFormatter:function(e){return(0,f.getLocalTime)(1e3*Number(e)).format(o?t("Do HH:mm"):"HH:mm")}});return c.default.createElement("div",{className:h.default.wrapper},c.default.createElement("div",{className:h.default.chartWrapper},c.default.createElement("div",{className:h.default.title},n),c.default.createElement("div",{className:h.default.chart},c.default.createElement(p.default,(0,r.default)({width:"100%",height:120,bgColor:"transparent"},u)))))}}]),a}(c.default.Component);a.default=v},3364:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(13)),r=n(a(14)),o=n(a(17)),u=n(a(16)),i=n(a(18)),s=n(a(0)),d=n(a(1)),c=a(114),f=n(a(956)),m=n(a(567)),p=n(a(571)),h=n(a(389)),v=n(a(2460)),g=n(a(2461)),y=n(a(946)),E=n(a(2540)),b=function(e){function t(){return(0,l.default)(this,t),(0,o.default)(this,(0,u.default)(t).apply(this,arguments))}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props,t=e.x,a=e.y,n=e.payload;return s.default.createElement("g",{transform:"translate(".concat(t,",").concat(a,")")},s.default.createElement("text",{x:0,y:0,dy:12,fill:"#79879c",textAnchor:"middle"},n.value))}}]),t}(s.default.PureComponent),_=function(e){function t(){return(0,l.default)(this,t),(0,o.default)(this,(0,u.default)(t).apply(this,arguments))}return(0,i.default)(t,e),(0,r.default)(t,[{key:"getHorizontalPoints",value:function(){var e=this.props.height,t=(e-30-6)/4;return Array(4).fill("").map((function(e,a){return 30+t*a}))}},{key:"renderArea",value:function(){var e=this.props,t=e.unit,a=e.areaColors;return this.series.map((function(e,n){var l=c.COLORS_MAP[a[n]];return s.default.createElement(f.default,{key:e,dataKey:e,stroke:l,fillOpacity:"1",fill:"url(#colorPv)",unit:t})}))}},{key:"render",value:function(){var e=this.props,t=e.width,a=e.height,n=e.xKey,l=e.data;return s.default.createElement(y.default,{width:t,height:a,debounce:1},s.default.createElement(v.default,{data:l,margin:{top:32,left:16,right:16,bottom:0}},s.default.createElement("defs",null,s.default.createElement("linearGradient",{id:"colorPv",x1:"0",y1:"0",x2:"0",y2:"1"},s.default.createElement("stop",{offset:"5%",stopColor:"#55bc8a",stopOpacity:.2}),s.default.createElement("stop",{offset:"95%",stopColor:"#55bc8a",stopOpacity:0}))),s.default.createElement(g.default,{vertical:!1,stroke:"#36435c",strokeDasharray:"2 2",horizontalPoints:this.getHorizontalPoints()}),s.default.createElement(h.default,{dataKey:n,axisLine:!1,tickLine:!1,height:30,interval:"preserveStart",tick:s.default.createElement(b,null),minTickGap:20}),s.default.createElement(p.default,{hide:!0,type:"number",domain:[function(e){return 0-Math.abs(e)},function(e){return 1.6*e}]}),s.default.createElement(m.default,{wrapperStyle:{zIndex:1e3},content:s.default.createElement(E.default,null)}),this.renderArea()))}},{key:"series",get:function(){var e=this.props,t=e.xKey,a=e.data;return Object.keys(a[0]||{}).filter((function(e){return e!==t}))}}]),t}(s.default.Component);t.default=_,_.propTypes={width:d.default.oneOfType([d.default.string,d.default.number]),height:d.default.oneOfType([d.default.string,d.default.number]),xKey:d.default.string,unit:d.default.string,data:d.default.array,bgColor:d.default.string,areaColors:d.default.array},_.defaultProps={width:180,height:56,xKey:"time",unit:"",bgColor:c.COLORS_MAP.lightest,areaColors:["green","blue","yellow","red"],data:[]}},3365:function(e,t,a){e.exports={wrapper:"PhysicalResourceItem__wrapper--235Yd",chartWrapper:"PhysicalResourceItem__chartWrapper--1Ih0P",chart:"PhysicalResourceItem__chart--3awmU",title:"PhysicalResourceItem__title--2jhkS"}},3366:function(e,t,a){e.exports={wrapper:"ResourceUsage__wrapper--29aBx",header:"ResourceUsage__header--3S-YB",timeSelect:"ResourceUsage__timeSelect--3zET3"}},3367:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=n(19),m=n(60),p=l(n(22)),h=l(n(58)),v=n(226),g=l(n(38)),y=l(n(2525)),E=n(939),b=l(n(3368)),_=l(n(2583)),S=l(n(3369)),k={workload_cpu_usage:"cpu",workload_memory_usage_wo_cache:"memory",workload_net_bytes_transmitted:"bandwidth",workload_net_bytes_received:"bandwidth"},C=(0,m.inject)("rootStore")(r=(0,m.observer)(r=function(e){function a(e){var t;return(0,o.default)(this,a),(t=(0,i.default)(this,(0,s.default)(a).call(this,e))).store=new b.default({namespaces:(0,p.default)(t.props.match,"params.namespace")}),t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"componentWillMount",value:function(){this.store.fetchAll()}},{key:"getWorkloadLink",value:function(e){var t=e.owner_kind;if("Pod"!==t){var a=e.resource_name,n=(void 0===a?"":a).replace(/\w+:/,""),l=this.props.match.params.namespace;return{Deployment:"/projects/".concat(l,"/deployments/").concat(n),StatefulSet:"/projects/".concat(l,"/statefulsets/").concat(n),DaemonSet:"/projects/".concat(l,"/daemonsets/").concat(n)}[t]}}},{key:"renderHeader",value:function(){return c.default.createElement("div",{className:S.default.header},c.default.createElement("div",{className:S.default.title},t("Resource Name")),c.default.createElement(_.default,{className:S.default.select,store:this.store}))}},{key:"renderEmpty",value:function(){return c.default.createElement("div",{className:S.default.empty},c.default.createElement(g.default,{name:"backup",size:32}),c.default.createElement("div",null,t("No relevant data")))}},{key:"renderContent",value:function(){var e=this,a=(0,f.toJS)(this.store.data);return!this.store.isLoading&&(0,h.default)(a)?this.renderEmpty():c.default.createElement("div",{className:S.default.content},a.slice(0,5).map((function(n){var l={Deployment:"backup",StatefulSet:"stateful-set",DaemonSet:"deamon-set",Pod:"pod",Default:"backup"},r=e.getWorkloadLink(n),o=n.resource_name.replace(/\w+:/,""),u=100*n[e.store.sort_metric]/a[0][e.store.sort_metric],i=(0,E.getSuitableUnit)(n[e.store.sort_metric],k[e.store.sort_metric]);return c.default.createElement("div",{className:S.default.app,key:o},c.default.createElement("div",{className:S.default.appContent},c.default.createElement(g.default,{name:l[n.owner_kind]||l.Default,type:"dark",size:40}),c.default.createElement("div",{className:S.default.text},c.default.createElement("div",{className:"relative","data-tooltip":o},c.default.createElement("div",null,r?c.default.createElement(v.Link,{to:r},o):o)),c.default.createElement("p",null,t(n.owner_kind))),c.default.createElement("div",{className:S.default.value},(0,E.getValueByUnit)(n[e.store.sort_metric],i)||0,c.default.createElement("span",{style:{fontSize:12}}," ",i))),c.default.createElement("div",{className:S.default.background,style:{width:"".concat(u.toFixed(2),"%")}}))})))}},{key:"render",value:function(){return c.default.createElement(y.default,{className:S.default.wrapper,title:"".concat(t("Resources Usage Ranking"),"(Top5)")},this.renderHeader(),this.renderContent())}}]),a}(c.default.Component))||r)||r;a.default=C},3368:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r,o,u,i,s,d=n(a(44)),c=n(a(13)),f=n(a(14)),m=n(a(17)),p=n(a(16)),h=n(a(66)),v=n(a(18)),g=n(a(41)),y=(n(a(45)),a(19)),E=n(a(2620)),b=["workload_cpu_usage","workload_memory_usage_wo_cache","workload_net_bytes_transmitted","workload_net_bytes_received"],_=["workload_cpu_usage","workload_memory_usage_wo_cache","workload_net_bytes_transmitted","workload_net_bytes_received","replica"],S=(l=function(e){function t(){var e,a;(0,c.default)(this,t);for(var n=arguments.length,l=new Array(n),f=0;f<n;f++)l[f]=arguments[f];return a=(0,m.default)(this,(e=(0,p.default)(t)).call.apply(e,[this].concat(l))),(0,d.default)(a,"namespaces",r,(0,h.default)(a)),(0,d.default)(a,"sort_metric_options",o,(0,h.default)(a)),(0,d.default)(a,"sort_metric",u,(0,h.default)(a)),(0,d.default)(a,"metrics_filter",i,(0,h.default)(a)),(0,d.default)(a,"changeNamespace",s,(0,h.default)(a)),a}return(0,v.default)(t,e),(0,f.default)(t,[{key:"fetchUrl",get:function(){return"".concat(this.apiVersion,"/namespaces/").concat(this.namespaces,"/workloads")}}]),t}(E.default),r=(0,g.default)(l.prototype,"namespaces",[y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=(0,g.default)(l.prototype,"sort_metric_options",[y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return b}}),u=(0,g.default)(l.prototype,"sort_metric",[y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return b[0]}}),i=(0,g.default)(l.prototype,"metrics_filter",[y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return _.join("|")}}),s=(0,g.default)(l.prototype,"changeNamespace",[y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.namespaces=t,e.fetchAll()}}}),l);t.default=S},3369:function(e,t,a){e.exports={wrapper:"UsageRanking__wrapper--1UALy",header:"UsageRanking__header--3DIgk",title:"UsageRanking__title--MNoZg",select:"UsageRanking__select--1uhE3",app:"UsageRanking__app--3xSZJ",value:"UsageRanking__value--2sWPI",appContent:"UsageRanking__appContent--1XzM6",text:"UsageRanking__text--1WsQh",background:"UsageRanking__background--3m6Wy",empty:"UsageRanking__empty--3YrK_"}},3370:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(3)),f=l(n(38)),m=n(49),p=l(n(3371)),h=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props.className;return d.default.createElement("div",{className:(0,c.default)(p.default.wrapper,e)},d.default.createElement("div",{className:p.default.header},d.default.createElement(f.default,{name:"question",size:24}),t("Help information")),d.default.createElement("div",{className:p.default.tip},d.default.createElement("a",{href:(0,m.getDocsUrl)("project_members"),target:"_blank"},"💁 ",t("Invite other members into current project ?"))),d.default.createElement("div",{className:p.default.tip},d.default.createElement("a",{href:(0,m.getDocsUrl)("internet"),target:"_blank"},"💁 ",t("How to setup the project gateway ?"))))}}]),a}(d.default.Component);a.default=h},3371:function(e,t,a){e.exports={wrapper:"Help__wrapper--3y0Ct",header:"Help__header--1pRsl",tip:"Help__tip--vebuY"}},3372:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(66)),c=l(n(18)),f=l(n(0)),m=n(60),p=n(19),h=l(n(22)),v=l(n(2665)),g=l(n(2608)),y=l(n(224)),E=l(n(2523)),b=l(n(3373)),_=l(n(2784)),S=l(n(3451)),k=l(n(3467)),C=l(n(3468)),w=(0,m.inject)("rootStore")(r=(0,m.observer)(r=function(e){function a(e){var t;return(0,o.default)(this,a),(t=(0,i.default)(this,(0,s.default)(a).call(this,e))).handleTabChange=function(e){var a=t.props.match.params.namespace;t.routing.push("/projects/".concat(a,"/applications/").concat(e))},t.showDeploySampleApp=function(){t.setState({showServiceDeployApp:!0,showDeployApp:!1,sampleApp:"bookinfo"})},t.showDeployAppModal=function(){t.canDeployTemplateApp?t.setState({showDeployApp:!0}):t.setState({showServiceDeployApp:!0})},t.hideDeployAppModal=function(){t.setState({showDeployApp:!1})},t.handleDeployApp=function(e){var a=t.props.match.params.namespace;switch(e){case"service-form":return t.setState({showServiceDeployApp:!0,showDeployApp:!1});case"sample-service-form":return t.setState({showServiceDeployApp:!0,showDeployApp:!1,sampleApp:"bookinfo"});case"app-repo":return t.setState({showAppRepo:!0,showDeployApp:!1});case"app-template":return t.routing.push("/apps?workspace=".concat(t.workspace,"&namespace=").concat(a))}},t.hideServiceDeployAppModal=function(){t.setState({showServiceDeployApp:!1,sampleApp:""})},t.handleServiceDeployApp=function(e){var a=t.props.match.params.namespace;t.crdAppStore.create(e).then((function(){t.hideServiceDeployAppModal(),t.routing.push("/projects/".concat(a,"/applications/composing/").concat((0,h.default)(e,"application.metadata.name")))}))},t.hideRepoAppModal=function(){t.setState({showAppRepo:!1})},t.handleDeployRepoApp=function(){var e=t.props.match.params.namespace;t.hideRepoAppModal(),t.routing.push("/projects/".concat(e,"/applications/template"))},t.opAppStore=new v.default,t.crdAppStore=new g.default,t.projectStore=t.props.rootStore.project,t.state={showDeployApp:!1,appType:t.props.match.params.type||t.defaultAppType},t.disposer=(0,p.when)((function(){return t.projectStore.data.name===t.namespace}),t.initialFetch.bind((0,d.default)(t))),t}return(0,c.default)(a,e),(0,u.default)(a,[{key:"componentWillReceiveProps",value:function(e){var t=e.match.params.type;t&&t!==this.state.appType&&this.setState({appType:t||this.defaultAppType})}},{key:"componentDidMount",value:function(){localStorage.getItem("defaultAppType")!==this.state.appType&&localStorage.setItem("defaultAppType",this.state.appType)}},{key:"componentWillUnmount",value:function(){this.disposer&&this.disposer()}},{key:"initialFetch",value:function(){var e=this.projectStore.data,t=(0,h.default)(e,"annotations.openpitrix_runtime");globals.app.enableAppStore&&this.opAppStore.fetchList({namespace:e.name,runtime_id:t}),this.crdAppStore.fetchList({namespace:e.name}),this.disposer&&this.disposer()}},{key:"renderHeader",value:function(){return f.default.createElement(E.default,{className:"margin-b12",title:t("Applications"),description:t("APPLICATIONS_DESC"),module:"applications",tips:this.tips,tabs:globals.app.enableAppStore?this.tabs:void 0})}},{key:"renderModals",value:function(){var e=this.state,t=e.showServiceDeployApp,a=e.showAppRepo,n=e.sampleApp;return f.default.createElement(f.default.Fragment,null,this.canDeployTemplateApp&&this.canDeployComposingApp&&f.default.createElement(b.default,{visible:this.state.showDeployApp,onOk:this.handleDeployApp,onCancel:this.hideDeployAppModal,canDeployTemplateApp:this.canDeployTemplateApp,canDeployComposingApp:this.canDeployComposingApp}),f.default.createElement(_.default,{store:this.crdAppStore,visible:t,namespace:this.namespace,onOk:this.handleServiceDeployApp,onCancel:this.hideServiceDeployAppModal,isSubmitting:this.crdAppStore.isSubmitting,sampleApp:n}),f.default.createElement(S.default,{workspace:this.workspace,visible:a,onCancel:this.hideRepoAppModal,onDeploySuccess:this.handleDeployRepoApp}))}},{key:"renderApps",value:function(){return"template"===this.state.appType?f.default.createElement(k.default,{store:this.opAppStore,canCreate:this.canDeployTemplateApp,showDeployAppModal:this.showDeployAppModal,project:this.projectStore.data,match:this.props.match}):f.default.createElement(C.default,{store:this.crdAppStore,canCreate:this.canDeployComposingApp,showDeployAppModal:this.showDeployAppModal,project:this.projectStore.data,match:this.props.match})}},{key:"render",value:function(){return f.default.createElement("div",null,this.renderHeader(),this.renderApps(),this.renderModals())}},{key:"namespace",get:function(){return this.props.match.params.namespace}},{key:"workspace",get:function(){return(0,h.default)(this,"props.rootStore.project.data.workspace")}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"defaultAppType",get:function(){var e,t=localStorage.getItem("defaultAppType");return-1!==["template","composing"].indexOf(t)?e=t:(e=globals.app.enableAppStore?"template":"composing",localStorage.setItem("defaultAppType",e)),e}},{key:"canDeployTemplateApp",get:function(){return globals.app.enableAppStore&&globals.app.hasPermission({module:"applications",project:this.namespace,action:"create"})}},{key:"canDeployComposingApp",get:function(){var e=this.props.match.params.namespace,t=globals.app.getActions({module:"deployments",project:e}).includes("create"),a=globals.app.getActions({module:"services",project:e}).includes("create");return t&&a}},{key:"tabs",get:function(){return{value:this.state.appType,onChange:this.handleTabChange,options:[{value:"template",label:t("App Templates"),count:this.opAppStore.list.total||0},{value:"composing",label:t("Composing App"),count:this.crdAppStore.list.total||0}]}}},{key:"tips",get:function(){return[{title:t("Application Type"),description:t("APPLICATION_TYPE_DESC")},{title:t("HOW_TO_USE_APPLICATION_GOVE_Q"),description:t("HOW_TO_USE_APPLICATION_GOVE_A"),operation:this.canDeployComposingApp?f.default.createElement(y.default,{onClick:this.showDeploySampleApp},t("Deploy Sample Application")):null,closable:!1}]}}]),a}(f.default.Component))||r)||r;a.default=w},3373:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(30)),c=l(n(0)),f=l(n(1)),m=l(n(3)),p=l(n(38)),h=l(n(387)),v=l(n(3374)),g=function(e){var t=e.icon,a=e.image,n=e.title,l=e.desc,r=e.disabled,o=e.onEnter;return c.default.createElement("div",{className:(0,m.default)(v.default.item,(0,d.default)({},v.default.disable,r)),onClick:o},a?c.default.createElement("img",{src:a,alt:""}):c.default.createElement(p.default,{name:t,size:40}),c.default.createElement("div",{className:v.default.text},c.default.createElement("div",null,n),c.default.createElement("p",null,l)))},y=function(e){function a(){var e,t;(0,r.default)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(t=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(l)))).handleServiceForm=function(){t.props.onOk("service-form")},t.handleAppTemplate=function(){t.props.onOk("app-template")},t.handleAppRepo=function(){t.props.onOk("app-repo")},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel,l=e.canDeployComposingApp,r=e.canDeployTemplateApp;return c.default.createElement(h.default,{width:600,style:{borderRadius:"8px"},onOk:this.handleOk,onCancel:n,hideHeader:!0,hideFooter:!0,visible:a,bodyClassName:v.default.body},c.default.createElement("div",{className:v.default.header},c.default.createElement("div",{className:v.default.logo},c.default.createElement("img",{src:"/assets/application.svg",alt:""})),c.default.createElement("div",{className:v.default.text},c.default.createElement("h2",null,t("Deploy New Application")),c.default.createElement("p",null,t("APP_DEPLOYMENT_DESC")))),c.default.createElement("div",{className:v.default.footer},l&&c.default.createElement(g,{icon:"templet",title:t("From App Store"),desc:t("FROM_APP_STORE_DESC"),onEnter:this.handleAppTemplate}),r&&c.default.createElement(g,{icon:"catalog",title:t("From App Templates"),desc:t("FROM_APP_TEMPLATES_DESC"),onEnter:this.handleAppRepo}),l&&c.default.createElement(g,{icon:"stretch",title:t("Composing App"),desc:t("COMPOSING_APP_DESC"),onEnter:this.handleServiceForm})))}}]),a}(c.default.Component);a.default=y,y.propTypes={visible:f.default.bool,onOk:f.default.func,onCancel:f.default.func},y.defaultProps={visible:!1,onOk:function(){},onCancel:function(){}}},3374:function(e,t,a){e.exports={body:"DeployApp__body--Gr8gQ",header:"DeployApp__header--1yJrB",logo:"DeployApp__logo--22CAa",text:"DeployApp__text--h6bCn",footer:"DeployApp__footer--7fnLu",item:"DeployApp__item--izUJv",enterIcon:"DeployApp__enterIcon--2Zrta",disable:"DeployApp__disable--3Xkqe"}},3375:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(13)),r=n(a(14)),o=n(a(17)),u=n(a(16)),i=n(a(18)),s=n(a(63)),d=n(a(0)),c=n(a(1)),f=a(970),m=n(a(3376)),p=n(a(3378)),h=function(e){var t=e.application,a=e.ingress,n=(0,s.default)(e,["application","ingress"]),l={application:t,ingress:a};return Object.keys(n).forEach((function(e){var t=(0,f.getValue)("yaml",n[e].workload||{}),a=(0,f.getValue)("yaml",n[e].service||{});l[e]="".concat(t,"---\n").concat(a)})),l},v=function(e){function t(e){var a;return(0,l.default)(this,t),(a=(0,o.default)(this,(0,u.default)(t).call(this,e))).data=h(e.formTemplate),a.editor=d.default.createRef(),a}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentWillReceiveProps",value:function(e){e.formTemplate!==this.data&&(this.data=h(e.formTemplate))}},{key:"getData",value:function(){return this.editor.current.getData()}},{key:"render",value:function(){return d.default.createElement("div",{className:p.default.wrapper},d.default.createElement(m.default,{ref:this.editor,className:"height-full",value:this.data}))}}]),t}(d.default.Component);t.default=v,v.propTypes={formTemplate:c.default.object,onOk:c.default.func,isSubmitting:c.default.bool},v.defaultProps={onOk:function(){},isSubmitting:!1}},3376:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(30)),o=l(n(13)),u=l(n(17)),i=l(n(16)),s=l(n(14)),d=l(n(18)),c=l(n(0)),f=l(n(1)),m=l(n(3)),p=n(953),h=l(n(58)),v=l(n(133)),g=l(n(950)),y=n(970),E=l(n(38)),b=l(n(224)),_=l(n(951)),S=l(n(3377)),k=function(e){function a(e){var t;(0,o.default)(this,a),(t=(0,u.default)(this,(0,i.default)(a).call(this,e))).getData=function(){var e=t.state.mode,a={};return Object.keys(t.value).forEach((function(n){if((0,v.default)(t.value[n])&&-1!==t.value[n].indexOf("---")){var l=(0,y.getAllYAMLValue)(t.value[n]);a[n]={service:l.find((function(e){return"Service"===e.kind})),workload:l.find((function(e){return["Deployment","DaemonSet","StatefulSet"].includes(e.kind)}))}}else a[n]=(0,y.getValueObj)(e,t.value[n])})),a},t.handleUpload=function(e){var a=new FileReader;a.onload=function(e){if(!(0,h.default)(e.target.result)){var a=e.target.result.split("---").map((function(e){return(0,y.getValueObj)("yaml",e)}));t.value=a.length>1?(0,g.default)(a,"kind"):a[0],t.setState({selectKey:0})}},a.readAsText(e[0])},t.handleDownload=function(){var e=Object.keys(t.value).map((function(e){return(0,y.getValue)("yaml",t.value[e])})).join("---\n");t.saveAsFile(e,"app.yaml")},t.saveAsFile=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default.txt",a=new Blob([e],{type:"text/plain;charset=utf-8"});(0,p.saveAs)(a,t)},t.handleFileChange=function(e){var a=e.target.dataset.key;t.setState({selectKey:a})},t.handleChange=function(e){var a=t.state.selectKey;t.value[a]=e};var n=Object.keys(e.value);return t.value=e.value,t.state={selectKey:n[0]},t}return(0,d.default)(a,e),(0,s.default)(a,[{key:"options",get:function(){return{readOnly:this.props.readOnly,width:"100%",height:"100%"}}}]),(0,s.default)(a,[{key:"renderFileItem",value:function(e){var t=this.state.selectKey;return c.default.createElement("li",{key:e,"data-key":e,className:(0,m.default)((0,r.default)({},S.default.active,e===t)),onClick:this.handleFileChange},c.default.createElement(E.default,{name:"file",size:16}),e)}},{key:"renderFileList",value:function(){var e=this;return c.default.createElement("div",{className:S.default.fileList},c.default.createElement("div",{className:S.default.header},c.default.createElement("div",{className:S.default.title},t("File List")),c.default.createElement("div",{className:S.default.operations},c.default.createElement(b.default,{type:"flat",icon:"download",onClick:this.handleDownload}))),c.default.createElement("ul",null,Object.keys(this.value).map((function(t){return e.renderFileItem(t)}))))}},{key:"renderEditor",value:function(){var e=this.state.selectKey,t=this.value[e];return c.default.createElement(_.default,{className:S.default.editor,mode:"yaml",value:t,options:this.options,onChange:this.handleChange})}},{key:"render",value:function(){var e=this.props.className;return c.default.createElement("div",{className:(0,m.default)(S.default.mode,e)},this.renderFileList(),this.renderEditor())}}]),a}(c.default.Component);a.default=k,k.propTypes={className:f.default.string,value:f.default.oneOfType([f.default.string,f.default.object]),readOnly:f.default.bool},k.defaultProps={readOnly:!1}},3377:function(e,t,a){e.exports={mode:"EditMode__mode--1wJrn",editor:"EditMode__editor--2WD6c",fileList:"EditMode__fileList--38PX2",header:"EditMode__header--1uCWD",title:"EditMode__title--34D92",operations:"EditMode__operations--15e8-",active:"EditMode__active--2UGsh"}},3378:function(e,t,a){e.exports={wrapper:"Code__wrapper--2DbNJ",coder:"Code__coder--3RH9z"}},3379:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(22)),c=l(n(115)),f=l(n(268)),m=l(n(0)),p=n(1),h=l(n(386)),v=l(n(225)),g=l(n(2453)),y=n(114),E=l(n(267)),b=l(n(3380)),_=function(e){function a(){var e,n;(0,r.default)(this,a);for(var l=arguments.length,o=new Array(l),s=0;s<l;s++)o[s]=arguments[s];return(n=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(o)))).nameValidator=function(e,a,l){if(!a)return l();n.props.store.checkName({name:a,namespace:n.props.namespace}).then((function(a){if(a.exist)return l({message:t("Name exists"),field:e.field});l()}))},n.handleNameChange=(0,f.default)((function(e){(0,c.default)(n.props.formData,'metadata.labels["app.kubernetes.io/name"]',e),(0,c.default)(n.props.formData,'spec.selector.matchLabels["app.kubernetes.io/name"]',e),n.props.onLabelsChange((0,d.default)(n.props.formData,"spec.selector.matchLabels"))}),200),n.handleVersionChange=(0,f.default)((function(e){(0,c.default)(n.props.formData,'spec.selector.matchLabels["app.kubernetes.io/version"]',e),n.props.onLabelsChange((0,d.default)(n.props.formData,"spec.selector.matchLabels"))}),200),n.handleGovernanceChange=function(e){n.props.onGovernanceChange(e)},n}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props,a=e.formRef,n=e.serviceMeshEnable;return m.default.createElement("div",{className:b.default.wrapper},m.default.createElement("div",{className:"h5"},t("Basic Info")),m.default.createElement(E.default,{data:this.props.formData,ref:a},m.default.createElement(E.default.Item,{label:t("Application Name"),desc:t("NAME_DESC"),rules:[{required:!0,message:t("Please input an application name")},{pattern:y.PATTERN_NAME,message:"".concat(t("Invalid name"),", ").concat(t("NAME_DESC"))},{pattern:y.PATTERN_LENGTH_63,message:t("NAME_TOO_LONG")},{validator:this.nameValidator}]},m.default.createElement(h.default,{name:"metadata.name",onChange:this.handleNameChange})),m.default.createElement(E.default.Item,{label:t("Application Version(Optional)"),desc:t("Specify an application version")},m.default.createElement(h.default,{name:"metadata.labels['app.kubernetes.io/version']",onChange:this.handleVersionChange})),m.default.createElement(E.default.Item,{label:t("Application Governance"),desc:t.html("APP_GOVERNANCE_DESC")},m.default.createElement(v.default,{name:"metadata.annotations['servicemesh.kubesphere.io/enabled']",options:this.governances,defaultValue:n?"true":"false",onChange:this.handleGovernanceChange,disabled:!n})),m.default.createElement(E.default.Item,{label:t("Description")},m.default.createElement(g.default,{name:"spec.descriptor.description"}))))}},{key:"governances",get:function(){return[{label:t("On"),value:"true"},{label:t("Off"),value:"false"}]}}]),a}(m.default.Component);a.default=_,_.propTypes={onLabelsChange:p.PropTypes.func},_.defaultProps={onLabelsChange:function(){}}},3380:function(e,t,a){e.exports={wrapper:"BaseInfo__wrapper--1OmNz",upload:"BaseInfo__upload--3c_2f"}},3381:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(97)),o=l(n(63)),u=l(n(30)),i=l(n(37)),s=l(n(13)),d=l(n(14)),c=l(n(17)),f=l(n(16)),m=l(n(18)),p=l(n(269)),h=l(n(22)),v=l(n(115)),g=l(n(959)),y=l(n(58)),E=l(n(132)),b=l(n(0)),_=l(n(1)),S=l(n(943)),k=l(n(388)),C=l(n(954)),w=n(49),N=l(n(270)),T=l(n(3382)),P=l(n(2786)),M=l(n(3443)),R=l(n(3445)),D=l(n(3449)),O=function(e){function a(){var e,t;(0,s.default)(this,a);for(var n=arguments.length,l=new Array(n),d=0;d<n;d++)l[d]=arguments[d];return(t=(0,c.default)(this,(e=(0,f.default)(a)).call.apply(e,[this].concat(l)))).state={state:"list",subRoute:{},components:(0,p.default)(t.props.formData,["application","ingress"])||{},ingress:(0,h.default)(t.props.formData,"ingress",{}),selectComponentKey:"",selectRule:{},componentsError:"",rulesError:""},t.hasSubRoute=function(){return!(0,y.default)(t.state.subRoute)},t.handleSubFormSave=function(){var e=t.state.subRoute;e&&(0,E.default)(e.onSave)&&e.onSave()},t.handleSubFormCancel=function(){var e=t.state.subRoute;e&&(0,E.default)(e.onCancel)&&e.onCancel()},t.registerSubRoute=function(e,a){t.setState({subRoute:{onSave:e,onCancel:a}})},t.resetSubRoute=function(){t.setState({subRoute:{}})},t.updateComponentKind=function(){var e=t.props.formData.application;(0,v.default)(e,"spec.componentKinds",[{group:"",kind:"Service"},{group:"apps",kind:"Deployment"},{group:"apps",kind:"StatefulSet"},{group:"extensions",kind:"Ingress"},{group:"servicemesh.kubesphere.io",kind:"Strategy"},{group:"servicemesh.kubesphere.io",kind:"ServicePolicy"}])},t.showAddComponent=function(e){t.setState({state:"new-component",selectComponentKey:e})},t.showAddRule=function(e){t.setState({state:"new-rule",selectRule:e?(0,i.default)({},e,{_host:e.host}):{}})},t.hideAddComponent=function(){t.setState({state:"list",selectComponentKey:"",subRoute:{}})},t.hideAddRule=function(){t.setState({state:"list",selectRule:{},subRoute:{}})},t.handleAddComponent=function(e,a){t.updateAppLabels(a,t.props.appLabels),t.updateGovernance(a,t.props.isGovernance),t.setState((function(t){var n=t.components;return{components:(0,i.default)({},n,(0,u.default)({},e,a)),componentsError:""}}),(function(){t.props.formData[e]=a,t.updateComponentKind(),t.hideAddComponent()}))},t.handleAddRule=function(e){var a=e.protocol,n=e.secretName,l=e._host,u=(0,o.default)(e,["protocol","secretName","_host"]),i=t.state.ingress,s=l||u.host,d=(0,h.default)(i,"spec.rules"),c=[];c=d.find((function(e){return e.host===s}))?d.map((function(e){return e.host===s?u:e})):[].concat((0,r.default)(d),[u]),(0,v.default)(i,"spec.rules",c);var f=(0,h.default)(i,"spec.tls[0]",{});f.hosts&&f.hosts.includes(s)?"http"===a?(f.hosts=f.hosts.filter((function(e){return e!==s})),(0,y.default)(f.hosts)?(0,v.default)(i,"spec.tls",[]):(0,v.default)(i,"spec.tl[0]",f)):"https"===a&&(f.secretName=n,(0,v.default)(i,"spec.tls[0]",f)):"https"===a&&(f.secretName=n,f.hosts=(0,g.default)([].concat((0,r.default)(f.hosts||[]),[s])),(0,v.default)(i,"spec.tls[0]",f)),t.updateComponentKind(),t.hideAddRule()},t.handleDeleteComponent=function(e){t.setState((function(t){var a=t.components;return delete a[e],{components:(0,i.default)({},a)}}),(function(){delete t.props.formData[e],t.updateComponentKind()}))},t.handleDeleteRule=function(e){var a=t.state.ingress,n=(0,h.default)(a,"spec.rules",[]).filter((function(t){return t.host!==e}));(0,v.default)(a,"spec.rules",n);var l=(0,h.default)(a,"spec.tls[0]");l&&((0,y.default)(l.hosts)?(0,v.default)(a,"spec.tls",[]):(l.hosts=l.hosts.filter((function(t){return t!==e})),(0,v.default)(a,"spec.tls[0]",l))),t.setState({ingress:(0,i.default)({},a)}),t.updateComponentKind()},t}return(0,m.default)(a,e),(0,d.default)(a,[{key:"getChildContext",value:function(){return{registerSubRoute:this.registerSubRoute,resetSubRoute:this.resetSubRoute}}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.formData!==this.props.formData&&this.setState({components:(0,p.default)(e.formData,["application","ingress"])||{},ingress:(0,h.default)(e.formData,"ingress",{})}),(0,S.default)(e.appLabels,this.props.appLabels)||Object.values(this.state.components).forEach((function(a){t.updateAppLabels(a,e.appLabels)})),e.isGovernance!==this.props.isGovernance&&Object.values(this.state.components).forEach((function(a){t.updateGovernance(a,e.isGovernance)}))}},{key:"updateAppLabels",value:function(e,t){(0,w.mergeLabels)(e.workload,t),(0,w.mergeLabels)(e.service,t)}},{key:"updateGovernance",value:function(e,t){(0,v.default)(e.workload,'metadata.annotations["servicemesh.kubesphere.io/enabled"]',String(t)),(0,v.default)(e.service,'metadata.annotations["servicemesh.kubesphere.io/enabled"]',String(t)),(0,v.default)(e.workload,'spec.template.metadata.annotations["sidecar.istio.io/inject"]',String(t))}},{key:"validate",value:function(e){if("list"!==this.state.state)return k.default.warning(t("Please finish the sub form first"));if(Object.keys(this.state.components).length<=0)return k.default.warning(t("Application components should not be empty")),this.setState({componentsError:t("Application components should not be empty")});var a=this.props.gateway,n=this.state.ingress;if((0,h.default)(n,"spec.rules",[]).length>0&&(0,y.default)(a))return k.default.warning(t("DEPLOY_SAMPLE_NO_INTERNET_ACCESS_TIP")),this.setState({rulesError:t("DEPLOY_SAMPLE_NO_INTERNET_ACCESS_TIP")});e&&e()}},{key:"renderFooter",value:function(){var e=this.state.subRoute;return(0,y.default)(e)?null:b.default.createElement(C.default,{className:D.default.footer,onOk:this.handleSubFormSave,onCancel:this.handleSubFormCancel})}},{key:"renderContent",value:function(){var e,t=this.props,a=t.limitRange,n=t.configMaps,l=t.secrets,r=t.imageRegistries,o=t.gateway,u=t.namespace,i=t.appLabels,s=void 0===i?{}:i,d=t.isGovernance,c=this.state,f=c.components,m=c.ingress,p=c.componentsError,h=c.rulesError,v=c.selectComponentKey,g=c.selectRule;switch(c.state){case"list":e=b.default.createElement(b.default.Fragment,null,b.default.createElement(T.default,{error:p,data:f,onAdd:this.showAddComponent,onDelete:this.handleDeleteComponent}),b.default.createElement(M.default,{error:h,data:m,gateway:o,onAdd:this.showAddRule,onDelete:this.handleDeleteRule}));break;case"new-component":e=b.default.createElement(P.default,{appName:s["app.kubernetes.io/name"],detail:f[v]||{},componentKey:v,namespace:u,onOk:this.handleAddComponent,onCancel:this.hideAddComponent,limitRange:a,configMaps:n,secrets:l,imageRegistries:r,isGovernance:d});break;case"new-rule":var y=Object.values(f).map((function(e){return N.default.services(e.service)}));e=b.default.createElement(R.default,{className:D.default.formWrapper,data:g,namespace:u,onSave:this.handleAddRule,onCancel:this.hideAddRule,gateway:o,services:y,secrets:l})}return e}},{key:"render",value:function(){return b.default.createElement("div",{className:D.default.wrapper},this.renderContent(),this.renderFooter())}}]),a}(b.default.Component);a.default=O,O.propTypes={formData:_.default.object.isRequired},O.childContextTypes={registerSubRoute:_.default.func,resetSubRoute:_.default.func}},3382:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(1)),f=l(n(58)),m=l(n(224)),p=l(n(3383)),h=l(n(2785)),v=function(e){function a(){var e,t;(0,r.default)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(t=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(l)))).handleAdd=function(){t.props.onAdd()},t.handleEdit=function(e){t.props.onAdd(e)},t.handleDelete=function(e){t.props.onDelete(e)},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"renderContent",value:function(){var e=this,a=this.props.data;return(0,f.default)(a)?d.default.createElement("div",{className:h.default.empty},d.default.createElement("div",null,d.default.createElement("p",null,t("Application components combine workloads and services as components in applications")),d.default.createElement(m.default,{onClick:this.handleAdd},t("Add Component")))):d.default.createElement("div",null,Object.keys(a).map((function(t){return d.default.createElement(p.default,{key:t,data:a[t],propsKey:t,onEdit:e.handleEdit,onDelete:e.handleDelete})})),d.default.createElement("div",{className:"text-right margin-t12"},d.default.createElement(m.default,{onClick:this.handleAdd},t("Add Component"))))}},{key:"render",value:function(){var e=this.props.error;return d.default.createElement("div",{className:h.default.wrapper},d.default.createElement("div",{className:"h5"},t("Application Components")),this.renderContent(),e&&d.default.createElement("p",{className:h.default.error},e))}}]),a}(d.default.Component);a.default=v,v.propTypes={data:c.default.object,onAdd:c.default.func,onDelete:c.default.func},v.defaultProps={data:{},onAdd:function(){},onDelete:function(){}}},3383:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(22)),c=l(n(2472)),f=l(n(0)),m=l(n(1)),p=l(n(38)),h=n(938),v=l(n(227)),g=l(n(224)),y=n(114),E=n(964),b=l(n(2785)),_=function(e){function a(){var e,t;(0,r.default)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(t=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(l)))).handleEdit=function(){t.props.onEdit(t.props.propsKey)},t.handleDelete=function(){t.props.onDelete(t.props.propsKey)},t.renderPorts=function(){var e=t.props.data,a=(0,d.default)(e,"service.spec.ports",[]);return f.default.createElement("div",{className:b.default.tip},a.map((function(e,t){return f.default.createElement("p",{key:t},(0,E.getServicePort)(e))})))},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props.data,a=(0,d.default)(e,"workload.kind"),n=(0,c.default)(y.MODULE_KIND_MAP,(function(e){return e===a}))||"deployments",l=(0,d.default)(e,"service.spec.ports",[]);return f.default.createElement("div",{className:b.default.item},f.default.createElement(h.Columns,{className:"is-gapless"},f.default.createElement(h.Column,{className:"is-narrow"},f.default.createElement(p.default,{name:y.ICON_TYPES[n],size:40})),f.default.createElement(h.Column,null,f.default.createElement("div",{className:b.default.block},f.default.createElement("div",{className:"h6"},(0,d.default)(e,"service.metadata.name","-")),f.default.createElement("p",null,t("Workload Type"),": ",t(a)))),f.default.createElement(h.Column,null,f.default.createElement("div",{className:b.default.block},f.default.createElement("p",null,t("Component Version"),":"," ",(0,d.default)(e,"workload.metadata.labels.version")),f.default.createElement("p",null,t("Replicas Number"),": ",(0,d.default)(e,"workload.spec.replicas",0)))),f.default.createElement(h.Column,null,f.default.createElement("div",{className:b.default.block},f.default.createElement("div",{className:"flexbox"},f.default.createElement("span",null,t("Ports"),":  "),f.default.createElement("span",null,l.slice(0,2).map((function(e,t){return f.default.createElement("span",{className:"display-block",key:t},(0,E.getServicePort)(e))}))),l.length>2&&f.default.createElement(v.default,{content:this.renderPorts()},f.default.createElement(p.default,{name:"more",className:b.default.more,clickable:!0})))))),f.default.createElement("div",{className:b.default.operations},f.default.createElement(g.default,{type:"flat",icon:"trash",onClick:this.handleDelete}),f.default.createElement(g.default,{type:"flat",icon:"pen",onClick:this.handleEdit})))}}]),a}(f.default.Component);a.default=_,_.propTypes={data:m.default.shape({workload:m.default.object,service:m.default.object}),propsKey:m.default.string,onEdit:m.default.func,onDelete:m.default.func},_.defaultProps={data:{workload:{},service:{}},propsKey:"",onEdit:function(){},onDelete:function(){}}},3384:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(268)),c=l(n(0)),f=l(n(386)),m=l(n(225)),p=l(n(38)),h=l(n(227)),v=l(n(2530)),g=l(n(2666)),y=n(114),E=l(n(3386)),b=function(e){function a(e){var t;return(0,r.default)(this,a),(t=(0,u.default)(this,(0,i.default)(a).call(this,e))).triggerChange=(0,d.default)((function(){var e=t.state,a=e.name,n=e.protocol,l=e.containerPort;t.props.onChange({name:a,protocol:"UDP"===n?"UDP":"TCP",containerPort:l})}),300),t.handleNameChange=function(e,a){t.setState({name:a},(function(){return t.triggerChange()}))},t.handleProtocolChange=function(e){var a,n=t.state.name,l="".concat(t.state.protocol.toLowerCase(),"-");a=n.startsWith(l)?"".concat(e.toLowerCase(),"-").concat(n.replace(l,"")):"".concat(e.toLowerCase(),"-"),t.setState({name:a,protocol:e},(function(){return t.triggerChange()}))},t.handleContainerPortChange=function(e){t.setState({containerPort:e},(function(){return t.triggerChange()}))},t.defaultProtocol="HTTP",t.state=t.getStateFromProps(e),t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.value!==this.props.value&&this.setState(this.getStateFromProps(e))}},{key:"getStateFromProps",value:function(e){var t=this.defaultProtocol,a=e.value,n=a.name,l=a.containerPort;if(n){var r=n.match(/^(\w+)-(.*)/);r&&(t=(r[1]||this.defaultProtocol).toUpperCase())}return{name:n||"".concat(t.toLowerCase(),"-"),protocol:y.PROTOCOLS.some((function(e){return e.value===t}))?t:e.value.protocol,containerPort:l}}},{key:"render",value:function(){var e=this.state,a=e.name,n=e.protocol,l=e.containerPort;return c.default.createElement("div",{className:E.default.wrapper},c.default.createElement(g.default,{prefix:c.default.createElement("div",{className:E.default.tip},c.default.createElement("span",null,t("Protocol")),c.default.createElement(h.default,{content:t("ISTIO_PROTOCOL_TIP")},c.default.createElement(p.default,{name:"question"})))},c.default.createElement(m.default,{name:"protocol",value:n,options:y.PROTOCOLS,defaultValue:this.defaultProtocol,onChange:this.handleProtocolChange})),c.default.createElement(g.default,{prefix:t("Name")},c.default.createElement(f.default,{name:"name",value:a,placeholder:t("required"),onChange:this.handleNameChange})),c.default.createElement(g.default,{prefix:t("Container Port")},c.default.createElement(v.default,{name:"containerPort",min:1,max:65535,value:l,integer:!0,placeholder:t("required"),onChange:this.handleContainerPortChange})))}}]),a}(c.default.Component);a.default=b,b.defaultProps={value:{},onChange:function(){}}},3385:function(e,t,a){e.exports={wrapper:"AddonsInput__wrapper--7te1l",text:"AddonsInput__text--3nzWD"}},3386:function(e,t,a){e.exports={wrapper:"ContainerPort__wrapper--1nzmy",tip:"ContainerPort__tip--2Njdk"}},3387:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(268)),c=l(n(0)),f=l(n(386)),m=l(n(225)),p=l(n(38)),h=l(n(227)),v=l(n(2530)),g=l(n(2666)),y=n(114),E=l(n(3388)),b=function(e){function a(e){var t;return(0,r.default)(this,a),(t=(0,u.default)(this,(0,i.default)(a).call(this,e))).triggerChange=(0,d.default)((function(){var e=t.state,a=e.name,n=e.protocol,l=e.containerPort,r=e.servicePort;t.props.onChange({name:a,protocol:"UDP"===n?"UDP":"TCP",containerPort:l,servicePort:r})}),300),t.handleNameChange=function(e,a){t.setState({name:a},(function(){return t.triggerChange()}))},t.handleProtocolChange=function(e){var a,n=t.state.name,l="".concat(t.state.protocol.toLowerCase(),"-");a=n.startsWith(l)?"".concat(e.toLowerCase(),"-").concat(n.replace(l,"")):"".concat(e.toLowerCase(),"-"),t.setState({name:a,protocol:e},(function(){return t.triggerChange()}))},t.handleContainerPortChange=function(e){t.setState({containerPort:e},(function(){return t.triggerChange()}))},t.handleServicePortChange=function(e){t.setState({servicePort:e},(function(){return t.triggerChange()}))},t.defaultProtocol="HTTP",t.state=t.getStateFromProps(e),t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.value!==this.props.value&&this.setState(this.getStateFromProps(e))}},{key:"getStateFromProps",value:function(e){var t=this.defaultProtocol,a=e.value,n=a.name,l=a.containerPort,r=a.servicePort;if(n){var o=n.match(/^(\w+)-(.*)/);o&&(t=(o[1]||this.defaultProtocol).toUpperCase())}return{name:n||"".concat(t.toLowerCase(),"-"),protocol:y.PROTOCOLS.some((function(e){return e.value===t}))?t:e.value.protocol,containerPort:l,servicePort:r}}},{key:"render",value:function(){var e=this.state,a=e.name,n=e.protocol,l=e.containerPort,r=e.servicePort;return c.default.createElement("div",{className:E.default.wrapper},c.default.createElement(g.default,{prefix:c.default.createElement("div",{className:E.default.tip},c.default.createElement("span",null,t("Protocol")),c.default.createElement(h.default,{content:t("ISTIO_PROTOCOL_TIP")},c.default.createElement(p.default,{name:"question"})))},c.default.createElement(m.default,{name:"protocol",value:n,options:y.PROTOCOLS,defaultValue:this.defaultProtocol,onChange:this.handleProtocolChange})),c.default.createElement(g.default,{prefix:t("Name")},c.default.createElement(f.default,{name:"name",value:a,placeholder:t("required"),onChange:this.handleNameChange})),c.default.createElement(g.default,{prefix:t("Container Port")},c.default.createElement(v.default,{name:"containerPort",min:1,max:65535,value:l,integer:!0,placeholder:t("required"),onChange:this.handleContainerPortChange})),c.default.createElement(g.default,{prefix:t("Service Port")},c.default.createElement(v.default,{name:"servicePort",min:1,max:65535,value:r,integer:!0,onChange:this.handleServicePortChange})))}}]),a}(c.default.Component);a.default=b,b.defaultProps={value:{},onChange:function(){}}},3388:function(e,t,a){e.exports={wrapper:"ContainerServicePort__wrapper--2jnaJ"}},3389:function(e,t,a){e.exports={input:"Commands__input--9VIeO"}},3390:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(70)),o=l(n(63)),u=l(n(97)),i=l(n(13)),s=l(n(14)),d=l(n(17)),c=l(n(16)),f=l(n(18)),m=l(n(58)),p=l(n(0)),h=l(n(1)),v=l(n(224)),g=l(n(3391)),y=l(n(2546)),E=function(e){function a(e){var t;return(0,i.default)(this,a),(t=(0,d.default)(this,(0,c.default)(a).call(this,e))).handleAddRef=function(){1===t.state.value.length&&(0,m.default)(t.state.value[0].name)&&(0,m.default)(t.state.value[0].value)?t.setState({value:[{name:"",valueFrom:{}}]}):t.setState({value:[].concat((0,u.default)(t.state.value),[{name:"",valueFrom:{}}])})},t.checkItemValid=function(e){return!((0,m.default)(e)||(0,m.default)(e.name)||(0,m.default)(e.value)&&(0,m.default)(e.valueFrom))},t.state={value:(0,m.default)(e.value)?[{name:"",value:""}]:e.value},t}return(0,f.default)(a,e),(0,s.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.value&&JSON.stringify(e.value)!==JSON.stringify(this.state.value)&&this.setState({value:(0,m.default)(e.value)?[]:e.value})}},{key:"isAddEnable",value:function(){return!(1!==this.state.value.length||!(0,m.default)(this.state.value[0].name)||!(0,m.default)(this.state.value[0].value))||this.state.value.every(this.checkItemValid)}},{key:"render",value:function(){var e=this.props,a=(e.value,e.configMaps),n=e.secrets,l=(0,o.default)(e,["value","configMaps","secrets"]),u=this.state.value;return p.default.createElement(y.default,(0,r.default)({value:u,itemType:"object",checkItemValid:this.checkItemValid,addText:t("Add Environment Variable"),extraAdd:p.default.createElement(v.default,{onClick:this.handleAddRef,disabled:!this.isAddEnable()},t("Use ConfigMap or Secret"))},l),p.default.createElement(g.default,{configMaps:a,secrets:n}))}}]),a}(p.default.Component);a.default=E,E.propTypes={name:h.default.string,value:h.default.array,onChange:h.default.func,configMaps:h.default.array,secrets:h.default.array},E.defaultProps={name:"",value:[],onChange:function(){},configMaps:[],secrets:[]}},3391:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(30)),o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(22)),f=l(n(58)),m=l(n(0)),p=n(226),h=l(n(1)),v=l(n(2468)),g=n(49),y=l(n(38)),E=l(n(386)),b=l(n(225)),_=l(n(2545)),S={ConfigMap:"configmaps",Secret:"secrets"},k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"name";return(0,c.default)(e,"value.valueFrom.configMapKeyRef.".concat(t),(0,c.default)(e,"value.valueFrom.secretKeyRef.".concat(t),""))},C=(0,v.default)("/projects/:namespace/:module"),w=function(e){function a(){var e,n;(0,o.default)(this,a);for(var l=arguments.length,u=new Array(l),d=0;d<l;d++)u[d]=arguments[d];return(n=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(u)))).state={resource:k(n.props)},n.handleChange=function(e){var t=n.props,a=t.configMaps,l=t.secrets,o={name:e.name,valueFrom:{}};if(e.resource){var u="",i=a.find((function(t){return t.name===e.resource})),s=l.find((function(t){return t.name===e.resource})),d=i||s;i?u="configMapKeyRef":s&&(u="secretKeyRef"),u&&(o.valueFrom=(0,r.default)({},u,{name:d.name,key:e.resourceKey}))}n.props.onChange(o)},n.handleSelectChange=function(e){n.setState({resource:e})},n.valueRenderer=function(e){var a=n.getDetailPrefix(e.type);return m.default.createElement("p",null,e.label,m.default.createElement("span",{style:{color:"#abb4be"}}," (",t(e.type),")"),a&&m.default.createElement(p.Link,{to:"".concat(a,"/").concat(e.value),target:"_blank"},m.default.createElement(y.default,{className:"align-text-bottom",name:"question"})))},n}return(0,d.default)(a,e),(0,u.default)(a,[{key:"componentWillReceiveProps",value:function(e){var t=k(e);t&&t!==k(this.props)&&this.setState({resource:t})}},{key:"getDetailPrefix",value:function(e){var t=C.exec(location.pathname)||[];return t.length>2?"/projects/".concat(t[1],"/").concat(S[e]):""}},{key:"getResourceOptions",value:function(){var e=this.props,a=e.configMaps,n=e.secrets,l=[];return(0,f.default)(a)||l.push({label:t("ConfigMap"),options:a.map((function(e){return{label:(0,g.getDisplayName)(e),value:e.name,type:"ConfigMap"}}))}),(0,f.default)(n)||l.push({label:t("Secret"),options:n.map((function(e){return{label:(0,g.getDisplayName)(e),value:e.name,type:"Secret"}}))}),l}},{key:"getKeysOptions",value:function(){var e=this.state.resource,t=this.props,a=t.configMaps,n=t.secrets,l=a.find((function(t){return t.name===e})),r=n.find((function(t){return t.name===e})),o=l||r||{};return Object.keys(o.data||{}).map((function(e){return{label:e,value:e}}))}},{key:"render",value:function(){var e=this.props,a=e.value,n=void 0===a?{}:a,l=e.onChange;if(n.valueFrom){var r={name:n.name,resource:k(this.props),resourceKey:k(this.props,"key")};return m.default.createElement(_.default,{value:r,onChange:this.handleChange},m.default.createElement(E.default,{name:"name",placeholder:t("name")}),m.default.createElement(b.default,{name:"resource",placeholder:t("Select resource"),options:this.getResourceOptions(),onChange:this.handleSelectChange,valueRenderer:this.valueRenderer}),m.default.createElement(b.default,{name:"resourceKey",placeholder:t("Select Key"),options:this.getKeysOptions()}))}return m.default.createElement(_.default,{value:n,onChange:l},m.default.createElement(E.default,{name:"name",placeholder:t("name")}),m.default.createElement(E.default,{name:"value",placeholder:t("value")}))}}]),a}(m.default.Component);a.default=w,w.propTypes={value:h.default.object,onChange:h.default.func,configMaps:h.default.array,secrets:h.default.array},w.defaultProps={name:"",value:{},onChange:function(){},configMaps:[],secrets:[]}},3392:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(1)),f=l(n(3)),m=l(n(58)),p=l(n(22)),h=n(938),v=l(n(38)),g=l(n(224)),y=l(n(3393)),E=l(n(3395)),b=function(e){function a(){var e,t;(0,r.default)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(t=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(l)))).state={showForm:!1},t.getProbeTypeText=function(e){return"httpGet"in e?"HTTP Request Check":"tcpSocket"in e?"TCP Port Check":"Exec Commnad Check"},t.showForm=function(){t.setState({showForm:!0})},t.hideForm=function(){t.setState({showForm:!1})},t.handleForm=function(e){(0,t.props.onChange)(e),t.hideForm()},t.handleDelete=function(){(0,t.props.onChange)()},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"renderProbeInfo",value:function(){var e=this.props.value;if("httpGet"in e)return d.default.createElement(d.default.Fragment,null,d.default.createElement("div",null,d.default.createElement("strong",null,(0,p.default)(e,"httpGet.scheme","")),d.default.createElement("p",null,t("Type"))),d.default.createElement("div",null,d.default.createElement("strong",null,(0,p.default)(e,"httpGet.path","")),d.default.createElement("p",null,t("Path"))),d.default.createElement("div",null,d.default.createElement("strong",null,(0,p.default)(e,"httpGet.port","")),d.default.createElement("p",null,t("Port"))));if("tcpSocket"in e)return d.default.createElement("div",null,d.default.createElement("strong",null,(0,p.default)(e,"tcpSocket.port","")),d.default.createElement("p",null,t("Port")));if("exec"in e){var a=(0,p.default)(e,"exec.command",[]);return d.default.createElement("div",null,d.default.createElement("strong",null,a[0],a.length>1&&" ..."),d.default.createElement("p",null,t("Command")))}return null}},{key:"renderProbeForm",value:function(){var e=this.props.value;return d.default.createElement(y.default,{className:E.default.form,data:e,onSave:this.handleForm,onCancel:this.hideForm})}},{key:"render",value:function(){var e=this.props,a=e.type,n=e.description,l=e.value;return this.state.showForm?d.default.createElement("div",{className:E.default.probe},this.renderProbeForm()):(0,m.default)(l)?d.default.createElement("div",{className:(0,f.default)(E.default.empty),onClick:this.showForm},d.default.createElement("div",null,"".concat(t("Add ")).concat(a)),d.default.createElement("p",{className:"text-secondary"},n)):d.default.createElement("div",{className:E.default.probe},d.default.createElement("div",{className:E.default.content},d.default.createElement(v.default,{name:"monitor",size:40}),d.default.createElement("div",null,d.default.createElement("strong",null,t(this.getProbeTypeText(l))),d.default.createElement("p",null,d.default.createElement("span",null,t("Initial Delay"),": ","".concat(l.initialDelaySeconds||0,"s")),"  ",d.default.createElement("span",null,t("Timeout"),": ","".concat(l.timeoutSeconds||0,"s")))),this.renderProbeInfo()),d.default.createElement(h.Buttons,null,d.default.createElement(g.default,{type:"flat",icon:"trash",onClick:this.handleDelete}),d.default.createElement(g.default,{type:"flat",icon:"pen",onClick:this.showForm})))}}]),a}(d.default.Component);a.default=b,b.propTypes={name:c.default.string,value:c.default.object,onChange:c.default.func,onShowForm:c.default.func},b.defaultProps={name:"",value:{},onChange:function(){},onShowForm:function(){}}},3393:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o,u,i=l(n(37)),s=l(n(13)),d=l(n(14)),c=l(n(17)),f=l(n(16)),m=l(n(18)),p=l(n(0)),h=n(60),v=l(n(1)),g=l(n(3)),y=l(n(22)),E=n(938),b=l(n(2455)),_=l(n(2454)),S=l(n(225)),k=l(n(386)),C=l(n(267)),w=l(n(2530)),N=l(n(2790)),T=l(n(2545)),P=l(n(954)),M=l(n(3394)),R=(0,h.observer)((u=o=function(e){function a(e){var t;return(0,s.default)(this,a),(t=(0,c.default)(this,(0,f.default)(a).call(this,e))).filterData=function(e){var a=t.state.checkerType,n=(0,i.default)({},e);switch(a){default:case"http":delete n.tcpSocket,delete n.exec;break;case"command":delete n.httpGet,delete n.tcpSocket;break;case"tcp":delete n.httpGet,delete n.exec}return n},t.handleTypeChange=function(e){t.setState({checkerType:e})},t.handleSubmit=function(){var e=t.props.onSave,a=t.formRef.current;a&&a.validate((function(){e(t.filterData(a.getData()))}))},t.state={formData:(0,y.default)(e.data,{}),checkerType:t.checkerType},t.formRef=p.default.createRef(),t}return(0,m.default)(a,e),(0,d.default)(a,[{key:"renderProbeSection",value:function(){var e=this.state.checkerType;return"command"===e?p.default.createElement(C.default.Item,{key:e,label:t("Commands"),desc:t("PROBE_COMMAND_DESC"),rules:[{required:!0,message:t("Please input command")}]},p.default.createElement(N.default,{className:"max-width-full",name:"exec.command"})):"tcp"===e?p.default.createElement(E.Columns,null,p.default.createElement(E.Column,null,p.default.createElement(C.default.Item,{label:t("Port"),rules:[{required:!0,message:t("Please input port")}]},p.default.createElement(w.default,{name:"tcpSocket.port",defaultValue:80,min:0,max:65535,integer:!0}))),p.default.createElement(E.Column,null)):p.default.createElement(C.default.Item,{key:e,label:t("HTTP Request"),rules:[{required:!0,message:t("Please input http request")}]},p.default.createElement(T.default,{name:"httpGet",className:M.default.object,defaultValue:this.defaultData},p.default.createElement(S.default,{name:"scheme",options:this.httpRequestTypes}),p.default.createElement(k.default,{name:"path"}),p.default.createElement(w.default,{name:"port",min:0,max:65535,integer:!0})))}},{key:"render",value:function(){var e=this.props,a=e.className,n=e.onCancel,l=this.state,r=l.formData,o=l.checkerType;return p.default.createElement("div",{className:(0,g.default)(M.default.wrapper,a)},p.default.createElement("div",{className:(0,g.default)(M.default.radioGroup,"probe-radio-group")},p.default.createElement(_.default,{wrapClassName:"radio-default",buttonWidth:150,value:o,onChange:this.handleTypeChange,size:"small"},p.default.createElement(b.default,{value:"http"},t("HTTP Request Check")),p.default.createElement(b.default,{value:"command"},t("Exec Commnad Check")),p.default.createElement(b.default,{value:"tcp"},t("TCP Port Check")))),p.default.createElement(C.default,{ref:this.formRef,type:"inner",data:r},p.default.createElement("div",{className:"margin-b12"},this.renderProbeSection()),p.default.createElement(E.Columns,null,p.default.createElement(E.Column,null,p.default.createElement(C.default.Item,{label:t("Initial Delay(s)"),desc:t("INITIAL_DELAY_DESC")},p.default.createElement(w.default,{name:"initialDelaySeconds",defaultValue:0,min:0,integer:!0}))),p.default.createElement(E.Column,null,p.default.createElement(C.default.Item,{label:t("Timeout(s)"),desc:t("TIMEOUT_DESC")},p.default.createElement(w.default,{name:"timeoutSeconds",defaultValue:1,min:1,integer:!0})))),p.default.createElement(E.Columns,null,p.default.createElement(E.Column,null,p.default.createElement(C.default.Item,{label:t("Period Seconds"),desc:t("PERIOD_SECONDS_DESC")},p.default.createElement(w.default,{name:"periodSeconds",defaultValue:10,min:1,integer:!0}))),p.default.createElement(E.Column,null,p.default.createElement(C.default.Item,{label:t("Success Threshold"),desc:t("SUCCESS_THRESHOLD_DESC")},p.default.createElement(w.default,{name:"successThreshold",defaultValue:1,min:1,integer:!0})))),p.default.createElement(E.Columns,null,p.default.createElement(E.Column,null,p.default.createElement(C.default.Item,{label:t("Failure Threshold"),desc:t("FAILURE_THRESHOLD_DESC")},p.default.createElement(w.default,{name:"failureThreshold",defaultValue:3,min:1,integer:!0}))),p.default.createElement(E.Column,null))),p.default.createElement(P.default,{className:M.default.confirm,onOk:this.handleSubmit,onCancel:n}))}},{key:"defaultData",get:function(){return{scheme:"HTTP",path:"/",port:80}}},{key:"checkerType",get:function(){var e=this.props.data;return"exec"in e?"command":"tcpSocket"in e?"tcp":"http"}},{key:"httpRequestTypes",get:function(){return[{label:"HTTP",value:"HTTP"},{label:"HTTPS",value:"HTTPS"}]}}]),a}(p.default.Component),o.propTypes={className:v.default.string,data:v.default.object,onSave:v.default.func,onCancel:v.default.func},o.defaultProps={data:{},onSave:function(){},onCancel:function(){}},r=u))||r;a.default=R},3394:function(e,t,a){e.exports={wrapper:"ProbeForm__wrapper--2qA0D",radioGroup:"ProbeForm__radioGroup--lTdgb",confirm:"ProbeForm__confirm--3750n",object:"ProbeForm__object--2y_cK"}},3395:function(e,t,a){e.exports={probe:"ProbeInput__probe--3aWvL",content:"ProbeInput__content--2F5Lm",empty:"ProbeInput__empty--bvVfd",form:"ProbeInput__form--2DcqG"}},3396:function(e,t,a){e.exports={item:"HealthChecker__item--1A0EK"}},3397:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(22)),f=n(19),m=n(49),p=n(114),h=l(n(386)),v=l(n(225)),g=n(938),y=l(n(267)),E=l(n(2600)),b=l(n(2599)),_=l(n(2590)),S=l(n(2604)),k=l(n(2543)),C=l(n(2537)),w=l(n(3399)),N=l(n(3405)),T=function(e){function a(e){var t;return(0,r.default)(this,a),(t=(0,u.default)(this,(0,i.default)(a).call(this,e))).valueRenderer=function(e){return d.default.createElement(E.default,{type:"init"===e.value?"warning":"default"},e.label)},t.renderImageForm=function(){return d.default.createElement(w.default,{name:"image",className:N.default.imageSearch,namespace:t.props.namespace,formTemplate:t.props.data,imageRegistries:t.imageRegistries})},t.state={quota:{},limitRange:{},imageRegistries:[]},t.quotaStore=new S.default,t.projectStore=new k.default,t.secretStore=new C.default,t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"fetchData",value:function(){var e=this,t=this.props.namespace;Promise.all([this.quotaStore.fetch({namespace:t}),this.projectStore.fetchLimitRanges({namespace:t}),this.secretStore.fetchByK8s({namespace:this.props.namespace,fieldSelector:"type=kubernetes.io/dockerconfigjson"})]).then((function(){e.setState({quota:e.quotaStore.data,limitRange:(0,c.default)((0,f.toJS)(e.projectStore.limitRanges),"data[0].limit"),imageRegistries:e.secretStore.list.data})}))}},{key:"renderAdvancedSettings",value:function(){var e=this.props,a=e.defaultContainerType,n=e.onContainerTypeChange,l=this.state.quota,r=(0,c.default)(l,'left["requests.cpu"]'),o=(0,c.default)(l,'left["requests.memory"]'),u=(0,c.default)(l,'left["limits.cpu"]'),i=(0,c.default)(l,'left["limits.memory"]'),s=d.default.createElement("div",{className:N.default.message},t("Left Quota"),":    [",t("Resource Request"),": CPU"," ",r?"".concat((0,m.cpuFormat)(r)," Core"):t("No Limit"),","," ",t("Memory")," ",o?"".concat((0,m.memoryFormat)(o)," Mi"):t("No Limit"),"]    [",t("Resource Limit"),": CPU"," ",u?"".concat((0,m.cpuFormat)(u)," Core"):t("No Limit"),","," ",t("Memory")," ",i?"".concat((0,m.memoryFormat)(i)," Mi"):t("No Limit"),"]");return d.default.createElement(_.default,null,d.default.createElement(d.default.Fragment,null,d.default.createElement(g.Columns,null,d.default.createElement(g.Column,null,d.default.createElement(y.default.Item,{label:t("Container Name"),desc:t("NAME_DESC"),rules:[{required:!0,message:t("Please input name")},{pattern:p.PATTERN_NAME,message:"".concat(t("Invalid name"),", ").concat(t("NAME_DESC"))},{pattern:p.PATTERN_LENGTH_63,message:t("NAME_TOO_LONG")}]},d.default.createElement(h.default,{name:"name",defaultValue:"container-".concat((0,m.generateId)())}))),d.default.createElement(g.Column,null,d.default.createElement(y.default.Item,{label:t("Container Type")},d.default.createElement(v.default,{name:"type",defaultValue:a,options:this.containerTypes,onChange:n,valueRenderer:this.valueRenderer})))),d.default.createElement(y.default.Item,null,d.default.createElement(b.default,{name:"resources",defaultValue:this.defaultResourceLimit})),s))}},{key:"render",value:function(){return d.default.createElement(y.default.Group,{label:t("Container Settings"),desc:t("Setting for the name of the container and the computing resources of the container"),noWrapper:!0},this.renderImageForm(),this.renderAdvancedSettings())}},{key:"defaultResourceLimit",get:function(){var e=this.state.limitRange,t=void 0===e?{}:e;if(t.defaultRequest||t.default)return{requests:t.defaultRequest||{},limits:t.default||{}}}},{key:"containerTypes",get:function(){return[{label:t("Worker Container"),value:"worker"},{label:t("Init Container"),value:"init"}]}},{key:"imageRegistries",get:function(){return this.state.imageRegistries.map((function(e){var t=(0,c.default)(e,'data[".dockerconfigjson"].auths',{}),a=Object.keys(t)[0]||"";return{url:a,username:(0,c.default)(t[a],"username"),label:e.name,value:e.name}}))}}]),a}(d.default.Component);a.default=T},3398:function(e,t,a){e.exports={toggle:"ToggleView__toggle--1sOiE",children:"ToggleView__children--3aYqr"}},3399:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(70)),o=l(n(61)),u=l(n(37)),i=l(n(63)),s=l(n(62)),d=l(n(13)),c=l(n(14)),f=l(n(17)),m=l(n(16)),p=l(n(18)),h=l(n(0)),v=l(n(22)),g=l(n(115)),y=l(n(2458)),E=l(n(55)),b=l(n(58)),_=l(n(3)),S=l(n(131)),k=l(n(38)),C=l(n(129)),w=n(49),N=n(114),T=l(n(267)),P=l(n(224)),M=l(n(1)),R=l(n(2649)),D=l(n(3400)),O=l(n(2794)),x=function(e){function a(e){var n;return(0,d.default)(this,a),(n=(0,f.default)(this,(0,m.default)(a).call(this,e))).handleEnter=function(e){if(globals.config.enableImageSearch){var t=e||{},a=t.logo,l=void 0===a?"":a,r=t.short_description,o=void 0===r?"":r,u=n.props.formTemplate,i=(0,v.default)(u,"pullSecret"),s=(0,v.default)(u,"image","");n.image&&s===n.image||n.getImageDetail({image:s,secret:i,logo:l,short_description:o})}},n.getImageDetail=function(){var e=(0,s.default)(o.default.mark((function e(t){var a,l,r,s,d,c;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.image,l=t.secret,r=(0,i.default)(t,["image","secret"]),s=n.props.namespace,a){e.next=4;break}return e.abrupt("return");case 4:return n.image=a,n.setState({isLoading:!0}),e.next=8,n.store.getImageDetail({namespace:s,image:a,secret:l});case 8:if(d=e.sent,c=(0,u.default)({},d,r,{image:a}),(0,g.default)(globals,"cache[".concat(a,"]"),c),!n.isUnMounted){e.next=13;break}return e.abrupt("return");case 13:(0,b.default)(c.exposedPorts)||n.setState({showPortsTips:!0}),n.setState({isLoading:!1});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleFillPorts=function(){var e=n.selectedImage.exposedPorts.map((function(e){var t=e.split("/")[1],a=Number(e.split("/")[0]);return{name:"".concat(t,"-").concat(a),protocol:t.toUpperCase(),containerPort:a,servicePort:a}}));(0,b.default)(e)||((0,g.default)(n.props.formTemplate,"ports",e),n.context.forceUpdate())},n.renderSelectedContent=function(){if(n.state.isLoading)return h.default.createElement(C.default,null,h.default.createElement("div",{className:O.default.selectedContent}));if((0,E.default)(n.selectedImage)){if("failed"===n.selectedImage.status)return h.default.createElement("div",{className:(0,_.default)(O.default.selectedContent,O.default.emptyContent)},h.default.createElement(k.default,{name:"docker",className:O.default.icon}),h.default.createElement("p",{className:O.default.desc},t("Not found this image")));var e=n.selectedImage,a=e.image,l=e.size,r=e.layers,o=e.message,u=e.createTime,i=e.exposedPorts,s=void 0===i?[]:i,d=e.registry,c=e.logo,f=e.short_description,m=s.join("; "),p=o||f;return h.default.createElement("div",{className:O.default.selectedContent},h.default.createElement("div",{className:O.default.selectedInfo},h.default.createElement("img",{className:O.default.logo,src:c||"/assets/no_img.svg",alt:a}),h.default.createElement("div",{className:O.default.imageInfo},h.default.createElement("p",{className:O.default.title},a),h.default.createElement("p",{className:O.default.desc},"".concat((0,S.default)(u).fromNow(),", ").concat((0,w.formatSize)(l),", ").concat(r," ").concat(t("layers")))),n.state.showPortsTips?h.default.createElement(P.default,{className:O.default.defaultPortButtons,onClick:n.handleFillPorts},"👉 ",t("Use Default Ports")):null),p?h.default.createElement("div",{className:O.default.message},p):null,h.default.createElement("div",{className:O.default.config},h.default.createElement("div",{className:O.default.selectedInfo},h.default.createElement(k.default,{name:"tag",className:O.default.icon}),h.default.createElement("div",{className:O.default.imageInfo},h.default.createElement("p",null,n.tag),h.default.createElement("p",null,t("tag")))),h.default.createElement("div",{className:O.default.selectedInfo},h.default.createElement(k.default,{name:"port",className:O.default.icon}),h.default.createElement("div",{className:O.default.imageInfo},h.default.createElement("p",null,m||t("No default ports config")),h.default.createElement("p",null,t("ports")))),h.default.createElement("div",{className:O.default.selectedInfo},h.default.createElement(k.default,{name:"docker",className:O.default.icon}),h.default.createElement("div",{className:O.default.imageInfo},h.default.createElement("p",null,d),h.default.createElement("p",null,t("registry"))))))}return h.default.createElement("div",{className:(0,_.default)(O.default.selectedContent,O.default.emptyContent)},h.default.createElement(k.default,{name:"docker",className:O.default.icon}),h.default.createElement("p",{className:O.default.desc},t("Please select image")))},n.store=new R.default,n.getImageDetail=(0,y.default)(n.getImageDetail,1e3),n.state={isLoading:!1,showPortsTips:!1},n}return(0,p.default)(a,e),(0,c.default)(a,[{key:"componentDidMount",value:function(){var e=this.props.formTemplate,t=(0,v.default)(e,"image","");if(!this.selectedImage&&t){var a=(0,v.default)(e,"pullSecret");this.getImageDetail({image:t,secret:a})}}},{key:"componentWillUnMount",value:function(){this.isUnMounted=!0}},{key:"render",value:function(){return h.default.createElement(h.default.Fragment,null,h.default.createElement(T.default.Item,{label:t("Image"),desc:t.html("IMAGE_DESC",{link:(0,w.getDocsUrl)("imageregistry")}),rules:[{required:!0,message:t("IMAGE_PLACEHOLDER")},{pattern:N.PATTERN_IMAGE,message:t("Invalid image")}]},h.default.createElement(D.default,(0,r.default)({},this.props,{store:this.store,onEnter:this.handleEnter,name:"image",onLoading:this.handleLoadingChange}))),globals.config.enableImageSearch&&this.renderSelectedContent())}},{key:"selectedImage",get:function(){var e=this.props.formTemplate,t=(0,v.default)(e,"image","");return(0,v.default)(globals.cache,"[".concat(t,"]"))}},{key:"tag",get:function(){var e=(0,v.default)(this.props.formTemplate,"image",""),t=N.PATTERN_IMAGE_TAG.exec(e);return(0,v.default)(t,"[".concat(t.length-1,"]"),":latest").slice(1)}}]),a}(h.default.Component);a.default=x,x.defaultProps={className:"",type:"add"},x.contextTypes={forceUpdate:M.default.func}},3400:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(97)),o=l(n(30)),u=l(n(61)),i=l(n(62)),s=l(n(13)),d=l(n(14)),c=l(n(17)),f=l(n(16)),m=l(n(18)),p=l(n(0)),h=l(n(22)),v=l(n(115)),g=l(n(58)),y=l(n(3)),E=l(n(38)),b=l(n(129)),_=l(n(2534)),S=l(n(3401)),k=l(n(3403)),C=l(n(2794)),w=function(e){function a(e){var n;return(0,s.default)(this,a),(n=(0,c.default)(this,(0,f.default)(a).call(this,e))).handleDOMClick=function(e){n.dropContentRef&&n.dropContentRef.current&&!n.dropContentRef.current.contains(e.target)&&n.hideContent()},n.showContent=function(){n.setState({visible:!0},(function(){document.addEventListener("click",n.handleDOMClick)}))},n.hideContent=function(){n.setState({visible:!1},(function(){document.removeEventListener("click",n.handleDOMClick)}))},n.handleDetailRedirect=function(e){var t=e.currentTarget.dataset.image;window.open("https://hub.docker.com/_/".concat(t))},n.handleSecretChange=function(e){var t=n.props.formTemplate,a=n.secretsOptions.find((function(t){return t.value===e})).url||"docker.io";a=a.endsWith("/")?a:"".concat(a,"/"),(0,v.default)(t,"pullSecret",e),(0,v.default)(t,'metadata.annotations["kubesphere.io/registryUrl"]',a),n.props.onChange(n.registryUrl)},n.handleInputChange=function(e,t){if(n.registryUrl){var a=n.registryUrl.endsWith("/")?"".concat(n.registryUrl).concat(t):"".concat(n.registryUrl,"/").concat(t);n.props.onChange(a)}else n.props.onChange(t)},n.handleKeyUp=function(e){13===e.keyCode&&n.handleConfirm()},n.handleConfirm=function(){n.imageName&&n.props.onEnter()},n.handleImageSelected=function(){var e=(0,i.default)(u.default.mark((function e(t){var a,l,r,o;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.currentTarget.dataset,l=a.image,r=a.logo,o=a.short_description,n.props.onChange(l),n.hideContent(),n.props.onEnter({logo:r,short_description:o});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleSearch=function(e){n.fetchDockerList(e)},n.fetchDockerList=function(){var e=(0,i.default)(u.default.mark((function e(t){var a;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isLoading:!0}),e.next=3,n.store.getDockerImagesLists({q:t,image_filter:t?void 0:"official",page_size:50,type:"image"}).finally((function(){n.setState({isLoading:!1})}));case 3:a=e.sent,n.setState({dockerList:(0,h.default)(a,"summaries",[])});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.renderContent=function(){return p.default.createElement("div",{className:(0,y.default)(C.default.dropContent,(0,o.default)({},C.default.dropContent_hide,!n.state.visible)),ref:n.dropContentRef},p.default.createElement("div",{className:C.default.header},p.default.createElement(_.default,{className:C.default.search,onSearch:n.handleSearch,placeholder:t("SEARCH_IMAGE_PLACEHOLDER")}),n.state.isLoading&&p.default.createElement(b.default,{className:"float-left",size:28})),n.renderDockerList())},n.state={dockerList:[],visible:!1,isLoading:!1},n.store=e.store,n.dropContentRef=p.default.createRef(),n}return(0,m.default)(a,e),(0,d.default)(a,[{key:"componentDidMount",value:function(){this.fetchDockerList()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleDOMClick)}},{key:"renderDockerList",value:function(){var e=this;return(0,g.default)(this.state.dockerList)?p.default.createElement("ul",{className:C.default.listContent},p.default.createElement("div",{className:(0,y.default)(C.default.selectedContent,C.default.emptyContent)},p.default.createElement(E.default,{name:"docker",className:C.default.icon}),p.default.createElement("p",{className:C.default.desc},t("Not found this image")))):p.default.createElement("ul",{className:C.default.listContent},this.state.dockerList.map((function(t){return p.default.createElement("li",{className:C.default.ImageItem,key:t.name},p.default.createElement("img",{src:(0,h.default)(t,"logo_url.large")||"/assets/no_img.svg",alt:t.name}),p.default.createElement("div",{className:C.default.info},p.default.createElement("p",{onClick:e.handleImageSelected,className:C.default.clickable,"data-image":t.slug,"data-logo":(0,h.default)(t,"logo_url.large",""),"data-short_description":t.short_description},t.name),p.default.createElement("p",null,t.short_description)),p.default.createElement("div",{className:C.default.starContainer},p.default.createElement(E.default,{className:C.default.star,name:"star"}),t.star_count),p.default.createElement("div",{className:C.default.actions},p.default.createElement("span",{className:C.default.clickable,onClick:e.handleDetailRedirect,"data-image":t.slug},p.default.createElement(E.default,{name:"paper",size:16,changeable:!0})),p.default.createElement("span",{className:C.default.clickable,onClick:e.handleImageSelected,"data-image":t.slug,"data-logo":(0,h.default)(t,"logo_url.large",""),"data-short_description":t.short_description},p.default.createElement(E.default,{name:"check",size:16,changeable:!0}))))})))}},{key:"render",value:function(){return p.default.createElement(p.default.Fragment,null,p.default.createElement(k.default,{className:C.default.imageInput,onChange:this.handleInputChange,value:this.imageName,autoComplete:"off",placeholder:this.secretValue?"nginx:latest":t("IMAGE_PLACEHOLDER"),onBlur:this.handleConfirm,onKeyUp:this.handleKeyUp},p.default.createElement(S.default,{value:this.secretValue,className:C.default.secretSelect,options:this.secretsOptions,onChange:this.handleSecretChange,disabled:this.secretsOptions.length<=1})),this.secretValue||!globals.config.enableImageSearch?null:p.default.createElement(E.default,{name:"templet",changeable:!0,className:C.default.dropDownIcon,onClick:this.showContent}),this.renderContent())}},{key:"secretValue",get:function(){var e=this.props.formTemplate;return(0,h.default)(e,"pullSecret","")}},{key:"registryUrl",get:function(){var e=this,t=this.props,a=t.formTemplate,n=t.imageRegistries;if(!(0,g.default)(n)&&this.secretValue){var l=n.find((function(t){return t.value===e.secretValue})),r=(0,h.default)(l,"url","");if(r)return r=r.replace(/^(http(s)?:\/\/)?(.*)$/,"$3")}return(0,h.default)(a,'metadata.annotations["kubesphere.io/registryUrl"]',"")}},{key:"imageName",get:function(){var e=this.props.value;if(e.startsWith(this.registryUrl)){var t=new RegExp("".concat(this.registryUrl,"(/)?"));return e.replace(t,"")}return e}},{key:"secretsOptions",get:function(){var e=this.props.imageRegistries.map((function(e){return{label:"".concat(e.url," (").concat(e.value,")"),value:e.value,url:e.url}}));return[{label:"DockerHub",value:"",url:""}].concat((0,r.default)(e))}}]),a}(p.default.Component);a.default=w,w.defaultProps={imageRegistries:[],className:"",value:"",onChange:function(){}}},3401:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(30)),r=n(a(13)),o=n(a(14)),u=n(a(17)),i=n(a(16)),s=n(a(18)),d=n(a(0)),c=n(a(1)),f=n(a(268)),m=n(a(58)),p=n(a(130)),h=n(a(943)),v=n(a(3)),g=n(a(38)),y=n(a(190)),E=n(a(3402)),b=function(e){function t(e){var a;return(0,r.default)(this,t),(a=(0,u.default)(this,(0,i.default)(t).call(this,e))).triggerChange=(0,f.default)((function(){(0,a.props.onChange)(a.state.value)})),a.handleClick=function(e){a.setState({value:e,showOptions:!1},(function(){a.triggerChange()}))},a.toggleShowOptions=function(){a.setState((function(e){e.showOptions}))},a.handleShowOptions=function(){a.setState({showOptions:!0})},a.handleHideOptions=function(){a.setState({showOptions:!1})},a.state={value:(0,p.default)(e.value)?e.defaultValue:e.value,showOptions:!1},a.optionsRef=d.default.createRef(),a}return(0,s.default)(t,e),(0,o.default)(t,[{key:"renderOption",value:function(e,t){var a=this;return d.default.createElement("div",{key:e.uid||e.value,onClick:function(){return a.handleClick(e.value)},className:(0,v.default)(E.default.option,(0,l.default)({},E.default.selected,t))},e.label)}},{key:"renderOptions",value:function(){var e=this,t=this.props,a=t.options,n=t.disabled,l=this.state.value;if(n||(0,m.default)(a))return null;var r=a.find((function(e){return(0,h.default)(e.value,l)}));return d.default.createElement("div",{className:E.default.options},r&&this.renderOption(r,!0),a.filter((function(e){return!(0,h.default)(e.value,l)})).map((function(t){return e.renderOption(t)})))}},{key:"renderControl",value:function(){var e=this.props,t=e.value,a=e.defaultValue,n=e.placeholder,r=e.options,o=e.disabled,u=t||a,i=r.find((function(e){return(0,h.default)(e.value,u)}))||n||{};return d.default.createElement("div",{className:E.default.control},d.default.createElement("span",{className:E.default.label},i.label),!o&&d.default.createElement(g.default,{className:(0,v.default)(E.default.rightIcon,(0,l.default)({},E.default.rightIcon_toggle,this.state.showOptions)),name:"chevron-down",size:20}))}},{key:"render",value:function(){var e=this.props,t=e.className,a=e.disabled;return d.default.createElement("div",{className:(0,v.default)(E.default.wrapper,(0,l.default)({},E.default.disabled,a),t)},d.default.createElement(y.default,{closeAfterClick:!1,onClick:this.toggleShowOptions,visible:this.state.showOptions,onOpen:this.handleShowOptions,onClose:this.handleHideOptions,content:this.renderOptions()},this.renderControl()))}}]),t}(d.default.Component);t.default=b,b.propTypes={className:c.default.string,value:c.default.any,defaultValue:c.default.any,options:c.default.array.isRequired,onChange:c.default.func},b.defaultProps={className:"",defaultValue:"",options:[],onChange:function(){}}},3402:function(e,t,a){e.exports={wrapper:"Select__wrapper--gn_YE",disabled:"Select__disabled--3bD0q",control:"Select__control--1LWKl",options:"Select__options--fA47m",label:"Select__label--3tohR",rightIcon:"Select__rightIcon--1UMFN",rightIcon_toggle:"Select__rightIcon_toggle--VsP9i",selected:"Select__selected--2TnVG",option:"Select__option--3KEFZ"}},3403:function(e,t,a){"use strict";var n=a(81),l=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(a(70)),o=l(a(30)),u=l(a(63)),i=l(a(13)),s=l(a(14)),d=l(a(17)),c=l(a(16)),f=l(a(18)),m=n(a(0)),p=l(a(1)),h=l(a(3)),v=l(a(132)),g=l(a(269)),y=l(a(963)),E=l(a(3404)),b=function(e){function t(e){var a;return(0,i.default)(this,t),(a=(0,d.default)(this,(0,c.default)(t).call(this,e))).focus=function(){a.node.focus()},a.blur=function(){a.node.blur()},a.handleChange=function(e){var t=e.target.value,n=a.props,l=n.value,r=n.onChange,o=l||t;a.setState({value:o}),r!==y.default&&r(e,t)},a.handleKeyDown=function(e){var t=a.props,n=t.onPressEnter,l=t.onKeyDown;13===e.keyCode&&n&&n(e),l&&l(e)},a.state={value:String(e.value||e.defaultValue),isFocus:!1},a}return(0,f.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.className,n=t.size,l=t.disabled,i=t.children,s=(0,u.default)(t,["className","size","disabled","children"]),d=this.state.value;return m.default.createElement("span",{className:(0,h.default)(E.default.input,a,(0,o.default)({},"is-".concat(n),n))},i,m.default.createElement("input",(0,r.default)({},(0,g.default)(s,"schemas","onKeyDown","onPressEnter","onChange","value","defaultValue","validateStatus","validateHelp","validateIcon","validateOnChange","validateOnBlur"),{disabled:(0,v.default)(l)?l():l,onKeyDown:this.handleKeyDown,onChange:this.handleChange,value:d,ref:function(t){e.node=t},"data-test":"imageSearch"})),m.default.createElement("span",{className:(0,h.default)(E.default.border,"input")}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return"value"in e&&e.value!==t.value?{value:e.value}:null}}]),t}(m.PureComponent);b.propTypes={name:p.default.string,type:p.default.string,className:p.default.string,size:p.default.oneOf(["small","default","large"]),value:p.default.oneOfType([p.default.string,p.default.number]),defaultValue:p.default.oneOfType([p.default.string,p.default.number]),disabled:p.default.oneOfType([p.default.bool,p.default.func]),onChange:p.default.func,onPressEnter:p.default.func,onKeyDown:p.default.func},b.defaultProps={type:"text",size:"default",disabled:!1,onChange:y.default,onPressEnter:y.default,onKeyDown:y.default,defaultValue:""};var _=b;t.default=_},3404:function(e,t,a){e.exports={input:"Input__input--3AG4U",border:"Input__border--162Nh","is-small":"Input__is-small--1Llen",icon:"Input__icon--2N91T","is-default":"Input__is-default--ON32X","is-large":"Input__is-large--3V8yR"}},3405:function(e,t,a){e.exports={message:"ContainerSetting__message--3obsx",imageSearch:"ContainerSetting__imageSearch--1OhvK"}},3406:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(267)),f=l(n(3407)),m=l(n(2796)),p=l(n(2797)),h=l(n(3412)),v=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){return d.default.createElement(c.default.Group,{label:t("Container Security Context"),desc:t("CONTAINER_SECURITY_CTX_DESC"),checkable:!0},d.default.createElement(f.default,null),d.default.createElement(m.default,null),d.default.createElement(p.default,null),d.default.createElement(h.default,null))}}]),a}(d.default.PureComponent);a.default=v},3407:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(267)),f=l(n(2795)),m=l(n(3409)),p=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){return d.default.createElement("div",{className:"margin-b12"},d.default.createElement("div",{className:m.default.title},t("Access Control")),d.default.createElement("div",{className:m.default.content},d.default.createElement(c.default.Item,null,d.default.createElement(f.default,{name:"".concat(this.prefix,".privileged"),title:t("ACCESS_CONTROL_PRIVILEGED"),description:t("ACCESS_CONTROL_PRIVILEGED_DESC")})),d.default.createElement(c.default.Item,null,d.default.createElement(f.default,{name:"".concat(this.prefix,".allowPrivilegeEscalation"),title:t("ACCESS_CONTROL_ALLOWPRIVILEGEESCALATION"),description:t("ACCESS_CONTROL_ALLOWPRIVILEGEESCALATION_DESC")})),d.default.createElement(c.default.Item,null,d.default.createElement(f.default,{name:"".concat(this.prefix,".readOnlyRootFilesystem"),title:t("ACCESS_CONTROL_READONLYROOTFILESYSTEM"),description:t("ACCESS_CONTROL_READONLYROOTFILESYSTEM_DESC")}))))}},{key:"prefix",get:function(){return this.props.prefix||"securityContext"}}]),a}(d.default.Component);a.default=p},3408:function(e,t,a){e.exports={wrapper:"CheckableText__wrapper--15WzU",text:"CheckableText__text--1FbvX"}},3409:function(e,t,a){e.exports={title:"AccessControl__title--xiiGb",content:"AccessControl__content--3MKZe"}},3410:function(e,t,a){e.exports={title:"UserGroup__title--93bRv",content:"UserGroup__content--ALf6y"}},3411:function(e,t,a){e.exports={title:"SELinuxOptions__title--3mzDz",content:"SELinuxOptions__content--2BaVt"}},3412:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(13)),r=n(a(14)),o=n(a(17)),u=n(a(16)),i=n(a(18)),s=n(a(0)),d=n(a(386)),c=n(a(267)),f=n(a(2546)),m=n(a(3413)),p=function(e){function t(){return(0,l.default)(this,t),(0,o.default)(this,(0,u.default)(t).apply(this,arguments))}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){return s.default.createElement("div",{className:"margin-b12"},s.default.createElement("div",{className:m.default.title},"Capabilities (Beta)"),s.default.createElement("div",{className:m.default.content},s.default.createElement(c.default.Item,{label:"Add"},s.default.createElement(f.default,{name:"".concat(this.prefix,".capabilities.add")},s.default.createElement(d.default,null))),s.default.createElement(c.default.Item,{label:"Drop"},s.default.createElement(f.default,{name:"".concat(this.prefix,".capabilities.drop")},s.default.createElement(d.default,null)))))}},{key:"prefix",get:function(){return this.props.prefix||"securityContext"}}]),t}(s.default.Component);t.default=p},3413:function(e,t,a){e.exports={title:"Capabilities__title--K8wgj",content:"Capabilities__content--3X53t"}},3414:function(e,t,a){e.exports={container:"ContainerForm__container--1ZV1z",wrapper:"ContainerForm__wrapper--3NA0X",toggle:"ContainerForm__toggle--3ZJu0",formGroup:"ContainerForm__formGroup--3yEl2",header:"ContainerForm__header--1LL-9",info:"ContainerForm__info--3SRMw",title:"ContainerForm__title--1IrUC",desc:"ContainerForm__desc--20WcR",formArea:"ContainerForm__formArea--INKvI"}},3415:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(70)),r=n(a(97)),o=n(a(13)),u=n(a(14)),i=n(a(17)),s=n(a(16)),d=n(a(18)),c=n(a(0)),f=n(a(2667)),m=function(e){function t(){var e,a;(0,o.default)(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(a=(0,i.default)(this,(e=(0,s.default)(t)).call.apply(e,[this].concat(l)))).handleDelete=function(e){var t=a.props,n=t.value,l=t.onChange,r=t.onDelete;l(n.filter((function(t){return t.name!==e&&"istio-proxy"!==t.name}))),r&&r(e)},a}return(0,d.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e=this.props,t=e.value,a=void 0===t?[]:t,n=a;return"true"===e.isGovernance&&(n=[{name:"istio-proxy",image:"istio/proxyv2:1.0.0"}].concat((0,r.default)(a))),c.default.createElement(f.default,(0,l.default)({},this.props,{readOnlyList:["istio-proxy"],value:n,onDelete:this.handleDelete}))}}]),t}(c.default.Component);t.default=m},3416:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(37)),o=l(n(0)),u=l(n(1)),i=l(n(22)),s=l(n(38)),d=l(n(2535)),c=l(n(2600)),f=n(49),m=l(n(2798)),p=function(e){var a=e.type,n=void 0===a?"worker":a,l=e.container,u=e.onDelete,p=e.onEdit,h=e.readOnly,v=(0,i.default)(l,"resources.limits",{}),g=(0,i.default)(l,"resources.requests",{});if("istio-proxy"===l.name)return o.default.createElement(d.default.Item,{icon:"istio",title:l.name,description:"".concat(t("Image"),": ").concat(l.image)});var y=o.default.createElement("div",{className:m.default.limits},(v.cpu||g.cpu)&&o.default.createElement("span",{className:m.default.limit},o.default.createElement(s.default,{name:"cpu",size:20}),o.default.createElement("span",null,"".concat(g.cpu?(0,f.cpuFormat)(g.cpu):0," ~ ").concat(v.cpu?(0,f.cpuFormat)(v.cpu):"∞"))),(v.memory||g.memory)&&o.default.createElement("span",{className:m.default.limit},o.default.createElement(s.default,{name:"memory",size:20}),"".concat(g.memory?"".concat((0,f.memoryFormat)(g.memory),"Mi"):0," ~ ").concat(v.memory?"".concat((0,f.memoryFormat)(v.memory),"Mi"):"∞"))),E="init"===n?o.default.createElement("span",null,l.name,o.default.createElement(c.default,{className:"margin-l8",type:"warning"},t("Init Container"))):l.name;return o.default.createElement(d.default.Item,{icon:"docker",title:E,description:"".concat(t("Image"),": ").concat(l.image),extras:y,onDelete:!h&&function(){return u(l.name)},onEdit:!h&&function(){return p((0,r.default)({type:n},l))}})};p.propTypes={container:u.default.object};var h=p;a.default=h},3417:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r=n(a(13)),o=n(a(14)),u=n(a(17)),i=n(a(16)),s=n(a(18)),d=n(a(0)),c=n(a(130)),f=a(60),m=a(2564),p=n(a(3439)),h=(0,f.inject)("rootStore")(l=(0,f.observer)(l=function(e){function t(){var e,a;(0,r.default)(this,t);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(a=(0,u.default)(this,(e=(0,i.default)(t)).call.apply(e,[this].concat(l)))).showVolume=function(){a.props.onUpdateState({state:"ShowVolume",selectVolume:{}})},a.showEditVolume=function(e){var t;t=(0,c.default)(e.configMap)&&(0,c.default)(e.secret)?"ShowVolume":"ShowConfig",a.props.onUpdateState({state:t,selectVolume:e})},a.showVolumeTemplate=function(){a.props.onUpdateState({state:"ShowVolumeTemplate"})},a.showEditVolumeTemplate=function(e){a.props.onUpdateState({state:"ShowVolumeTemplate",selectVolume:e})},a.resetState=function(e){a.props.onUpdateState({state:e||""})},a.showConfig=function(){a.props.onUpdateState({state:"ShowConfig",selectVolume:{}})},a}return(0,s.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){var e=null;switch(this.props.state){case"ShowVolume":e=d.default.createElement("div",{className:p.default.wrapper},this.renderVolume());break;case"ShowConfig":e=d.default.createElement("div",{className:p.default.wrapper},this.renderConfig());break;case"ShowVolumeTemplate":e=d.default.createElement("div",{className:p.default.wrapper},this.renderVolumeTemplate());break;default:e=this.renderList()}return e}},{key:"formTemplate",get:function(){return this.props.formData.workload}},{key:"selectVolume",get:function(){return this.props.selectVolume}}]),t}(m.Component))||l)||l;t.default=h},3418:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(63)),o=l(n(37)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(0)),m=l(n(1)),p=l(n(3)),h=l(n(22)),v=l(n(115)),g=l(n(58)),y=l(n(130)),E=n(938),b=l(n(2535)),_=n(974),S=l(n(3419)),k=l(n(2799)),C=function(e){function a(){var e,t;(0,u.default)(this,a);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(t=(0,s.default)(this,(e=(0,d.default)(a)).call.apply(e,[this].concat(l)))).getFormattedVolumes=function(){var e=t.props,a=e.value,n=e.volumes,l=e.containers,r=e.logPath;return(0,g.default)(a)?[]:a.map((function(e){var t={};(0,y.default)(e.persistentVolumeClaim)||(t=n.find((function(t){return t.name===e.persistentVolumeClaim.claimName})));var a=[];return l.forEach((function(t){if(t.volumeMounts){var n=t.volumeMounts.find((function(t){return t.name===e.name}));if(n){var l=(0,h.default)(r,"containerLogConfigs.".concat(t.name,".").concat(e.name),[]).join(",");a.push((0,o.default)({},n,{logPath:l,containerName:t.name}))}}})),(0,o.default)({},e,{volume:t,volumeMounts:a})}))},t.deleteVolumeMounts=function(e){var a=t.context.formData,n="".concat(t.props.prefix,"spec.containers"),l=(0,h.default)(a,n,[]);l.forEach((function(t){(0,g.default)(t.volumeMounts)||(t.volumeMounts=t.volumeMounts.filter((function(t){return t.name!==e})))})),(0,v.default)(a,n,l)},t.handleAddVolume=function(){t.props.onShowVolume()},t.handleAddConfig=function(){t.props.onShowConfig()},t.handleEdit=function(e){var a=e.volume,n=e.volumeMounts,l=(0,r.default)(e,["volume","volumeMounts"]);(0,_.isNotPersistentVolume)(e)?t.props.onShowEdit((0,o.default)({},l,{volumeMounts:n})):t.props.onShowEdit({volume:a,volumeMounts:n,specVolume:(0,o.default)({},l)})},t.handleDelete=function(e){var a=t.props,n=a.value,l=a.onChange;t.deleteVolumeMounts(e),l(n.filter((function(t){return t.name!==e})))},t}return(0,c.default)(a,e),(0,i.default)(a,[{key:"renderAddVolume",value:function(){return f.default.createElement(E.Columns,null,f.default.createElement(E.Column,null,f.default.createElement(b.default.Add,{onClick:this.handleAddVolume,title:t("Add Volume"),description:t("Support EmptyDir and PersistentVolumeClaim")})),f.default.createElement(E.Column,null,f.default.createElement(b.default.Add,{onClick:this.handleAddConfig,title:t("Mount ConfigMap or Secret"),description:t("Mount the configmap or secret to the specified directory")})))}},{key:"render",value:function(){var e=this,t=this.props.className,a=this.getFormattedVolumes();return f.default.createElement("div",{className:(0,p.default)(k.default.wrapper,t)},f.default.createElement("div",{className:k.default.content},!(0,g.default)(a)&&f.default.createElement("ul",{className:k.default.list},a.map((function(t){return f.default.createElement(S.default,{volume:t,key:t.name,onEdit:e.handleEdit,onDelete:e.handleDelete})}))),this.renderAddVolume()))}}]),a}(f.default.Component);a.default=C,C.propTypes={prefix:m.default.string,name:m.default.string,value:m.default.array,volumes:m.default.array,volumeTypes:m.default.array,containers:m.default.array,onChange:m.default.func,onShowVolume:m.default.func,onShowConfig:m.default.func,onShowEdit:m.default.func},C.defaultProps={prefix:"",name:"",value:[],volumes:[],volumeTypes:[],containers:[],onChange:function(){},onShowVolume:function(){},onShowConfig:function(){},onShowEdit:function(){}},C.contextTypes={formData:m.default.object}},3419:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(70)),o=l(n(22)),u=l(n(58)),i=l(n(0)),s=l(n(1)),d=l(n(38)),c=l(n(2535)),f=l(n(2799)),m=function(e){var a=e.volume,n=e.onDelete,l=e.onEdit,s={};n&&(s.onDelete=function(){return n(a.name)}),l&&(s.onEdit=function(){return l(a)});var m,p,h="storage";a.hostPath?(m="".concat(t("Type"),": ").concat(t("HostPath")),p=[{title:(0,o.default)(a,"hostPath.path","-"),description:t("Host Path")}]):a.emptyDir?(m="".concat(t("Type"),": ").concat(t("EmptyDir")),p=[]):a.configMap?(h="hammer",m="".concat(t("Type"),": ").concat(t("ConfigMap")),p=[{title:(0,o.default)(a,"configMap.name","-"),description:t("ConfigMap")}]):a.secret?(h="key",m="".concat(t("Type"),": ").concat(t("Secret")),p=[{title:(0,o.default)(a,"secret.secretName","-"),description:t("Secret")}]):(m="".concat(t("Storage Classs"),": ").concat((0,o.default)(a,"volume.storageClassName","-")),p=[{title:(0,o.default)(a,"volume.capacity","-"),description:t("Capacity")},{title:(0,o.default)(a,"volume.accessMode","-"),description:t("Access Mode")}]);var v=!(0,u.default)(a.volumeMounts)&&i.default.createElement("div",{className:f.default.mount},i.default.createElement("ul",null,a.volumeMounts.map((function(e){var a=e.containerName,n=e.mountPath,l=e.subPath,r=e.logPath,o=e.readOnly;return i.default.createElement("li",{key:n},i.default.createElement("div",null,i.default.createElement(d.default,{name:"docker",size:20}),i.default.createElement("span",null,a)),i.default.createElement("div",null,i.default.createElement(d.default,{name:"mgmt-node",size:20}),i.default.createElement("span",null,n),i.default.createElement("span",{className:"text-secondary"}," (",o?t("ReadOnly"):t("ReadAndWrite"),")")),l&&i.default.createElement("div",null,i.default.createElement(d.default,{name:"textfield",size:20})," ",i.default.createElement("span",null,l)),r&&i.default.createElement("div",null,i.default.createElement(d.default,{name:"log",size:20})," ",i.default.createElement("span",null,r)))}))));return i.default.createElement(c.default.Item,(0,r.default)({icon:h,title:a.name,description:m,extras:v,details:p},s))};m.propTypes={container:s.default.object};var p=m;a.default=p},3420:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(37)),o=l(n(63)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(0)),m=l(n(1)),p=l(n(3)),h=l(n(58)),v=l(n(2454)),g=l(n(2455)),y=n(945),E=l(n(270)),b=l(n(3421)),_=l(n(3425)),S=l(n(3427)),k=l(n(3429)),C=function(e){function a(e){var t;return(0,u.default)(this,a),(t=(0,s.default)(this,(0,d.default)(a).call(this,e))).handleGoBack=function(){var e=t.context.resetSubRoute;e&&e(),t.props.onCancel()},t.handleSubmit=function(e){var a=t.props.onSave,n=t.state.type,l=t.formRef.current;l&&l.validate((function(){var t,u=l.getData();if("exist"===n)t=u.volume;else if("temp"===n)t={name:u.name,emptyDir:{}};else if("host"===n){u.volumeMounts;var i=(0,o.default)(u,["volumeMounts"]);t=i}else if("new"===n){u.volumeMounts;var s=(0,o.default)(u,["volumeMounts"]);t=E.default.volumes(s)}var d=[];u.volumeMounts&&(d=u.volumeMounts.map((function(e){return(0,r.default)({},e,{volume:t})}))),a(t,d),e&&e()}))},t.handleTypeChange=function(e){t.setState({type:e})},t.formRef=f.default.createRef(),t.state={type:t.checkVolumeType(e.volume)||"exist"},t}return(0,c.default)(a,e),(0,i.default)(a,[{key:"componentDidMount",value:function(){var e=this.props.onCancel,t=this.context.registerSubRoute;t&&t(this.handleSubmit,e)}},{key:"checkVolumeType",value:function(e){var t="exist";return(0,h.default)(e)?t:(e.emptyDir?t="temp":e.hostPath&&(t="host"),t)}},{key:"renderContent",value:function(){var e,t=this.props,a=t.volume,n=t.volumes,l=t.containers,r=t.checkVolumeNameExist,o=t.collectSavedLog,u=a.name;switch(this.state.type){case"temp":e=f.default.createElement(_.default,{formRef:this.formRef,formData:a,currentName:u,containers:l,checkVolumeNameExist:r,collectSavedLog:o});break;case"host":e=f.default.createElement(S.default,{formRef:this.formRef,formData:a,currentName:u,containers:l,checkVolumeNameExist:r});break;default:case"exist":e=f.default.createElement(b.default,{formRef:this.formRef,formData:a,currentName:u,volumes:n,containers:l,collectSavedLog:o})}return e}},{key:"render",value:function(){var e=this.props,a=e.className,n=e.module,l=e.contentClassName;return f.default.createElement("div",{className:(0,p.default)(k.default.wrapper,a)},f.default.createElement("div",{className:"h6"},f.default.createElement("a",{className:"custom-icon",onClick:this.handleGoBack},f.default.createElement(y.ReactComponent,null)),t("Volumes")),f.default.createElement("div",{className:(0,p.default)(k.default.contentWrapper,l)},f.default.createElement("div",{className:k.default.title},t("Volume Source")),f.default.createElement(v.default,{wrapClassName:"radio-default",value:this.state.type,onChange:this.handleTypeChange,size:"small"},f.default.createElement(g.default,{value:"exist"},t("Exist Volumes")),f.default.createElement(g.default,{value:"temp"},t("Temporary Volume")),"daemonsets"===n&&f.default.createElement(g.default,{value:"host"},t("HostPath"))),this.renderContent()))}}]),a}(f.default.Component);a.default=C,C.propTypes={className:m.default.string,containers:m.default.array,volume:m.default.object,onSave:m.default.func,onCancel:m.default.func},C.defaultProps={className:"",volume:{},containers:[],onSave:function(){},onCancel:function(){}},C.contextTypes={registerSubRoute:m.default.func,resetSubRoute:m.default.func}},3421:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(950)),c=l(n(58)),f=l(n(0)),m=l(n(3)),p=l(n(1)),h=l(n(972)),v=l(n(267)),g=l(n(952)),y=l(n(2609)),E=n(49),b=l(n(3424)),_=function(e){function a(){var e,n;(0,r.default)(this,a);for(var l=arguments.length,o=new Array(l),s=0;s<l;s++)o[s]=arguments[s];return(n=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(o)))).mountValidator=function(e,a,l){if((0,c.default)(a))return l();a.forEach((function(a){if(!a)return l();if("null"===a.readOnly)l();else if(a.mountPath){if(n.getMountPaths(a).includes(a.mountPath))return l({message:t("Mount path is already in use"),field:e.field});l()}else l({message:t("Please specify the read and write mode and mount path"),field:e.field})}))},n}return(0,s.default)(a,e),(0,o.default)(a,[{key:"getMountPaths",value:function(e){return this.mountPaths||(this.mountPaths=(0,d.default)(this.props.containers,"name")),(0,c.default)(this.mountPaths[e.containerName])||(0,c.default)(this.mountPaths[e.containerName].volumeMounts)?[]:this.mountPaths[e.containerName].volumeMounts.filter((function(t){return t.name!==e.name})).map((function(e){return e.mountPath}))}},{key:"render",value:function(){var e=this.props,a=e.containers,n=e.formRef,l=e.formData,r=e.className,o=e.collectSavedLog,u={icon:"storage",label:t("Choose an exist volume"),description:t("CHOOSE_EXIST_VOLUME_DESC")};return f.default.createElement("div",{className:(0,m.default)(b.default.wrapper,r)},f.default.createElement(v.default,{data:l,ref:n},f.default.createElement(v.default.Item,{rules:[{required:!0,message:t("Please select a volume")}]},f.default.createElement(g.default,{name:"volume",options:this.volumes,placeholder:u})),f.default.createElement(v.default.Item,{rules:[{validator:this.mountValidator}]},f.default.createElement(y.default,{name:"volumeMounts",containers:a,collectSavedLog:o}))))}},{key:"volumes",get:function(){return this.props.volumes.map((function(e){return{uid:e.name,icon:"storage",label:f.default.createElement("span",null,(0,E.getDisplayName)(e)," ",f.default.createElement(h.default,null,e.inUse?t("In Use"):t("Idle"))),description:"".concat(t("Storage Class"),": ").concat(e.storageClassName),value:e,details:[{label:e.capacity,description:t("Capacity")},{label:e.accessMode,description:t("Access Mode")}]}}))}}]),a}(f.default.Component);a.default=_,_.propTypes={formRef:p.default.object,formData:p.default.object,className:p.default.string,containers:p.default.array,volumes:p.default.array},_.defaultProps={className:"",volumes:[],formData:{},containers:[]}},3422:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(37)),o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=l(n(1)),m=l(n(38)),p=l(n(225)),h=l(n(386)),v=l(n(227)),g=n(938),y=l(n(971)),E=l(n(224)),b=l(n(3423)),_=[{label:"ReadAndWrite",value:"false"},{label:"ReadOnly",value:"true"},{label:"Not Mount",value:"null"}],S=function(e){function a(){var e,t;(0,o.default)(this,a);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(t=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(l)))).state={visible:!1,subPath:t.props.value.subPath},t.handleSelectChange=function(e){var a=t.props,n=a.value,l=a.container;(0,a.onChange)((0,r.default)({},n,{readOnly:e,containerName:l,mountPath:"null"===e?"":n.mountPath}))},t.handleMountPathChange=function(e){var a=t.props,n=a.value,l=a.container;(0,a.onChange)((0,r.default)({},n,{mountPath:e.target.value,containerName:l}))},t.handleSubPathChange=function(e){t.setState({subPath:e.target.value})},t.handleSubPathSave=function(){var e=t.props,a=e.value,n=e.container,l=e.onChange,o=t.state.subPath;l((0,r.default)({},a,{subPath:o,containerName:n})),t.setState({visible:!1})},t.handleLogPathChange=function(e){var a=t.props,n=a.value,l=a.container;(0,a.onChange)((0,r.default)({},n,{logPath:e.target.value,containerName:l}))},t.showSubPathForm=function(){t.setState({visible:!0})},t.hideSubPathForm=function(){t.setState({subPath:t.props.value.subPath,visible:!1})},t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.value.subPath!==this.state.subPath&&this.setState({subPath:e.value.subPath})}},{key:"getMountOptions",value:function(){return _.map((function(e){return{label:t(e.label),value:e.value}}))}},{key:"renderLogPathTip",value:function(){return c.default.createElement("div",null,c.default.createElement("div",{className:"tooltip-title"},t("container log relative path")),c.default.createElement("p",null,t.html("CONTAINER_LOG_PATH_TIP")))}},{key:"renderSubPathForm",value:function(){return c.default.createElement("div",{className:b.default.subForm},c.default.createElement("div",{className:b.default.formTitle},c.default.createElement("div",null,t("Click to add subPath")),c.default.createElement("p",null,t.html("ADD_SUBPATH_TIP"))),c.default.createElement("div",{className:b.default.formContent},c.default.createElement("div",{className:b.default.subPath},c.default.createElement(g.Control,{className:"has-icons-left has-icons-right"},c.default.createElement(m.default,{className:"is-left",name:"textfield",size:20}),c.default.createElement(h.default,{name:"subPath",defaultValue:this.state.subPath,placeholder:t("sub path"),onChange:this.handleSubPathChange})))),c.default.createElement("div",{className:b.default.formFooter},c.default.createElement(E.default,{onClick:this.hideSubPathForm},t("Cancel")),c.default.createElement(E.default,{type:"control",onClick:this.handleSubPathSave},t("OK"))))}},{key:"renderSubPathTip",value:function(){return c.default.createElement("div",null,c.default.createElement("div",{className:"tooltip-title"},t("Click to add subPath")),c.default.createElement("p",null,t.html("ADD_SUBPATH_TIP")))}},{key:"renderSubPath",value:function(){var e=this.props.value,t=this.state.visible;return e&&e.mountPath?t?c.default.createElement(y.default,{className:b.default.popper,trigger:"click",visible:t,placement:"bottom",closeAfterClick:!1,content:this.renderSubPathForm(),onClose:this.hideSubPathForm},e.subPath?c.default.createElement("div",{className:b.default.subPathText},e.subPath):c.default.createElement(m.default,{className:"is-right",name:"textfield",size:20,clickable:!0})):c.default.createElement(v.default,{content:this.renderSubPathTip()},e.subPath?c.default.createElement("div",{className:b.default.subPathText,onClick:this.showSubPathForm},e.subPath):c.default.createElement(m.default,{className:"is-right",name:"textfield",size:20,clickable:!0,onClick:this.showSubPathForm})):null}},{key:"render",value:function(){var e=this.props,a=e.value,n=e.container,l=e.collectSavedLog;return c.default.createElement("div",{className:b.default.wrapper},c.default.createElement("div",{className:b.default.title},c.default.createElement(m.default,{name:"docker",size:20}),n),c.default.createElement(p.default,{name:"readOnly",className:b.default.readOnly,value:a.readOnly,options:this.getMountOptions(),onChange:this.handleSelectChange}),c.default.createElement(g.Control,{className:"has-icons-left has-icons-right ".concat(b.default.mountPath)},c.default.createElement(m.default,{className:"is-left",name:"mgmt-node",size:20}),c.default.createElement(h.default,{name:"mountPath",defaultValue:a.mountPath,disabled:"null"===a.readOnly,placeholder:"".concat(t("container mount path"),", ").concat(t("for example"),": /data"),onChange:this.handleMountPathChange}),this.renderSubPath()),"true"===l&&"false"===a.readOnly&&c.default.createElement(c.default.Fragment,null,c.default.createElement(g.Control,{className:"has-icons-left has-icons-right ".concat(b.default.logPath)},c.default.createElement(m.default,{className:"is-left",name:"log",size:20}),c.default.createElement(h.default,{name:"logPath",defaultValue:a.logPath,disabled:"null"===a.readOnly,placeholder:t("container log relative path"),onChange:this.handleLogPathChange})),c.default.createElement(v.default,{content:this.renderLogPathTip()},c.default.createElement(m.default,{className:b.default.icon,name:"question",size:20}))))}}]),a}(c.default.Component);a.default=S,S.propTypes={name:f.default.string,container:f.default.string,value:f.default.object,onChange:f.default.func},S.defaultProps={name:"",value:{},onChange:function(){}}},3423:function(e,t,a){e.exports={wrapper:"MountInput__wrapper--2U-7r",title:"MountInput__title--siYMd",readOnly:"MountInput__readOnly--k-ti4",mountPath:"MountInput__mountPath--23Vv3",logPath:"MountInput__logPath--xsesz",icon:"MountInput__icon--1b9AM",popper:"MountInput__popper--fprqT",subForm:"MountInput__subForm--PtGbJ",formTitle:"MountInput__formTitle--34f0O",subPath:"MountInput__subPath--I-usc",subPathText:"MountInput__subPathText--3wUAF",formFooter:"MountInput__formFooter--2XuHt"}},3424:function(e,t,a){e.exports={wrapper:"AddExistVolumes__wrapper--qrgln"}},3425:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(950)),c=l(n(58)),f=l(n(0)),m=l(n(3)),p=l(n(1)),h=l(n(386)),v=n(114),g=l(n(267)),y=l(n(2609)),E=l(n(3426)),b=function(e){function a(){var e,n;(0,r.default)(this,a);for(var l=arguments.length,o=new Array(l),s=0;s<l;s++)o[s]=arguments[s];return(n=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(o)))).mountValidator=function(e,a,l){if((0,c.default)(a))return l({message:t("Please select at least one container to mount"),field:e.field});a.forEach((function(a){if(!a)return l();if("null"===a.readOnly)l();else if(a.mountPath){var r=n.getMountPaths(a);if(a.subPath){if(r.some((function(e){return e.mountPath===a.mountPath&&e.subPath===a.subPath})))return l({message:t("Mount path is already in use"),field:e.field})}else if(r.some((function(e){return e.mountPath===a.mountPath})))return l({message:t("Mount path is already in use"),field:e.field});l()}else l({message:t("Please specify the read and write mode and mount path"),field:e.field})}))},n.nameValidator=function(e,a,l){if(!a)return l();var r=n.props,o=r.currentName;(0,r.checkVolumeNameExist)(a)&&o!==a?l({message:t("volume name exist"),field:e.field}):l()},n}return(0,s.default)(a,e),(0,o.default)(a,[{key:"getMountPaths",value:function(e){return this.mountPaths||(this.mountPaths=(0,d.default)(this.props.containers,"name")),(0,c.default)(this.mountPaths[e.containerName])||(0,c.default)(this.mountPaths[e.containerName].volumeMounts)?[]:this.mountPaths[e.containerName].volumeMounts.filter((function(t){return t.name!==e.name}))}},{key:"render",value:function(){var e=this.props,a=e.containers,n=e.formData,l=e.formRef,r=e.className,o=e.collectSavedLog;return f.default.createElement("div",{className:(0,m.default)(E.default.wrapper,r)},f.default.createElement(g.default,{data:n,ref:l},f.default.createElement(g.default.Item,{label:t("Volume Name"),desc:t("NAME_DESC"),rules:[{required:!0,message:t("Please input volume name")},{pattern:v.PATTERN_NAME,message:"".concat(t("Invalid name"),", ").concat(t("NAME_DESC"))},{validator:this.nameValidator}]},f.default.createElement(h.default,{name:"name",autoFocus:!0})),f.default.createElement(g.default.Item,{rules:[{required:t("Please input mount path"),validator:this.mountValidator}]},f.default.createElement(y.default,{name:"volumeMounts",containers:a,collectSavedLog:o}))))}}]),a}(f.default.Component);a.default=b,b.propTypes={formRef:p.default.object,formData:p.default.object,className:p.default.string,containers:p.default.array,checkVolumeNameExist:p.default.func},b.defaultProps={className:"",formData:{},containers:[]}},3426:function(e,t,a){e.exports={wrapper:"AddTemporary__wrapper--tsyns",alert:"AddTemporary__alert--183z7"}},3427:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(950)),c=l(n(58)),f=l(n(0)),m=l(n(1)),p=l(n(386)),h=n(114),v=l(n(267)),g=l(n(2609)),y=l(n(3428)),E=function(e){function a(){var e,n;(0,r.default)(this,a);for(var l=arguments.length,o=new Array(l),s=0;s<l;s++)o[s]=arguments[s];return(n=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(o)))).mountValidator=function(e,a,l){if((0,c.default)(a))return l();a.forEach((function(a){if(!a)return l();if("null"===a.readOnly)l();else if(a.mountPath){if(n.getMountPaths(a).includes(a.mountPath))return l({message:t("Mount path is already in use"),field:e.field});l()}else l({message:t(""),field:e.field})}))},n.nameValidator=function(e,a,l){if(!a)return l();var r=n.props,o=r.currentName;(0,r.checkVolumeNameExist)(a)&&o!==a?l({message:t("volume name exist"),field:e.field}):l()},n}return(0,s.default)(a,e),(0,o.default)(a,[{key:"getMountPaths",value:function(e){return this.mountPaths||(this.mountPaths=(0,d.default)(this.props.containers,"name")),(0,c.default)(this.mountPaths[e.containerName])||(0,c.default)(this.mountPaths[e.containerName].volumeMounts)?[]:this.mountPaths[e.containerName].volumeMounts.filter((function(t){return t.name!==e.name})).map((function(e){return e.mountPath}))}},{key:"render",value:function(){var e=this.props,a=e.containers,n=e.formData,l=e.formRef,r=e.collectSavedLog;return f.default.createElement("div",{className:y.default.wrapper},f.default.createElement(v.default,{data:n,ref:l},f.default.createElement(v.default.Item,{label:t("Volume Name"),desc:t("NAME_DESC"),rules:[{required:!0,message:t("Please input volume name")},{pattern:h.PATTERN_NAME,message:"".concat(t("Invalid name"),", ").concat(t("NAME_DESC"))},{validator:this.nameValidator}]},f.default.createElement(p.default,{name:"name",autoFocus:!0})),f.default.createElement(v.default.Item,{label:t("HostPath")},f.default.createElement(p.default,{name:"hostPath.path"})),f.default.createElement(v.default.Item,{rules:[{validator:this.mountValidator}]},f.default.createElement(g.default,{name:"volumeMounts",containers:a,collectSavedLog:r}))))}}]),a}(f.default.Component);a.default=E,E.propTypes={formRef:m.default.object,formData:m.default.object,containers:m.default.array,checkVolumeNameExist:m.default.func},E.defaultProps={formData:{},containers:[]}},3428:function(e,t,a){e.exports={wrapper:"AddHostPath__wrapper--31vvl"}},3429:function(e,t,a){e.exports={wrapper:"AddVolume__wrapper--2nvRV",contentWrapper:"AddVolume__contentWrapper--1OWIG",title:"AddVolume__title--u7mUn"}},3430:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(82)),o=l(n(37)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(22)),m=l(n(950)),p=l(n(58)),h=l(n(0)),v=l(n(1)),g=l(n(386)),y=l(n(225)),E=l(n(2454)),b=l(n(2455)),_=l(n(952)),S=l(n(267)),k=l(n(2546)),C=l(n(2545)),w=l(n(2609)),N=n(945),T=n(49),P=l(n(2559)),M=l(n(2537)),R=l(n(3431)),D=function(e){function a(e){var n;if((0,u.default)(this,a),(n=(0,s.default)(this,(0,d.default)(a).call(this,e))).handleGoBack=function(){var e=n.context.resetSubRoute;e&&e(),n.props.onCancel()},n.handleSelectChange=function(e){var t=n.state,a=t.configMaps,l=t.secrets,r=a.find((function(t){return t.name===e})),o=l.find((function(t){return t.name===e})),u=r||o||{};n.setState({resource:u})},n.handleTypeChange=function(e){n.setState({type:e})},n.handleSubmit=function(e){var t=n.props.onSave,a=n.state.resource,l=n.formRef.current;l&&l.validate((function(){var r=l.getData(),u=r.volumeMounts,i=r.name,s=r.items,d={name:(0,f.default)(n.props,"volume.name","volume-".concat((0,T.generateId)()))};a.type?d.secret={secretName:i,items:s}:d.configMap={name:i,items:s};var c=[];u&&(c=u.map((function(e){return(0,o.default)({},e,{volume:d})}))),t(d,c),e&&e()}))},n.mountValidator=function(e,a,l){if((0,p.default)(a))return l();a.forEach((function(a){if(!a)return l();if("null"===a.readOnly)l();else if(a.mountPath){if(n.getMountPaths(a).includes(a.mountPath))return l({message:t("Mount path is already in use"),field:e.field});l()}else l({message:t("Please specify the read and write mode and mount path"),field:e.field})}))},n.formRef=h.default.createRef(),(0,p.default)(e.volume))n.state={formData:{},configMaps:[],secrets:[],resource:{},type:"configmap"};else{var l=e.volume.configMap||e.volume.secret||{};n.state={formData:{name:l.name||l.secretName,items:l.items,volumeMounts:e.volume.volumeMounts},configMaps:[],secrets:[],resource:{},type:e.volume.configMap?"configmap":"secret"}}return n.configMapStore=new P.default,n.secretStore=new M.default,n}return(0,c.default)(a,e),(0,i.default)(a,[{key:"componentDidMount",value:function(){var e=this.props.onCancel,t=this.context.registerSubRoute;t&&t(this.handleSubmit,e),this.fetchData()}},{key:"fetchData",value:function(){var e=this,t=this.props.namespace;Promise.all([this.configMapStore.fetchByK8s({namespace:t}),this.secretStore.fetchByK8s({namespace:t})]).then((function(t){var a=(0,r.default)(t,2),n=a[0],l=a[1];e.setState({configMaps:n,secrets:l},(function(){e.state.formData.name&&e.handleSelectChange(e.state.formData.name)}))}))}},{key:"getMountPaths",value:function(e){return this.mountPaths||(this.mountPaths=(0,m.default)(this.props.containers,"name")),(0,p.default)(this.mountPaths[e.containerName])||(0,p.default)(this.mountPaths[e.containerName].volumeMounts)?[]:this.mountPaths[e.containerName].volumeMounts.filter((function(t){return t.name!==e.name})).map((function(e){return e.mountPath}))}},{key:"getResourceOptions",value:function(){var e=this.state,a=e.type,n=e.configMaps,l=e.secrets;return"configmap"!==a||(0,p.default)(n)?"secret"!==a||(0,p.default)(l)?[]:l.map((function(e){return{label:(0,T.getDisplayName)(e),description:t("Secret"),value:e.name,icon:"key"}})):n.map((function(e){return{label:(0,T.getDisplayName)(e),description:t("ConfigMap"),value:e.name,icon:"hammer"}}))}},{key:"getKeysOptions",value:function(){var e=this.state.resource;return Object.keys(e.data||{}).map((function(e){return{label:e,value:e}}))}},{key:"renderContent",value:function(){var e=this.props,a=e.containers,n=e.collectSavedLog,l=this.state,r=l.type,o=l.formData,u=this.getResourceOptions(),i={label:(0,p.default)(u)?t("No Available Resource"):t("Please select a ".concat(r)),description:t("REFFER_".concat(r.toUpperCase(),"_DESC"))};return h.default.createElement(S.default,{data:o,ref:this.formRef},h.default.createElement("div",{className:R.default.card},h.default.createElement(S.default.Item,null,h.default.createElement(_.default,{name:"name",options:u,placeholder:i,onChange:this.handleSelectChange})),h.default.createElement(S.default.Item,{rules:[{validator:this.mountValidator}]},h.default.createElement(w.default,{name:"volumeMounts",containers:a,collectSavedLog:n}))),h.default.createElement(S.default.Group,{label:t("Select specific keys and paths"),desc:t("SELECT_SECRET_DESC"),checkable:!0,keepDataWhenUncheck:!0},h.default.createElement(S.default.Item,null,h.default.createElement(k.default,{name:"items",itemType:"object",addText:t("Add")},h.default.createElement(C.default,null,h.default.createElement(y.default,{name:"key",placeholder:t("Select Key"),options:this.getKeysOptions()}),h.default.createElement(g.default,{name:"path",placeholder:t("Mount Path")}))))))}},{key:"render",value:function(){var e=this.state.type;return h.default.createElement("div",{className:R.default.wrapper},h.default.createElement("div",{className:"h6"},h.default.createElement("a",{className:"custom-icon",onClick:this.handleGoBack},h.default.createElement(N.ReactComponent,null)),t("ConfigMap & Secret")),h.default.createElement("div",{className:R.default.contentWrapper},h.default.createElement("div",{className:R.default.title},t("Type")),h.default.createElement(E.default,{wrapClassName:"radio-default",value:e,onChange:this.handleTypeChange,size:"small"},h.default.createElement(b.default,{value:"configmap"},t("ConfigMap")),h.default.createElement(b.default,{value:"secret"},t("Secret"))),this.renderContent()))}}]),a}(h.default.Component);a.default=D,D.propTypes={containers:v.default.array,volume:v.default.object,namespace:v.default.string,onSave:v.default.func,onCancel:v.default.func},D.defaultProps={volume:{},containers:[],onSave:function(){},onCancel:function(){}},D.contextTypes={registerSubRoute:v.default.func,resetSubRoute:v.default.func}},3431:function(e,t,a){e.exports={wrapper:"MountConfig__wrapper--3pnsB",contentWrapper:"MountConfig__contentWrapper--1wqGC",title:"MountConfig__title--3oPV7",card:"MountConfig__card--2ShsD"}},3432:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(37)),o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=l(n(1)),m=l(n(3)),p=l(n(22)),h=l(n(58)),v=l(n(2535)),g=l(n(3433)),y=l(n(2800)),E=function(e){function a(){var e,t;(0,o.default)(this,a);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(t=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(l)))).getFormattedVolumes=function(){var e=t.props,a=e.value,n=e.containers;return(0,h.default)(a)||(0,h.default)(n)?[]:a.map((function(e){var t=[];return n.forEach((function(a){if(a.volumeMounts){var n=a.volumeMounts.find((function(t){return t.name===e.metadata.name}));n&&t.push((0,r.default)({},n,{containerName:a.name}))}})),(0,r.default)({},e,{volumeMounts:t})}))},t.deleteVolumeMounts=function(e){var a=t.context.formData,n=(0,p.default)(a,"".concat(t.props.prefix,"spec.containers"),[]);n.forEach((function(t){(0,h.default)(t.volumeMounts)||(t.volumeMounts=t.volumeMounts.filter((function(t){return t.name!==e})))})),(0,p.default)(a,"".concat(t.props.prefix,"spec.containers"),n)},t.handleAddVolume=function(){t.props.onShowAddVolume()},t.handleEdit=function(e){t.props.onShowEdit(e)},t.handleDelete=function(e){var a=t.props,n=a.value,l=a.onChange;t.deleteVolumeMounts(e),l(n.filter((function(t){return t.metadata.name!==e})))},t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"renderAddVolume",value:function(){return c.default.createElement(v.default.Add,{onClick:this.handleAddVolume,title:t("Add Volume Template"),description:t("ADD_VOLUME_TEMPLATE_DESC")})}},{key:"render",value:function(){var e=this,t=this.props.className,a=this.getFormattedVolumes();return c.default.createElement("div",{className:(0,m.default)(y.default.wrapper,t)},c.default.createElement("div",{className:y.default.content},!(0,h.default)(a)&&c.default.createElement("ul",{className:y.default.list},a.map((function(t){return c.default.createElement(g.default,{volume:t,key:(0,p.default)(t,"metadata.name"),onEdit:e.handleEdit,onDelete:e.handleDelete})}))),this.renderAddVolume()))}}]),a}(c.default.Component);a.default=E,E.propTypes={prefix:f.default.string,name:f.default.string,value:f.default.array,containers:f.default.array,onChange:f.default.func,onShowAddVolume:f.default.func,onShowEdit:f.default.func},E.defaultProps={prefix:"",name:"",value:[],containers:[],onChange:function(){},onShowAddVolume:function(){},onShowEdit:function(){}},E.contextTypes={formData:f.default.object}},3433:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(22)),o=l(n(0)),u=l(n(1)),i=l(n(38)),s=l(n(2535)),d=l(n(2800)),c=function(e){var a=e.volume,n=e.onDelete,l=e.onEdit,u=[{title:(0,r.default)(a,"spec.resources.requests.storage","-"),description:t("Capacity")},{title:(0,r.default)(a,"spec.accessModes[0]","-"),description:t("Access Mode")}],c=o.default.createElement("div",{className:d.default.mount},o.default.createElement("ul",null,a.volumeMounts&&a.volumeMounts.map((function(e){var a=e.containerName,n=e.mountPath,l=e.subPath,r=e.readOnly;return o.default.createElement("li",{key:n},o.default.createElement("div",null,o.default.createElement(i.default,{name:"docker",size:20}),o.default.createElement("span",null,a)),o.default.createElement("div",null,o.default.createElement(i.default,{name:"mgmt-node",size:20})," ",o.default.createElement("span",null,n),o.default.createElement("span",{className:"text-secondary"}," (",r?t("ReadOnly"):t("ReadAndWrite"),")")),l&&o.default.createElement("div",null,o.default.createElement(i.default,{name:"textfield",size:20})," ",o.default.createElement("span",null,l)))}))));return o.default.createElement(s.default.Item,{icon:"storage",title:(0,r.default)(a,"metadata.name","-"),description:"".concat(t("Storage Classs"),": ").concat((0,r.default)(a,"spec.storageClassName","-")),extras:c,details:u,onDelete:function(){return n(a.metadata.name)},onEdit:function(){return l(a)}})};c.propTypes={container:u.default.object};var f=c;a.default=f},3434:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o,u,i=l(n(37)),s=l(n(63)),d=l(n(13)),c=l(n(14)),f=l(n(17)),m=l(n(16)),p=l(n(18)),h=l(n(950)),v=l(n(58)),g=l(n(0)),y=l(n(1)),E=l(n(3)),b=n(60),_=l(n(386)),S=l(n(267)),k=l(n(2609)),C=n(114),w=n(945),N=l(n(2801)),T=l(n(2570)),P=l(n(3437)),M=(0,b.observer)((u=o=function(e){function a(e){var n;return(0,d.default)(this,a),(n=(0,f.default)(this,(0,m.default)(a).call(this,e))).handleGoBack=function(){var e=n.context.resetSubRoute;e&&e(),n.props.onCancel()},n.handleSubmit=function(e){var t=n.props.onSave,a=n.formRef.current;a&&a.validate((function(){var n=a.getData(),l=n.volumeMounts,r=void 0===l?[]:l,o=(0,s.default)(n,["volumeMounts"]);t(o,r.map((function(e){return(0,i.default)({},e,{name:o.metadata.name})}))),e&&e()}))},n.mountValidator=function(e,a,l){if((0,v.default)(a))return l();a.forEach((function(a){if(!a)return l();if("null"===a.readOnly)l();else if(a.mountPath){if(n.getMountPaths(a).includes(a.mountPath))return l({message:t("Mount path is already in use"),field:e.field});l()}else l({message:t("Please specify the read and write mode and mount path"),field:e.field})}))},n.nameValidator=function(e,a,l){if(!a)return l();var r=n.props,o=r.volume,u=r.namespace;(0,r.checkVolumeNameExist)(a)&&o.metadata.name!==a?l({message:t("volume name exist"),field:e.field}):n.volumeStore.checkName({name:a,namespace:u}).then((function(a){if(a.exist)return l({message:t("volume name exist"),field:e.field});l()}))},n.formRef=g.default.createRef(),n.volumeStore=new T.default,n.state={formData:e.volume},n}return(0,p.default)(a,e),(0,c.default)(a,[{key:"componentDidMount",value:function(){var e=this.props.onCancel,t=this.context.registerSubRoute;t&&t(this.handleSubmit,e)}},{key:"getMountPaths",value:function(e){return this.mountPaths||(this.mountPaths=(0,h.default)(this.props.containers,"name")),(0,v.default)(this.mountPaths[e.containerName])||(0,v.default)(this.mountPaths[e.containerName].volumeMounts)?[]:this.mountPaths[e.containerName].volumeMounts.filter((function(t){return t.name!==e.name})).map((function(e){return e.mountPath}))}},{key:"render",value:function(){var e=this.props,a=e.containers,n=e.className,l=e.contentClassName,r=e.collectSavedLog,o=this.state.formData;return g.default.createElement("div",{className:(0,E.default)(P.default.wrapper,n)},g.default.createElement("div",{className:"h6"},g.default.createElement("a",{className:"custom-icon",onClick:this.handleGoBack},g.default.createElement(w.ReactComponent,null)),t("Add Volume Template")),g.default.createElement("div",{className:(0,E.default)(P.default.contentWrapper,l)},g.default.createElement("div",{className:P.default.card},g.default.createElement(S.default,{data:o,ref:this.formRef},g.default.createElement(S.default.Item,{className:P.default.name,label:t("Volume Name"),desc:t("LONG_NAME_DESC"),rules:[{required:!0,message:t("Please input volume name")},{pattern:C.PATTERN_NAME,message:"".concat(t("Invalid name"),", ").concat(t("LONG_NAME_DESC"))},{validator:this.nameValidator}]},g.default.createElement(_.default,{name:"metadata.name",autoFocus:!0})),g.default.createElement(N.default,null),g.default.createElement(S.default.Item,{label:t("Mount Path"),rules:[{validator:this.mountValidator}]},g.default.createElement(k.default,{name:"volumeMounts",containers:a,collectSavedLog:r}))))))}}]),a}(g.default.Component),o.propTypes={containers:y.default.array,volume:y.default.object,namespace:y.default.string,onSave:y.default.func,onCancel:y.default.func,checkVolumeNameExist:y.default.func},o.defaultProps={volume:{},containers:[],namespace:"",onSave:function(){},onCancel:function(){}},o.contextTypes={registerSubRoute:y.default.func,resetSubRoute:y.default.func},r=u))||r;a.default=M},3435:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(70)),o=l(n(50)),u=l(n(0)),i=l(n(2454)),s=n(114),d=l(n(3436)),c=function(e){var a=e.name,n=e.value;return u.default.createElement("div",{className:d.default.accessMode},u.default.createElement("p",{className:"name"},"".concat(a,"(").concat(n,")")),u.default.createElement("p",{className:"desc"},t("ACCESS_MODE_".concat(n))))},f=function(e){if(e.loading)return null;var t=Object.keys(s.ACCESS_MODES).map((function(e){return{label:u.default.createElement(c,{name:e,value:s.ACCESS_MODES[e]}),value:e}}));return(0,o.default)(e.supportedAccessModes)&&(t=t.filter((function(t){return e.supportedAccessModes.includes(t.value)}))),u.default.createElement("div",{className:d.default.accessModeWrapper},u.default.createElement(i.default,(0,r.default)({options:t},e)))};a.default=f},3436:function(e,t,a){e.exports={accessModeWrapper:"AccessModes__accessModeWrapper--t3ac6",accessMode:"AccessModes__accessMode--2ntH9"}},3437:function(e,t,a){e.exports={wrapper:"AddVolumeTemplate__wrapper--2sHTA",contentWrapper:"AddVolumeTemplate__contentWrapper--xUWl2",card:"AddVolumeTemplate__card--2LsjI",title:"AddVolumeTemplate__title--3ud0I"}},3438:function(e,t,a){e.exports={toggle:"VolumeSettings__toggle--2BhdZ"}},3439:function(e,t,a){e.exports={wrapper:"VolumeSettings__wrapper--1XxYE",list:"VolumeSettings__list--6G441"}},3440:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(1)),f=l(n(38)),m=l(n(3441)),p=function(e){function a(){var e,t;(0,r.default)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(t=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(l)))).handlePlus=function(){var e=t.props,a=e.value,n=e.defaultValue;(0,e.onChange)((a||n)+1)},t.handleMinus=function(){var e=t.props,a=e.value,n=e.defaultValue;(0,e.onChange)(Math.max(1,(a||n)-1))},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props,a=e.value,n=e.defaultValue;return d.default.createElement("div",{className:m.default.wrapper},d.default.createElement("div",{className:m.default.content},d.default.createElement("div",{className:m.default.number},a||n),d.default.createElement("div",{className:m.default.text},d.default.createElement("p",null,d.default.createElement("strong",null,t("Replicas"))),d.default.createElement("p",null,t("Specify Replicas Number"))),d.default.createElement("div",{className:m.default.control},d.default.createElement(f.default,{name:"chevron-up",onClick:this.handlePlus,size:24,clickable:!0}),d.default.createElement(f.default,{name:"chevron-down",onClick:this.handleMinus,size:24,clickable:!0}))))}}]),a}(d.default.Component);a.default=p,p.propTypes={value:c.default.number,defaultValue:c.default.number,onChange:c.default.func},p.defaultProps={onChange:function(){}}},3441:function(e,t,a){e.exports={wrapper:"Replicas__wrapper--msHFx",content:"Replicas__content--PRM0_",number:"Replicas__number--1nVM7",text:"Replicas__text--3DM4H",control:"Replicas__control--1qXVc"}},3442:function(e,t,a){e.exports={wrapper:"ComponentForm__wrapper--1KGjF",formWrapper:"ComponentForm__formWrapper--GTNc1",containers:"ComponentForm__containers--10oVM",containerForm:"ComponentForm__containerForm--3yAeA",probeForm:"ComponentForm__probeForm--gZpoR"}},3443:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(1)),f=l(n(22)),m=l(n(58)),p=l(n(942)),h=l(n(224)),v=l(n(3444)),g=l(n(2802)),y=function(e){function a(){var e,t;(0,r.default)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(t=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(l)))).handleAdd=function(){t.props.onAdd()},t.handleEdit=function(e){t.props.onAdd(e)},t.handleDelete=function(e){t.props.onDelete(e)},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"renderContent",value:function(){var e=this,a=this.props,n=a.data,l=a.gateway,r=(0,f.default)(n,"spec.rules",[]),o=(0,f.default)(n,"spec.tls[0]",{});return(0,m.default)(r)?d.default.createElement("div",{className:g.default.empty},d.default.createElement("div",null,d.default.createElement("p",null,t("If you need to access applications by application route, add routing rules")),d.default.createElement(h.default,{onClick:this.handleAdd,disabled:(0,m.default)(l)},t("Add Route Rule")))):d.default.createElement("ul",null,r.map((function(t){return d.default.createElement(v.default,{key:t.host,rule:t,tls:o,onEdit:e.handleEdit,onDelete:e.handleDelete})})),d.default.createElement("div",{className:"text-center margin-t12"},d.default.createElement(h.default,{onClick:this.handleAdd,disabled:(0,m.default)(l)},t("Add Route Rule"))))}},{key:"render",value:function(){var e=this.props,a=e.gateway,n=e.error;return d.default.createElement("div",{className:g.default.wrapper},d.default.createElement("div",{className:"h5"},t("Application Route")),(0,m.default)(a)&&d.default.createElement(p.default,{className:"margin-b12",description:t.html("NO_INTERNET_ACCESS_TIP"),type:"warning"}),this.renderContent(),n&&d.default.createElement("p",{className:g.default.error},n))}}]),a}(d.default.Component);a.default=y,y.propTypes={data:c.default.object,onAdd:c.default.func,onDelete:c.default.func},y.defaultProps={data:{},onAdd:function(){},onDelete:function(){}}},3444:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(37)),o=l(n(22)),u=l(n(0)),i=l(n(1)),s=n(938),d=l(n(38)),c=l(n(224)),f=l(n(2802)),m=function(e){var a=e.rule,n=e.tls,l=void 0===n?{}:n,i=e.onDelete,m=e.onEdit,p=l.hosts&&l.hosts.includes(a.host)?"https":"http";return u.default.createElement("li",{className:f.default.card},u.default.createElement("div",{className:f.default.content},u.default.createElement(d.default,{name:"earth",size:40}),u.default.createElement("div",{className:f.default.title},a.host,u.default.createElement("p",null,u.default.createElement("span",null,t("Protocol"),": ",p),"https"===p&&u.default.createElement("span",null,t("Certificate"),": ",l.secretName))),u.default.createElement(s.Buttons,null,u.default.createElement(c.default,{type:"flat",icon:"trash",onClick:function(){return i(a.host)}}),u.default.createElement(c.default,{type:"flat",icon:"pen",onClick:function(){m("https"===p?(0,r.default)({},a,{protocol:"https",secretName:l.secretName}):(0,r.default)({},a,{protocol:"http"}))}}))),a.http.paths.map((function(e){return u.default.createElement("div",{key:e.path,className:f.default.path},u.default.createElement(s.Columns,null,u.default.createElement(s.Column,null,u.default.createElement("span",null,t("path"),": ",u.default.createElement("strong",null,e.path))),u.default.createElement(s.Column,null,u.default.createElement("span",null,t("Service"),":"," ",u.default.createElement("strong",null,(0,o.default)(e,"backend.serviceName")))),u.default.createElement(s.Column,null,u.default.createElement("span",null,t("Port"),": ",u.default.createElement("strong",null,(0,o.default)(e,"backend.servicePort"))))))})))};m.propTypes={rule:i.default.object};var p=m;a.default=p},3445:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(942)),f=l(n(2455)),m=l(n(2454)),p=l(n(267)),h=n(945),v=l(n(2803)),g=l(n(3448)),y=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props.data,a=this.state.type;return d.default.createElement("div",{className:g.default.wrapper},d.default.createElement("div",{className:"h5"},d.default.createElement("a",{className:"custom-icon",onClick:this.handleGoBack},d.default.createElement(h.ReactComponent,null)),t("Set Route Rule")),d.default.createElement("div",{className:g.default.formWrapper},d.default.createElement("div",{className:g.default.form},d.default.createElement(p.default,{ref:this.formRef,data:e},d.default.createElement(p.default.Item,{label:t("Mode")},d.default.createElement(m.default,{wrapClassName:"radio-default",buttonWidth:155,value:a,onChange:this.handleModeChange,size:"small"},d.default.createElement(f.default,{value:"auto"},t("Auto Generate")),d.default.createElement(f.default,{value:"specify"},t("Specify Domain")))),d.default.createElement(c.default,{className:"margin-t12 margin-b12",description:t.html("RULE_SETTING_MODE_".concat(a.toUpperCase())),type:"info"}),this.renderForm()))))}}]),a}(v.default);a.default=y},3446:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(70)),o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(22)),f=l(n(115)),m=l(n(0)),p=l(n(386)),h=l(n(225)),v=l(n(2545)),g=l(n(2804)),y=function(e){function a(){var e,t;(0,o.default)(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(t=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(l)))).state={service:""},t.handleChange=function(e){var a=t.props.onChange,n=(0,c.default)(e,"backend.servicePort");isNaN(Number(n))||(0,f.default)(e,"backend.servicePort",Number(n)),a&&a(e)},t.handleServiceChange=function(e){t.setState({service:e})},t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"componentWillReceiveProps",value:function(e){var t=(0,c.default)(e,"value.backend.serviceName");t&&t!==this.state.service&&this.setState({service:t})}},{key:"render",value:function(){return m.default.createElement(v.default,(0,r.default)({},this.props,{onChange:this.handleChange}),m.default.createElement(p.default,{name:"path",placeholder:t("Path"),defaultValue:"/"}),m.default.createElement(h.default,{name:"backend.serviceName",placeholder:t("Please select a service"),options:this.services,onChange:this.handleServiceChange}),m.default.createElement(g.default,{name:"backend.servicePort",placeholder:t("port"),options:this.ports}))}},{key:"services",get:function(){return this.props.services.map((function(e){return{label:e.name,value:e.name}}))}},{key:"ports",get:function(){var e=this,t=this.props.services.find((function(t){return t.name===e.state.service}));return t?t.ports.map((function(e){return{label:e.port,value:e.port}})):[]}}]),a}(m.default.Component);a.default=y,y.defaultProps={value:{},onChange:function(){}}},3447:function(e,t,a){e.exports={wrapper:"RuleForm__wrapper--3--VX",advance:"RuleForm__advance--2EJlm",toggle:"RuleForm__toggle--2S7Nw",customFormItem:"RuleForm__customFormItem--1u5SU",formWrapper:"RuleForm__formWrapper--2dDLG",form:"RuleForm__form--2YOPm"}},3448:function(e,t,a){e.exports={wrapper:"RuleForm__wrapper--2ZJXc",formWrapper:"RuleForm__formWrapper--1jESO",form:"RuleForm__form--2hvZ8"}},3449:function(e,t,a){e.exports={wrapper:"Resources__wrapper--_AGdj",footer:"Resources__footer--34fmE",formWrapper:"Resources__formWrapper--b0zpT"}},3450:function(e,t,a){e.exports={modal:"CreateApp__modal--p8a6H",header:"CreateApp__header--1O2uh",body:"CreateApp__body--QLzi6",switch:"CreateApp__switch--1JnPI"}},3451:function(e,t,a){"use strict";var n=a(4),l=a(81);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o,u,i=n(a(70)),s=n(a(63)),d=n(a(13)),c=n(a(14)),f=n(a(17)),m=n(a(16)),p=n(a(18)),h=l(a(0)),v=a(60),g=n(a(1)),y=n(a(387)),E=n(a(224)),b=a(2531),_=n(a(3452)),S=n(a(3457)),k=n(a(3466)),C=(0,v.observer)((u=o=function(e){function t(e){var a;return(0,d.default)(this,t),(a=(0,f.default)(this,(0,m.default)(t).call(this,e))).setViewType=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"appList",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.WORKSPACE_REPO_ID;a.setState({selectRepo:t,viewType:e})},a.handleClickApp=function(e){a.setState({viewType:"appDetail",selectApp:e})},a.state={selectRepo:"",viewType:"appList",selectApp:null},a}return(0,p.default)(t,e),(0,c.default)(t,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onCancel,n=e.onDeploySuccess,l=e.workspace,r=(0,s.default)(e,["visible","onCancel","onDeploySuccess","workspace"]),o=this.state,u=o.viewType,d=o.selectApp,c=o.selectRepo;return h.default.createElement(y.default,(0,i.default)({width:1070,className:k.default.modal,bodyClassName:k.default.body,visible:t,onCancel:a,rightScreen:!0,hideHeader:!0,hideFooter:!0},r),h.default.createElement(E.default,{className:k.default.close,icon:"close",iconType:"light",type:"control",onClick:a}),"appList"===u&&h.default.createElement(_.default,{workspace:l,selectRepo:c,setType:this.setViewType,onClickApp:this.handleClickApp}),"appDetail"===u&&h.default.createElement(S.default,{setType:this.setViewType,app:d,workspace:l,onDeploySuccess:n}))}}]),t}(h.Component),o.propTypes={workspace:g.default.string,visible:g.default.bool,onOk:g.default.func,onCancel:g.default.func,onDeploySuccess:g.default.func},o.defaultProps={workspace:"",visible:!1,onOk:function(){},onCancel:function(){}},r=u))||r;t.default=C},3452:function(e,a,n){"use strict";var l=n(4),r=n(81);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o,u,i,s=l(n(97)),d=l(n(61)),c=l(n(37)),f=l(n(62)),m=l(n(13)),p=l(n(14)),h=l(n(17)),v=l(n(16)),g=l(n(18)),y=l(n(225)),E=r(n(0)),b=n(60),_=l(n(1)),S=l(n(22)),k=l(n(963)),C=l(n(224)),w=l(n(2534)),N=l(n(2805)),T=l(n(2572)),P=l(n(2770)),M=n(2531),R=l(n(3456)),D=(0,b.observer)((i=u=function(e){function a(e){var t;return(0,m.default)(this,a),(t=(0,h.default)(this,(0,v.default)(a).call(this,e))).fetchRepos=(0,f.default)(d.default.mark((function e(){var a,n,l=arguments;return d.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=l.length>0&&void 0!==l[0]?l[0]:{},n=t.props.workspace,e.next=4,t.repoStore.fetchList((0,c.default)({status:"active",noLimit:!0,workspace:n},a));case 4:case"end":return e.stop()}}),e)}))),t.fetchApps=(0,f.default)(d.default.mark((function e(){var a,n,l,r,o,u=arguments;return d.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=u.length>0&&void 0!==u[0]?u[0]:{},n=!(u.length>1&&void 0!==u[1])||u[1],e.next=4,t.appStore.fetchList(Object.assign({page:1,limit:M.STORE_APP_LIMIT,status:t.isFormWorkspace?"":"active",isv:t.isFormWorkspace?t.props.workspace:"",repo_id:t.selectedRepo},a));case 4:l=t.appStore,r=l.allApps,o=l.list,n?(r.clear(),r.replace(o.data)):r.push.apply(r,(0,s.default)(o.data));case 6:case"end":return e.stop()}}),e)}))),t.fetchMoreApps=(0,f.default)(d.default.mark((function e(){var a;return d.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.appStore.list.page,e.next=3,t.fetchApps({page:a+1},!1);case 3:case"end":return e.stop()}}),e)}))),t.handleSearch=function(e){t.fetchApps({keyword:e})},t.handleRefresh=function(){t.fetchApps()},t.handleChangeRepo=function(e){t.selectedRepo!==e&&t.setState({selectRepo:e},(function(){t.fetchApps()}))},t.state={selectRepo:e.selectRepo},t.appStore=new T.default,t.repoStore=new P.default,t}var n;return(0,g.default)(a,e),(0,p.default)(a,[{key:"componentDidMount",value:(n=(0,f.default)(d.default.mark((function e(){return d.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchRepos();case 2:if(!(this.repoSelectOptions.length>0)){e.next=5;break}return e.next=5,this.fetchApps();case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"renderHeader",value:function(){return E.default.createElement("div",{className:R.default.header},E.default.createElement("div",{className:R.default.logo},E.default.createElement("img",{src:"/assets/application.svg",alt:""})),E.default.createElement("div",{className:R.default.text},E.default.createElement("h2",null,t("App Templates")),E.default.createElement("p",null,t("APP_TEMPLATES_MODAL_DESC"))))}},{key:"renderToolbar",value:function(){return E.default.createElement("div",{className:R.default.toolbar},E.default.createElement(y.default,{name:"repo",onChange:this.handleChangeRepo,className:R.default.selectRepos,options:this.repoSelectOptions,value:this.selectedRepo}),E.default.createElement(w.default,{onSearch:this.handleSearch,className:R.default.search,placeholder:t("SEARCH_TIPS")}),E.default.createElement(C.default,{type:"flat",icon:"refresh",onClick:this.handleRefresh}))}},{key:"render",value:function(){var e=this.appStore,t=e.allApps,a=e.list,n=a.isLoading,l=a.total;return E.default.createElement(E.default.Fragment,null,this.renderHeader(),this.renderToolbar(),E.default.createElement("div",{className:R.default.apps},E.default.createElement(N.default,{itemCls:R.default.appItem,apps:t.toJS(),isLoading:n,total:l,onFetchMore:this.fetchMoreApps,onClickAppItem:this.props.onClickApp,disableLink:!0})))}},{key:"isFormWorkspace",get:function(){return this.selectedRepo===M.WORKSPACE_REPO_ID}},{key:"repoSelectOptions",get:function(){var e=this.repoStore.list.data.map((function(e){var t=e.name;return{value:e.repo_id,label:t}}));return e.unshift({value:M.WORKSPACE_REPO_ID,label:t("From workspace")}),e}},{key:"selectedRepo",get:function(){return this.state.selectRepo||(0,S.default)(this.repoSelectOptions,"[0].value")}}]),a}(E.Component),u.propTypes={workspace:_.default.string,store:_.default.object,onClickApp:_.default.func,fetchApps:_.default.func,selectRepo:_.default.string},u.defaultProps={workspace:"",store:{},onClickApp:k.default},o=i))||o;a.default=D},3456:function(e,t,a){e.exports={apps:"Apps__apps--1UatQ",appItem:"Apps__appItem--1M1BO",header:"Apps__header--2X4aw",logo:"Apps__logo--2VFLG",text:"Apps__text--180h4",toolbar:"Apps__toolbar--fwgiu",selectRepos:"Apps__selectRepos--hUYgP",search:"Apps__search--1Qe3P"}},3457:function(e,a,n){"use strict";var l=n(4),r=n(81);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o,u,i,s=l(n(63)),d=l(n(61)),c=l(n(37)),f=l(n(62)),m=l(n(13)),p=l(n(14)),h=l(n(17)),v=l(n(16)),g=l(n(18)),y=r(n(0)),E=n(60),b=l(n(1)),_=l(n(2468)),S=l(n(22)),k=l(n(2464)),C=n(938),w=l(n(224)),N=l(n(388)),T=l(n(2806)),P=l(n(2807)),M=l(n(2808)),R=l(n(2809)),D=l(n(2572)),O=l(n(2555)),x=l(n(3463)),I=l(n(3465)),A=k.default.TabPanel,L=(0,E.observer)((i=u=function(e){function a(e){var n;return(0,m.default)(this,a),(n=(0,h.default)(this,(0,v.default)(a).call(this,e))).fetchVersions=(0,f.default)(d.default.mark((function e(){var t,a=arguments;return d.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},e.next=3,n.versionStore.fetchList((0,c.default)({},t,{app_id:n.appId}));case 3:case"end":return e.stop()}}),e)}))),n.handleTabChange=function(e){n.setState({tab:e})},n.handleClickBack=function(){var e=n.props.app;n.props.setType("appList",e.repo_id)},n.showDeploy=function(){n.setState({showDeploy:!0})},n.hideDeploy=function(){n.setState({showDeploy:!1})},n.handleDeploy=function(e){var a=e.namespace,l=(0,s.default)(e,["namespace"]);n.appStore.deploy(l,{namespace:a}).then((function(){n.hideDeploy(),N.default.success({content:"".concat(t("Deploy Successfully"),"!")}),n.props.onDeploySuccess()}))},n.handleChangeAppVersion=function(e){n.setState({selectAppVersion:e})},n.state={tab:"versionInfo",selectAppVersion:"",showDeploy:!1},n.appStore=new D.default,n.versionStore=new O.default,n}var n;return(0,g.default)(a,e),(0,p.default)(a,[{key:"componentDidMount",value:(n=(0,f.default)(d.default.mark((function e(){var t;return d.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchVersions();case 2:t=(0,S.default)(this.versionStore,"list.data[0].version_id",""),this.setState((function(){return{selectAppVersion:t}})),this.appStore.fetchDetail({app_id:[this.appId]});case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"componentWillUnmount",value:function(){this.props.setType()}},{key:"renderVersionList",value:function(){return y.default.createElement(R.default,{versionStore:this.versionStore,selectVersion:this.state.selectAppVersion,fetchVersions:this.fetchVersions,handleChangeVersion:this.handleChangeAppVersion})}},{key:"renderDeployForm",value:function(){var e=(0,_.default)("/projects/:namespace/:module/:type?").exec(location.pathname);return y.default.createElement(P.default,{app:this.appStore.detail,onOk:this.handleDeploy,onCancel:this.hideDeploy,isSubmitting:this.appStore.isSubmitting,noHeader:!0,fromProjectApp:!0,contentClass:I.default.content,footerClass:I.default.footer,className:I.default.deployForm,params:{version:this.state.selectAppVersion,workspace:this.props.workspace,namespace:e[1]||"",module:e[2]||""}})}},{key:"renderDeployButton",value:function(){return y.default.createElement("div",{className:I.default.deployButton},y.default.createElement(w.default,{type:"control",onClick:this.showDeploy,noShadow:!0},t("Deploy")))}},{key:"renderContent",value:function(){var e=this.state,a=e.selectAppVersion,n=e.tab,l=this.appStore.detail;return y.default.createElement("div",{className:I.default.appContent},y.default.createElement(k.default,{className:"tabs-new",activeName:n,onChange:this.handleTabChange},y.default.createElement(A,{label:t("App Info"),name:"versionInfo"},this.renderDeployButton(),y.default.createElement(C.Columns,null,y.default.createElement(C.Column,{className:"is-9"},y.default.createElement(T.default,{appId:this.appId,versionId:a,currentTab:n})),y.default.createElement(C.Column,null,this.renderVersionList(),y.default.createElement(M.default,{app:l})))),y.default.createElement(A,{label:t("Chart File"),name:"chartFiles"},this.renderDeployButton(),y.default.createElement(C.Columns,null,y.default.createElement(C.Column,{className:"is-9"},y.default.createElement(T.default,{appId:this.appId,versionId:a,currentTab:n})),y.default.createElement(C.Column,null,this.renderVersionList(),y.default.createElement(M.default,{app:l}))))))}},{key:"render",value:function(){var e=this.props.app,t=this.state.showDeploy;return y.default.createElement(y.default.Fragment,null,y.default.createElement("div",{className:I.default.header},y.default.createElement(x.default,{onClickBack:this.handleClickBack,title:e.name,desc:e.description,icon:e.icon})),t?this.renderDeployForm():this.renderContent())}},{key:"appId",get:function(){return this.props.app.app_id}}]),a}(y.Component),u.propTypes={app:b.default.object,setType:b.default.func,workspace:b.default.string,onDeploySuccess:b.default.func},u.defaultProps={app:{},onDeploySuccess:function(){}},o=i))||o;a.default=L},3463:function(e,a,n){"use strict";var l=n(81),r=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o=r(n(13)),u=r(n(14)),i=r(n(17)),s=r(n(16)),d=r(n(18)),c=l(n(0)),f=r(n(1)),m=r(n(38)),p=r(n(944)),h=r(n(3464)),v=function(e){function a(){var e,t;(0,o.default)(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(t=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(l)))).handleClickBack=function(){t.props.onClickBack?t.props.onClickBack():history.back()},t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"render",value:function(){var e=this.props,a=e.title,n=e.desc,l=e.icon;return c.default.createElement("div",{className:h.default.banner},c.default.createElement("div",{className:h.default.back,onClick:this.handleClickBack},c.default.createElement(m.default,{name:"return",size:20}),c.default.createElement("span",null,t("Back"))),c.default.createElement("div",{className:h.default.intro},c.default.createElement("span",{className:h.default.icon},c.default.createElement(p.default,{src:l,alt:"",iconLetter:a,iconSize:48})),c.default.createElement("div",{className:h.default.text},c.default.createElement("h3",null,a),c.default.createElement("p",null,n))),c.default.createElement("div",{className:h.default.rightIcon},c.default.createElement("span",{className:h.default.image},c.default.createElement(p.default,{src:l,alt:"",iconLetter:a,iconSize:200}))))}}]),a}(c.PureComponent);v.propTypes={title:f.default.string,desc:f.default.string,icon:f.default.string,onClickBack:f.default.func};var g=v;a.default=g},3464:function(e,t,a){e.exports={banner:"Banner__banner--1FsQG",back:"Banner__back--1gmVP",intro:"Banner__intro--3j5up",icon:"Banner__icon--fDrmq",text:"Banner__text--Pk8jY",rightIcon:"Banner__rightIcon--_Ea0p",image:"Banner__image--2Dw5W"}},3465:function(e,t,a){e.exports={header:"AppDetail__header--oS6Sd",appContent:"AppDetail__appContent--fl0v5",deployButton:"AppDetail__deployButton--19wqA",deployForm:"AppDetail__deployForm--4xi-o",footer:"AppDetail__footer--1AZSz",loading:"AppDetail__loading--4r_xE"}},3466:function(e,t,a){e.exports={modal:"RepoApp__modal--1Kack",body:"RepoApp__body--1QrRg",close:"RepoApp__close--3PAVl"}},3467:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(37)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(0)),m=n(60),p=n(19),h=n(49),v=l(n(22)),g=l(n(2521)),y=l(n(2605)),E=l(n(2810)),b=l(n(2542)),_=l(n(2518)),S=(0,m.inject)("rootStore")(r=(0,m.observer)(r=function(e){function a(){var e,n;(0,u.default)(this,a);for(var l=arguments.length,r=new Array(l),i=0;i<l;i++)r[i]=arguments[i];return(n=(0,s.default)(this,(e=(0,d.default)(a)).call.apply(e,[this].concat(r)))).getColumns=function(){return[{title:t("Name"),dataIndex:"name",sorter:!0,sortOrder:n.getSortOrder("name"),render:function(e,t){return f.default.createElement(y.default,{isApp:!0,to:"".concat(n.prefix,"/").concat(t.cluster_id),avatar:t.app.icon,iconLetter:e,iconSize:40,title:e,desc:t.description})}},{title:t("Status"),dataIndex:"status",isHideable:!0,width:"20%",render:function(e,a){return f.default.createElement(g.default,{name:t(a.transition_status||e),type:a.transition_status||e})}},{title:t("Version"),dataIndex:"version.name",isHideable:!0,width:"20%"},{title:t("Last Updated Time"),dataIndex:"status_time",sorter:!0,sortOrder:n.getSortOrder("status_time"),isHideable:!0,width:180,render:function(e,t){return(0,h.getLocalTime)(t.update_time||t.status_time).format("YYYY-MM-DD HH:mm:ss")}},{key:"more",width:20,render:n.renderMore}]},n.getData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,v.default)(n.props.project,"annotations.openpitrix_runtime");n.props.project.name&&n.store.fetchList((0,o.default)({namespace:n.props.project.name,runtime_id:t},e))},n}return(0,c.default)(a,e),(0,i.default)(a,[{key:"init",value:function(){this.store=this.props.store,this.state={showAppRepo:!1,deleteModal:!1}}},{key:"getTableProps",value:function(){var e=this.props.canCreate?[{key:"deploy",type:"control",text:t("Deploy New Application"),onClick:this.props.showDeployAppModal}]:[];return(0,o.default)({},_.default.prototype.getTableProps.call(this),{actions:e,onCreate:null,selectActions:[]})}},{key:"renderHeader",value:function(){return null}},{key:"renderEmpty",value:function(){var e=this.props.canCreate?this.props.showDeployAppModal:null;return f.default.createElement(b.default,{createText:t("Deploy New Application"),desc:t("APP_TEMPLATE_DESC"),onCreate:e})}},{key:"renderExtraModals",value:function(){var e=this.state.selectItem;return f.default.createElement(E.default,{visible:this.state.editModal,detail:(0,p.toJS)(e),onOk:this.handleEdit,onCancel:this.hideModal("editModal"),isSubmitting:this.store.isSubmitting})}},{key:"module",get:function(){return"applications"}},{key:"rowKey",get:function(){return"name"}},{key:"prefix",get:function(){var e=this.props.match.params.namespace;return"/projects/".concat(e,"/applications/template")}}]),a}(_.default))||r)||r;a.default=S},3468:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(37)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(22)),m=l(n(0)),p=n(60),h=n(49),v=l(n(2521)),g=l(n(2519)),y=l(n(2527)),E=l(n(2542)),b=l(n(2518)),_=(0,p.inject)("rootStore")(r=(0,p.observer)(r=function(e){function a(){var e,n;(0,u.default)(this,a);for(var l=arguments.length,r=new Array(l),i=0;i<l;i++)r[i]=arguments[i];return(n=(0,s.default)(this,(e=(0,d.default)(a)).call.apply(e,[this].concat(r)))).getColumns=function(){return[{title:t("Name"),dataIndex:"name",sorter:!0,sortOrder:n.getSortOrder("name"),search:!0,render:function(e,t){return m.default.createElement(g.default,{title:(0,h.getDisplayName)(t),avatar:t.icon||"/assets/default-app.svg",to:"".concat(n.prefix,"/").concat(e),desc:(0,f.default)(t,'annotations["kubesphere.io/description"]',"-")})}},{title:t("Status"),dataIndex:"status",isHideable:!0,width:"20%",render:function(e){return m.default.createElement(v.default,{name:t(e),type:e})}},{title:t("Version"),dataIndex:"version",isHideable:!0,width:"20%"},{title:t("Created Time"),dataIndex:"createTime",sorter:!0,sortOrder:n.getSortOrder("createTime"),isHideable:!0,width:180,render:function(e){return(0,h.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}},{key:"more",width:20,render:n.renderMore}]},n.getData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n.store.fetchList((0,o.default)({namespace:n.props.match.params.namespace},e))},n}return(0,c.default)(a,e),(0,i.default)(a,[{key:"init",value:function(){this.store=this.props.store,this.state={showServiceDeployApp:!1,sampleApp:"",deleteModal:!1}}},{key:"getTableProps",value:function(){var e=this.props.canCreate?[{key:"deploy",type:"control",text:t("Deploy New Application"),onClick:this.props.showDeployAppModal}]:[];return(0,o.default)({},b.default.prototype.getTableProps.call(this),{actions:e,onCreate:null,selectActions:[]})}},{key:"renderHeader",value:function(){return null}},{key:"renderEmpty",value:function(){var e=this.props.canCreate?this.props.showDeployAppModal:null;return m.default.createElement(E.default,{createText:t("Deploy New Application"),desc:t("APP_TEMPLATE_DESC"),onCreate:e})}},{key:"renderExtraModals",value:function(){var e=this.state.selectItem,t=void 0===e?{}:e;return m.default.createElement(y.default,{visible:this.state.editModal,detail:t._originData,onOk:this.handleEdit,onCancel:this.hideModal("editModal"),isSubmitting:this.store.isSubmitting})}},{key:"rowKey",get:function(){return"name"}},{key:"prefix",get:function(){var e=this.props.match.params.namespace;return"/projects/".concat(e,"/applications/composing")}},{key:"module",get:function(){return"applications"}}]),a}(b.default))||r)||r;a.default=_},3469:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r=n(a(30)),o=n(a(63)),u=n(a(70)),i=n(a(13)),s=n(a(14)),d=n(a(17)),c=n(a(16)),f=n(a(18)),m=n(a(0)),p=a(60),h=n(a(3470)),v=n(a(2536)),g=a(114),y=n(a(940)),E=a(3471),b=n(a(3480)),_=(0,p.observer)(l=function(e){function t(e){var a;return(0,i.default)(this,t),(a=(0,d.default)(this,(0,c.default)(t).call(this,e))).store=new v.default(a.module),a}return(0,f.default)(t,e),(0,s.default)(t,[{key:"componentDidMount",value:function(){this.store.fetchCounts(this.params,["deployments","statefulsets","daemonsets"])}},{key:"renderHeader",value:function(){return m.default.createElement(h.default,(0,u.default)({module:this.module},this.params,{deploymentsCount:this.store.counts.deployments,statefulsetsCount:this.store.counts.statefulsets,daemonsetsCount:this.store.counts.daemonsets}))}},{key:"renderWorkloads",value:function(){return m.default.createElement(b.default,(0,u.default)({module:this.module,name:g.MODULE_KIND_MAP[this.module],store:this.store,formSteps:E.FORM_STEPS[this.module],formTemplate:this.formTemplate},this.props))}},{key:"render",value:function(){return m.default.createElement(m.default.Fragment,null,this.renderHeader(),this.renderWorkloads())}},{key:"params",get:function(){var e=this.props.match.params;e.module;return(0,o.default)(e,["module"])}},{key:"module",get:function(){return this.props.match.params.module}},{key:"formTemplate",get:function(){var e=this.params.namespace,t=g.MODULE_KIND_MAP[this.module];if(!t||!y.default[this.module])return{};var a,n=y.default[this.module]({namespace:e});return"statefulsets"===this.module?(a={},(0,r.default)(a,t,n),(0,r.default)(a,"Service",y.default.services({namespace:e,selector:n.metadata.labels})),a):(0,r.default)({},t,n)}}]),t}(m.default.Component))||l;t.default=_},3470:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=n(60),m=l(n(2523)),p=(0,f.inject)("rootStore")(r=(0,f.observer)(r=function(e){function a(){var e,t;(0,o.default)(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(t=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(l)))).handleTabChange=function(e){var a=t.props.namespace;t.routing.push("/projects/".concat(a,"/").concat(e))},t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"render",value:function(){return c.default.createElement(m.default,{className:"margin-b12",title:t("Workloads"),description:t("WORKLOADS_DESC"),module:this.props.module,tabs:this.tabs})}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"tabs",get:function(){return{value:this.props.module,onChange:this.handleTabChange,options:[{value:"deployments",label:t("Deployments"),count:this.props.deploymentsCount},{value:"statefulsets",label:t("StatefulSets"),count:this.props.statefulsetsCount},{value:"daemonsets",label:t("DaemonSets"),count:this.props.daemonsetsCount}]}}}]),a}(c.default.Component))||r)||r;a.default=p},3471:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.FORM_STEPS=void 0;var l=n(a(3472)),r=n(a(3478)),o=n(a(3479)),u={deployments:l.default,statefulsets:r.default,daemonsets:o.default};t.FORM_STEPS=u},3472:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(2565)),r=n(a(2574)),o=n(a(2564)),u=n(a(2610)),i=[{title:"Basic Info",icon:"cdn",component:l.default,required:!0},{title:"Container Image",icon:"docker",component:r.default,required:!0},{title:"Mount Volumes",icon:"storage",component:o.default,required:!0},{title:"Advanced Settings",icon:"slider",component:u.default,required:!0}];t.default=i},3473:function(e,t,a){e.exports={wrapper:"ReplicasControl__wrapper--3B75b",replicas:"ReplicasControl__replicas--1narK"}},3474:function(e,t,a){e.exports={wrapper:"UpdateStrategy__wrapper--2RYq6",options:"UpdateStrategy__options--2W1a9"}},3475:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(2544)),f=l(n(267)),m=l(n(2796)),p=l(n(2797)),h=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){return d.default.createElement(f.default.Group,{label:t("Pod Security Context"),desc:t("CONTAINER_SECURITY_CTX_DESC"),checkable:!0},d.default.createElement(c.default,{className:"margin-b12",type:"warning",title:t("ALERT_WARNING"),message:t("POD_SECURITY_CONTEXT_DESC")}),d.default.createElement(m.default,{prefix:this.props.prefix}),d.default.createElement(p.default,{prefix:this.props.prefix}))}}]),a}(d.default.PureComponent);a.default=h},3476:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(268)),c=l(n(58)),f=l(n(130)),m=l(n(0)),p=l(n(267)),h=l(n(2538)),v=n(49),g=function(e){function a(){var e,n;(0,r.default)(this,a);for(var l=arguments.length,o=new Array(l),s=0;s<l;s++)o[s]=arguments[s];return(n=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(o)))).handleLabelsChange=(0,d.default)((function(e){var t=n.props,a=t.module,l=t.formTemplate;(0,v.updateLabels)(l,a,e)}),200),n.labelsValidator=function(e,a,l){return(0,f.default)(a)||(0,c.default)(a)?l():(0,v.isValidLabel)(a)?void n.props.store.checkLabels({labels:a,namespace:n.props.namespace}).then((function(a){if(a.exist)return l({message:t("Labels exists"),field:e.field});l()})):l({message:t("LABEL_FORMAT_DESC")})},n}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){return m.default.createElement(m.default.Fragment,null,m.default.createElement(p.default.Item,{label:t("Labels"),rules:[{validator:this.labelsValidator}]},m.default.createElement(h.default,{name:"metadata.labels",addText:t("Add Label"),onChange:this.handleLabelsChange,readOnlyKeys:["app"]})),m.default.createElement(p.default.Item,{label:t("Annotations")},m.default.createElement(h.default,{name:"metadata.annotations",addText:t("Add Annotation"),hiddenKeys:globals.config.preservedAnnotations})))}}]),a}(m.default.Component);a.default=g},3477:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(267)),f=l(n(2538)),m=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){return d.default.createElement(c.default.Item,null,d.default.createElement(f.default,{name:"".concat(this.prefix,"nodeSelector"),addText:t("Add Node Selector")}))}},{key:"prefix",get:function(){return this.props.prefix||"spec.template.spec."}}]),a}(d.default.Component);a.default=m},3478:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(49),r=n(a(2565)),o=n(a(2574)),u=n(a(2564)),i=n(a(2610)),s=[{title:"Basic Info",icon:"cdn",component:r.default,required:!0},{title:"Container Image",icon:"docker",component:(0,l.withProps)(o.default,{withService:!0}),required:!0},{title:"Mount Volumes",icon:"storage",component:u.default,required:!0},{title:"Advanced Settings",icon:"slider",component:i.default,required:!0}];t.default=s},3479:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(2565)),r=n(a(2574)),o=n(a(2564)),u=n(a(2610)),i=[{title:"Basic Info",icon:"cdn",component:l.default,required:!0},{title:"Container Image",icon:"docker",component:r.default,required:!0},{title:"Mount Volumes",icon:"storage",component:o.default,required:!0},{title:"Advanced Settings",icon:"slider",component:u.default,required:!0}];t.default=i},3480:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(61)),u=l(n(37)),i=l(n(63)),s=l(n(62)),d=l(n(13)),c=l(n(14)),f=l(n(17)),m=l(n(16)),p=l(n(18)),h=l(n(0)),v=n(60),g=l(n(2519)),y=l(n(388)),E=l(n(2518)),b=l(n(2569)),_=l(n(2670)),S=l(n(2539)),k=l(n(2526)),C=l(n(2527)),w=l(n(2812)),N=l(n(2813)),T=n(49),P=n(941),M=n(114),R=(0,v.inject)("rootStore")(r=(0,v.observer)(r=function(e){function a(){var e,n;(0,d.default)(this,a);for(var l=arguments.length,r=new Array(l),o=0;o<l;o++)r[o]=arguments[o];return(n=(0,f.default)(this,(e=(0,m.default)(a)).call.apply(e,[this].concat(r)))).getColumns=function(){return[{title:t("Name"),dataIndex:"name",sorter:!0,sortOrder:n.getSortOrder("name"),search:!0,render:function(e,t){return h.default.createElement(g.default,{icon:M.ICON_TYPES[n.module],iconSize:40,title:(0,T.getDisplayName)(t),desc:n.getItemDesc(t),to:"".concat(n.prefix,"/").concat(e)})}},{title:t("Status"),dataIndex:"status",filters:n.getStatus(),filteredValue:n.getFilteredValue("status"),isHideable:!0,search:!0,width:"20%",render:n.renderStatus},{title:t("Application"),dataIndex:"app.kubernetes.io/name",isHideable:!0,search:!0,width:"25%",render:function(e,t){return t.app}},"deployments"===n.module?{title:t("Updated Time"),dataIndex:"updateTime",sorter:!0,sortOrder:n.getSortOrder("updateTime"),isHideable:!0,width:150,render:function(e){return(0,T.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}}:{title:t("Created Time"),dataIndex:"createTime",sorter:!0,sortOrder:n.getSortOrder("createTime"),isHideable:!0,width:150,render:function(e){return(0,T.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}},{key:"more",width:20,render:n.renderMore}]},n.getItemDesc=function(e){var a=(0,P.getWorkloadStatus)(e,n.module),l=a.status,r=a.reason;return r?h.default.createElement(b.default,{status:l,reason:t(r),data:e}):e.description||"-"},n.handleYamlEdit=function(e){var t=n.state.selectItem;n.store.update(t,e).then((function(){n.hideModal("editYamlModal")()}))},n.renderStatus=function(e,t){return h.default.createElement(N.default,{data:t,module:n.module})},n.handleRedeploy=function(){var e=n.state.selectItem;n.store.patch(e,{spec:{template:{metadata:{annotations:{"kubesphere.io/restartedAt":new Date}}}}}).then((function(){n.hideModal("redeployModal")(),y.default.success({content:"".concat(t("Redeploy Successfully"),"!")})}))},n}var n;return(0,p.default)(a,e),(0,c.default)(a,[{key:"init",value:function(){this.store=this.props.store,this.initWebsocket()}},{key:"componentWillReceiveProps",value:function(e){e.module!==this.props.module&&(this.store.setModule(e.module),this.store.list.reset(),this.initWebsocket(),this.getData())}},{key:"getData",value:(n=(0,s.default)(o.default.mark((function e(){var t,a,n,l=arguments;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},a=t.silent,n=(0,i.default)(t,["silent"]),a&&(this.list.silent=!0),e.next=4,this.store.fetchList((0,u.default)({},this.params,n));case 4:this.list.silent=!1;case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getStatus",value:function(){return M.WORKLOAD_STATUS.map((function(e){return{text:t(e.text),value:e.value}}))}},{key:"renderHeader",value:function(){return null}},{key:"renderModals",value:function(){var e=this,t=this.state,a=t.editModal,n=t.editYamlModal,l=t.deleteModal,r=t.batchDeleteModal,o=t.createModal,u=t.redeployModal,i=t.selectItem,s=void 0===i?{}:i,d=this.store.isSubmitting;return h.default.createElement(h.default.Fragment,null,h.default.createElement(C.default,{visible:a,detail:s._originData,isSubmitting:d,onOk:this.handleEdit,onCancel:this.hideModal("editModal")}),h.default.createElement(k.default,{store:this.store,visible:n,detail:s._originData,isSubmitting:d,onOk:this.handleYamlEdit,onCancel:this.hideModal("editYamlModal")}),h.default.createElement(w.default,{resource:s,visible:l,onOk:this.handleDelete,onCancel:this.hideModal("deleteModal"),isSubmitting:d}),this.list.selectedRowKeys&&h.default.createElement(w.default,{resource:this.list.data.filter((function(t){return e.list.selectedRowKeys.includes(t.name)})),visible:r,onOk:this.handleBatchDelete,onCancel:this.hideModal("batchDeleteModal"),isSubmitting:d}),h.default.createElement(_.default,{visible:u,detail:s,type:M.MODULE_KIND_MAP[this.module],onOk:this.handleRedeploy,onCancel:this.hideModal("redeployModal"),isSubmitting:d}),h.default.createElement(S.default,{name:this.name,module:this.module,store:this.store,visible:o,steps:this.steps,formTemplate:this.props.formTemplate,isSubmitting:this.store.isSubmitting,onOk:this.handleCreate,onCancel:this.hideModal("createModal")}))}},{key:"module",get:function(){return this.props.module}},{key:"name",get:function(){return this.props.name}},{key:"steps",get:function(){return this.props.formSteps}},{key:"params",get:function(){var e=this.props.match.params;e.module;return(0,i.default)(e,["module"])}},{key:"itemActions",get:function(){return[{key:"edit",icon:"pen",text:t("EDIT"),action:"edit",onClick:this.showModal("editModal")},{key:"editYaml",icon:"pen",text:t("Edit YAML"),action:"edit",onClick:this.showModal("editYamlModal")},{key:"redeploy",icon:"restart",text:t("Redeploy"),action:"edit",onClick:this.showModal("redeployModal")},{key:"delete",icon:"trash",text:t("Delete"),action:"delete",onClick:this.showModal("deleteModal")}]}}]),a}(E.default))||r)||r;a.default=R},3481:function(e,t,a){e.exports={wrapper:"Redeploy__wrapper--3gb5X",text:"Redeploy__text--1YDX9"}},3482:function(e,t,a){e.exports={modalHeader:"WorkloadDelete__modalHeader--3TWrk",modalBody:"WorkloadDelete__modalBody--GK12m",body:"WorkloadDelete__body--c8zsi",resources:"WorkloadDelete__resources--2XklT",resource:"WorkloadDelete__resource--2gyGr",selected:"WorkloadDelete__selected--7hDVe",resourceName:"WorkloadDelete__resourceName--2w4PD",resourceType:"WorkloadDelete__resourceType--2acsO",footer:"WorkloadDelete__footer--3Cme0",empty:"WorkloadDelete__empty--3b_ip"}},3483:function(e,t,a){},3484:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(37)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(2463)),f=l(n(18)),m=l(n(0)),p=n(60),h=l(n(38)),v=n(49),g=n(114),y=l(n(2521)),E=l(n(2579)),b=l(n(2596)),_=l(n(2518)),S=l(n(2526)),k=l(n(2569)),C=l(n(961)),w=l(n(3485)),N=(0,p.inject)("rootStore")(r=(0,p.observer)(r=function(e){function a(){var e,n;(0,u.default)(this,a);for(var l=arguments.length,r=new Array(l),o=0;o<l;o++)r[o]=arguments[o];return(n=(0,s.default)(this,(e=(0,d.default)(a)).call.apply(e,[this].concat(r)))).getItemDesc=function(e){var a=e.podStatus,n=a.status,l=a.type;return"running"!==l&&"completed"!==l?m.default.createElement(k.default,{status:l,reason:t(n),data:e,type:"pod"}):t(l)},n.getColumns=function(){return[{title:t("Name"),dataIndex:"name",sorter:!0,sortOrder:n.getSortOrder("name"),search:!0,render:n.renderAvatar},{title:t("Node"),dataIndex:"node",isHideable:!0,width:"18%",render:n.renderNode},{title:t("Pod IP"),dataIndex:"podIp",isHideable:!0,width:"15%"},{title:t("Application"),dataIndex:"app.kubernetes.io/name",isHideable:!0,search:!0,width:"15%",render:function(e,t){return t.app}},{title:t("Updated Time"),dataIndex:"startTime",sorter:!0,sortOrder:n.getSortOrder("startTime"),isHideable:!0,width:150,render:function(e){return(0,v.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}},{key:"more",width:20,render:n.renderMore}]},n.renderAvatar=function(e,t){var a=t.podStatus;return m.default.createElement("div",{className:w.default.avatar},m.default.createElement("div",{className:w.default.icon},m.default.createElement(h.default,{name:g.ICON_TYPES[n.module],size:40}),m.default.createElement(E.default,{className:w.default.indicator,type:a.type,flicker:!0})),m.default.createElement("div",null,m.default.createElement(b.default,{className:w.default.title,to:"".concat(n.prefix,"/").concat(e)},e),m.default.createElement("div",{className:w.default.desc},n.getItemDesc(t))))},n.renderNode=function(e,t){var a=t.node,l=t.nodeIp;if(!a)return"-";var r="".concat(a,"(").concat(l,")");return m.default.createElement(b.default,{to:"/infrastructure/nodes/".concat(a),auth:n.canViewNode},r)},n.renderStatus=function(e){return m.default.createElement(y.default,{type:e.type,name:t(e.type),flicker:!0})},n}return(0,f.default)(a,e),(0,i.default)(a,[{key:"init",value:function(){this.store=new C.default,this.initWebsocket()}},{key:"getTableProps",value:function(){return(0,o.default)({},(0,c.default)((0,d.default)(a.prototype),"getTableProps",this).call(this),{onCreate:null})}},{key:"getStatus",value:function(){return g.POD_STATUS.map((function(e){return{text:t(e.text),value:e.value}}))}},{key:"renderExtraModals",value:function(){var e=this.state,t=e.viewYaml,a=e.selectItem,n=void 0===a?{}:a;return m.default.createElement("div",null,m.default.createElement(S.default,{visible:t,detail:n._originData,onCancel:this.hideModal("viewYaml"),readOnly:!0}))}},{key:"module",get:function(){return"pods"}},{key:"name",get:function(){return"Pod"}},{key:"canViewNode",get:function(){return globals.app.hasPermission({module:"nodes",action:"view"})}},{key:"itemActions",get:function(){return[{key:"viewYaml",icon:"pen",text:t("View YAML"),action:"view",onClick:this.showModal("viewYaml")},{key:"delete",icon:"trash",text:t("Delete"),action:"delete",onClick:this.showModal("deleteModal")}]}}]),a}(_.default))||r)||r;a.default=N},3485:function(e,t,a){e.exports={avatar:"Pods__avatar--18wjE",icon:"Pods__icon--asHVq",indicator:"Pods__indicator--Hf_3Y",title:"Pods__title--3C8yR",desc:"Pods__desc--2Xm1G"}},3486:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(70)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(0)),m=n(60),p=n(49),h=n(114),v=n(941),g=n(940),y=l(n(2536)),E=l(n(3487)),b=l(n(2519)),_=l(n(2518)),S=l(n(2816)),k=l(n(2569)),C=l(n(3488)),w=l(n(2539)),N=l(n(2527)),T=(0,m.inject)("rootStore")(r=(0,m.observer)(r=function(e){function a(){var e,n;(0,u.default)(this,a);for(var l=arguments.length,r=new Array(l),o=0;o<l;o++)r[o]=arguments[o];return(n=(0,s.default)(this,(e=(0,d.default)(a)).call.apply(e,[this].concat(r)))).getItemDesc=function(e){var a=(0,v.getWorkloadStatus)(e,n.module),l=a.status,r=a.reason;return r?f.default.createElement(k.default,{status:l,reason:t(r),data:e}):e.description||"-"},n.getColumns=function(){return[{title:t("Name"),dataIndex:"name",sorter:!0,sortOrder:n.getSortOrder("name"),search:!0,render:function(e,t){return f.default.createElement(b.default,{icon:h.ICON_TYPES[n.module],iconSize:40,title:(0,p.getDisplayName)(t),desc:n.getItemDesc(t),to:"".concat(n.prefix,"/").concat(e)})}},{title:t("Status"),dataIndex:"status",filters:n.getStatus(),filteredValue:n.getFilteredValue("status"),isHideable:!0,search:!0,width:"25%",render:n.renderStatus},{title:t("Last schedule time"),dataIndex:"updateTime",sorter:!0,sortOrder:n.getSortOrder("updateTime"),isHideable:!0,search:!0,width:"20%",render:function(e){return(0,p.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}},{key:"more",width:20,render:n.renderMore}]},n.handleRerun=function(e){n.store.rerun(e).then((function(){n.getData()}))},n.renderStatus=function(e,t){return f.default.createElement(C.default,{data:t,module:n.module})},n}return(0,c.default)(a,e),(0,i.default)(a,[{key:"init",value:function(){this.store=new y.default(this.module),this.store.fetchCounts(["jobs","cronjobs"]),this.initWebsocket()}},{key:"getStatus",value:function(){return h.JOB_STATUS.map((function(e){return{text:t(e.text),value:e.value}}))}},{key:"renderHeader",value:function(){return f.default.createElement(S.default,(0,o.default)({module:this.module},this.props.match.params,{jobsCount:this.store.counts.jobs,cronjobsCount:this.store.counts.cronjobs}))}},{key:"renderExtraModals",value:function(){var e=this.state,t=e.createModal,a=e.editModal,n=e.selectItem,l=void 0===n?{}:n,r=this.store.isSubmitting;return f.default.createElement("div",null,f.default.createElement(w.default,{name:this.name,module:this.module,store:this.store,visible:t,steps:this.steps,formTemplate:this.formTemplate,isSubmitting:r,onOk:this.handleCreate,onCancel:this.hideModal("createModal")}),f.default.createElement(N.default,{visible:a,detail:l._originData,isSubmitting:r,onOk:this.handleEdit,onCancel:this.hideModal("editModal")}))}},{key:"module",get:function(){return"jobs"}},{key:"name",get:function(){return"Job"}},{key:"quotaKey",get:function(){return"count/jobs.batch"}},{key:"steps",get:function(){return E.default}},{key:"formTemplate",get:function(){var e=this.props.match.params.namespace;return(0,g.getFormTemplate)(e,this.module)}},{key:"itemActions",get:function(){return[{key:"edit",icon:"pen",text:t("EDIT"),action:"edit",onClick:this.showModal("editModal")},{key:"rerun",icon:"refresh",text:t("Rerun"),action:"edit",onClick:this.handleRerun},{key:"delete",icon:"trash",text:t("Delete"),action:"delete",onClick:this.showModal("deleteModal")}]}}]),a}(_.default))||r)||r;a.default=T},3487:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(49),r=n(a(2565)),o=n(a(2564)),u=n(a(2610)),i=n(a(2814)),s=n(a(2815)),d=[{title:"Basic Info",icon:"cdn",component:(0,l.withProps)(r.default,{maxNameLength:63}),required:!0},{title:"Job Settings",icon:"job",component:i.default,required:!0},{title:"Container Image",icon:"docker",component:s.default,required:!0},{title:"Mount Volumes",icon:"storage",component:o.default,required:!0},{title:"Advanced Settings",icon:"slider",component:u.default,required:!0}];t.default=d},3488:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){var a=e.data,n=e.module,l=(0,u.getWorkloadStatus)(a,n).status,i="Running"===l?"JobRunning":l;return r.default.createElement(o.default,{type:i,name:t(l),flicker:!0})};var r=l(n(0)),o=l(n(2521)),u=n(941)},3489:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.Component=a.default=void 0;var r=l(n(37)),o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=n(226),m=n(60),p=n(19),h=n(565),v=l(n(22)),g=n(49),y=n(114),E=l(n(2519)),b=l(n(2521)),_=l(n(2523)),S=l(n(3490)),k=l(n(2527)),C=l(n(2539)),w=l(n(940)),N=l(n(948)),T=function(e){function a(){var e,n;(0,o.default)(this,a);for(var l=arguments.length,u=new Array(l),d=0;d<l;d++)u[d]=arguments[d];return(n=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(u)))).unMountActions=function(){n.freshDisposer&&n.freshDisposer(),clearTimeout(n.freshTimer)},n.handleFresh=function(){var e=(0,h.parse)(location.search.slice(1));n.getData((0,r.default)({},e,{silent:!0}))},n.getColumns=function(){return[{title:t("Name"),dataIndex:"name",render:function(e,a){return c.default.createElement(E.default,{icon:y.ICON_TYPES[n.module],iconSize:40,title:(0,g.getDisplayName)(a),desc:a.serviceName?t("Build image for service x",{service:a.serviceName}):"-",to:"".concat(n.prefix,"/").concat(e)})}},{title:t("Status"),dataIndex:"status",isHideable:!0,width:"15%",render:function(e){var a=(0,v.default)(e,"lastRunState","");return a="Running"===a?"Building":a,c.default.createElement(b.default,{name:t(a||"Not running yet"),type:a||"Unknown",flicker:!0})}},{title:t("type"),dataIndex:"type",isHideable:!0,width:"15%",render:function(e){return t(e)}},{title:t("Service"),dataIndex:"serviceName",width:"15%",render:function(e){return e?c.default.createElement(f.Link,{to:"./services/".concat(e,"/")},e):"-"}},{title:t("Created Time"),dataIndex:"createTime",isHideable:!0,width:150,render:function(e){return(0,g.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}},{key:"more",width:20,render:n.renderMore}]},n}return(0,d.default)(a,e),(0,u.default)(a,[{key:"init",value:function(){var e=this;this.store=new N.default(this.module),this.freshDisposer=(0,p.reaction)((function(){return e.store.list.isLoading}),(function(){var t=e.store.list.data.some((function(e){return"Running"===(0,v.default)(e,"status.lastRunState","Running")}));clearTimeout(e.freshTimer),t&&(e.freshTimer=setTimeout(e.handleFresh,4e3))}),!0)}},{key:"renderHeader",value:function(){return c.default.createElement(_.default,{className:"margin-b12",title:t(this.title),description:t("IMAGE_BUILDER_DESC"),module:this.module,tips:this.tips})}},{key:"renderExtraModals",value:function(){var e=this.state,t=e.editModal,a=e.selectItem,n=void 0===a?{}:a,l=e.createModal,r=this.props.match.params.namespace;return c.default.createElement("div",null,c.default.createElement(C.default,{noCodeEdit:!0,namespace:r,name:this.name,module:this.module,store:this.store,visible:l,steps:this.steps,formTemplate:this.formTemplate,isSubmitting:this.store.isSubmitting,onOk:this.handleCreate,onCancel:this.hideModal("createModal")}),c.default.createElement(k.default,{visible:t,detail:n._originData,isSubmitting:this.store.isSubmitting,onOk:this.handleEdit,onCancel:this.hideModal("editModal")}))}},{key:"module",get:function(){return"s2ibuilders"}},{key:"name",get:function(){return"Image Builder"}},{key:"steps",get:function(){return S.default}},{key:"itemActions",get:function(){return[{key:"edit",icon:"pen",text:t("EDIT"),action:"edit",onClick:this.showModal("editModal")},{key:"delete",icon:"trash",text:t("Delete"),action:"delete",onClick:this.showModal("deleteModal")}]}},{key:"formTemplate",get:function(){var e=this.props.match.params.namespace;return w.default.s2ibuilders({namespace:e})}}]),a}(l(n(2518)).default),P=(0,m.inject)("rootStore")((0,m.observer)(T));a.default=P;var M=T;a.Component=M},3490:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(3491)),r=n(a(2633)),o=[{title:"Choose a language",component:l.default},{title:"Build Settings",component:r.default,required:!0}];t.default=o},3491:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(30)),o=l(n(97)),u=l(n(61)),i=l(n(62)),s=l(n(13)),d=l(n(14)),c=l(n(17)),f=l(n(16)),m=l(n(18)),p=l(n(0)),h=l(n(115)),v=l(n(22)),g=l(n(566)),y=l(n(1)),E=n(114),b=l(n(3)),_=l(n(267)),S=l(n(38)),k=l(n(948)),C=n(2566),w=l(n(2633)),N=l(n(2671)),T=l(n(3499)),P=function(e){function a(e){var t;return(0,s.default)(this,a),(t=(0,c.default)(this,(0,f.default)(a).call(this,e))).fetchData=(0,i.default)(u.default.mark((function e(){var a;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.store.getS2iSupportLanguage();case 2:a=e.sent,t.setState(a);case 4:case"end":return e.stop()}}),e)}))),t.handleLanguageSelect=function(e,a){return function(){var n=t.props.steps;"b2i"===a&&((0,h.default)(n,"[1].component",N.default),(0,h.default)(t.props.formTemplate,'metadata.labels["s2i-type.kubesphere.io"]',"b2i"),(0,h.default)(t.props.formTemplate,"spec.config.isBinaryURL",!0)),"s2i"===a&&((0,h.default)(n,"[1].component",w.default),(0,h.default)(t.props.formTemplate,'metadata.labels["s2i-type.kubesphere.io"]',"s2i"),(0,g.default)(t.props.formTemplate,"spec.config.isBinaryURL")),t.context.setSteps(n),(0,h.default)(t.props.formTemplate,"metadata.annotations.languageType",e),t.forceUpdate()}},t.store=new k.default,t.state={s2i:(0,o.default)(E.S2i_SUPPORTED_TYPES),b2i:(0,o.default)(E.B2I_SUPPORTED_TYPES)},t}return(0,m.default)(a,e),(0,d.default)(a,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e=this,a=this.props,n=a.formTemplate,l=a.formRef,o=(0,v.default)(this.props.formTemplate,"metadata.annotations.languageType"),u=(0,v.default)(this.props.formTemplate,'metadata.labels["s2i-type.kubesphere.io"]',"s2i");return p.default.createElement(_.default,{ref:l,data:n},p.default.createElement("div",{className:T.default.header},p.default.createElement("p",null,t("IMAGE_FROM_S2I")),p.default.createElement("p",null,t("S2I_DESC"))),p.default.createElement("ul",{className:T.default.content},this.state.s2i.map((function(t){return p.default.createElement("li",{key:t,className:(0,b.default)(T.default.item,(0,r.default)({},T.default.item_select,o===t&&"s2i"===u)),onClick:e.handleLanguageSelect(t,"s2i")},p.default.createElement(S.default,{name:(0,C.getLanguageIcon)(t,"radio"),size:48}),p.default.createElement("p",null,t))}))),p.default.createElement("div",{className:T.default.header},p.default.createElement("p",null,t("IMAGE_FROM_B2I")),p.default.createElement("p",null,t("B2I_DESC"))),p.default.createElement("ul",{className:T.default.content},this.state.b2i.map((function(t){return p.default.createElement("li",{key:t,className:(0,b.default)(T.default.item,(0,r.default)({},T.default.item_select,o===t&&"b2i"===u)),onClick:e.handleLanguageSelect(t,"b2i")},p.default.createElement(S.default,{name:(0,C.getLanguageIcon)(t,"radio"),size:48}),p.default.createElement("p",null,t))}))))}}]),a}(p.default.Component);a.default=P,P.contextTypes={setSteps:y.default.func}},3492:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(22)),c=l(n(0)),f=l(n(1)),m=l(n(386)),p=l(n(225)),h=l(n(3493)),v=l(n(2545)),g=function(e){function a(){var e,t;(0,r.default)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(t=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(l)))).handleChange=function(e){var a=t.props.options,n=(0,d.default)(e,"name"),l=a.find((function(e){return e.key===n}));t.key!==n&&(e.value=(0,d.default)(l,"defaultValue","")),t.props.onChange(e),t.key=n},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props,a=e.value,n=e.options;return c.default.createElement(v.default,{value:a,onChange:this.handleChange},c.default.createElement(p.default,{name:"name",placeholder:t("key"),options:n}),"boolean"===this.valueType?c.default.createElement(h.default,{name:"value",placeholder:t("value")}):c.default.createElement(m.default,{name:"value",placeholder:t("value")}))}},{key:"valueType",get:function(){var e=this.props,t=e.value,a=e.options,n=(0,d.default)(t,"name",""),l=a.find((function(e){return e.key===n}));return(0,d.default)(l,"type","string")}}]),a}(c.default.Component);a.default=g,g.propTypes={value:f.default.object,onChange:f.default.func,configMaps:f.default.array,secrets:f.default.array},g.defaultProps={value:{},onChange:function(){}}},3493:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(70)),r=n(a(63)),o=n(a(13)),u=n(a(14)),i=n(a(17)),s=n(a(16)),d=n(a(18)),c=n(a(0)),f=n(a(225)),m=function(e){function t(){var e,a;(0,o.default)(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(a=(0,i.default)(this,(e=(0,s.default)(t)).call.apply(e,[this].concat(l)))).handleChange=function(e,t){var n=a.props.onChange;n&&n(e&&"true"===e,t)},a}return(0,d.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e=this.props,t=e.value,a=(e.onChange,(0,r.default)(e,["value","onChange"]));return c.default.createElement(f.default,(0,l.default)({value:String(t),onChange:this.handleChange},a))}}]),t}(c.default.Component);t.default=m,m.defaultProps={options:[{label:"true",value:"true"},{label:"false",value:"false"}]}},3494:function(e,t,a){e.exports={form:"TemplateSelect__form--37rWu",leftIcon:"TemplateSelect__leftIcon--1hPE6",loading:"TemplateSelect__loading--1e2aJ"}},3495:function(e,t,a){e.exports={columns:"S2IForm__columns--2SXJv",column:"S2IForm__column--12uxU",columsEdit:"S2IForm__columsEdit--3Q05k",margin_b_10:"S2IForm__margin_b_10--3Z3e-",disabled:"S2IForm__disabled--1ox4o"}},3496:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(70)),o=l(n(37)),u=l(n(61)),i=l(n(62)),s=l(n(30)),d=l(n(13)),c=l(n(14)),f=l(n(17)),m=l(n(16)),p=l(n(18)),h=l(n(0)),v=l(n(38)),g=l(n(2499)),y=l(n(2606)),E=l(n(388)),b=l(n(393)),_=l(n(22)),S=l(n(115)),k=l(n(3)),C=n(49),w=n(114),N=l(n(948)),T=l(n(3497)),P={"x-kubernetes-action":"post","x-kubernetes-group-version-kind":'{"group":"devops.kubesphere.io","version":"v1alpha1","kind":"S2iBinary"}'},M=function(e){function a(e){var n;(0,d.default)(this,a),(n=(0,f.default)(this,(0,m.default)(a).call(this,e))).formatFileName=function(e){return n.binaryName=e.toLowerCase().replace(/([^a-zA-Z0-9])/g,"-")+Math.random().toString(36).slice(-4),n.binaryName},n.setFileStatus=function(e,t){n.setState((function(a){return{files:Object.assign({},a.files,(0,s.default)({},e,Object.assign({},a.files[e],t)))}}))},n.getUploadUrl=function(){return"/kapis/devops.kubesphere.io/v1alpha2/namespaces/".concat(n.props.namespace,"/s2ibinaries/").concat(n.binaryName,"/file")},n.beforeUploadHandler=function(){var e=(0,i.default)(u.default.mark((function e(a){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if([a.name.slice(a.name.lastIndexOf(".")+1),"binary",""].includes(n.filesType)){e.next=4;break}return E.default.error(t("WRONG_FILE_EXTENSION_NAME",{type:n.filesType})),e.abrupt("return",Promise.reject(t("WRONG_FILE_EXTENSION_NAME",{type:n.filesType})));case 4:return e.next=6,n.store.creatBinary(n.formatFileName(a.name),n.props.namespace);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.startHandler=function(e){n.setFileStatus(e.uid,{size:e.size,name:e.name,showProgress:!0,showFile:!1,percentage:0,status:"active"})},n.progressHandler=function(e,t){var a=(0,b.default)(e.percent)?Math.round(e.percent):0;n.setFileStatus(t.uid,{size:t.size,percentage:100===a?99:a,status:"active"})},n.successHandler=function(e,a){var l={name:a.name,size:a.size,showProgress:!1,showFile:!0,percentage:100,status:"active"};n.setFileStatus(a.uid,l),n.props.onChange((0,_.default)(e,"spec.downloadURL")),(0,S.default)(n.props.formTemplate,'metadata.annotations.["kubesphere.io/file"]',JSON.stringify(l)),E.default.success({content:t("Upload file success")}),n.props.uploadSuccess&&n.props.uploadSuccess()},n.errorHandler=function(e,a,l){n.setFileStatus(l.uid,{size:l.size,showProgress:!0,showFile:!1,status:"exception"}),E.default.error({content:t("Upload file failed")})},n.handleReUpload=function(){Object.keys(n.state.files).forEach((function(e){n.uploader.abort(e)})),n.setState({files:{}}),n.props.onChange(""),n.uploader.onClick()},n.store=new N.default;var l={};return n.filesType&&"binary"!==n.filesType&&(l={accept:".".concat(n.filesType)}),n.uploaderProps=(0,o.default)({name:"s2ibinary",method:"put",action:n.getUploadUrl,multiple:!1,headers:P},l,{beforeUpload:n.beforeUploadHandler,onStart:n.startHandler,onSuccess:n.successHandler,onProgress:n.progressHandler,onError:n.errorHandler}),n.state={files:n.uploadedfile?{default:JSON.parse(n.uploadedfile)}:{}},n}return(0,p.default)(a,e),(0,c.default)(a,[{key:"renderProgress",value:function(e){var a=this.state.files[e];return h.default.createElement("div",{className:T.default.uploadingContent,key:e},h.default.createElement("p",{className:T.default.fileInfo},h.default.createElement("span",{className:T.default.fileName},a.name),h.default.createElement("span",{className:T.default.uploadText},t("Upload percent"),": ",a.percentage,"%"),h.default.createElement("span",{className:T.default.uploadText},t("File size"),": ",(0,C.formatSize)(a.size))),h.default.createElement(g.default,{className:T.default.progress,percent:a.percentage,strokeWidth:8,key:e,showInfo:!1}))}},{key:"renderFileItem",value:function(e){var a=this.state.files[e];return h.default.createElement("div",{className:T.default.uploadingContent,key:e},h.default.createElement("p",{className:T.default.fileInfo},h.default.createElement("span",{className:T.default.fileName},a.name),h.default.createElement("span",{className:T.default.uploadText},t("Upload percent"),": 100%"),h.default.createElement("span",{className:T.default.uploadText},t("File size"),": ",(0,C.formatSize)(a.size))),h.default.createElement(g.default,{className:T.default.progress,percent:100,strokeWidth:8,showInfo:!1}))}},{key:"render",value:function(){var e=this,a=this.state.files,n=Object.keys(a).length;return h.default.createElement("div",{className:T.default.container},h.default.createElement(y.default,(0,r.default)({},this.uploaderProps,{ref:function(t){e.uploader=t}}),h.default.createElement("div",{className:(0,k.default)(T.default.selectContainer,(0,s.default)({},T.default.none,n))},h.default.createElement(v.default,{className:T.default.icon,size:40,name:this.filesType,type:"coloured"}),h.default.createElement("p",{className:T.default.title},t("Click to select the artifact file to upload")),h.default.createElement("p",{className:T.default.desc},t("".concat(this.filesType.toUpperCase()||"B2I_DEFAULT","_DESC"))))),h.default.createElement("div",{className:(0,k.default)(T.default.uploadContainer,(0,s.default)({},T.default.none,!n))},h.default.createElement(v.default,{className:T.default.icon,size:40,name:this.filesType,type:"coloured"}),Object.keys(a).map((function(t){return a[t]?a[t].showProgress?e.renderProgress(t):a[t].showFile?e.renderFileItem(t):null:null})),h.default.createElement(v.default,{changeable:!0,name:"upload",onClick:this.handleReUpload,className:T.default.uploadIcon})))}},{key:"filesType",get:function(){var e=(0,_.default)(this.props.formTemplate,"metadata.annotations.languageType");return e&&w.B2I_SUPPORTED_TYPES.includes(e)?e:""}},{key:"uploadedfile",get:function(){return(0,_.default)(this.props.formTemplate,'metadata.annotations.["kubesphere.io/file"]')}}]),a}(h.default.Component);a.default=M},3497:function(e,t,a){e.exports={container:"BinaryFileUploader__container--3Q2I8",selectContainer:"BinaryFileUploader__selectContainer--eTpjm",icon:"BinaryFileUploader__icon--3x-lr",title:"BinaryFileUploader__title--2tmR_",desc:"BinaryFileUploader__desc--FXOj4",uploadContainer:"BinaryFileUploader__uploadContainer--q0ATR",uploadingContent:"BinaryFileUploader__uploadingContent--2Zv4m",fileInfo:"BinaryFileUploader__fileInfo--1d0Ay",fileName:"BinaryFileUploader__fileName--1WqNW",uploadText:"BinaryFileUploader__uploadText--d5T4K",progress:"BinaryFileUploader__progress--2wAli",uploadIcon:"BinaryFileUploader__uploadIcon--3nkK-",none:"BinaryFileUploader__none--3YZ9-"}},3498:function(e,t,a){e.exports={title:"B2IForm__title--2POj-",columns:"B2IForm__columns--1-bH8",column:"B2IForm__column--1OrC_",columsEdit:"B2IForm__columsEdit--GINt-",environment_info:"B2IForm__environment_info--3KXoN"}},3499:function(e,t,a){e.exports={header:"LanguageSelect__header--UF0cy",content:"LanguageSelect__content--3nX5v",item_select:"LanguageSelect__item_select--1-Jk3"}},3500:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(70)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(0)),m=n(60),p=n(49),h=n(114),v=n(941),g=n(940),y=l(n(2519)),E=l(n(3501)),b=l(n(2536)),_=l(n(2518)),S=l(n(2816)),k=l(n(2569)),C=l(n(2813)),w=l(n(2539)),N=l(n(2527)),T=l(n(2526)),P=(0,m.inject)("rootStore")(r=(0,m.observer)(r=function(e){function a(){var e,n;(0,u.default)(this,a);for(var l=arguments.length,r=new Array(l),o=0;o<l;o++)r[o]=arguments[o];return(n=(0,s.default)(this,(e=(0,d.default)(a)).call.apply(e,[this].concat(r)))).handleSwitch=function(e){return function(t){n.store.switch(t,e).then((function(){n.getData()}))}},n.getItemDesc=function(e){var a=(0,v.getWorkloadStatus)(e,n.module),l=a.status,r=a.reason;return r?f.default.createElement(k.default,{status:l,reason:t(r),data:e}):e.description||"-"},n.getColumns=function(){return[{title:t("Name"),dataIndex:"name",sorter:!0,sortOrder:n.getSortOrder("name"),search:!0,render:function(e,t){return f.default.createElement(y.default,{icon:h.ICON_TYPES[n.module],iconSize:40,title:(0,p.getDisplayName)(t),desc:n.getItemDesc(t),to:"".concat(n.prefix,"/").concat(e)})}},{title:t("Status"),dataIndex:"status",filters:n.getStatus(),filteredValue:n.getFilteredValue("status"),isHideable:!0,search:!0,width:"20%",render:n.renderStatus},{title:t("Schedule"),dataIndex:"spec.schedule",isHideable:!0,search:!0,width:"20%"},{title:t("Created Time"),dataIndex:"createTime",sorter:!0,sortOrder:n.getSortOrder("createTime"),isHideable:!0,search:!0,width:150,render:function(e){return(0,p.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}},{key:"more",width:20,render:n.renderMore}]},n.handleYamlEdit=function(e){var t=n.state.selectItem;n.store.update(t,e).then((function(){n.hideModal("editYamlModal")()}))},n.renderStatus=function(e,t){return f.default.createElement(C.default,{data:t,module:n.module})},n}return(0,c.default)(a,e),(0,i.default)(a,[{key:"init",value:function(){this.store=new b.default(this.module),this.initWebsocket()}},{key:"getStatus",value:function(){return h.CRONJOB_STATUS.map((function(e){return{text:t(e.text),value:e.value}}))}},{key:"renderHeader",value:function(){return f.default.createElement(S.default,(0,o.default)({module:this.module},this.props.match.params,{count:this.store.list.total}))}},{key:"renderExtraModals",value:function(){var e=this.state,t=e.createModal,a=e.editModal,n=e.editYamlModal,l=e.selectItem,r=void 0===l?{}:l,o=this.store.isSubmitting;return f.default.createElement("div",null,f.default.createElement(w.default,{name:this.name,module:this.module,store:this.store,visible:t,steps:this.steps,formTemplate:this.formTemplate,isSubmitting:o,onOk:this.handleCreate,onCancel:this.hideModal("createModal")}),f.default.createElement(T.default,{store:this.store,visible:n,detail:r._originData,isSubmitting:o,onOk:this.handleYamlEdit,onCancel:this.hideModal("editYamlModal")}),f.default.createElement(N.default,{visible:a,detail:r._originData,isSubmitting:o,onOk:this.handleEdit,onCancel:this.hideModal("editModal")}))}},{key:"module",get:function(){return"cronjobs"}},{key:"name",get:function(){return"CronJob"}},{key:"steps",get:function(){return E.default}},{key:"formTemplate",get:function(){var e=this.props.match.params.namespace;return(0,g.getFormTemplate)(e,this.module)}},{key:"itemActions",get:function(){return[{key:"edit",icon:"pen",text:t("EDIT"),action:"edit",onClick:this.showModal("editModal")},{key:"editYaml",icon:"pen",text:t("Edit YAML"),action:"edit",onClick:this.showModal("editYamlModal")},{show:function(e){return e.suspend},key:"start",icon:"start",text:t("Start"),action:"edit",onClick:this.handleSwitch(!0)},{show:function(e){return!e.suspend},key:"pause",icon:"stop",text:t("Pause"),action:"edit",onClick:this.handleSwitch(!1)},{key:"delete",icon:"trash",text:t("Delete"),action:"delete",onClick:this.showModal("deleteModal")}]}}]),a}(_.default))||r)||r;a.default=P},3501:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(49),r=n(a(3502)),o=n(a(2814)),u=n(a(2815)),i=n(a(2564)),s=n(a(2610)),d=[{title:"Basic Info",icon:"cdn",component:r.default,required:!0},{title:"CronJob Settings",icon:"cron-job",component:(0,l.withProps)(o.default,{prefix:"spec.jobTemplate.spec."}),required:!0},{title:"Container Image",icon:"docker",component:(0,l.withProps)(u.default,{prefix:"spec.jobTemplate.spec.template."}),required:!0},{title:"Mount Volumes",icon:"storage",component:(0,l.withProps)(i.default,{prefix:"spec.jobTemplate.spec.template."}),required:!0},{title:"Advanced Settings",icon:"slider",component:s.default,required:!0}];t.default=d},3502:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(22)),c=l(n(115)),f=l(n(268)),m=l(n(0)),p=n(938),h=l(n(386)),v=l(n(2453)),g=l(n(225)),y=l(n(267)),E=l(n(2530)),b=l(n(2804)),_=l(n(2590)),S=n(114),k=function(e){function a(){var e,n;(0,r.default)(this,a);for(var l=arguments.length,o=new Array(l),s=0;s<l;s++)o[s]=arguments[s];return(n=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(o)))).handleNameChange=(0,f.default)((function(e){var t=(0,d.default)(n.formTemplate,"metadata.labels",{});t.app=e,(0,c.default)(n.formTemplate,"spec.jobTemplate.metadata.labels",t)}),200),n.nameValidator=function(e,a,l){if(!a)return l();n.props.store.checkName({name:a,namespace:n.namespace}).then((function(a){if(a.exist)return l({message:t("Name exists"),field:e.field});l()}))},n.getConcurrencyPolicyOptions=function(){return[{label:"Allow",value:"Allow"},{label:"Forbid",value:"Forbid"},{label:"Replace",value:"Replace"}]},n}return(0,s.default)(a,e),(0,o.default)(a,[{key:"getCronOptions",value:function(){return[{label:"0 * * * * (".concat(t("Every Hour"),")"),value:"0 * * * *"},{label:"0 0 * * * (".concat(t("Every Day"),")"),value:"0 0 * * *"},{label:"0 0 * * 0 (".concat(t("Every Week"),")"),value:"0 0 * * 0"},{label:"0 0 1 * * (".concat(t("Every Month"),")"),value:"0 0 1 * *"}]}},{key:"render",value:function(){var e=this.props.formRef;return m.default.createElement(y.default,{data:this.formTemplate,ref:e},m.default.createElement(p.Columns,null,m.default.createElement(p.Column,null,m.default.createElement(y.default.Item,{label:t("Name"),desc:t("CRONJOB_NAME_DESC"),rules:[{required:!0,message:t("Please input name")},{pattern:S.PATTERN_NAME,message:"".concat(t("Invalid name"),", ").concat(t("CRONJOB_NAME_DESC"))},{pattern:S.PATTERN_LENGTH_52,message:t("CRONJOB_NAME_TOO_LONG")},{validator:this.nameValidator}]},m.default.createElement(h.default,{name:"metadata.name",onChange:this.handleNameChange,autoFocus:!0}))),m.default.createElement(p.Column,null,m.default.createElement(y.default.Item,{label:t("Alias"),desc:t("ALIAS_DESC")},m.default.createElement(h.default,{name:"metadata.annotations['kubesphere.io/alias-name']"})))),m.default.createElement(p.Columns,null,m.default.createElement(p.Column,null,m.default.createElement(y.default.Item,{label:t("Description")},m.default.createElement(v.default,{name:"metadata.annotations['kubesphere.io/description']"}))),m.default.createElement(p.Column,null,m.default.createElement(y.default.Item,{label:t("Schedule"),desc:t.html("CRONJOB_CRON_DESC"),rules:[{required:!0,message:t("Please input schedule")}]},m.default.createElement(b.default,{name:"spec.schedule",options:this.getCronOptions()})))),m.default.createElement(_.default,null,m.default.createElement(p.Columns,{className:"margin-t8"},m.default.createElement(p.Column,null,m.default.createElement(y.default.Item,{label:t("startingDeadlineSeconds(s)"),desc:t("START_DEADLINE_SECONDS_DESC")},m.default.createElement(E.default,{min:0,name:"spec.startingDeadlineSeconds",integer:!0})),m.default.createElement(y.default.Item,{label:t("failedJobsHistoryLimit"),desc:t("Number of failed jobs allowed to be retained")},m.default.createElement(E.default,{min:0,name:"spec.failedJobsHistoryLimit",integer:!0}))),m.default.createElement(p.Column,null,m.default.createElement(y.default.Item,{label:t("successfulJobsHistoryLimit"),desc:t("Number of success jobs allowed to be retained")},m.default.createElement(E.default,{min:0,name:"spec.successfulJobsHistoryLimit",integer:!0})),m.default.createElement(y.default.Item,{label:t("concurrencyPolicy"),desc:t("Concurrency policy settings")},m.default.createElement(g.default,{name:"spec.concurrencyPolicy",options:this.getConcurrencyPolicyOptions()}))))))}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,d.default)(t,S.MODULE_KIND_MAP[a],t)}},{key:"namespace",get:function(){return(0,d.default)(this.formTemplate,"metadata.namespace")}}]),a}(m.default.Component);a.default=k},3503:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=n(60),m=n(49),p=n(114),h=n(940),v=l(n(947)),g=l(n(2536)),y=l(n(2518)),E=l(n(2586)),b=l(n(2519)),_=l(n(388)),S=l(n(2526)),k=l(n(2527)),C=l(n(2819)),w=l(n(3505)),N=l(n(2822)),T=l(n(2823)),P=(0,f.inject)("rootStore")(r=(0,f.observer)(r=function(e){function a(){var e,n;(0,o.default)(this,a);for(var l=arguments.length,r=new Array(l),u=0;u<l;u++)r[u]=arguments[u];return(n=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(r)))).getColumns=function(){return[{title:t("Name"),dataIndex:"name",sorter:!0,sortOrder:n.getSortOrder("name"),search:!0,width:"24%",render:function(e,t){return c.default.createElement(b.default,{icon:p.ICON_TYPES[n.module],iconSize:40,title:(0,m.getDisplayName)(t),desc:t.description||"-",to:"".concat(n.prefix,"/").concat(e)})}},{title:t("Service Type"),dataIndex:'annotations["kubesphere.io/serviceType"]',isHideable:!0,width:"16%",render:function(e,a){return c.default.createElement(E.default,{title:e?t("SERVICE_TYPE_".concat(e.toUpperCase())):t("Custom Creation"),description:a.type||"-"})}},{title:t("Internet Access"),dataIndex:"specType",isHideable:!0,width:"20%",render:function(e,t){return"ClusterIP"===e?"-":"NodePort"===e?c.default.createElement(E.default,{description:e,title:t.ports.filter((function(e){return e.nodePort})).map((function(e){return"".concat(e.port,":").concat(e.nodePort,"/").concat(e.protocol)})).join(";")}):c.default.createElement(E.default,{description:e,title:t.loadBalancerIngress||t.externalName})}},{title:t("Application"),dataIndex:"app.kubernetes.io/name",isHideable:!0,search:!0,width:"16%",render:function(e,t){return t.app}},{title:t("Created Time"),dataIndex:"createTime",sorter:!0,sortOrder:n.getSortOrder("createTime"),isHideable:!0,width:150,render:function(e){return(0,m.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}},{key:"more",width:20,render:n.renderMore}]},n.handleYamlEdit=function(e){var t=n.state.selectItem;n.store.update(t,e).then((function(){n.hideModal("editYamlModal")(),n.routing.query()}))},n.handleEditGateway=function(e){var a=n.state.selectItem;n.store.update(a,e).then((function(){n.hideModal("editGatewayModal")(),_.default.success({content:"".concat(t("Updated Successfully"),"!")}),n.routing.query()}))},n.handleEditService=function(e){var a=n.state.selectItem;n.store.update(a,e).then((function(){n.hideModal("editServiceModal")(),_.default.success({content:"".concat(t("Updated Successfully"),"!")}),n.routing.query()}))},n}return(0,d.default)(a,e),(0,u.default)(a,[{key:"init",value:function(){this.store=new v.default(this.module),this.workloadStore=new g.default}},{key:"renderModals",value:function(){var e=this,t=this.store.isSubmitting,a=this.state,n=a.createModal,l=a.editModal,r=a.editYamlModal,o=a.editGatewayModal,u=a.editServiceModal,i=a.deleteModal,s=a.batchDeleteModal,d=a.selectItem,f=void 0===d?{}:d,m=this.props.match.params.namespace;return c.default.createElement(c.default.Fragment,null,c.default.createElement(w.default,{visible:n,namespace:m,store:this.store,workloadStore:this.workloadStore,isSubmitting:t,onOk:this.handleCreate,onCancel:this.hideModal("createModal")}),c.default.createElement(T.default,{resource:f,visible:i,onOk:this.handleDelete,onCancel:this.hideModal("deleteModal"),isSubmitting:t}),this.list.selectedRowKeys&&c.default.createElement(T.default,{resource:this.list.data.filter((function(t){return e.list.selectedRowKeys.includes(t.name)})),visible:s,onOk:this.handleBatchDelete,onCancel:this.hideModal("batchDeleteModal"),isSubmitting:t}),c.default.createElement(k.default,{visible:l,detail:f._originData,isSubmitting:t,onOk:this.handleEdit,onCancel:this.hideModal("editModal")}),c.default.createElement(S.default,{store:this.store,visible:r,detail:f._originData,isSubmitting:t,onOk:this.handleYamlEdit,onCancel:this.hideModal("editYamlModal")}),c.default.createElement(C.default,{visible:o,detail:f._originData,onOk:this.handleEditGateway,onCancel:this.hideModal("editGatewayModal"),isSubmitting:t}),c.default.createElement(N.default,{visible:u,detail:f._originData,type:f.type,onOk:this.handleEditService,onCancel:this.hideModal("editServiceModal"),isSubmitting:t}))}},{key:"module",get:function(){return"services"}},{key:"name",get:function(){return"Service"}},{key:"formTemplate",get:function(){var e=this.props.match.params.namespace;return(0,h.getFormTemplate)(e,this.module)}},{key:"tips",get:function(){return[{title:t("SERVICE_TYPES_Q"),description:t("SERVICE_TYPES_A")},{title:t("SCENARIOS_FOR_SERVICES_Q"),description:t("SCENARIOS_FOR_SERVICES_A")}]}},{key:"itemActions",get:function(){return[{key:"edit",icon:"pen",text:t("EDIT"),action:"edit",onClick:this.showModal("editModal")},{key:"editYaml",icon:"pen",text:t("Edit YAML"),action:"edit",onClick:this.showModal("editYamlModal")},{key:"editService",icon:"network-router",text:t("Edit Service"),action:"edit",onClick:this.showModal("editServiceModal")},{key:"editGateway",icon:"ip",text:t("Edit Internet Access"),action:"edit",show:function(e){return e.type===p.SERVICE_TYPES.VirtualIP},onClick:this.showModal("editGatewayModal")},{key:"delete",icon:"trash",text:t("Delete"),action:"delete",onClick:this.showModal("deleteModal")}]}}]),a}(y.default))||r)||r;a.default=P},3504:function(e,t,a){e.exports={wrapper:"ServiceGatewaySetting__wrapper--3TA3Q",title:"ServiceGatewaySetting__title--2xJak",contentWrapper:"ServiceGatewaySetting__contentWrapper--AdN2o",option:"ServiceGatewaySetting__option--36a3_"}},3505:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(61)),o=l(n(62)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(97)),m=l(n(0)),p=l(n(38)),h=l(n(115)),v=l(n(387)),g=l(n(2539)),y=l(n(948)),E=l(n(3506)),b=l(n(940)),_=n(2566),S=n(114),k=l(n(3528)),C=[{name:"Service Type",description:"SERVICE_TYPE",options:[{icon:"backup",name:"Stateless Service",value:"statelessservice"},{icon:"stateful-set",name:"Stateful Service",value:"statefulservice"},{icon:"ip",name:"External Service",value:"externalservice"}]}].concat((0,f.default)(globals.app.hasKSModule("devops")?[{name:"SERVICE_FROM_CODE",type:"s2i",description:"SERVICE_FROM_CODE_DESC",options:S.S2i_SUPPORTED_TYPES},{name:"SERVICE_FROM_ARTIFACTS",type:"b2i",description:"SERVICE_FROM_ARTIFACTS_DESC",options:S.B2I_SUPPORTED_TYPES}]:[]),[{name:"Custom Creation",description:"SERVICE_CUSTOM_CREATE",options:[{icon:"clock",name:"Specify Workloads",value:"simpleservice"},{icon:"coding",name:"Edit by YAML",value:"yaml"}]}]),w=function(e){function a(e){var t;return(0,u.default)(this,a),(t=(0,s.default)(this,(0,d.default)(a).call(this,e))).fetchData=(0,o.default)(r.default.mark((function e(){var a,n;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.store.getS2iSupportLanguage();case 2:a=e.sent,n=t.state.groups.map((function(e){return"b2i"===e.type&&(e.options=a.b2i),"s2i"===e.type&&(e.options=a.s2i),e})),t.setState({groups:n});case 5:case"end":return e.stop()}}),e)}))),t.handleTypeSelect=function(e){t.setState({type:e.currentTarget.dataset.value,s2iType:e.currentTarget.dataset.type})},t.handleWorkloadModuleChange=function(e){t.setState({workloadModule:e})},t.store=new y.default,t.state={type:"",workloadModule:"deployments",groups:C},t}return(0,c.default)(a,e),(0,i.default)(a,[{key:"componentDidMount",value:function(){globals.app.hasKSModule("devops")&&this.fetchData()}},{key:"componentWillReceiveProps",value:function(e){e.visible||this.setState({type:"",workloadModule:"deployments"})}},{key:"renderHeader",value:function(){return m.default.createElement("div",{className:k.default.header},m.default.createElement("div",{className:"h4 margin-b12"},t("Create Service")),m.default.createElement("p",null,t.html("SERVICE_CREATE_DESC")),m.default.createElement("img",{src:"/assets/create-service.svg",alt:""}))}},{key:"renderGroups",value:function(){var e=this;return m.default.createElement("div",{className:k.default.groups},this.state.groups.map((function(a){return m.default.createElement("div",{key:a.name,className:k.default.group},m.default.createElement("div",{className:k.default.title},m.default.createElement("div",null,t(a.name)),m.default.createElement("p",null,t(a.description))),m.default.createElement("ul",null,a.options.map((function(n){return m.default.createElement("li",{key:n.value||n,"data-value":n.value||n,"data-type":a.type,onClick:e.handleTypeSelect},m.default.createElement("div",null,m.default.createElement(p.default,{name:n.icon||(0,_.getLanguageIcon)(n,"radio"),size:48})),m.default.createElement("div",null,t(n.name||n)))}))))})))}},{key:"renderSubModal",value:function(e,a){var n,l=this.props,r=l.store,o=l.workloadStore,u=l.visible,i=l.onOk,s=l.onCancel,d=l.namespace,c=l.isSubmitting;if(a){var f="s2i"===a,p={S2i:b.default.s2ibuilders({namespace:d,isS2i:f,languageType:e}),Deployment:b.default.deployments({namespace:d}),Service:b.default.services({namespace:d})},v=f?E.default.s2iservice:E.default.b2iservice,y="".concat(f?t("Language Type"):t("Artifacts Type")," : ").concat(t(e));return m.default.createElement(g.default,{icon:e,title:f?t("SERVICE_FROM_CODE"):t("SERVICE_FROM_ARTIFACTS"),description:y,width:960,module:this.state.workloadModule,store:o,name:t("Stateless Service"),visible:u,steps:v,formTemplate:p,isSubmitting:c,updateModule:this.handleWorkloadModuleChange,onOk:i,onCancel:s,noCodeEdit:!0})}switch(e){case"statelessservice":var _={Deployment:b.default.deployments({namespace:d}),Service:b.default.services({namespace:d})};(0,h.default)(_,'Service.metadata.annotations["kubesphere.io/serviceType"]',e),o.setModule("deployments"),n=m.default.createElement(g.default,{width:960,module:"deployments",store:o,name:t("Stateless Service"),description:t("STATELESS_SERVICE_DESC"),visible:u,steps:E.default[e],formTemplate:_,isSubmitting:c,onOk:i,onCancel:s});break;case"statefulservice":var S={StatefulSet:b.default.statefulsets({namespace:d}),Service:b.default.services({namespace:d})};(0,h.default)(S,'Service.metadata.annotations["kubesphere.io/serviceType"]',e),o.setModule("statefulsets"),n=m.default.createElement(g.default,{width:960,module:"statefulsets",store:o,name:t("Stateful Service"),description:t("STATEFUL_SERVICE_DESC"),visible:u,steps:E.default[e],formTemplate:S,isSubmitting:c,onOk:i,onCancel:s});break;case"simpleservice":case"externalservice":var k={Service:b.default.services({namespace:d})},C="externalservice"===e?"".concat(t("Create ")).concat(t("External Service")):t("Create service by specify workloads"),w="externalservice"===e?t("SERVICE_EXTERNAL_NAME_DESC"):t("SERVISE_SIMPLE_DESC");"externalservice"===e&&(0,h.default)(k,'Service.metadata.annotations["kubesphere.io/serviceType"]',e),n=m.default.createElement(g.default,{width:960,module:"services",store:r,title:C,description:w,visible:u,steps:E.default[e],formTemplate:k,isSubmitting:c,onOk:i,onCancel:s});break;case"yaml":var N={Service:b.default.services({namespace:d})},T=t("Create service by yaml");n=m.default.createElement(g.default,{width:960,module:"services",store:r,title:T,visible:u,formTemplate:N,isSubmitting:c,onOk:i,onCancel:s,onlyCode:!0})}return n}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onCancel,n=this.state,l=n.type,r=n.s2iType;return l?this.renderSubModal(l,r):m.default.createElement(v.default,{bodyClassName:k.default.body,width:960,visible:t,onCancel:a,hideHeader:!0,hideFooter:!0},this.renderHeader(),this.renderGroups())}}]),a}(m.default.Component);a.default=w},3506:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(49),r=n(a(3507)),o=n(a(2574)),u=n(a(2564)),i=n(a(3508)),s=n(a(2820)),d=n(a(2672)),c=n(a(3521)),f=n(a(2671)),m=n(a(2633)),p=n(a(3523)),h={statelessservice:[{title:"Basic Info",icon:"cdn",component:r.default,required:!0},{title:"Container Image",icon:"docker",component:(0,l.withProps)(o.default,{withService:!0}),required:!0},{title:"Mount Volumes",icon:"storage",component:u.default,required:!0},{title:"Advanced Settings",icon:"slider",component:i.default,required:!0}],statefulservice:[{title:"Basic Info",icon:"cdn",component:r.default,required:!0},{title:"Container Image",icon:"docker",component:(0,l.withProps)(o.default,{withService:!0}),required:!0},{title:"Mount Volumes",icon:"storage",component:u.default,required:!0},{title:"Advanced Settings",icon:"slider",component:i.default,required:!0}],externalservice:[{title:"Basic Info",icon:"cdn",component:(0,l.withProps)(r.default,{noWorkload:!0}),required:!0},{title:"External Name",icon:"strategy-group",component:s.default,required:!0}],simpleservice:[{title:"Basic Info",icon:"cdn",component:(0,l.withProps)(r.default,{noWorkload:!0}),required:!0},{title:"Service Settings",component:d.default,required:!0},{title:"Advanced Settings",icon:"slider",component:(0,l.withProps)(i.default,{noWorkload:!0}),required:!0}],b2iservice:[{title:"Basic Info",icon:"cdn",component:r.default,required:!0},{title:"Build Settings",icon:"strategy-group",component:(0,l.composeComponent)(c.default,(0,l.withProps)(f.default,{prefix:"S2i"})),required:!0},{title:"Container Settings",icon:"docker",component:(0,l.withProps)(p.default,{withService:!0}),required:!0},{title:"Mount Volumes",icon:"storage",component:u.default,required:!0},{title:"Advanced Settings",icon:"slider",component:i.default,required:!0}],s2iservice:[{title:"Basic Info",icon:"cdn",component:r.default,required:!0},{title:"Build Settings",icon:"strategy-group",component:(0,l.composeComponent)(c.default,(0,l.withProps)(m.default,{prefix:"S2i"})),required:!0},{title:"Container Settings",icon:"docker",component:(0,l.withProps)(p.default,{withService:!0}),required:!0},{title:"Mount Volumes",icon:"storage",component:u.default,required:!0},{title:"Advanced Settings",icon:"slider",component:i.default,required:!0}]};t.default=h},3507:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(97)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(22)),m=l(n(115)),p=l(n(268)),h=l(n(58)),v=l(n(0)),g=n(60),y=n(938),E=l(n(386)),b=l(n(225)),_=l(n(2453)),S=l(n(267)),k=l(n(2590)),C=n(49),w=n(114),N=l(n(947)),T=l(n(2608)),P=(0,g.observer)(r=function(e){function a(){var e,n;(0,u.default)(this,a);for(var l=arguments.length,r=new Array(l),o=0;o<l;o++)r[o]=arguments[o];return(n=(0,s.default)(this,(e=(0,d.default)(a)).call.apply(e,[this].concat(r)))).store=new N.default,n.appStore=new T.default,n.state={showServiceMesh:!1,selectApp:{}},n.handleNameChange=(0,p.default)((function(e){var t=n.props,a=t.module,l=t.formTemplate,r=t.noWorkload,o=(0,f.default)(n.formTemplate,'metadata.annotations["kubesphere.io/alias-name"]'),u=(0,f.default)(n.formTemplate,"metadata.labels",{});u.app=e,r||((0,m.default)(l[n.workloadKind],"metadata.name","".concat(e,"-").concat((0,C.generateId)())),(0,m.default)(l[n.workloadKind],'metadata.annotations["kubesphere.io/alias-name"]',o||e),"StatefulSet"===n.workloadKind&&(0,m.default)(l[n.workloadKind],"spec.serviceName",e)),(0,C.updateLabels)(l,a,u)}),200),n.handleAliasNameChange=(0,p.default)((function(e){var t=n.props,a=t.formTemplate,l=t.noWorkload,r=(0,f.default)(n.formTemplate,"metadata.name");l||(0,m.default)(a[n.workloadKind],'metadata.annotations["kubesphere.io/alias-name"]',e||r)}),200),n.handleServiceMeshChange=function(e){var t=n.props,a=t.formTemplate;!t.noWorkload&&(0,m.default)(a[n.workloadKind],'metadata.annotations["servicemesh.kubesphere.io/enabled"]',e)},n.handleAppChange=function(e,t){n.setState({showServiceMesh:!!e,selectApp:(t.find((function(t){return t.value===e}))||{}).app||{}})},n.nameValidator=function(e,a,l){if(!a)return l();n.store.checkName({name:a,namespace:n.namespace}).then((function(a){if(a.exist)return l({message:t("Name exists"),field:e.field});l()}))},n}return(0,c.default)(a,e),(0,i.default)(a,[{key:"componentDidMount",value:function(){this.appStore.fetchList({namespace:this.namespace,limit:1/0})}},{key:"render",value:function(){var e=this.props,a=e.formRef,n=e.noWorkload,l=this.state,r=l.showServiceMesh,o=l.selectApp;return v.default.createElement(S.default,{data:this.formTemplate,ref:a},v.default.createElement(y.Columns,null,v.default.createElement(y.Column,null,v.default.createElement(S.default.Item,{label:t("Name"),desc:t("SERVICE_NAME_DESC"),rules:[{required:!0,message:t("Please input name")},{pattern:w.PATTERN_SERVICE_NAME,message:"".concat(t("Invalid name"),", ").concat(t("SERVICE_NAME_DESC"))},{pattern:w.PATTERN_LENGTH_63,message:t("NAME_TOO_LONG")},{validator:this.nameValidator}]},v.default.createElement(E.default,{name:"metadata.name",onChange:this.handleNameChange,autoFocus:!0}))),v.default.createElement(y.Column,null,v.default.createElement(S.default.Item,{label:t("Alias"),desc:t("ALIAS_DESC")},v.default.createElement(E.default,{name:"metadata.annotations['kubesphere.io/alias-name']",onChange:this.handleAliasNameChange})))),v.default.createElement(y.Columns,null,v.default.createElement(y.Column,null,v.default.createElement(S.default.Item,{label:t("Description")},v.default.createElement(_.default,{name:"metadata.annotations['kubesphere.io/description']"}))),v.default.createElement(y.Column,null)),v.default.createElement(k.default,null,v.default.createElement("div",{className:"margin-t8"},v.default.createElement(y.Columns,null,v.default.createElement(y.Column,null,v.default.createElement(S.default.Item,{label:t("Join Application"),desc:t("SERVICE_NAME_DESC")},v.default.createElement(b.default,{name:"metadata.labels['app.kubernetes.io/name']",onChange:this.handleAppChange,options:this.applications,loading:this.appStore.list.isLoading,defaultValue:""}))),!(0,h.default)(o)&&v.default.createElement(y.Column,null,v.default.createElement(S.default.Item,{label:t("Version")},v.default.createElement(E.default,{name:"metadata.labels.version",defaultValue:"v1"})))),!n&&r&&v.default.createElement(y.Columns,null,v.default.createElement(y.Column,null,v.default.createElement(S.default.Item,{label:t("Service Mesh"),desc:o.serviceMeshEnable?"":t("Application governance is not enabled")},v.default.createElement(b.default,{name:"metadata.annotations['servicemesh.kubesphere.io/enabled']",options:this.serviceMeshOptions,onChange:this.handleServiceMeshChange,defaultValue:o.serviceMeshEnable?"true":"false",disabled:!o.serviceMeshEnable}))),v.default.createElement(y.Column,null)))))}},{key:"formTemplate",get:function(){return this.props.formTemplate.Service}},{key:"workloadKind",get:function(){var e=this.props,t=e.module;return e.noWorkload?"":w.MODULE_KIND_MAP[t]}},{key:"namespace",get:function(){return(0,f.default)(this.formTemplate,"metadata.namespace")}},{key:"serviceMeshOptions",get:function(){return[{label:t("Off"),value:"false"},{label:t("On"),value:"true"}]}},{key:"applications",get:function(){return[{label:t("Not Join"),value:""}].concat((0,o.default)(this.appStore.list.data.map((function(e){return{app:e,label:e.name,value:e.name}}))))}}]),a}(v.default.Component))||r;a.default=P},3508:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(22)),f=l(n(115)),m=n(114),p=l(n(267)),h=l(n(3509)),v=l(n(3510)),g=l(n(3511)),y=l(n(3513)),E=function(e){function a(){var e,t;(0,r.default)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(t=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(l)))).handleLabelsChange=function(e){var a=t.props,n=a.formTemplate;a.noWorkload||((0,f.default)(n,"Service.spec.selector",e),(0,f.default)(n,"Service.metadata.labels",e))},t.handleSessionAffinityChange=function(e){var a=t.props,n=a.formTemplate;a.noWorkload||(0,f.default)(n,"Service.spec.sessionAffinity",e?"clusterIP":"None")},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props,a=e.formRef,n=e.formTemplate,l=e.module,r=e.store,o=e.noWorkload;return d.default.createElement(p.default,{data:n,ref:a},(o||"statefulsets"!==l)&&d.default.createElement(p.default.Group,{label:t("Internet Access"),desc:t("SERVICES_INTERNET_ACCESS_DESC"),checkable:!0},d.default.createElement(g.default,{formTemplate:n})),d.default.createElement(p.default.Group,{label:t("Open Session Sticky"),desc:t("the maximum session sticky time is 10800s(3 hours)"),checkable:!0},d.default.createElement(y.default,{formTemplate:n})),!o&&d.default.createElement(p.default.Group,{label:t("Setting node schedule policy"),desc:t("Running pods on the specified nodes"),keepDataWhenUnCheck:!0,checkable:!0},d.default.createElement(v.default,{kind:this.kind,namespace:this.namespace,formTemplate:n})),d.default.createElement(p.default.Group,{label:t("Add metadata"),desc:t("Additional metadata settings for resources such as Label and Annotation"),keepDataWhenUnCheck:!0,checkable:!0},d.default.createElement(h.default,{store:r,module:l,kind:this.kind,namespace:this.namespace,formTemplate:n,onLabelsChange:this.handleLabelsChange})))}},{key:"namespace",get:function(){return(0,c.default)(this.formTemplate,"Service.metadata.namespace")}},{key:"kind",get:function(){var e=this.props.module;return m.MODULE_KIND_MAP[e]}}]),a}(d.default.Component);a.default=E},3509:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(268)),c=l(n(58)),f=l(n(130)),m=l(n(0)),p=l(n(267)),h=l(n(2538)),v=n(49),g=function(e){function a(){var e,n;(0,r.default)(this,a);for(var l=arguments.length,o=new Array(l),s=0;s<l;s++)o[s]=arguments[s];return(n=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(o)))).handleLabelsChange=(0,d.default)((function(e){var t=n.props,a=t.module,l=t.formTemplate,r=t.onLabelsChange;(0,v.updateLabels)(l,a,e),r&&r(e)}),200),n.labelsValidator=function(e,a,l){return(0,f.default)(a)?l():(0,c.default)(a)?l({message:t("Labels cannot be empty")}):(0,v.isValidLabel)(a)?void n.props.store.checkLabels({labels:a,namespace:n.props.namespace}).then((function(a){if(a.exist)return l({message:t("Labels exists"),field:e.field});l()})):l({message:t("LABEL_FORMAT_DESC")})},n}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props.kind;return m.default.createElement(m.default.Fragment,null,m.default.createElement(p.default.Item,{label:t("Labels"),rules:[{required:!0,message:t("Labels cannot be empty")},{validator:this.labelsValidator}]},m.default.createElement(h.default,{name:"".concat(e,".metadata.labels"),addText:t("Add Label"),onChange:this.handleLabelsChange,readOnlyKeys:["app"]})),m.default.createElement(p.default.Item,{label:t("Annotations")},m.default.createElement(h.default,{name:"".concat(e,".metadata.annotations"),addText:t("Add Annotation"),hiddenKeys:globals.config.preservedAnnotations})))}}]),a}(m.default.Component);a.default=g},3510:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(267)),f=l(n(2538)),m=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){return d.default.createElement(c.default.Item,null,d.default.createElement(f.default,{name:"".concat(this.prefix,"nodeSelector"),addText:t("Add Node Selector")}))}},{key:"prefix",get:function(){return"".concat(this.props.kind,".spec.template.spec.")}}]),a}(d.default.Component);a.default=m},3511:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(22)),c=l(n(115)),f=l(n(566)),m=l(n(0)),p=l(n(225)),h=l(n(267)),v=l(n(2538)),g=l(n(3512)),y=function(e){function a(e){var t;return(0,r.default)(this,a),(t=(0,u.default)(this,(0,i.default)(a).call(this,e))).handleAccessModeChange=function(e){if("LoadBalancer"===e){var a=(0,d.default)(t.formTemplate,"metadata.annotations",{});a=Object.assign({},globals.config.loadBalancerDefaultAnnotations,a),(0,c.default)(t.formTemplate,"metadata.annotations",a)}else Object.keys(globals.config.loadBalancerDefaultAnnotations).forEach((function(e){(0,f.default)(t.formTemplate,'metadata.annotations["'.concat(e,'"]'))}));t.setState({mode:e})},t.optionRenderer=function(e){return m.default.createElement("div",{className:g.default.option},m.default.createElement("div",null,e.label),m.default.createElement("p",null,e.desc))},t.state={mode:(0,d.default)(t.formTemplate,"spec.type","ClusterIP")},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.state.mode;return m.default.createElement(m.default.Fragment,null,m.default.createElement(h.default.Item,{label:t("Access Method")},m.default.createElement(p.default,{name:"Service.spec.type",options:this.accessModes,onChange:this.handleAccessModeChange,optionRenderer:this.optionRenderer})),"LoadBalancer"===e&&m.default.createElement(h.default.Item,{label:t("Annotations")},m.default.createElement(v.default,{name:"Service.metadata.annotations",hiddenKeys:globals.config.preservedAnnotations,addText:t("Add Annotation")})))}},{key:"formTemplate",get:function(){return this.props.formTemplate.Service}},{key:"accessModes",get:function(){return[{label:"NodePort",desc:t("ACCESS_NODEPORT_TIP"),value:"NodePort"},{label:"LoadBalancer",desc:t("ACCESS_LOADBALANCER_TIP"),value:"LoadBalancer"}]}}]),a}(m.default.Component);a.default=y},3512:function(e,t,a){e.exports={wrapper:"InternetAccess__wrapper--2pH3a",title:"InternetAccess__title--2_hRp",contentWrapper:"InternetAccess__contentWrapper--2Qz_q",option:"InternetAccess__option--2rHTh"}},3513:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(115)),f=l(n(267)),m=l(n(2530)),p=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"componentDidMount",value:function(){var e=this.props.formTemplate;(0,c.default)(e,"Service.spec.sessionAffinity","ClientIP")}},{key:"componentWillUnmount",value:function(){var e=this.props.formTemplate;(0,c.default)(e,"Service.spec.sessionAffinity","None")}},{key:"render",value:function(){return d.default.createElement(f.default.Item,{label:t("Maximum session sticky time(s)")},d.default.createElement(m.default,{name:"Service.spec.sessionAffinityConfig.clientIP.timeoutSeconds",defaultValue:10800,min:0}))}}]),a}(d.default.Component);a.default=p},3514:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(268)),c=l(n(0)),f=l(n(386)),m=l(n(225)),p=l(n(38)),h=l(n(227)),v=l(n(2530)),g=l(n(2666)),y=n(114),E=l(n(3515)),b=function(e){function a(e){var t;return(0,r.default)(this,a),(t=(0,u.default)(this,(0,i.default)(a).call(this,e))).triggerChange=(0,d.default)((function(){var e=t.state,a=e.name,n=e.protocol,l=e.targetPort,r=e.port;t.props.onChange({name:a,protocol:"UDP"===n?"UDP":"TCP",targetPort:l,port:r})}),300),t.handleNameChange=function(e,a){t.setState({name:a},(function(){return t.triggerChange()}))},t.handleProtocolChange=function(e){var a,n=t.state.name,l="".concat(t.state.protocol.toLowerCase(),"-");a=n.startsWith(l)?"".concat(e.toLowerCase(),"-").concat(n.replace(l,"")):"".concat(e.toLowerCase(),"-"),t.setState({name:a,protocol:e},(function(){return t.triggerChange()}))},t.handleTargetPortChange=function(e){t.setState({targetPort:e},(function(){return t.triggerChange()}))},t.handlePortChange=function(e){t.setState({port:e},(function(){return t.triggerChange()}))},t.defaultProtocol="HTTP",t.state=t.getStateFromProps(e),t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.value!==this.props.value&&this.setState(this.getStateFromProps(e))}},{key:"getStateFromProps",value:function(e){var t=this.defaultProtocol,a=e.value,n=a.name,l=a.targetPort,r=a.port;if(n){var o=n.match(/^(\w+)-(.*)/);o&&(t=(o[1]||this.defaultProtocol).toUpperCase())}return{name:n||"".concat(t.toLowerCase(),"-"),protocol:y.PROTOCOLS.some((function(e){return e.value===t}))?t:e.value.protocol,targetPort:l,port:r}}},{key:"render",value:function(){var e=this.state,a=e.name,n=e.protocol,l=e.targetPort,r=e.port;return c.default.createElement("div",{className:E.default.wrapper},c.default.createElement(g.default,{prefix:c.default.createElement("div",{className:E.default.tip},c.default.createElement("span",null,t("Protocol")),c.default.createElement(h.default,{content:t("ISTIO_PROTOCOL_TIP")},c.default.createElement(p.default,{name:"question"})))},c.default.createElement(m.default,{name:"protocol",value:n,options:y.PROTOCOLS,defaultValue:this.defaultProtocol,onChange:this.handleProtocolChange})),c.default.createElement(g.default,{prefix:t("Name")},c.default.createElement(f.default,{name:"name",value:a,onChange:this.handleNameChange})),c.default.createElement(g.default,{prefix:t("Container Port")},c.default.createElement(v.default,{name:"targetPort",min:1,max:65535,value:l,integer:!0,onChange:this.handleTargetPortChange})),c.default.createElement(g.default,{prefix:t("Service Port")},c.default.createElement(v.default,{name:"port",min:1,max:65535,value:r,integer:!0,onChange:this.handlePortChange})))}}]),a}(c.default.Component);a.default=b,b.defaultProps={value:{},onChange:function(){}}},3515:function(e,t,a){e.exports={wrapper:"ServicePort__wrapper--3AXbB"}},3516:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(70)),o=l(n(82)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(58)),m=l(n(268)),p=l(n(0)),h=l(n(943)),v=l(n(942)),g=l(n(227)),y=l(n(971)),E=l(n(224)),b=l(n(2538)),_=l(n(2536)),S=n(49),k=l(n(3517)),C=l(n(3519)),w=function(e){function a(e){var t;return(0,u.default)(this,a),(t=(0,s.default)(this,(0,d.default)(a).call(this,e))).fetchRelatedWorkloads=(0,m.default)((function(e){var a=e.value,n=e.namespace;if((0,f.default)(a)||Object.keys(a).some(f.default)||Object.values(a).some(f.default))t.setState({relatedDeployments:[],relatedDaemonSets:[],relatedStatefulSets:[]});else if((0,S.isValidLabel)(a)){var l=(0,S.joinSelector)(a);Promise.all([t.store.fetchByK8s({namespace:n,labelSelector:l},"deployments"),t.store.fetchByK8s({namespace:n,labelSelector:l},"daemonsets"),t.store.fetchByK8s({namespace:n,labelSelector:l},"statefulsets")]).then((function(e){var a=(0,o.default)(e,3),n=a[0],l=a[1],r=a[2];t.setState({relatedDeployments:n,relatedDaemonSets:l,relatedStatefulSets:r})}))}}),500),t.handleWorkloadSelect=function(e){var a=t.props.onChange;a&&a(e),t.setState({selectLabels:e})},t.store=new _.default,t.state={relatedDeployments:[],relatedDaemonSets:[],relatedStatefulSets:[]},(0,f.default)(e.value)||t.fetchRelatedWorkloads(e),t}return(0,c.default)(a,e),(0,i.default)(a,[{key:"componentWillReceiveProps",value:function(e){(0,h.default)(e.value,this.props.value)||this.fetchRelatedWorkloads(e)}},{key:"renderRelatedTips",value:function(){var e=this.props.value,a=this.state,n=a.relatedDeployments,l=a.relatedDaemonSets,r=a.relatedStatefulSets,u=n.length+l.length+r.length;if((0,f.default)(e))return null;var i=t("The currently selectors");if(0===u)return i+=t(" has no corresponding workload"),p.default.createElement(v.default,{className:C.default.alert,message:i,type:"warning"});var s=Object.entries(e).map((function(e){var t=(0,o.default)(e,2),a=t[0],n=t[1];return"".concat(a,"=").concat(n)})).join(", ");i+="(".concat(s,")"),i+=t("SERVICE_SELECTOR_AFFECT_2",{count:u});var d=p.default.createElement("div",null,p.default.createElement("p",null,t("TOTAL_WORKLOAD",{count:u})),n.map((function(e){var a=e.name;return p.default.createElement("p",{key:"deploy-".concat(a)},t("Deployments"),": ",a)})),l.map((function(e){var a=e.name;return p.default.createElement("p",{key:"ds-".concat(a)},t("DaemonSets"),": ",a)})),r.map((function(e){var a=e.name;return p.default.createElement("p",{key:"sts-".concat(a)},t("StatefulSets"),": ",a)}))),c=p.default.createElement("div",null,p.default.createElement("p",{className:"inline-block"},i)," ",p.default.createElement(g.default,{content:d,trigger:"click"},p.default.createElement("a",{className:"text-green"},t("View"))));return p.default.createElement(v.default,{className:C.default.alert,message:c,type:"warning"})}},{key:"renderWorkloadSelectForm",value:function(){return p.default.createElement(k.default,{namespace:this.props.namespace,onSelect:this.handleWorkloadSelect})}},{key:"render",value:function(){var e=this.state.visible;return p.default.createElement("div",{className:C.default.wrapper},this.renderRelatedTips(),p.default.createElement(b.default,(0,r.default)({},this.props,{controlledValue:this.state.selectLabels})),p.default.createElement(y.default,{className:C.default.popper,trigger:"click",visible:e,placement:"right",content:this.renderWorkloadSelectForm(),closeAfterClick:!1},p.default.createElement(E.default,{className:C.default.workload},t("Specify Workload"))))}}]),a}(p.default.Component);a.default=w},3517:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(37)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(0)),m=n(60),p=l(n(22)),h=l(n(2455)),v=l(n(2454)),g=l(n(224)),y=l(n(2544)),E=l(n(2567)),b=l(n(2536)),_=l(n(3518)),S=l(n(2821)),k=(0,m.observer)(r=function(e){function a(e){var t;return(0,u.default)(this,a),(t=(0,s.default)(this,(0,d.default)(a).call(this,e))).handleTypeChange=function(e){t.setState({type:e,visible:!0},(function(){t.store.setModule(t.state.type),t.fetchData()}))},t.fetchData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.store.fetchList((0,o.default)({namespace:t.props.namespace},e))},t.handleSelect=function(e){t.setState({selectItem:e,visible:!0})},t.handleCancel=function(){t.setState({visible:!1,selectItem:{}})},t.handleOK=function(){var e=t.props.onSelect,a=t.state.selectItem;e((0,p.default)(a,"_originData.spec.template.metadata.labels",{})),t.setState({visible:!1})},t.state={type:"deployments",selectItem:{},visible:!1},t.store=new b.default(t.state.type),t}return(0,c.default)(a,e),(0,i.default)(a,[{key:"render",value:function(){var e=this,a=this.state,n=a.type,l=a.selectItem,r=this.store.list,o=r.data,u=r.total,i=r.page,s=r.isLoading;return f.default.createElement("div",null,f.default.createElement("div",{className:S.default.body},f.default.createElement(y.default,{className:"margin-b8",message:t("SPECIFY_WORKLOAD_DESC"),hideIcon:!0}),f.default.createElement(v.default,{wrapClassName:"radio-default",buttonWidth:120,value:n,onChange:this.handleTypeChange,size:"small"},f.default.createElement(h.default,{value:"deployments"},t("Deployments")),f.default.createElement(h.default,{value:"statefulsets"},t("StatefulSets")),f.default.createElement(h.default,{value:"daemonsets"},t("DaemonSets"))),f.default.createElement("div",{className:S.default.workloads},f.default.createElement(E.default,{data:o,total:u,page:i,loading:s,onFetch:this.fetchData},o.map((function(t,a){return f.default.createElement(_.default,{key:"".concat(t.uid).concat(a),module:n,detail:t,onClick:e.handleSelect,selected:l.uid===t.uid})}))))),f.default.createElement("div",{className:S.default.footer},f.default.createElement(g.default,{onClick:this.handleCancel},t("Cancel")),f.default.createElement(g.default,{type:"control",onClick:this.handleOK},t("OK"))))}}]),a}(f.default.Component))||r;a.default=k},3518:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(30)),r=n(a(13)),o=n(a(14)),u=n(a(17)),i=n(a(16)),s=n(a(18)),d=n(a(0)),c=n(a(3)),f=n(a(38)),m=a(114),p=n(a(2821)),h=function(e){function t(){var e,a;(0,r.default)(this,t);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(a=(0,u.default)(this,(e=(0,i.default)(t)).call.apply(e,[this].concat(l)))).handleClick=function(){var e=a.props;(0,e.onClick)(e.detail)},a}return(0,s.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){var e=this.props,t=e.module,a=e.detail,n=e.selected;return d.default.createElement("div",{className:(0,c.default)(p.default.item,(0,l.default)({},p.default.selected,n)),onClick:this.handleClick},d.default.createElement(f.default,{name:m.ICON_TYPES[t],size:16}),d.default.createElement("div",{className:p.default.ring}),d.default.createElement("span",{className:p.default.name},a.name))}}]),t}(d.default.Component);t.default=h},3519:function(e,t,a){e.exports={wrapper:"SelectorsInput__wrapper--3SwR0",alert:"SelectorsInput__alert--3OIbx",workload:"SelectorsInput__workload--iNzx3",popper:"SelectorsInput__popper--3bnXt"}},3520:function(e,t,a){e.exports={wrapper:"ServiceSettings__wrapper--34R_l",contentWrapper:"ServiceSettings__contentWrapper--3EQRY",card:"ServiceSettings__card--3es2K",tabs:"ServiceSettings__tabs--15Rw2",label:"ServiceSettings__label--3ZBGR"}},3521:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(1)),f=l(n(22)),m=l(n(115)),p=l(n(952)),h=l(n(267)),v=n(49),g=l(n(940)),y=n(114),E=l(n(3522)),b=function(e){function a(){var e,t;(0,r.default)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(t=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(l)))).getValue=function(){var e=t.props.formTemplate;return(0,f.default)(e,"StatefulSet")?"stateful":"stateless"},t.handleChange=function(e){t.setTemplate(e),t.forceUpdate()},t.setTemplate=function(e){var a=t.props.formTemplate;if(e!==(a.Deployment?"stateless":"stateful")){var n="stateless"===e?"deployments":"statefulsets",l="stateless"===e?"statefulsets":"deployments",r=y.MODULE_KIND_MAP[n],o=y.MODULE_KIND_MAP[l];t.props.store.setModule(n),t.props.updateModule(n);var u=(0,f.default)(a[o],"metadata"),i=(0,f.default)(a[o],"metadata.labels");(0,m.default)(a,r,g.default[n]({namespace:t.namespace})),u&&(0,m.default)(a,"".concat(r,".metadata"),u),(0,v.updateLabels)(a,n,i),delete a[o]}},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=[{icon:"backup",value:"stateful",label:t("Stateful Service"),description:t("STATEFUL_SERVICE_DESC")},{icon:"backup",value:"stateless",label:t("Stateless Service"),description:t("STATELESS_SERVICE_DESC")}];return d.default.createElement(h.default.Item,{className:E.default.formItem,label:t("Service Type")},d.default.createElement(p.default,{value:this.getValue(),options:e,onChange:this.handleChange}))}},{key:"namespace",get:function(){var e=this.props.formTemplate;return(0,f.default)(e,"Service.metadata.namespace","")}}]),a}(d.default.Component);a.default=b,b.propTypes={formTemplate:c.default.object}},3522:function(e,t,a){e.exports={formItem:"StatefulSetting__formItem--21Ebx"}},3523:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(82)),r=n(a(13)),o=n(a(14)),u=n(a(17)),i=n(a(16)),s=n(a(66)),d=n(a(18)),c=n(a(22)),f=n(a(115)),m=n(a(566)),p=n(a(58)),h=n(a(2465)),v=n(a(569)),g=n(a(0)),y=a(49),E=a(114),b=n(a(2559)),_=n(a(2537)),S=n(a(267)),k=n(a(2811)),C=n(a(2669)),w=n(a(3524)),N=function(e){function t(e){var a;return(0,r.default)(this,t),(a=(0,u.default)(this,(0,i.default)(t).call(this,e))).validator=function(e){a.handleContainer(),e&&e()},a.getReplicas=function(){return(0,c.default)(a.formTemplate,"spec.replicas")||1},a.handleReplicaChange=function(e){a.setState({replicas:e})},a.updatePullSecrets=function(e){var t={},n={},l=a.containerSecretPath,r="".concat(a.prefix,"spec.imagePullSecrets");(0,c.default)(e,"".concat(a.prefix,"spec.containers"),[]).forEach((function(e){e.pullSecret&&(t[e.pullSecret]="",n[e.name]=e.pullSecret)})),(0,p.default)(t)?((0,f.default)(e,r,null),(0,f.default)(e,l,null)):((0,f.default)(e,r,Object.keys(t).map((function(e){return{name:e}}))),(0,f.default)(e,l,JSON.stringify(n)))},a.updateService=function(e){var t=a.props,n=t.formTemplate,l=t.module,r=(0,c.default)(e,"".concat(a.prefix,"spec.containers"),[]),o=[];r.forEach((function(e){e.ports&&e.ports.forEach((function(e){e.servicePort&&o.push({name:e.name,protocol:e.protocol,port:e.servicePort,targetPort:e.containerPort})}))})),(0,f.default)(n,"Service.spec.ports",o);var u=(0,c.default)(e,"metadata.labels",{}),i=(0,c.default)(e,"".concat(a.prefix,"metadata.labels"),{});(0,f.default)(n,"Service.metadata.labels",u),(0,f.default)(n,"Service.spec.selector",i),"StatefulSet"===l?(0,f.default)(n,"Service.spec.clusterIP","None"):(0,m.default)(n,"Service.spec.clusterIP")},a.state={showContainer:!1,selectContainer:{},configMaps:[],secrets:[],replicas:a.getReplicas()},a.configMapStore=new b.default,a.secretStore=new _.default,a.handleContainer=a.handleContainer.bind((0,s.default)(a)),a}return(0,d.default)(t,e),(0,o.default)(t,[{key:"componentDidMount",value:function(){var e=this.props.formRef;this.fetchData(),this.checkPullSecret(),this.props.withService&&this.initService(this.formTemplate),e.current.setCustomValidator(this.validator)}},{key:"checkPullSecret",value:function(){var e=(0,c.default)(this.formTemplate,"".concat(this.prefix,"spec.containers"),[]),t=(0,y.safeParseJSON)((0,c.default)(this.formTemplate,this.containerSecretPath,""));(0,p.default)(t)||e.forEach((function(e){t[e.name]&&(e.pullSecret=t[e.name])}))}},{key:"initService",value:function(){var e=(0,c.default)(this.formTemplate,"metadata.name"),t=(0,c.default)(this.props.formTemplate,"Service.metadata.name");e&&!t&&(t="".concat(e,"-service"),(0,f.default)(this.props.formTemplate,"Service.metadata.name",t),(0,f.default)(this.formTemplate,"spec.serviceName",t))}},{key:"fetchData",value:function(){var e=this,t=(0,c.default)(this.formTemplate,"metadata.namespace");Promise.all([this.configMapStore.fetchByK8s({namespace:t}),this.secretStore.fetchByK8s({namespace:t})]).then((function(t){var a=(0,l.default)(t,2),n=a[0],r=a[1];e.setState({configMaps:n,secrets:r})}))}},{key:"handleContainer",value:function(){var e=(0,c.default)(this.formTemplate,"".concat(this.prefix,"spec.containers[0]"));(0,v.default)(e,"resources.limits")&&(e.resources.limits=(0,h.default)(e.resources.limits,p.default)),this.updatePullSecrets(this.formTemplate),this.props.withService&&this.updateService(this.formTemplate)}},{key:"renderContainerForm",value:function(){var e=this.props,t=e.withService,a=e.module,n=this.state,l=n.configMaps,r=n.secrets;return g.default.createElement(w.default,{module:a,namespace:this.namespace,data:this.formTemplate,configMaps:l,secrets:r,withService:t})}},{key:"renderReplicasControl",value:function(){return g.default.createElement("div",{className:"margin-b12"},g.default.createElement(k.default,{template:this.formTemplate,onChange:this.handleReplicaChange}))}},{key:"renderUpdateStrategy",value:function(){var e=this.props,t=e.formRef,a=e.module,n=this.state.replicas;return g.default.createElement("div",{className:"margin-t12"},g.default.createElement(C.default,{formRef:t,module:a,data:this.formTemplate,replicas:n}))}},{key:"render",value:function(){var e=this.props.formRef;return g.default.createElement(S.default,{data:this.formTemplate,ref:e},this.renderReplicasControl(),this.renderContainerForm(),this.renderUpdateStrategy())}},{key:"prefix",get:function(){return this.props.prefix||"spec.template."}},{key:"namespace",get:function(){return(0,c.default)(this.formTemplate,"metadata.namespace")}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,c.default)(t,E.MODULE_KIND_MAP[a],t)}},{key:"containerSecretPath",get:function(){return"".concat(this.prefix,'metadata.annotations["kubesphere.io/containerSecrets"]')}}]),t}(g.default.Component);t.default=N},3524:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(13)),r=n(a(14)),o=n(a(17)),u=n(a(16)),i=n(a(18)),s=n(a(58)),d=n(a(0)),c=n(a(1)),f=n(a(3)),m=n(a(2788)),p=n(a(2789)),h=n(a(2791)),v=n(a(2792)),g=n(a(2793)),y=n(a(3525)),E=n(a(3527)),b=function(e){function t(e){var a;return(0,l.default)(this,t),(a=(0,o.default)(this,(0,u.default)(t).call(this,e))).handleSubmit=function(e){var t=a.props.onSave,n=a.formRef.current;n&&n.validate((function(){var a=n.getData();a.args&&(a.args=a.args.filter((function(e){return!(0,s.default)(e)}))),a.command&&(a.command=a.command.filter((function(e){return!(0,s.default)(e)}))),a.env&&(a.env=a.env.filter((function(e){var t=e.name;return!(0,s.default)(t)}))),a.ports&&(a.ports=a.ports.filter((function(e){return!(!e.name&&!e.containerPort&&!e.hostPort)}))),t(a),e&&e()}))},a.formRef=d.default.createRef(),a}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props,t=e.className,a=e.data,n=e.configMaps,l=e.secrets,r=e.namespace,o=e.withService,u="spec.template.spec.containers[0]";return d.default.createElement("div",{className:(0,f.default)(E.default.wrapper,t)},d.default.createElement(y.default,{prefix:u,namespace:r,data:a}),d.default.createElement(m.default,{prefix:u,withService:o}),d.default.createElement(v.default,{prefix:u}),this.supportProbe&&d.default.createElement(g.default,{prefix:u}),d.default.createElement(p.default,{prefix:u}),d.default.createElement(h.default,{prefix:u,configMaps:n,secrets:l}))}},{key:"supportProbe",get:function(){return["deployments","daemonsets","statefulsets"].includes(this.props.module)}}]),t}(d.default.Component);t.default=b,b.propTypes={className:c.default.string,type:c.default.string,titlePrefix:c.default.string,namespace:c.default.string,module:c.default.string,data:c.default.object,onSave:c.default.func,onCancel:c.default.func,configMaps:c.default.array,secrets:c.default.array},b.defaultProps={className:"",namespace:"",module:"",data:{},onSave:function(){},onCancel:function(){},configMaps:[],secrets:[]},b.contextTypes={registerSubRoute:c.default.func,resetSubRoute:c.default.func}},3525:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(22)),f=n(19),m=n(49),p=n(114),h=l(n(386)),v=l(n(267)),g=l(n(2599)),y=l(n(2590)),E=l(n(2604)),b=l(n(2543)),_=l(n(2537)),S=l(n(3526)),k=function(e){function a(e){var t;return(0,r.default)(this,a),(t=(0,u.default)(this,(0,i.default)(a).call(this,e))).state={quota:{},limitRange:{},imageRegistries:[]},t.quotaStore=new E.default,t.projectStore=new b.default,t.secretStore=new _.default,t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"fetchData",value:function(){var e=this,t=this.props.namespace;Promise.all([this.quotaStore.fetch({namespace:t}),this.projectStore.fetchLimitRanges({namespace:t}),this.secretStore.fetchByK8s({namespace:this.props.namespace,fieldSelector:"type=kubernetes.io/dockerconfigjson"})]).then((function(){e.setState({quota:e.quotaStore.data,limitRange:(0,c.default)((0,f.toJS)(e.projectStore.limitRanges),"data[0].limit"),imageRegistries:e.secretStore.list.data})}))}},{key:"renderAdvancedSettings",value:function(){var e=this.state.quota,a=(0,c.default)(e,'left["requests.cpu"]'),n=(0,c.default)(e,'left["requests.memory"]'),l=(0,c.default)(e,'left["limits.cpu"]'),r=(0,c.default)(e,'left["limits.memory"]'),o=d.default.createElement("div",{className:S.default.message},t("Left Quota"),":    [",t("Resource Request"),": CPU"," ",a?"".concat((0,m.cpuFormat)(a)," Core"):t("No Limit"),","," ",t("Memory")," ",n?"".concat((0,m.memoryFormat)(n)," Mi"):t("No Limit"),"]    [",t("Resource Limit"),": CPU"," ",l?"".concat((0,m.cpuFormat)(l)," Core"):t("No Limit"),","," ",t("Memory")," ",r?"".concat((0,m.memoryFormat)(r)," Mi"):t("No Limit"),"]");return d.default.createElement(y.default,null,d.default.createElement(d.default.Fragment,null,d.default.createElement(v.default.Item,null,d.default.createElement(g.default,{name:"".concat(this.prefix,"resources"),defaultValue:this.defaultResourceLimit})),o))}},{key:"render",value:function(){return d.default.createElement(v.default.Group,{label:t("Container Settings"),desc:t("Setting for the name of the container and the computing resources of the container"),noWrapper:!0},d.default.createElement(v.default.Item,{className:"margin-t12",label:t("Container Name"),desc:t("NAME_DESC"),rules:[{required:!0,message:t("Please input name")},{pattern:p.PATTERN_NAME,message:"".concat(t("Invalid name"),", ").concat(t("NAME_DESC"))},{pattern:p.PATTERN_LENGTH_63,message:t("NAME_TOO_LONG")}]},d.default.createElement(h.default,{name:"".concat(this.prefix,"name"),defaultValue:"container-".concat((0,m.generateId)())})),this.renderAdvancedSettings())}},{key:"prefix",get:function(){var e=this.props.prefix;return e?"".concat(e,"."):""}},{key:"defaultResourceLimit",get:function(){var e=this.state.limitRange,t=void 0===e?{}:e;if(t.defaultRequest||t.default)return{requests:t.defaultRequest||{},limits:t.default||{}}}},{key:"imageRegistries",get:function(){return this.state.imageRegistries.map((function(e){var t=(0,c.default)(e,'data[".dockerconfigjson"].auths',{}),a=Object.keys(t)[0]||"";return{url:a,username:(0,c.default)(t[a],"username"),label:e.name,value:e.name}}))}}]),a}(d.default.Component);a.default=k,k.defaultProps={prefix:""}},3526:function(e,t,a){e.exports={message:"ContainerSetting__message--1maRb"}},3527:function(e,t,a){e.exports={message:"ContainerForm__message--Q7T7J"}},3528:function(e,t,a){e.exports={body:"ServiceCreate__body--cbNCV",header:"ServiceCreate__header--3z9Nw",groups:"ServiceCreate__groups--2jTLP",group:"ServiceCreate__group--Hbk36",title:"ServiceCreate__title--1k3Iu"}},3529:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(2672)),f=l(n(267)),m=l(n(952)),p=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"renderTypeSelect",value:function(){return d.default.createElement(f.default.Item,{label:t("Access Type")},d.default.createElement(m.default,{className:"margin-b12",value:this.state.serviceType,onChange:this.handleTypeChange,options:this.types,disabled:!0}))}}]),a}(c.default);a.default=p},3530:function(e,t,a){e.exports={empty:"ServiceSetting__empty--1iYB_"}},3531:function(e,t,a){e.exports={modalHeader:"ServiceDelete__modalHeader--26d-m",modalBody:"ServiceDelete__modalBody--OJj3m",body:"ServiceDelete__body--xh0Sh",resources:"ServiceDelete__resources--3pLES",resource:"ServiceDelete__resource--LOltH",selected:"ServiceDelete__selected--1S_nF",resourceName:"ServiceDelete__resourceName--3wA79",resourceType:"ServiceDelete__resourceType--3B2I_",footer:"ServiceDelete__footer--2lXPm",empty:"ServiceDelete__empty--7aUFm"}},3532:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=l(n(58)),m=n(19),p=n(60),h=l(n(38)),v=n(49),g=n(114),y=n(940),E=l(n(2586)),b=l(n(2525)),_=l(n(224)),S=l(n(2519)),k=l(n(388)),C=l(n(2518)),w=l(n(2539)),N=l(n(2526)),T=l(n(2527)),P=l(n(2825)),M=l(n(2827)),R=l(n(2830)),D=l(n(2556)),O=l(n(3539)),x=l(n(3542)),I=(0,p.inject)("rootStore")(r=(0,p.observer)(r=function(e){function a(){var e,n;(0,o.default)(this,a);for(var l=arguments.length,r=new Array(l),u=0;u<l;u++)r[u]=arguments[u];return(n=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(r)))).getColumns=function(){return[{title:t("Name"),dataIndex:"name",sorter:!0,sortOrder:n.getSortOrder("name"),search:!0,render:function(e,t){return c.default.createElement(S.default,{icon:g.ICON_TYPES[n.module],iconSize:40,title:(0,v.getDisplayName)(t),desc:t.description||"-",to:"".concat(n.prefix,"/").concat(e)})}},{title:t("Gateway Address"),dataIndex:"loadBalancerIngress[0].ip",isHideable:!0,width:"22%"},{title:t("Application"),dataIndex:"app.kubernetes.io/name",isHideable:!0,search:!0,width:"22%",render:function(e,t){return t.app}},{title:t("Created Time"),dataIndex:"createTime",sorter:!0,sortOrder:n.getSortOrder("createTime"),isHideable:!0,width:150,render:function(e){return(0,v.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}},{key:"more",width:20,render:n.renderMore}]},n.handleEditAnnotations=function(e){var a=n.state.selectItem;n.store.update(a,e).then((function(){n.hideModal("editAnnotationsModal")(),k.default.success({content:"".concat(t("Updated Successfully"),"!")}),n.routing.query()}))},n.handleYamlEdit=function(e){var t=n.state.selectItem;n.store.update(t,e).then((function(){n.hideModal("editYamlModal")()}))},n.handleEditRules=function(e){var a=n.state.selectItem;n.store.update(a,e).then((function(){n.hideModal("editRulesModal")(),k.default.success({content:"".concat(t("Updated Successfully"),"!")}),n.routing.query()}))},n.handleGatewaySetting=function(e){var t=n.props.match.params.namespace;n.store.addGateway({namespace:t},e).then((function(){n.hideModal("addGateway")(),n.store.getGateway({namespace:t})}))},n}return(0,d.default)(a,e),(0,u.default)(a,[{key:"init",value:function(){this.store=new D.default(this.module),this.store.getGateway(this.props.match.params),this.initWebsocket()}},{key:"getEmptyProps",value:function(){var e=this.store.gateway,t=e.data,a=e.isLoading;return(0,f.default)(t)&&!a?{onCreate:null}:{}}},{key:"renderExtraModals",value:function(){var e=this.state,t=e.createModal,a=e.editModal,n=e.editYamlModal,l=e.editAnnotationsModal,r=e.editRulesModal,o=e.addGateway,u=e.selectItem,i=void 0===u?{}:u,s=this.store.isSubmitting;return c.default.createElement("div",null,c.default.createElement(P.default,{visible:l,detail:i._originData,isSubmitting:s,onOk:this.handleEditAnnotations,onCancel:this.hideModal("editAnnotationsModal")}),c.default.createElement(M.default,{visible:r,detail:i._originData,isSubmitting:s,onOk:this.handleEditRules,onCancel:this.hideModal("editRulesModal")}),c.default.createElement(R.default,{detail:(0,m.toJS)(this.store.gateway.data),visible:o,onOk:this.handleGatewaySetting,onCancel:this.hideModal("addGateway"),isSubmitting:s}),c.default.createElement(w.default,{name:this.name,module:this.module,store:this.store,visible:t,steps:this.steps,formTemplate:this.formTemplate,isSubmitting:s,onOk:this.handleCreate,onCancel:this.hideModal("createModal")}),c.default.createElement(T.default,{visible:a,detail:i._originData,isSubmitting:s,onOk:this.handleEdit,onCancel:this.hideModal("editModal")}),c.default.createElement(N.default,{store:this.store,visible:n,detail:i._originData,isSubmitting:s,onOk:this.handleYamlEdit,onCancel:this.hideModal("editYamlModal")}))}},{key:"renderHeader",value:function(){var e=this.store.gateway,t=e.data,a=e.isLoading;return c.default.createElement(c.default.Fragment,null,C.default.prototype.renderHeader.call(this),(0,f.default)(t)&&!a&&this.renderCreateGateway())}},{key:"renderCreateGateway",value:function(){return c.default.createElement(b.default,{className:"margin-t12 margin-b12"},c.default.createElement("div",{className:"flexbox"},c.default.createElement(h.default,{className:"margin-r12",name:"loadbalancer",size:40}),c.default.createElement(E.default,{className:x.default.text,title:t("Gateway not set"),description:t("PROJECT_INTERNET_ACCESS_DESC")}),this.canSetGateway&&c.default.createElement(_.default,{className:x.default.button,type:"control",onClick:this.showModal("addGateway")},t("Set Gateway"))))}},{key:"module",get:function(){return"ingresses"}},{key:"authKey",get:function(){return"routes"}},{key:"name",get:function(){return"Route"}},{key:"steps",get:function(){return O.default}},{key:"formTemplate",get:function(){var e=this.props.match.params.namespace;return(0,y.getFormTemplate)(e,this.module)}},{key:"canSetGateway",get:function(){return globals.app.hasPermission({module:"advanced",action:"manage",project:this.props.match.params.namespace})}},{key:"tips",get:function(){return[{title:t("PREREQUESTS_FOR_USE_ROUTE_Q"),description:t("PREREQUESTS_FOR_USE_ROUTE_A"),more:(0,v.getDocsUrl)("internet")},{title:t("ACCESS_TYPES_OF_ROUTE_Q"),description:t("ACCESS_TYPES_OF_ROUTE_A")}]}},{key:"itemActions",get:function(){return[{key:"edit",icon:"pen",text:t("EDIT"),action:"edit",onClick:this.showModal("editModal")},{key:"editYaml",icon:"pen",text:t("Edit YAML"),action:"edit",onClick:this.showModal("editYamlModal")},{key:"editRules",icon:"firewall",text:t("Edit Rules"),action:"edit",onClick:this.showModal("editRulesModal")},{key:"editAnnotations",icon:"firewall",text:t("Edit Annotations"),action:"edit",onClick:this.showModal("editAnnotationsModal")},{key:"delete",icon:"trash",text:t("Delete"),action:"delete",onClick:this.showModal("deleteModal")}]}}]),a}(C.default))||r)||r;a.default=I},3533:function(e,t,a){e.exports={dropdown:"AnnotationsInput__dropdown--1eq9u"}},3534:function(e,t,a){e.exports={wrapper:"RouteAnnotationsEdit__wrapper--1Krvo",formWrapper:"RouteAnnotationsEdit__formWrapper--313r2"}},3535:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(22)),c=l(n(115)),f=l(n(58)),m=l(n(0)),p=l(n(1)),h=l(n(224)),v=l(n(3536)),g=l(n(2829)),y=function(e){function a(){var e,t;(0,r.default)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(t=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(l)))).handleAdd=function(){t.props.onShow()},t.handleEdit=function(e){t.props.onShow(e)},t.handleDelete=function(e){var a=t.props,n=a.value;(0,a.onChange)(n.filter((function(t){return t.host!==e})));var l=(0,d.default)(t.context.formData,"spec.tls[0]");l&&((0,f.default)(l.hosts)?(0,c.default)(t.context.formData,"spec.tls",[]):(l.hosts=l.hosts.filter((function(t){return t!==e})),(0,c.default)(t.context.formData,"spec.tls[0]",l)))},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"renderEmpty",value:function(){var e=this.props.disabled;return m.default.createElement("div",{className:g.default.empty},m.default.createElement("p",null,t("Please add at least one routing rule")),m.default.createElement(h.default,{className:g.default.add,onClick:this.handleAdd,disabled:e},t("Add Route Rule")))}},{key:"renderContent",value:function(){var e=this,a=this.props.value,n=(0,d.default)(this.context.formData,"spec.tls[0]");return m.default.createElement("div",{className:g.default.content},m.default.createElement("ul",{className:g.default.list},a.map((function(t){return m.default.createElement(v.default,{rule:t,tls:n,key:t.host,onEdit:e.handleEdit,onDelete:e.handleDelete})}))),m.default.createElement("div",{className:"text-right"},m.default.createElement(h.default,{className:g.default.add,onClick:this.handleAdd},t("Add Route Rule"))))}},{key:"render",value:function(){var e=this.props.value;return m.default.createElement("div",{className:g.default.wrapper},e.length<=0?this.renderEmpty():this.renderContent())}}]),a}(m.default.Component);a.default=y,y.propTypes={name:p.default.string,value:p.default.array,onChange:p.default.func,onShow:p.default.func},y.defaultProps={name:"",value:[],onChange:function(){},onShow:function(){}},y.contextTypes={formData:p.default.object}},3536:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(37)),o=l(n(22)),u=l(n(0)),i=l(n(1)),s=n(938),d=l(n(38)),c=l(n(224)),f=l(n(2829)),m=function(e){var a=e.rule,n=e.tls,l=void 0===n?{}:n,i=e.onDelete,m=e.onEdit,p=l.hosts&&l.hosts.includes(a.host)?"https":"http";return u.default.createElement("li",{className:f.default.card},u.default.createElement("div",{className:f.default.content},u.default.createElement(d.default,{name:"earth",size:40}),u.default.createElement("div",{className:f.default.title},a.host,u.default.createElement("p",null,u.default.createElement("span",null,t("Protocol"),": ",p),"https"===p&&u.default.createElement("span",null,t("Certificate"),": ",l.secretName))),u.default.createElement(s.Buttons,null,u.default.createElement(c.default,{type:"flat",icon:"trash",onClick:function(){return i(a.host)}}),u.default.createElement(c.default,{type:"flat",icon:"pen",onClick:function(){m("https"===p?(0,r.default)({},a,{protocol:"https",secretName:l.secretName}):(0,r.default)({},a,{protocol:"http"}))}}))),a.http.paths.map((function(e){return u.default.createElement("div",{key:e.path,className:f.default.path},u.default.createElement(s.Columns,null,u.default.createElement(s.Column,null,u.default.createElement("span",null,t("path"),": ",u.default.createElement("strong",null,e.path))),u.default.createElement(s.Column,null,u.default.createElement("span",null,t("Service"),":"," ",u.default.createElement("strong",null,(0,o.default)(e,"backend.serviceName")))),u.default.createElement(s.Column,null,u.default.createElement("span",null,t("Port"),": ",u.default.createElement("strong",null,(0,o.default)(e,"backend.servicePort"))))))})))};m.propTypes={rule:i.default.object};var p=m;a.default=p},3537:function(e,t,a){e.exports={wrapper:"RouteRulesEdit__wrapper--2wf3c"}},3538:function(e,t,a){e.exports={modalBody:"GatewaySetting__modalBody--1W8IC",body:"GatewaySetting__body--2ynZ9",footer:"GatewaySetting__footer--2ypYy",wrapper:"GatewaySetting__wrapper--3Xw8W",content:"GatewaySetting__content--3kJmD",types:"GatewaySetting__types--3hcGi",toggle:"GatewaySetting__toggle--30PuU",toggleTip:"GatewaySetting__toggleTip--2Tpg7"}},3539:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(2565)),r=n(a(2828)),o=n(a(3540)),u=[{title:"Basic Info",icon:"cdn",component:l.default,required:!0},{title:"Route Rules",icon:"cdn",component:r.default,required:!0},{title:"Advanced Settings",icon:"slider",component:o.default,required:!0}];t.default=u},3540:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(22)),f=n(114),m=l(n(267)),p=l(n(3541)),h=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props,a=e.store,n=e.formRef;return d.default.createElement(m.default,{data:this.formTemplate,ref:n},d.default.createElement(m.default.Group,{label:t("Add metadata"),desc:t("Additional metadata settings for resources such as Label and Annotation"),keepDataWhenUnCheck:!0,checkable:!0},d.default.createElement(p.default,{store:a,prefix:this.prefix,namespace:this.namespace,formTemplate:this.formTemplate})))}},{key:"prefix",get:function(){return this.props.prefix||"spec.template.spec."}},{key:"namespace",get:function(){return(0,c.default)(this.formTemplate,"metadata.namespace")}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,c.default)(t,f.MODULE_KIND_MAP[a],t)}}]),a}(d.default.Component);a.default=h},3541:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(58)),c=l(n(130)),f=l(n(0)),m=l(n(267)),p=l(n(2538)),h=n(49),v=l(n(2826)),g=function(e){function a(){var e,n;(0,r.default)(this,a);for(var l=arguments.length,o=new Array(l),s=0;s<l;s++)o[s]=arguments[s];return(n=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(o)))).labelsValidator=function(e,a,l){return(0,c.default)(a)?l():(0,d.default)(a)?l({message:t("Labels cannot be empty")}):(0,h.isValidLabel)(a)?void n.props.store.checkLabels({labels:a,namespace:n.props.namespace}).then((function(a){if(a.exist)return l({message:t("Labels exists"),field:e.field});l()})):l({message:t("LABEL_FORMAT_DESC")})},n}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){return f.default.createElement(f.default.Fragment,null,f.default.createElement(m.default.Item,{label:t("Annotations")},f.default.createElement(v.default,{name:"metadata.annotations",addText:t("Add Annotation"),hiddenKeys:globals.config.preservedAnnotations})),f.default.createElement(m.default.Item,{label:t("Labels"),rules:[{required:!0,message:t("Labels cannot be empty")},{validator:this.labelsValidator}]},f.default.createElement(p.default,{name:"metadata.labels",addText:t("Add Label"),readOnlyKeys:["app"]})))}}]),a}(f.default.Component);a.default=g},3542:function(e,t,a){e.exports={text:"Routes__text--2Uwfl",button:"Routes__button--3d_Lj"}},3543:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(37)),u=l(n(61)),i=l(n(62)),s=l(n(82)),d=l(n(13)),c=l(n(14)),f=l(n(17)),m=l(n(16)),p=l(n(2463)),h=l(n(18)),v=l(n(0)),g=n(60),y=l(n(22)),E=l(n(58)),b=n(49),_=n(941),S=n(114),k=n(939),C=n(940),w=l(n(2519)),N=l(n(2521)),T=l(n(2518)),P=l(n(2539)),M=l(n(2526)),R=l(n(2527)),D=l(n(2569)),O=l(n(2570)),x=l(n(2734)),I=l(n(3544)),A=l(n(3548)),L={inode_utilisation:"pvc_bytes_utilisation",capacityTotal:"pvc_bytes_total"},j=(0,g.inject)("rootStore")(r=(0,g.observer)(r=function(e){function a(){var e,n;(0,d.default)(this,a);for(var l=arguments.length,r=new Array(l),o=0;o<l;o++)r[o]=arguments[o];return(n=(0,f.default)(this,(e=(0,m.default)(a)).call.apply(e,[this].concat(r)))).getPVCMetrics=function(e){var t=n.monitorStore.data,a={};return Object.entries(L).forEach((function(n){var l=(0,s.default)(n,2),r=l[0],o=l[1],u=(0,y.default)(t,"".concat(o,".data.result"))||[];a[r]=u.find((function(t){return(0,y.default)(t,"metric.resource_name")===e}))})),a},n.getItemDesc=function(e){var t=(0,_.getVolumeStatus)(e);return(0,E.default)(t)?e.storageClassName||"-":v.default.createElement(D.default,{reason:t,data:e,type:"volume"})},n.getColumns=function(){return[{title:t("Name"),dataIndex:"name",sorter:!0,sortOrder:n.getSortOrder("name"),search:!0,render:function(e,t){return v.default.createElement(w.default,{icon:S.ICON_TYPES[n.module],iconSize:40,title:(0,b.getDisplayName)(t),desc:n.getItemDesc(t),to:"".concat(n.prefix,"/").concat(e)})}},{title:t("Status"),dataIndex:"status",filters:n.getStatus(),filteredValue:n.getFilteredValue("status"),isHideable:!0,search:!0,width:"14%",render:function(e){var a=e.phase;return v.default.createElement(N.default,{type:a,className:A.default.status,name:t("VOLUME_STATUS_".concat(a.toUpperCase()))})}},{title:t("Capacity"),dataIndex:"capacity",sorter:!0,sortOrder:n.getSortOrder("capacity"),isHideable:!0,width:"16%",render:function(e,a){var l=a.accessMode,r=a.name,o=n.getPVCMetrics(r),u=(0,y.default)(o,"inode_utilisation.value[1]"),i=(0,y.default)(o,"capacityTotal.value[1]",0);return v.default.createElement("div",{className:A.default.capacity},v.default.createElement("h3",null,i?(0,k.getSuitableValue)(i,"memory"):e,v.default.createElement("small",null,"(",t("used"),(0,k.getSuitableValue)(u,"%"),"%)")),v.default.createElement("p",null,l))}},{title:t("Mount"),dataIndex:"inUse",isHideable:!0,width:"14%",render:function(e){return e?t("Mounted"):t("Not Mounted")}},{title:t("Created Time"),dataIndex:"createTime",sorter:!0,sortOrder:n.getSortOrder("createTime"),isHideable:!0,width:150,render:function(e){return(0,b.getLocalTime)(e).format("YYYY-MM-DD HH:mm")}},{key:"more",width:20,render:n.renderMore}]},n.handleYamlEdit=function(e){var t=n.state.selectItem;n.store.update(t,e).then((function(){n.hideModal("editYamlModal")()}))},n}var n;return(0,h.default)(a,e),(0,c.default)(a,[{key:"init",value:function(){this.store=new O.default;var e=this.props.match.params.namespace;this.monitorStore=new x.default({namespace:e,last:!0}),this.initWebsocket()}},{key:"getData",value:(n=(0,i.default)(u.default.mark((function e(t){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,p.default)((0,m.default)(a.prototype),"getData",this).call(this,t),clearInterval(this.monitorTimer),this.monitorTimer=this.monitorStore.monitoringMetrics({},{interval:5e4});case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"componentWillUnmount",value:function(){(0,p.default)((0,m.default)(a.prototype),"componentWillUnmount",this).call(this),clearInterval(this.monitorTimer)}},{key:"getStatus",value:function(){return S.VOLUME_STATUS.map((function(e){return{text:t(e.text),value:e.value}}))}},{key:"getTableProps",value:function(){return(0,o.default)({},(0,p.default)((0,m.default)(a.prototype),"getTableProps",this).call(this),{isRefreshing:this.monitorStore.isRefreshing,isMetricsLoading:this.monitorStore.isLoading,alwaysUpdate:!0})}},{key:"renderExtraModals",value:function(){var e=this.state,t=e.createModal,a=e.editModal,n=e.editYamlModal,l=e.selectItem,r=void 0===l?{}:l,o=this.store.isSubmitting;return v.default.createElement("div",null,v.default.createElement(P.default,{name:this.name,module:this.module,store:this.store,visible:t,steps:this.steps,formTemplate:this.formTemplate,isSubmitting:o,onOk:this.handleCreate,onCancel:this.hideModal("createModal")}),v.default.createElement(R.default,{visible:a,detail:r._originData,isSubmitting:o,onOk:this.handleEdit,onCancel:this.hideModal("editModal")}),v.default.createElement(M.default,{store:this.store,visible:n,detail:r._originData,isSubmitting:o,onOk:this.handleYamlEdit,onCancel:this.hideModal("editYamlModal")}))}},{key:"module",get:function(){return"volumes"}},{key:"name",get:function(){return"Volume"}},{key:"steps",get:function(){return I.default}},{key:"formTemplate",get:function(){var e=this.props.match.params.namespace;return(0,C.getFormTemplate)(e,this.module)}},{key:"tips",get:function(){return[{title:t("WHAT_IS_STORAGE_CLASS_Q"),description:t("WHAT_IS_STORAGE_CLASS_A")},{title:t("WHAT_IS_LOCAL_VOLUME_Q"),description:t("WHAT_IS_LOCAL_VOLUME_A")}]}},{key:"itemActions",get:function(){return[{key:"edit",icon:"pen",text:t("EDIT"),action:"edit",onClick:this.showModal("editModal")},{key:"editYaml",icon:"pen",text:t("Edit YAML"),action:"edit",onClick:this.showModal("editYamlModal")},{key:"delete",icon:"trash",text:t("Delete"),action:"delete",onClick:this.showModal("deleteModal")}]}}]),a}(T.default))||r)||r;a.default=j},3544:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(2565)),r=n(a(3545)),o=n(a(3546)),u=[{title:"Basic Info",icon:"cdn",component:l.default,required:!0},{title:"Volume Settings",icon:"storage",component:r.default,required:!0},{title:"Advanced Settings",icon:"slider",component:o.default,required:!0}];t.default=u},3545:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(13)),r=n(a(14)),o=n(a(17)),u=n(a(16)),i=n(a(18)),s=n(a(0)),d=n(a(22)),c=a(114),f=n(a(267)),m=n(a(2801)),p=function(e){function t(){return(0,l.default)(this,t),(0,o.default)(this,(0,u.default)(t).apply(this,arguments))}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.formRef;return s.default.createElement(f.default,{data:this.formTemplate,ref:e},s.default.createElement(m.default,null))}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,d.default)(t,c.MODULE_KIND_MAP[a],t)}}]),t}(s.default.Component);t.default=p},3546:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(22)),f=n(114),m=l(n(267)),p=l(n(3547)),h=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props,a=e.store,n=e.formRef;return d.default.createElement(m.default,{data:this.formTemplate,ref:n},d.default.createElement(m.default.Group,{label:t("Add metadata"),desc:t("Additional metadata settings for resources such as Label and Annotation"),keepDataWhenUnCheck:!0,checkable:!0},d.default.createElement(p.default,{store:a,namespace:this.namespace,formTemplate:this.formTemplate})))}},{key:"namespace",get:function(){return(0,c.default)(this.formTemplate,"metadata.namespace")}},{key:"formTemplate",get:function(){var e=this.props,t=e.formTemplate,a=e.module;return(0,c.default)(t,f.MODULE_KIND_MAP[a],t)}}]),a}(d.default.Component);a.default=h},3547:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(58)),c=l(n(130)),f=l(n(0)),m=l(n(267)),p=l(n(2538)),h=n(49),v=function(e){function a(){var e,n;(0,r.default)(this,a);for(var l=arguments.length,o=new Array(l),s=0;s<l;s++)o[s]=arguments[s];return(n=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(o)))).labelsValidator=function(e,a,l){return(0,c.default)(a)?l():(0,d.default)(a)?l({message:t("Labels cannot be empty")}):(0,h.isValidLabel)(a)?void n.props.store.checkLabels({labels:a,namespace:n.props.namespace}).then((function(a){if(a.exist)return l({message:t("Labels exists"),field:e.field});l()})):l({message:t("LABEL_FORMAT_DESC")})},n}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){return f.default.createElement(f.default.Fragment,null,f.default.createElement(m.default.Item,{label:t("Labels"),rules:[{required:!0,message:t("Labels cannot be empty")},{validator:this.labelsValidator}]},f.default.createElement(p.default,{name:"metadata.labels",addText:t("Add Label"),onChange:this.handleLabelsChange,readOnlyKeys:["app"]})),f.default.createElement(m.default.Item,{label:t("Annotations")},f.default.createElement(p.default,{name:"metadata.annotations",addText:t("Add Annotation")})))}}]),a}(f.default.Component);a.default=v},3548:function(e,t,a){e.exports={capacity:"Volumes__capacity--243L3",status:"Volumes__status--3XGLs"}},3549:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(37)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(0)),m=n(19),p=n(60),h=l(n(22)),v=l(n(58)),g=l(n(2465)),y=l(n(940)),E=l(n(2557)),b=l(n(388)),_=l(n(2644)),S=l(n(2767)),k=l(n(2524)),C=l(n(3550)),w=l(n(2523)),N=l(n(3551)),T=l(n(3553)),P=l(n(3557)),M=(0,p.inject)("rootStore")(r=(0,p.observer)(r=function(e){function a(e){var n;return(0,u.default)(this,a),(n=(0,s.default)(this,(0,d.default)(a).call(this,e))).hideEdit=function(){n.setState({showEdit:!1})},n.handleEdit=function(e){n.store.patch({name:n.namespace},e).then((function(){n.hideEdit(),n.store.fetchDetail(n.params)}))},n.hideDelete=function(){n.setState({showDelete:!1})},n.handleDelete=function(){n.store.delete({name:n.namespace},{workspace:n.workspace}).then((function(){n.routing.push("/")}))},n.showEditDefaultResource=function(){n.setState({showEditDefaultResource:!0})},n.hideEditDefaultResource=function(){n.setState({showEditDefaultResource:!1})},n.handleEditDefaultResource=function(e){n.hideEditDefaultResource();var t=(0,m.toJS)(n.store.limitRanges.data);(0,v.default)(t[0])?n.store.createLimitRange({namespace:n.props.match.params.namespace},(0,o.default)({},y.default.limitRange(),{spec:{limits:[(0,o.default)({},e,{type:"Container"})]}})).then((function(){n.store.fetchLimitRanges(n.props.match.params)})):n.store.updateLimitRange(t[0],(0,o.default)({},t[0]._originData,{spec:{limits:[(0,o.default)({},t[0].limit,e)]}})).then((function(){n.store.fetchLimitRanges(n.props.match.params)}))},n.showEditQuota=function(){n.setState({showEditQuota:!0})},n.hideEditQuota=function(){n.setState({showEditQuota:!1})},n.handleEditQuota=function(e){var t={name:e.name,namespace:n.namespace},a=(0,h.default)(e,"spec.hard",{});e.spec={hard:(0,g.default)(a,v.default)},n.quotaStore.checkName(t).then((function(a){a.exist?n.quotaStore.update(t,{apiVersion:"v1",kind:"ResourceQuota",metadata:(0,o.default)({},t,{name:n.namespace}),spec:e.spec}).then(n.postEditQuota):n.quotaStore.create({apiVersion:"v1",kind:"ResourceQuota",metadata:(0,o.default)({},t,{name:n.namespace}),spec:e.spec}).then(n.postEditQuota)}))},n.postEditQuota=function(){n.hideEditQuota(),n.quotaStore.fetch(n.params),b.default.success({content:"".concat(t("Updated Successfully"),"!")})},n.handleMoreMenuClick=function(e,t){switch(t){case"edit":n.setState({showEdit:!0});break;case"edit-default-resource":n.setState({showEditDefaultResource:!0});break;case"edit-quota":n.setState({showEditQuota:!0});break;case"delete":n.setState({showDelete:!0})}},n.state={showEdit:!1,showDelete:!1,showEditQuota:!1,showEditDefaultResource:!1},n.roleStore=new E.default,n}return(0,c.default)(a,e),(0,i.default)(a,[{key:"componentDidMount",value:function(){this.store.fetchMembers(this.params),this.roleStore.fetchList(this.params),this.store.fetchLimitRanges(this.params),this.quotaStore.fetch(this.params)}},{key:"getWorkspaceUrl",value:function(){var e=this.workspace;return globals.app.hasPermission({module:"workspaces",action:"manage"})||globals.app.hasPermission({module:"workspaces",action:"view",workspace:e})?"/workspaces/".concat(e,"/overview"):"/"}},{key:"render",value:function(){var e=(0,m.toJS)(this.store.data),a=this.roleStore.list.total,n=this.store.members.total,l=(0,h.default)(this.quotaStore,'data.used["count/services"]',0),r=(0,m.toJS)(this.store.limitRanges.data),o=(0,m.toJS)(this.quotaStore.data);return f.default.createElement("div",null,f.default.createElement(w.default,{icon:"cdn",title:t("Basic Info"),description:t("PROJECT_BASIC_INFO_DESC"),module:"project_base_info",tips:this.tips}),f.default.createElement(N.default,{detail:e,roleCount:a,memberCount:n,serviceCount:l,workspace:this.workspace,actions:this.enabledItemActions,onMenuClick:this.handleMoreMenuClick}),f.default.createElement(P.default,{detail:r[0]}),f.default.createElement(T.default,{detail:o}),f.default.createElement(C.default,{detail:r[0],namespace:this.namespace,visible:this.state.showEditDefaultResource,onOk:this.handleEditDefaultResource,onCancel:this.hideEditDefaultResource,isSubmitting:this.store.isSubmitting}),f.default.createElement(_.default,{detail:e,visible:this.state.showEdit,onOk:this.handleEdit,onCancel:this.hideEdit,isSubmitting:this.store.isSubmitting}),f.default.createElement(k.default,{detail:e,desc:t.html("DELETE_PROJECT_TIP",{resource:e.name}),visible:this.state.showDelete,onOk:this.handleDelete,onCancel:this.hideDelete,isSubmitting:this.store.isSubmitting}),f.default.createElement(S.default,{detail:e,visible:this.state.showEditQuota,onOk:this.handleEditQuota,onCancel:this.hideEditQuota,isSubmitting:this.quotaStore.isSubmitting}))}},{key:"store",get:function(){return this.props.rootStore.project}},{key:"quotaStore",get:function(){return this.props.rootStore.quota}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"params",get:function(){return(0,h.default)(this.props.match,"params",{})}},{key:"workspace",get:function(){return this.store.data.workspace}},{key:"namespace",get:function(){return this.params.namespace}},{key:"tips",get:function(){return[{title:t("HOW_TO_USE_QUOTA_Q"),description:t("HOW_TO_USE_QUOTA_A")},{title:t("WHAT_IS_LIMIT_RANGE_Q"),description:t("WHAT_IS_LIMIT_RANGE_A")}]}},{key:"enabledActions",get:function(){return globals.app.getActions({module:"projects",project:this.namespace})}},{key:"itemActions",get:function(){var e=[{key:"edit",icon:"pen",action:"edit",text:t("Edit Info")},{key:"edit-default-resource",icon:"pen",action:"edit",text:t("Edit Resource Default Request")},{key:"delete",icon:"trash",action:"delete",text:t("Delete Project")}];return globals.app.hasPermission({workspace:this.workspace,module:"workspaces",action:"edit"})&&e.splice(1,0,{key:"edit-quota",icon:"pen",action:"edit",text:t("Edit Quota")}),e}},{key:"enabledItemActions",get:function(){var e=this;return this.itemActions.filter((function(t){return!t.action||e.enabledActions.includes(t.action)}))}}]),a}(f.default.Component))||r)||r;a.default=M},3550:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(22)),c=l(n(0)),f=l(n(1)),m=l(n(387)),p=l(n(2599)),h=function(e){function a(e){var t;return(0,r.default)(this,a),(t=(0,u.default)(this,(0,i.default)(a).call(this,e))).handleChange=function(e){t.setState({data:{default:e.limits,defaultRequest:e.requests}})},t.handleOk=function(){(0,t.props.onOk)(t.state.data)},t.state={data:(0,d.default)(e.detail,"limit",{})},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.detail&&e.detail.limit&&e.detail.limit!==this.state.data&&this.setState({data:e.detail.limit})}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel,l=e.isSubmitting;return c.default.createElement(m.default,{width:691,title:t("Container Resource Default Request"),icon:"firewall",onOk:this.handleOk,onCancel:n,visible:a,isSubmitting:l},c.default.createElement(p.default,{defaultValue:this.resourceLimit,onChange:this.handleChange}))}},{key:"resourceLimit",get:function(){return{requests:(0,d.default)(this.props.detail,"limit.defaultRequest",{}),limits:(0,d.default)(this.props.detail,"limit.default",{})}}}]),a}(c.default.Component);a.default=h,h.propTypes={detail:f.default.object,namespace:f.default.string,visible:f.default.bool,onOk:f.default.func,onCancel:f.default.func,isSubmitting:f.default.bool},h.defaultProps={visible:!1,isSubmitting:!1,namespace:"",detail:{},onOk:function(){},onCancel:function(){}}},3551:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(22)),f=l(n(58)),m=n(226),p=l(n(3)),h=l(n(38)),v=l(n(271)),g=l(n(190)),y=n(49),E=l(n(224)),b=l(n(2525)),_=l(n(3552)),S=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"renderMoreMenu",value:function(){var e=this.props,t=e.actions,a=e.onMenuClick;return d.default.createElement(v.default,{onClick:a},t.map((function(e){return d.default.createElement(v.default.MenuItem,{key:e.key},d.default.createElement(h.default,{name:e.icon})," ",e.text)})))}},{key:"render",value:function(){var e=this.props,a=e.detail,n=e.workspace,l=e.serviceCount,r=e.memberCount,o=e.roleCount,u=e.actions;return d.default.createElement(b.default,{className:_.default.wrapper,title:t("Project Info")},d.default.createElement("div",{className:_.default.header},d.default.createElement(h.default,{name:"project",size:40}),d.default.createElement("div",{className:_.default.item},d.default.createElement("div",null,(0,y.getDisplayName)(a)),d.default.createElement("p",null,t("Project Name"))),d.default.createElement("div",{className:_.default.item},d.default.createElement("div",null,d.default.createElement(m.Link,{to:"/"},(0,c.default)(a,'annotations["kubesphere.io/workspace"]',n||"-"))),d.default.createElement("p",null,t("Workspace"))),d.default.createElement("div",{className:_.default.item},d.default.createElement("div",null,(0,c.default)(a,"creator","-")),d.default.createElement("p",null,t("Creator"))),d.default.createElement("div",{className:_.default.item},d.default.createElement("div",null,(0,y.getLocalTime)(a.createTime).format("YYYY-MM-DD HH:mm:ss")),d.default.createElement("p",null,t("Created Time"))),!(0,f.default)(u)&&d.default.createElement("div",{className:(0,p.default)(_.default.item,"text-right")},d.default.createElement(g.default,{className:"dropdown-default",content:this.renderMoreMenu(),trigger:"click",placement:"bottomRight"},d.default.createElement(E.default,null,t("Manage Project"))))),d.default.createElement("div",{className:_.default.content},d.default.createElement("div",{className:_.default.contentItem},d.default.createElement(h.default,{name:"appcenter",size:40}),d.default.createElement("div",{className:_.default.item},d.default.createElement("div",null,l),d.default.createElement("p",null,t("Services")))),d.default.createElement("div",{className:_.default.contentItem},d.default.createElement(h.default,{name:"role",size:40}),d.default.createElement("div",{className:_.default.item},d.default.createElement("div",null,o),d.default.createElement("p",null,t("Project Roles")))),d.default.createElement("div",{className:_.default.contentItem},d.default.createElement(h.default,{name:"group",size:40}),d.default.createElement("div",{className:_.default.item},d.default.createElement("div",null,r),d.default.createElement("p",null,t("Project Members"))))))}}]),a}(d.default.Component);a.default=S},3552:function(e,t,a){e.exports={wrapper:"ProjectInfo__wrapper--y1eLr",header:"ProjectInfo__header--363Ff",item:"ProjectInfo__item--2DA2p",content:"ProjectInfo__content--nMtAh",contentItem:"ProjectInfo__contentItem--2NiYm"}},3553:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(82)),o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=l(n(22)),m=n(114),p=l(n(2525)),h=l(n(3554)),v=l(n(3556)),g=function(e){function a(){return(0,o.default)(this,a),(0,i.default)(this,(0,s.default)(a).apply(this,arguments))}return(0,d.default)(a,e),(0,u.default)(a,[{key:"render",value:function(){var e=this.props.detail;return c.default.createElement(p.default,{className:v.default.wrapper,title:t("Resource Quota")},Object.entries(m.QUOTAS_MAP).map((function(t){var a=(0,r.default)(t,2),n=a[0],l=a[1];return c.default.createElement(h.default,{key:n,name:n,total:(0,f.default)(e,'hard["'.concat(l.name,'"]')),used:(0,f.default)(e,'used["'.concat(l.name,'"]'),0),left:(0,f.default)(e,'left["'.concat(l.name,'"]'))})})))}}]),a}(c.default.Component);a.default=g},3554:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(0)),o=l(n(130)),u=l(n(38)),i=l(n(2752)),s=n(49),d=n(114),c=l(n(3555)),f=["limits.cpu","limits.memory","pods"],m=function(e){var a=e.name,n=e.total,l=e.used;if(!n&&!Number(l)&&-1===f.indexOf(a))return null;var m=0;return"limits.cpu"===a||"requests.cpu"===a?n&&(m=Number((0,s.cpuFormat)(l))/Number((0,s.cpuFormat)(n)),l="".concat((0,s.cpuFormat)(l)," Core"),n="".concat((0,s.cpuFormat)(n)," Core")):"limits.memory"===a||"requests.memory"===a?n&&(m=Number((0,s.memoryFormat)(l))/Number((0,s.memoryFormat)(n)),l="".concat((0,s.memoryFormat)(l,"Gi")," Gi"),n="".concat((0,s.memoryFormat)(n,"Gi")," Gi")):n&&(m=Number(l)/Number(n)),m=Math.min(Math.max(m,0),1),r.default.createElement("div",{className:c.default.quota},r.default.createElement(u.default,{name:d.ICON_TYPES[a],size:40}),r.default.createElement("div",{className:c.default.item},r.default.createElement("div",null,t(a)),r.default.createElement("p",null,t("Resource Type"))),r.default.createElement("div",{className:c.default.item},r.default.createElement("div",null,l),r.default.createElement("p",null,t("Used"))),r.default.createElement("div",{className:c.default.item},r.default.createElement("div",null,(0,o.default)(n)?t("No Limits"):n),r.default.createElement("p",null,t("Resource Limit"))),r.default.createElement("div",{className:c.default.item,style:{flex:3}},r.default.createElement("div",null,t("Usage")),r.default.createElement(i.default,{value:Math.min(m,1),className:c.default.bar,rightText:n?"":t("No Limits"),text:"".concat(t("Used")," ").concat(Number((100*m).toFixed(2)),"%")})))};a.default=m},3555:function(e,t,a){e.exports={quota:"QuotaItem__quota--3_Chj",item:"QuotaItem__item--39hSv",bar:"QuotaItem__bar--3C2Dy"}},3556:function(e,t,a){e.exports={wrapper:"ResourceQuota__wrapper--2SomA",header:"ResourceQuota__header--3IWXK",item:"ResourceQuota__item--tXNdZ",content:"ResourceQuota__content--1slhr",contentItem:"ResourceQuota__contentItem--nMyfC"}},3557:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(22)),c=l(n(0)),f=l(n(38)),m=l(n(2525)),p=n(49),h=l(n(3558)),v=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props.detail,a=(0,p.cpuFormat)((0,d.default)(e,"limit.default.cpu")),n=(0,p.cpuFormat)((0,d.default)(e,"limit.defaultRequest.cpu")),l=(0,p.memoryFormat)((0,d.default)(e,"limit.default.memory")),r=(0,p.memoryFormat)((0,d.default)(e,"limit.defaultRequest.memory"));return c.default.createElement(m.default,{title:t("Container Resource Default Request")},c.default.createElement("div",{className:h.default.content},c.default.createElement("div",{className:h.default.contentItem},c.default.createElement(f.default,{name:"cpu",size:40}),c.default.createElement("div",{className:h.default.item},c.default.createElement("div",null,n?"".concat(n," Core"):t("No Request")),c.default.createElement("p",null,t("Resource Request"))),c.default.createElement("div",{className:h.default.item},c.default.createElement("div",null,a?"".concat(a," Core"):t("No Limit")),c.default.createElement("p",null,t("Resource Limit")))),c.default.createElement("div",{className:h.default.contentItem},c.default.createElement(f.default,{name:"memory",size:40}),c.default.createElement("div",{className:h.default.item},c.default.createElement("div",null,r?"".concat(r," Mi"):t("No Request")),c.default.createElement("p",null,t("Resource Request"))),c.default.createElement("div",{className:h.default.item},c.default.createElement("div",null,l?"".concat(l," Mi"):t("No Limit")),c.default.createElement("p",null,t("Resource Limit"))))))}}]),a}(c.default.Component);a.default=v},3558:function(e,t,a){e.exports={item:"DefaultResource__item--3AKgH",content:"DefaultResource__content--7hMYw",contentItem:"DefaultResource__contentItem--8Zz1A"}},3559:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=n(60),m=n(49),p=n(114),h=n(940),v=l(n(2559)),g=l(n(2519)),y=l(n(2518)),E=l(n(2539)),b=l(n(2526)),_=l(n(2527)),S=l(n(2831)),k=l(n(3565)),C=(0,f.inject)("rootStore")(r=(0,f.observer)(r=function(e){function a(){var e,n;(0,o.default)(this,a);for(var l=arguments.length,r=new Array(l),u=0;u<l;u++)r[u]=arguments[u];return(n=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(r)))).getColumns=function(){return[{title:t("Name"),dataIndex:"name",sorter:!0,sortOrder:n.getSortOrder("name"),search:!0,render:function(e,t){return c.default.createElement(g.default,{icon:p.ICON_TYPES[n.module],iconSize:40,title:(0,m.getDisplayName)(t),desc:t.description||"-",to:"".concat(n.prefix,"/").concat(e)})}},{title:t("Config Field"),dataIndex:"data",isHideable:!0,width:"33%",render:function(e){return Object.keys(e).join(",")}},{title:t("Created Time"),dataIndex:"createTime",sorter:!0,sortOrder:n.getSortOrder("createTime"),isHideable:!0,width:150,render:function(e){return(0,m.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}},{key:"more",width:20,render:n.renderMore}]},n.handleYamlEdit=function(e){var t=n.state.selectItem;n.store.update(t,e).then((function(){n.hideModal("editYamlModal")()}))},n.handleEditConfigMap=function(e){n.store.update(n.state.selectItem,e).then((function(){n.hideModal("editConfigMapModal")(),n.routing.query()}))},n}return(0,d.default)(a,e),(0,u.default)(a,[{key:"init",value:function(){this.store=new v.default,this.initWebsocket()}},{key:"renderExtraModals",value:function(){var e=this.state,t=e.createModal,a=e.editModal,n=e.editYamlModal,l=e.editConfigMapModal,r=e.selectItem,o=void 0===r?{}:r,u=this.store.isSubmitting;return c.default.createElement("div",null,c.default.createElement(E.default,{name:this.name,module:this.module,store:this.store,visible:t,steps:this.steps,formTemplate:this.formTemplate,isSubmitting:u,onOk:this.handleCreate,onCancel:this.hideModal("createModal")}),c.default.createElement(_.default,{visible:a,detail:o._originData,isSubmitting:u,onOk:this.handleEdit,onCancel:this.hideModal("editModal")}),c.default.createElement(b.default,{store:this.store,visible:n,detail:o._originData,isSubmitting:u,onOk:this.handleYamlEdit,onCancel:this.hideModal("editYamlModal")}),c.default.createElement(S.default,{visible:l,detail:o._originData,onOk:this.handleEditConfigMap,onCancel:this.hideModal("editConfigMapModal"),isSubmitting:u}))}},{key:"module",get:function(){return"configmaps"}},{key:"name",get:function(){return"ConfigMap"}},{key:"steps",get:function(){return k.default}},{key:"formTemplate",get:function(){var e=this.props.match.params.namespace;return(0,h.getFormTemplate)(e,this.module)}},{key:"itemActions",get:function(){return[{key:"edit",icon:"pen",text:t("Edit"),action:"edit",onClick:this.showModal("editModal")},{key:"editYaml",icon:"pen",text:t("Edit YAML"),action:"edit",onClick:this.showModal("editYamlModal")},{key:"editConfigMap",icon:"pen",text:t("Modify Config"),action:"edit",onClick:this.showModal("editConfigMapModal")},{key:"delete",icon:"trash",text:t("Delete"),action:"delete",onClick:this.showModal("deleteModal")}]}}]),a}(y.default))||r)||r;a.default=C},3560:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(82)),o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=l(n(269)),m=l(n(2535)),p=l(n(3561)),h=function(e){function a(){var e,t;(0,o.default)(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(t=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(l)))).handleDelete=function(e){return function(){var a=t.props,n=a.value;(0,a.onChange)((0,f.default)(n,e))}},t.handleEdit=function(e){return function(){(0,t.props.onEdit)(e)}},t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"renderContent",value:function(){var e=this,a=this.props,n=a.value,l=a.onAdd;return c.default.createElement(m.default,null,Object.entries(n).map((function(t){var a=(0,r.default)(t,2),n=a[0],l=a[1];return c.default.createElement(m.default.Item,{key:n,icon:"hammer",title:n,description:l||"-",onDelete:e.handleDelete(n),onEdit:e.handleEdit(n)})})),c.default.createElement(m.default.Add,{title:t("Add data"),description:t("Add key / value pair formal data"),onClick:l}))}},{key:"render",value:function(){return c.default.createElement("div",{className:p.default.wrapper},this.renderContent())}}]),a}(c.default.Component);a.default=h,h.defaultProps={value:{}}},3561:function(e,t,a){e.exports={wrapper:"DataList__wrapper--aDvnS"}},3562:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(30)),o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=l(n(1)),m=l(n(386)),p=l(n(2453)),h=l(n(267)),v=n(945),g=l(n(3563)),y=function(e){function a(){var e,t;(0,o.default)(this,a);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(t=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(l)))).formRef=c.default.createRef(),t.state={formData:t.getFormData()},t.registerForm=function(){var e=t.context.registerSubRoute,a=t.props.onCancel;e&&e(t.handleSubmit,a)},t.handleGoBack=function(){var e=t.context.resetSubRoute;e&&e(),t.props.onCancel()},t.handleSubmit=function(e){var a=t.props.onOk,n=t.formRef&&t.formRef.current;n&&n.validate((function(){var t=n.getData(),l=t.key,o=t.value;a((0,r.default)({},l,o)),e&&e()}))},t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"componentDidMount",value:function(){this.registerForm()}},{key:"getFormData",value:function(){var e=this.props,t=e.detail,a=e.selectKey;return{key:a||"",value:t[a]||""}}},{key:"render",value:function(){var e=this.props,a=e.detail,n=e.selectKey;return c.default.createElement("div",{className:g.default.wrapper},c.default.createElement("div",{className:"h6"},c.default.createElement("a",{className:"custom-icon",onClick:this.handleGoBack},c.default.createElement(v.ReactComponent,null)),a[n]?t("Edit data"):t("Add data")),c.default.createElement("div",{className:g.default.formWrapper},c.default.createElement(h.default,{data:this.state.formData,ref:this.formRef},c.default.createElement(h.default.Item,{label:t("DATA-KEY"),description:t("The unique key value of this configuration map entry")},c.default.createElement(m.default,{name:"key",placeholder:"key"})),c.default.createElement(h.default.Item,{label:t("DATA-VALUE"),description:t("Enter the value of the configuration map entry or use the contents of the file")},c.default.createElement(p.default,{name:"value",placeholder:"value",rows:4,resize:!0})))))}}]),a}(c.default.Component);a.default=y,y.defaultProps={detail:{},selectKey:""},y.contextTypes={registerSubRoute:f.default.func,resetSubRoute:f.default.func}},3563:function(e,t,a){e.exports={wrapper:"DataForm__wrapper--1PdX-",formWrapper:"DataForm__formWrapper--3EIYg",confirm:"DataForm__confirm--SELJh"}},3564:function(e,t,a){e.exports={body:"ConfigMapEdit__body--19MqC",confirm:"ConfigMapEdit__confirm--1LGqn"}},3565:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(49),r=n(a(2565)),o=n(a(2832)),u=[{title:"Basic Info",component:(0,l.withProps)(r.default,{maxNameLength:63}),required:!0},{title:"ConfigMap Settings",component:o.default,required:!0}];t.default=u},3566:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=n(60),m=l(n(2537)),p=n(49),h=n(114),v=n(940),g=l(n(2518)),y=l(n(2519)),E=l(n(388)),b=l(n(2539)),_=l(n(2526)),S=l(n(2527)),k=l(n(2833)),C=l(n(3576)),w=(0,f.inject)("rootStore")(r=(0,f.observer)(r=function(e){function a(){var e,n;(0,o.default)(this,a);for(var l=arguments.length,r=new Array(l),u=0;u<l;u++)r[u]=arguments[u];return(n=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(r)))).getColumns=function(){return[{title:t("Name"),dataIndex:"name",sorter:!0,sortOrder:n.getSortOrder("name"),search:!0,render:function(e,t){return c.default.createElement(y.default,{icon:h.ICON_TYPES[n.module],iconSize:40,title:(0,p.getDisplayName)(t),desc:t.description||"-",to:"".concat(n.prefix,"/").concat(e)})}},{title:t("Type"),dataIndex:"type",isHideable:!0,width:"24%",render:function(e){return t(h.SECRET_TYPES[e]||e)}},{title:t("Config Number"),dataIndex:"data",isHideable:!0,width:"20%",render:function(e){return Object.keys(e).length}},{title:t("Created Time"),dataIndex:"createTime",sorter:!0,sortOrder:n.getSortOrder("createTime"),isHideable:!0,width:150,render:function(e){return(0,p.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}},{key:"more",width:20,render:n.renderMore}]},n.handleYamlEdit=function(e){var t=n.state.selectItem;n.store.update(t,e).then((function(){n.hideModal("editYamlModal")()}))},n.handleEditSecret=function(e){n.store.updateWithEncode(n.state.selectItem,e).then((function(){n.hideModal("editSecretModal")(),E.default.success({content:"".concat(t("Updated Successfully"),"!")}),n.routing.query()}))},n}return(0,d.default)(a,e),(0,u.default)(a,[{key:"init",value:function(){this.store=new m.default,this.initWebsocket()}},{key:"renderExtraModals",value:function(){var e=this.state,t=e.createModal,a=e.editModal,n=e.editYamlModal,l=e.editSecretModal,r=e.selectItem,o=void 0===r?{}:r,u=this.store.isSubmitting;return c.default.createElement("div",null,c.default.createElement(b.default,{name:this.name,module:this.module,store:this.store,visible:t,steps:this.steps,formTemplate:this.formTemplate,isSubmitting:u,onOk:this.handleCreate,onCancel:this.hideModal("createModal")}),c.default.createElement(S.default,{visible:a,detail:o._originData,isSubmitting:u,onOk:this.handleEdit,onCancel:this.hideModal("editModal")}),c.default.createElement(_.default,{store:this.store,visible:n,detail:o._originData,isSubmitting:u,onOk:this.handleYamlEdit,onCancel:this.hideModal("editYamlModal")}),c.default.createElement(k.default,{visible:l,detail:o,onOk:this.handleEditSecret,onCancel:this.hideModal("editSecretModal"),isSubmitting:this.store.isSubmitting}))}},{key:"module",get:function(){return"secrets"}},{key:"name",get:function(){return"Secret"}},{key:"steps",get:function(){return C.default}},{key:"formTemplate",get:function(){var e=this.props.match.params.namespace;return(0,v.getFormTemplate)(e,this.module)}},{key:"itemActions",get:function(){return[{key:"edit",icon:"pen",text:t("Edit"),action:"edit",onClick:this.showModal("editModal")},{key:"editYaml",icon:"pen",text:t("Edit YAML"),action:"edit",onClick:this.showModal("editYamlModal")},{key:"editSecret",icon:"pen",text:t("Edit Secret"),action:"edit",onClick:this.showModal("editSecretModal")},{key:"delete",icon:"trash",text:t("Delete"),action:"delete",onClick:this.showModal("deleteModal")}]}}]),a}(g.default))||r)||r;a.default=w},3567:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(70)),o=l(n(97)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(0)),m=l(n(386)),p=l(n(225)),h=l(n(38)),v=l(n(2530)),g=l(n(3568)),y=function(e){function a(e){var t;(0,u.default)(this,a),(t=(0,s.default)(this,(0,d.default)(a).call(this,e))).handleSelectChange=function(e){var a=t.props.onChange;e?t.setState({mode:"select"}):t.setState({mode:"input"}),a&&a(e)},t.changeToSelect=function(){var e=t.props,a=e.onChange,n=e.options;t.setState({mode:"select"},(function(){a&&a(n[0].value)}))};var n=e.value||e.defaultValue,l=e.options.find((function(e){return e.value===n}));return t.state={mode:l?"select":"input"},t}return(0,c.default)(a,e),(0,i.default)(a,[{key:"render",value:function(){var e=this.props,a=e.options,n=e.inputType,l=[].concat((0,o.default)(a),[{label:t("Custom"),value:""}]);return"input"===this.state.mode?f.default.createElement("span",{className:g.default.inputWrapper},"number"===n?f.default.createElement(v.default,(0,r.default)({},this.props,{placeholder:"",autoFocus:!0})):f.default.createElement(m.default,(0,r.default)({},this.props,{placeholder:"",autoFocus:!0})),f.default.createElement(h.default,{name:"changing-over",clickable:!0,onClick:this.changeToSelect})):f.default.createElement(p.default,(0,r.default)({},this.props,{options:l,onChange:this.handleSelectChange}))}}]),a}(f.default.Component);a.default=y},3568:function(e,t,a){e.exports={inputWrapper:"CustomSelect__inputWrapper--224-s"}},3569:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(82)),r=n(a(13)),o=n(a(14)),u=n(a(17)),i=n(a(16)),s=n(a(18)),d=n(a(0)),c=n(a(225)),f=n(a(386)),m=a(114),p=n(a(3570)),h=function(e){function t(){var e,a;(0,r.default)(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=(0,u.default)(this,(e=(0,i.default)(t)).call.apply(e,[this].concat(o)))).handleInputChange=function(e,t){var n=(t=t.toLowerCase()).match(m.SCHEME_REG)||[],r=(0,l.default)(n,4),o=r[1],u=void 0===o?a.schemeValue:o,i=r[3],s=void 0===i?"":i;a.props.onChange("".concat(u).concat(s))},a.handleSchemeChange=function(e){a.props.onChange("".concat(e).concat(a.inputValue))},a}return(0,s.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){return d.default.createElement("div",{className:p.default.container},d.default.createElement(c.default,{value:this.schemeValue,className:p.default.select,options:m.SCHEME_OPTIONS,onChange:this.handleSchemeChange}),d.default.createElement(f.default,{className:p.default.input,onChange:this.handleInputChange,value:this.inputValue,autoComplete:"off"}))}},{key:"inputValue",get:function(){var e=this.props.value.match(m.SCHEME_REG)||[],t=(0,l.default)(e,4)[3];return void 0===t?"":t}},{key:"schemeValue",get:function(){var e=this.props.value.match(m.SCHEME_REG)||[],t=(0,l.default)(e,2)[1];return void 0===t?"https://":t}}]),t}(d.default.Component);t.default=h,h.defaultProps={className:"",value:"",onChange:function(){}}},3570:function(e,t,a){e.exports={container:"SchemeInput__container--2VDZ-",select:"SchemeInput__select--1njJE"}},3571:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(82)),o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=l(n(269)),m=l(n(2535)),p=l(n(3572)),h=function(e){function a(){var e,t;(0,o.default)(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(t=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(l)))).handleDelete=function(e){return function(){var a=t.props,n=a.value;(0,a.onChange)((0,f.default)(n,e))}},t.handleEdit=function(e){return function(){(0,t.props.onEdit)(e)}},t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"renderContent",value:function(){var e=this,a=this.props,n=a.value,l=a.onAdd;return c.default.createElement(m.default,null,Object.entries(n).map((function(t){var a=(0,r.default)(t,2),n=a[0],l=a[1];return c.default.createElement(m.default.Item,{key:n,icon:"key",title:n,description:l||"-",onDelete:e.handleDelete(n),onEdit:e.handleEdit(n)})})),c.default.createElement(m.default.Add,{title:t("Add data"),description:t("Add key / value pair formal data"),onClick:l}))}},{key:"render",value:function(){return c.default.createElement("div",{className:p.default.wrapper},this.renderContent())}}]),a}(c.default.Component);a.default=h,h.defaultProps={value:{}}},3572:function(e,t,a){e.exports={wrapper:"DataList__wrapper---jwoK"}},3573:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(30)),o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=l(n(1)),m=l(n(386)),p=l(n(2453)),h=l(n(267)),v=n(945),g=l(n(3574)),y=function(e){function a(){var e,t;(0,o.default)(this,a);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(t=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(l)))).formRef=c.default.createRef(),t.state={formData:t.getFormData()},t.registerForm=function(){var e=t.context.registerSubRoute,a=t.props.onCancel;e&&e(t.handleSubmit,a)},t.handleGoBack=function(){var e=t.context.resetSubRoute;e&&e(),t.props.onCancel()},t.handleSubmit=function(e){var a=t.props.onOk,n=t.formRef&&t.formRef.current;n&&n.validate((function(){var t=n.getData(),l=t.key,o=t.value;a((0,r.default)({},l,o)),e&&e()}))},t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"componentDidMount",value:function(){this.registerForm()}},{key:"getFormData",value:function(){var e=this.props,t=e.detail,a=e.selectKey;return{key:a||"",value:t[a]||""}}},{key:"render",value:function(){var e=this.props,a=e.detail,n=e.selectKey;return c.default.createElement("div",{className:g.default.wrapper},c.default.createElement("div",{className:"h6"},c.default.createElement("a",{className:"custom-icon",onClick:this.handleGoBack},c.default.createElement(v.ReactComponent,null)),a[n]?t("Edit data"):t("Add data")),c.default.createElement("div",{className:g.default.formWrapper},c.default.createElement(h.default,{data:this.state.formData,ref:this.formRef},c.default.createElement(h.default.Item,{label:t("DATA-KEY")},c.default.createElement(m.default,{name:"key",placeholder:"key"})),c.default.createElement(h.default.Item,{label:t("DATA-VALUE")},c.default.createElement(p.default,{name:"value",placeholder:"value",rows:4,resize:!0})))))}}]),a}(c.default.Component);a.default=y,y.defaultProps={detail:{},selectKey:""},y.contextTypes={registerSubRoute:f.default.func,resetSubRoute:f.default.func}},3574:function(e,t,a){e.exports={wrapper:"DataForm__wrapper--1Ulfr",formWrapper:"DataForm__formWrapper--1Nq08",confirm:"DataForm__confirm--1BpCY"}},3575:function(e,t,a){e.exports={body:"SecretEdit__body--ok_C6",confirm:"SecretEdit__confirm--3kOQ-"}},3576:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(49),r=n(a(2565)),o=n(a(2834)),u=[{title:"Basic Info",component:(0,l.withProps)(r.default,{maxNameLength:63}),required:!0},{title:"Secret Settings",component:o.default,required:!0}];t.default=u},3577:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(37)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(22)),m=l(n(115)),p=l(n(0)),h=n(19),v=n(60),g=n(49),y=n(114),E=l(n(2519)),b=l(n(2623)),_=l(n(2624)),S=l(n(2523)),k=l(n(940)),C=l(n(2557)),w=l(n(2518)),N=_.default,T=(0,v.inject)("rootStore")(r=(0,v.observer)(r=function(e){function a(){var e,n;(0,u.default)(this,a);for(var l=arguments.length,r=new Array(l),o=0;o<l;o++)r[o]=arguments[o];return(n=(0,s.default)(this,(e=(0,d.default)(a)).call.apply(e,[this].concat(r)))).getColumns=function(){return[{title:t("Name"),dataIndex:"name",sorter:!0,sortOrder:n.getSortOrder("name"),search:!0,render:function(e){return p.default.createElement(E.default,{icon:y.ICON_TYPES[n.module],title:e,to:"".concat(n.prefix,"/").concat(e)})}},{title:t("Description"),key:"description",dataIndex:"description",isHideable:!0,width:"40%",render:function(e,a){var n=(0,f.default)(a,"name");return e&&globals.config.presetRoles.includes(n)?t(e):e}},{title:t("Created Time"),dataIndex:"createTime",sorter:!0,sortOrder:n.getSortOrder("createTime"),isHideable:!0,width:150,render:function(e){return(0,g.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}},{key:"more",render:n.renderMore}]},n}return(0,c.default)(a,e),(0,i.default)(a,[{key:"init",value:function(){this.store=new C.default,this.store.fetchRulesInfo()}},{key:"getTableProps",value:function(){return(0,o.default)({},w.default.prototype.getTableProps.call(this),{selectActions:[]})}},{key:"getDetailFormTemplate",value:function(e){if(!e)return{};var t=this.formTemplate;return(0,m.default)(t,"metadata.name",e.name),(0,m.default)(t,"metadata.annotations['kubesphere.io/description']",(0,f.default)(e,"description")),t}},{key:"renderModals",value:function(){var e=this.state,a=e.editModal,n=e.createModal,l=e.deleteModal,r=e.selectItem,o=void 0===r?{}:r,u=this.store,i=u.isSubmitting,s=u.rulesInfo;return p.default.createElement("div",null,p.default.createElement(b.default,{detail:o,module:this.module,visible:l,isSubmitting:i,onOk:this.handleDelete,onCancel:this.hideModal("deleteModal")}),p.default.createElement(N,{store:this.store,visible:a,title:t("Edit Project Role"),rulesInfo:(0,h.toJS)(s),formTemplate:this.getDetailFormTemplate(o),isSubmitting:i,onOk:this.handleEdit,onCancel:this.hideModal("editModal"),edit:!0}),p.default.createElement(_.default,{store:this.store,visible:n,rulesInfo:(0,h.toJS)(s),formTemplate:this.formTemplate,isSubmitting:i,onOk:this.handleCreate,onCancel:this.hideModal("createModal")}))}},{key:"renderHeader",value:function(){return p.default.createElement("div",{className:"margin-b12"},p.default.createElement(S.default,{icon:"role",title:t("Project Roles"),description:t("PROJECT_ROLE_DESC"),module:"project_roles"}))}},{key:"module",get:function(){return"roles"}},{key:"name",get:function(){return"Project Role"}},{key:"formTemplate",get:function(){var e=this.props.match.params.namespace;return k.default[this.module]({namespace:e})}},{key:"itemActions",get:function(){return[{key:"edit",icon:"pen",text:t("Edit"),action:"edit",show:function(e){return!globals.config.presetRoles.includes(e.name)},onClick:this.showModal("editModal")},{key:"delete",icon:"trash",text:t("Delete"),action:"delete",show:function(e){return!globals.config.presetRoles.includes(e.name)},onClick:this.showModal("deleteModal")}]}}]),a}(w.default))||r)||r;a.default=T},3578:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(70)),u=l(n(37)),i=l(n(13)),s=l(n(14)),d=l(n(17)),c=l(n(16)),f=l(n(18)),m=l(n(58)),p=l(n(50)),h=l(n(0)),v=n(19),g=n(60),y=n(49),E=l(n(2519)),b=l(n(2584)),_=l(n(2542)),S=l(n(2524)),k=l(n(2659)),C=l(n(2660)),w=l(n(2523)),N=l(n(2518)),T=l(n(2557)),P=(0,g.inject)("rootStore")(r=(0,g.observer)(r=function(e){function a(){var e,n;(0,i.default)(this,a);for(var l=arguments.length,r=new Array(l),o=0;o<l;o++)r[o]=arguments[o];return(n=(0,d.default)(this,(e=(0,c.default)(a)).call.apply(e,[this].concat(r)))).handlePaging=function(e){return n.list.paging(e)},n.getColumns=function(){return[{title:t("Member Name"),dataIndex:"username",search:!0,render:function(e,t){return h.default.createElement(E.default,{avatar:t.avatar_url||"/assets/default-user.svg",title:e,desc:t.email||"-",noLink:!0})}},{title:t("Status"),dataIndex:"status",isHideable:!0,width:"19%",render:function(e){return h.default.createElement(b.default,{status:e})}},{title:t("Role"),dataIndex:"role",isHideable:!0,width:"19%"},{title:t("Last Login Time"),dataIndex:"last_login_time",isHideable:!0,width:150,render:function(e){return h.default.createElement("p",null,e?(0,y.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss"):t("Not logged in yet"))}},{key:"more",width:20,render:function(e,t){return t.username===globals.user.username?null:n.renderMore(e,t)}}]},n.handleInvite=function(e,t){var a=n.props.match.params.namespace;n.store.addMember(a,e,t).then((function(){n.routing.query()}))},n.handleModify=function(e,t){var a=n.props.match.params.namespace,l=[];(0,p.default)(e)?e.forEach((function(e){l.push(n.store.changeMemberRole(a,e,t))})):l.push(n.store.changeMemberRole(a,e,t)),Promise.all(l).then((function(){(0,p.default)(e)&&n.store.setSelectRowKeys("members",[]),n.hideModal("modifyModal")(),n.routing.query()}))},n.handleDelete=function(){var e=n.state.selectItem,t=n.props.match.params.namespace;n.store.deleteMember(t,e).then((function(){n.hideModal("deleteModal")(),n.routing.query()}))},n.handleSelectRowKeys=function(e){n.store.setSelectRowKeys("members",e)},n.handleBatchDelete=function(){var e=n.props.match.params.namespace,t=n.store.members.selectedRowKeys;t.length>0&&n.store.batchDeleteMembers(e,t).then((function(){n.hideModal("batchDeleteModal")(),n.store.setSelectRowKeys("members",[]),n.routing.query()}))},n}return(0,f.default)(a,e),(0,s.default)(a,[{key:"init",value:function(){this.store=this.props.rootStore.project,this.roleStore=new T.default,this.roleStore.fetchList(this.props.match.params)}},{key:"getData",value:function(e){this.store.fetchMembers((0,u.default)({},this.props.match.params,e))}},{key:"getEmptyProps",value:function(){return{createText:t("Invite Member")}}},{key:"getTableProps",value:function(){return{hideSearch:!0,onFetch:this.handleFetch,onPaging:this.handlePaging,onSelectRowKeys:this.handleSelectRowKeys,onDelete:this.showModal("batchDeleteModal"),actions:[{key:"invite",type:"control",text:t("Invite Member"),action:"create",onClick:this.showModal("inviteModal")}],selectActions:[{key:"delete",type:"danger",text:t("Remove Members"),action:"delete",onClick:this.showModal("batchDeleteModal")}],getCheckboxProps:function(e){return{disabled:e.username===globals.user.username,name:e.username}}}}},{key:"renderEmpty",value:function(){var e=this.enabledActions.includes("create")?this.showModal("inviteModal"):null;return h.default.createElement(_.default,(0,o.default)({name:this.name,onCreate:e},this.getEmptyProps()))}},{key:"renderModals",value:function(){var e=this.state,a=e.modifyModal,n=e.inviteModal,l=e.deleteModal,r=e.batchDeleteModal,o=e.selectItem,u=void 0===o?{}:o,i=(0,v.toJS)(this.store.members),s=i.selectedRowKeys,d=i.originData,c=(0,v.toJS)(this.roleStore.list.data),f=(0,m.default)(u)?s.map((function(e){return d.find((function(t){return t.username===e}))})):[u],p=this.list.selectedRowKeys.join(", ");return h.default.createElement("div",null,h.default.createElement(S.default,{title:t("Sure to remove"),desc:t.html("REMOVE_MEMBER_TIP",{resource:u[this.rowKey]}),resource:u[this.rowKey],visible:l,onOk:this.handleDelete,onCancel:this.hideModal("deleteModal"),isSubmitting:this.store.isSubmitting}),this.list.selectedRowKeys&&h.default.createElement(S.default,{visible:r,title:t("Sure to remove"),desc:t.html("REMOVE_MEMBER_TIP",{resource:p}),resource:p,onOk:this.handleBatchDelete,onCancel:this.hideModal("batchDeleteModal"),isSubmitting:this.store.isSubmitting}),h.default.createElement(k.default,{roles:c,users:f,visible:a,onOk:this.handleModify,onCancel:this.hideModal("modifyModal"),isSubmitting:this.store.isSubmitting}),h.default.createElement(C.default,{visible:n,workspace:this.workspace,roles:c,users:d,onOk:this.handleInvite,onCancel:this.hideModal("inviteModal"),isSubmitting:this.store.isSubmitting}))}},{key:"renderHeader",value:function(){return h.default.createElement("div",{className:"margin-b12"},h.default.createElement(w.default,{icon:"group",title:t("Project Members"),description:t("PROJECT_MEMBERS_DESC"),module:"project_roles",tips:this.tips}))}},{key:"module",get:function(){return"users"}},{key:"authKey",get:function(){return"members"}},{key:"name",get:function(){return"Member"}},{key:"workspace",get:function(){return this.store.data.workspace}},{key:"rowKey",get:function(){return"username"}},{key:"list",get:function(){return this.store.members}},{key:"tips",get:function(){return[{title:t("HOW_TO_INVITE_MEMBER_Q"),description:t("HOW_TO_INVITE_MEMBER_A")}]}},{key:"itemActions",get:function(){return[{key:"modify",icon:"pen",text:t("Modify Member Role"),action:"edit",onClick:this.showModal("modifyModal")},{key:"delete",icon:"trash",text:t("Remove Member"),action:"delete",onClick:this.showModal("deleteModal")}]}}]),a}(N.default))||r)||r;a.default=P},3579:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=n(60),m=l(n(58)),p=l(n(2523)),h=l(n(3580)),v=l(n(3582)),g=(0,f.inject)("rootStore")(r=(0,f.observer)(r=function(e){function a(){return(0,o.default)(this,a),(0,i.default)(this,(0,s.default)(a).apply(this,arguments))}return(0,d.default)(a,e),(0,u.default)(a,[{key:"render",value:function(){return c.default.createElement("div",null,c.default.createElement(p.default,{icon:"cogwheel",title:t("Advanced Settings"),description:t("PROJECT_ADVANCED_SETTINGS_DESC"),tips:this.tips}),c.default.createElement(h.default,{match:this.props.match,actions:this.enableActions}),globals.app.hasKSModule("logging")&&!this.disabledLoggingSideCar&&c.default.createElement(v.default,{store:this.store,actions:this.enableActions}))}},{key:"store",get:function(){return this.props.rootStore.project}},{key:"namespace",get:function(){return this.props.match.params.namespace}},{key:"enableActions",get:function(){return globals.app.getActions({module:"advanced",project:this.namespace})}},{key:"disabledLoggingSideCar",get:function(){return!(0,m.default)(globals.config.disabledLoggingSidecarNamespace)&&globals.config.disabledLoggingSidecarNamespace.includes(this.namespace)}},{key:"tips",get:function(){return[{title:t("WHAT_IS_INTERNET_GATEWAY"),description:t("PROJECT_INTERNET_ACCESS_DESC")},{title:t("What is collecting file log ?"),description:t("WHAT_IS_COLLECT_FILE_LOG_A")}]}}]),a}(c.default.Component))||r)||r;a.default=g},3580:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(82)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(58)),m=l(n(0)),p=n(19),h=n(60),v=l(n(3)),g=l(n(190)),y=l(n(271)),E=l(n(38)),b=l(n(224)),_=l(n(2525)),S=l(n(2830)),k=l(n(2524)),C=l(n(2556)),w=l(n(3581)),N=(0,h.inject)("rootStore")(r=(0,h.observer)(r=function(e){function a(e){var t;return(0,u.default)(this,a),(t=(0,s.default)(this,(0,d.default)(a).call(this,e))).showGatewaySetting=function(){t.setState({showGatewaySetting:!0})},t.hideGatewaySetting=function(){t.setState({showGatewaySetting:!1})},t.handleGatewaySetting=function(e){t.hideGatewaySetting();var a=t.props.match.params.namespace,n=(0,p.toJS)(t.store.gateway.data);((0,f.default)(n)?t.store.addGateway.bind(t.store):t.store.updateGateway.bind(t.store))({namespace:a},e).then((function(){t.store.getGateway({namespace:a})}))},t.hideDelete=function(){t.setState({showDelete:!1})},t.handleDelete=function(){var e=t.props.match.params.namespace;t.store.deleteGateway({namespace:e}).then((function(){t.hideDelete(),t.store.getGateway({namespace:e})}))},t.handleMoreMenuClick=function(e,a){switch(a){case"edit":t.setState({showGatewaySetting:!0});break;case"delete":t.setState({showDelete:!0})}},t.state={showGatewaySetting:!1,showDelete:!1},t.store=new C.default,t}return(0,c.default)(a,e),(0,i.default)(a,[{key:"componentDidMount",value:function(){this.store.getGateway(this.props.match.params)}},{key:"getNodePorts",value:function(e){return e.ports?e.ports.map((function(e){return"".concat(e.name,":").concat(e.nodePort)})).join(", "):"-"}},{key:"getExternalIP",value:function(e){return((0,f.default)(e.externalIPs)?e.loadBalancerIngress:e.externalIPs.join(", "))||"-"}},{key:"renderEmpty",value:function(){return m.default.createElement(_.default,{className:"margin-t12 margin-b12",title:t("Internet Access")},m.default.createElement("div",{className:w.default.empty},m.default.createElement("div",{className:w.default.icon},m.default.createElement(E.default,{name:"loadbalancer",size:40})),m.default.createElement("div",{className:w.default.text},m.default.createElement("div",null,t("Gateway not set")),m.default.createElement("p",null,t("PROJECT_INTERNET_ACCESS_DESC"))),this.canEdit&&m.default.createElement(b.default,{className:"margin-t12",type:"control",onClick:this.showGatewaySetting},t("Set Gateway"))))}},{key:"renderMoreMenu",value:function(){return m.default.createElement(y.default,{onClick:this.handleMoreMenuClick},this.itemActions.map((function(e){return m.default.createElement(y.default.MenuItem,{key:e.key},m.default.createElement(E.default,{name:e.icon})," ",e.text)})))}},{key:"renderOperations",value:function(){return m.default.createElement(g.default,{content:this.renderMoreMenu(),trigger:"click",placement:"bottomRight"},m.default.createElement(b.default,{icon:"more",type:"flat"}))}},{key:"renderInternetAccess",value:function(e){return m.default.createElement(_.default,{className:"margin-t12",title:t("Internet Access")},m.default.createElement("div",{className:w.default.header},m.default.createElement(E.default,{name:"eip-group",size:40}),m.default.createElement("div",{className:w.default.item},m.default.createElement("div",null,e.type),m.default.createElement("p",null,t("Access Method"))),"NodePort"===e.type?m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{className:w.default.item},m.default.createElement("div",null,e.loadBalancerIngress||"-"),m.default.createElement("p",null,t("Gateway Address"))),m.default.createElement("div",{className:w.default.item},m.default.createElement("div",null,this.getNodePorts(e)),m.default.createElement("p",null,t("Node Port")))):m.default.createElement("div",{className:w.default.item},m.default.createElement("div",null,this.getExternalIP(e)),m.default.createElement("p",null,t("External IP"))),globals.app.hasKSModule("servicemesh")&&m.default.createElement("div",{className:w.default.item},m.default.createElement("div",null,e.serviceMeshEnable?t("GATEWAY_SERVICE_MESH_STATUS_ON"):t("GATEWAY_SERVICE_MESH_STATUS_OFF")),m.default.createElement("p",null,t("Application Governance"))),this.canEdit&&m.default.createElement("div",{className:(0,v.default)(w.default.item,"text-right")},m.default.createElement(g.default,{className:"dropdown-default",content:this.renderMoreMenu(),trigger:"click",placement:"bottomRight"},m.default.createElement(b.default,null,t("Edit"))))),"LoadBalancer"===e.type&&m.default.createElement("div",{className:w.default.annotations},m.default.createElement("p",null,t("Annotations")),m.default.createElement("ul",null,Object.entries(e.annotations).map((function(e){var t=(0,o.default)(e,2),a=t[0],n=t[1];return m.default.createElement("li",{key:a},m.default.createElement("span",{className:w.default.key},a),m.default.createElement("span",null,n))})))))}},{key:"renderContent",value:function(){var e=(0,p.toJS)(this.store.gateway),t=e.data;return e.isLoading?null:(0,f.default)(t)?this.renderEmpty():this.renderInternetAccess(t)}},{key:"renderModals",value:function(){return m.default.createElement("div",null,m.default.createElement(S.default,{detail:(0,p.toJS)(this.store.gateway.data),visible:this.state.showGatewaySetting,onOk:this.handleGatewaySetting,onCancel:this.hideGatewaySetting,isSubmitting:this.store.isSubmitting}),m.default.createElement(k.default,{title:t("DELETE_INTERNET_ACCESS_TITLE"),desc:t("DELETE_INTERNET_ACCESS_DESC"),visible:this.state.showDelete,onOk:this.handleDelete,onCancel:this.hideDelete,isSubmitting:this.store.isSubmitting}))}},{key:"render",value:function(){return m.default.createElement("div",null,this.renderContent(),this.canEdit&&this.renderModals())}},{key:"canEdit",get:function(){return this.props.actions.includes("manage")}},{key:"itemActions",get:function(){return[{key:"edit",icon:"pen",text:t("Edit Gateway")},{key:"delete",icon:"trash",text:t("Delete")}]}}]),a}(m.default.Component))||r)||r;a.default=N},3581:function(e,t,a){e.exports={header:"InternetAccess__header--3y31O",item:"InternetAccess__item--1JEsK",annotations:"InternetAccess__annotations--193FB",empty:"InternetAccess__empty--3Y_lc",icon:"InternetAccess__icon--3r9S6",text:"InternetAccess__text--1A7F5"}},3582:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=l(n(3)),m=l(n(22)),p=n(60),h=l(n(38)),v=l(n(2651)),g=l(n(2525)),y=l(n(2544)),E=l(n(387)),b=l(n(3583)),_=(0,p.observer)(r=function(e){function a(){var e,t;(0,o.default)(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(t=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(l)))).state={showCloseConfirm:!1},t.handleSwitch=function(){var e=t.props.store.data;return"enabled"===(0,m.default)(e,'labels["logging.kubesphere.io/logsidecar-injection"]')?t.setState({showCloseConfirm:!0}):t.handleToggle()},t.handleToggle=function(){var e=t.props.store.data,a="enabled"===(0,m.default)(e,'labels["logging.kubesphere.io/logsidecar-injection"]');t.props.store.patch({name:e.name},{metadata:{labels:{"logging.kubesphere.io/logsidecar-injection":a?"disabled":"enabled"}}}).then((function(){t.hideCloseConfirm(),t.props.store.fetchDetail({namespace:e.name})}))},t.hideCloseConfirm=function(){t.setState({showCloseConfirm:!1})},t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"render",value:function(){var e=this.state.showCloseConfirm,a=this.props.store.data,n="enabled"===(0,m.default)(a,'labels["logging.kubesphere.io/logsidecar-injection"]');return c.default.createElement(c.default.Fragment,null,c.default.createElement(g.default,{title:t("Collecting File Log")},c.default.createElement("div",{className:b.default.header},c.default.createElement(h.default,{name:"log",size:40}),c.default.createElement("div",{className:b.default.item},c.default.createElement("div",null,n?t("Opened"):t("Closed")),c.default.createElement("p",null,t("Collecting File Log"))),this.canEdit&&c.default.createElement("div",{className:(0,f.default)(b.default.item,"text-right")},c.default.createElement(v.default,{type:"control",text:n?t("Opened"):t("Closed"),onChange:this.handleSwitch,checked:n}))),c.default.createElement(y.default,{message:t("COLLECTING_FILE_LOG_DESC"),hideIcon:!0})),this.canEdit&&c.default.createElement(E.default,{visible:e,onOk:this.handleToggle,onCancel:this.hideCloseConfirm,width:520,hideHeader:!0},c.default.createElement("div",{className:b.default.modalHeader},c.default.createElement(h.default,{name:"question",size:40,color:{primary:"#fff",secondary:"#329dce"}}),c.default.createElement("div",{className:b.default.title},c.default.createElement("div",null,t("Are you sure to close ?")),c.default.createElement("p",null,t("The project's file log collection is about to close.")))),c.default.createElement("div",null,t.html("CLOSE_FILE_LOG_TIP"))))}},{key:"canEdit",get:function(){return this.props.actions.includes("manage")}}]),a}(c.default.Component))||r;a.default=_},3583:function(e,t,a){e.exports={header:"LogCollection__header--27Iir",item:"LogCollection__item--wV16T",modalHeader:"LogCollection__modalHeader--2iQd2",title:"LogCollection__title--3P5XR"}},3584:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(97)),r=n(a(3585)),o=n(a(3624)),u=n(a(3636)),i=n(a(3642)),s=n(a(3647)),d=n(a(3651)),c=[].concat((0,l.default)(r.default),(0,l.default)(o.default),(0,l.default)(u.default),(0,l.default)(i.default),(0,l.default)(s.default),(0,l.default)(d.default));t.default=c},3585:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(97)),r=a(49),o=a(564),u=n(a(2517)),i=n(a(2548)),s=n(a(2585)),d=n(a(2673)),c=n(a(2675)),f=n(a(2611)),m=n(a(2677)),p=n(a(2679)),h=n(a(2680)),v=a(2547),g="deployments",y="/projects/:namespace/".concat(g,"/:name"),E="".concat(y,"/revisions/:revision"),b=[{name:"resource-status",title:"Resource Status",component:f.default},{name:"revision-control",title:"Revision Control",component:c.default},{name:"monitors",title:"Monitoring",component:m.default},{name:"env",title:"Environment Variables",component:s.default},{name:"events",title:"Events",component:i.default}],_=[{name:"config-template",title:"Config Template",component:h.default},{name:"env",title:"Environment Variables",component:s.default},{name:"events",title:"Events",component:i.default}],S=[{label:"Project",url:"/projects/:namespace"},{label:"Deployments",url:"/projects/:namespace/".concat(g)}],k=[].concat((0,l.default)((0,v.getPodRoutes)(y,[].concat(S,[{label:"Detail",url:"/projects/:namespace/".concat(g,"/:name")}]))),[{path:E,component:(0,r.withProps)(u.default,{module:g,component:p.default,breadcrumbs:[].concat(S,[{label:"Revision Control",url:"/projects/:namespace/".concat(g,"/:name/revision-control")}])}),routes:(0,o.getChildRoutes)(_,E)},{path:y,component:(0,r.withProps)(u.default,{module:g,component:d.default,breadcrumbs:S}),routes:(0,o.getChildRoutes)(b,y)}]);t.default=k},3586:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(70)),o=l(n(30)),u=l(n(37)),i=l(n(13)),s=l(n(17)),d=l(n(16)),c=l(n(14)),f=l(n(18)),m=l(n(0)),p=l(n(1)),h=l(n(3)),v=l(n(58)),g=l(n(22)),y=l(n(38)),E=l(n(224)),b=l(n(954)),_=l(n(3587)),S=l(n(2837)),k=function(e){function a(e){var t;return(0,i.default)(this,a),(t=(0,s.default)(this,(0,d.default)(a).call(this,e))).registerSubRoute=function(e,a){t.setState({subRoute:{onSave:e,onCancel:a}})},t.resetSubRoute=function(){t.setState({subRoute:{}})},t.handleSubFormSave=function(){var e=t.state.subRoute;e&&e.onSave&&e.onSave((function(){t.setState({subRoute:{}})}))},t.handleSubFormCancel=function(){var e=t.state.subRoute;e&&e.onCancel&&(e.onCancel(),t.setState({subRoute:{}}))},t.handlePrev=function(){t.setState((function(e){var t=e.subRoute;return t&&t.onCancel&&t.onCancel(),{subRoute:{}}}))},t.handleChangeTab=function(e){var a=e.target.dataset.name;a&&t.setState({activeTab:a,subRoute:{}})},t.handleSaveForm=function(e,a){t.setState((function(t){var n=t.updatedTabs;return n[e]=a,{updatedTabs:n,formData:a}}))},t.handleSubmit=function(){var e=t.state.updatedTabs;(0,v.default)(e)?t.props.onCancel():t.props.onSubmit(t.state.formData,Object.keys(e))},t.tabs=e.forms.map((function(e){return(0,u.default)({},e,{component:(0,_.default)(e.component)})})),t.state={formData:e.data,activeTab:(0,g.default)(t.tabs,"[0].name"),updatedTabs:{},subRoute:{}},t}return(0,f.default)(a,e),(0,c.default)(a,[{key:"getChildContext",value:function(){return{registerSubRoute:this.registerSubRoute,resetSubRoute:this.resetSubRoute}}}]),(0,c.default)(a,[{key:"renderTabs",value:function(){var e=this.state,a=e.activeTab,n=e.updatedTabs;return m.default.createElement("ul",{className:S.default.tabs,onClick:this.handleChangeTab},this.tabs.map((function(e){var l=e.icon,r=e.title,u=e.name,i=u===a,s=i?"light":"dark";return m.default.createElement("li",{key:r,"data-name":u,className:(0,h.default)((0,o.default)({},S.default.active,i))},m.default.createElement("div",{className:S.default.icon},m.default.createElement(y.default,{name:l||"appcenter",size:20,type:s})),m.default.createElement("p",null,t(r)),m.default.createElement(y.default,{className:(0,h.default)(S.default.updated,(0,o.default)({},S.default.active,n[u])),name:"exclamation",size:18,color:{primary:"#fff",secondary:"#f5a623"}}))})))}},{key:"renderForm",value:function(){var e=this.props,t=e.module,a=e.store,n=this.state,l=n.activeTab,o=n.formData,u=this.tabs.find((function(e){return e.name===l}))||{},i=u.store||a,s=u.component;return this.formRef=m.default.createRef(),m.default.createElement("div",{className:S.default.form},m.default.createElement(s,(0,r.default)({},u,{formRef:this.formRef,module:t,store:i,formData:o,onSaveChange:this.handleSaveForm})),this.renderSubRouteConfirm())}},{key:"renderSubRouteConfirm",value:function(){var e=this.state.subRoute;return(0,v.default)(e)?null:m.default.createElement(b.default,{className:S.default.confirm,onOk:this.handleSubFormSave,onCancel:this.handleSubFormCancel})}},{key:"renderContent",value:function(){return m.default.createElement("div",{className:S.default.content},m.default.createElement("div",{className:S.default.container},this.renderTabs(),this.renderForm()))}},{key:"renderFooter",value:function(){var e=this.state.updatedTabs;return m.default.createElement("div",{className:S.default.footer},m.default.createElement("div",null,m.default.createElement(E.default,{onClick:this.props.onCancel},t("Cancel")),m.default.createElement(E.default,{type:"control",disabled:(0,v.default)(e),loading:this.props.isSubmitting,onClick:this.handleSubmit},t("Confirm"))))}},{key:"render",value:function(){return m.default.createElement("div",{className:S.default.wrapper},this.renderContent(),this.renderFooter())}}]),a}(m.default.Component);a.default=k,k.propTypes={module:p.default.string,store:p.default.object,forms:p.default.array,data:p.default.object,onSubmit:p.default.func},k.defaultProps={store:{},forms:[],data:{},onSubmit:function(){}},k.childContextTypes={registerSubRoute:p.default.func,resetSubRoute:p.default.func}},3587:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(30)),o=l(n(37)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(0)),m=n(19),p=l(n(3)),h=l(n(22)),v=l(n(977)),g=l(n(954)),y=l(n(2837)),E=function(e){return function(a){function n(e){var t;return(0,u.default)(this,n),(t=(0,s.default)(this,(0,d.default)(n).call(this,e))).handleFormChange=function(){t.setState({showFormActions:!0})},t.handleSaveChange=function(){var e=t.props,a=e.formRef,n=e.onSaveChange,l=(0,h.default)(a,"current");l&&l.validate((function(){t.setState({showFormActions:!1},(function(){n&&n(t.name,t.state.formData),t.prevState=(0,o.default)({},t.state,{formData:(0,v.default)(t.state.formData)})}))}))},t.handleCancelChange=function(){var e=t.prevState||t.initialState;t.setState((0,o.default)({},e))},t.state={showFormActions:!1,formData:(0,v.default)((0,m.toJS)(e.formData))},t.initialState=(0,v.default)(t.state),t}return(0,c.default)(n,a),(0,i.default)(n,[{key:"renderFormActions",value:function(){return f.default.createElement(g.default,{className:(0,p.default)(y.default.formActions,(0,r.default)({},y.default.active,this.state.showFormActions)),okText:t("Save"),cancelText:t("Undo"),onOk:this.handleSaveChange,onCancel:this.handleCancelChange})}},{key:"render",value:function(){var t=this.props,a=t.module,n=t.formRef;return f.default.createElement("div",{className:y.default.formWrapper},f.default.createElement(e,{formTemplate:this.formTemplate,formProps:this.formProps,formRef:n,module:a}),this.renderFormActions())}},{key:"name",get:function(){return this.props.name}},{key:"formTemplate",get:function(){var e=this.props.templatePrefix?"formData.".concat(this.props.templatePrefix):"formData";return(0,h.default)(this.state,e,{})}},{key:"formProps",get:function(){return{onChange:this.handleFormChange}}}]),n}(f.default.Component)};a.default=E},3588:function(e,t,a){e.exports={body:"Edit__body--dybN1"}},3589:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(3590)),r=n(a(3591)),o=n(a(3592)),u={deployments:[{icon:"dashboard",name:"updateStrategy",title:"Update Strategy",component:l.default},{icon:"container",name:"podTemplate",title:"Pod Template",component:r.default},{icon:"storage",name:"volumeSettings",title:"Volume",component:o.default}],statefulsets:[{icon:"dashboard",name:"updateStrategy",title:"Update Strategy",component:l.default},{icon:"container",name:"podTemplate",title:"Pod Template",component:r.default},{icon:"storage",name:"volumeSettings",title:"Volume",component:o.default}],daemonsets:[{icon:"dashboard",name:"updateStrategy",title:"Update Strategy",component:l.default},{icon:"container",name:"podTemplate",title:"Pod Template",component:r.default},{icon:"storage",name:"volumeSettings",title:"Volume",component:o.default}]};t.default=u},3590:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(13)),r=n(a(14)),o=n(a(17)),u=n(a(16)),i=n(a(18)),s=n(a(0)),d=n(a(22)),c=n(a(2669)),f=function(e){function t(){var e,a;(0,l.default)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=(0,o.default)(this,(e=(0,u.default)(t)).call.apply(e,[this].concat(r)))).formRef=s.default.createRef(),a}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props,t=e.formTemplate,a=e.formRef,n=e.formProps,l=e.module,r=(0,d.default)(t,"spec.replicas");return s.default.createElement("div",{className:"margin-t12"},s.default.createElement(c.default,{ownRef:a,formRef:this.formRef,formProps:n,module:l,data:t,replicas:r}))}}]),t}(s.default.Component);t.default=f},3591:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(70)),r=n(a(13)),o=n(a(14)),u=n(a(17)),i=n(a(16)),s=n(a(66)),d=n(a(18)),c=n(a(0)),f=n(a(267)),m=n(a(2574)),p=function(e){function t(){var e,a;(0,r.default)(this,t);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(a=(0,u.default)(this,(e=(0,i.default)(t)).call.apply(e,[this].concat(l)))).handleContainer=function(e){var t=a.props.formProps;m.default.prototype.handleContainer.call((0,s.default)(a),e),t.onChange()},a}return(0,d.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){var e=this.props,t=e.formRef,a=e.formProps,n=this.state,r=n.showContainer,o=n.selectContainer;return r?this.renderContainerForm(o):c.default.createElement(f.default,(0,l.default)({data:this.formTemplate,ref:t},a),this.renderContainerList())}},{key:"formTemplate",get:function(){return this.props.formTemplate}}]),t}(m.default);t.default=p},3592:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r=n(a(13)),o=n(a(17)),u=n(a(16)),i=n(a(66)),s=n(a(18)),d=a(60),c=a(2564),f=(0,d.inject)("rootStore")(l=(0,d.observer)(l=function(e){function t(){var e,a;(0,r.default)(this,t);for(var n=arguments.length,l=new Array(n),s=0;s<n;s++)l[s]=arguments[s];return(a=(0,o.default)(this,(e=(0,u.default)(t)).call.apply(e,[this].concat(l)))).handleVolume=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];c.Component.prototype.handleVolume.apply((0,i.default)(a),t),a.props.formProps.onChange()},a.handleVolumeTemplate=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];c.Component.prototype.handleVolumeTemplate.apply((0,i.default)(a),t),a.props.formProps.onChange()},a.handleLogToggle=function(){c.Component.prototype.handleLogToggle.apply((0,i.default)(a)),a.props.formProps.onChange()},a}return(0,s.default)(t,e),t}(c.Component))||l)||l;t.default=f},3593:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o,u,i=l(n(13)),s=l(n(14)),d=l(n(17)),c=l(n(16)),f=l(n(18)),m=l(n(0)),p=n(19),h=n(60),v=l(n(1)),g=l(n(115)),y=l(n(575)),E=l(n(386)),b=l(n(942)),_=l(n(129)),S=l(n(387)),k=l(n(267)),C=l(n(2530)),w=l(n(3594)),N=(0,h.observer)((u=o=function(e){function a(e){var t;return(0,i.default)(this,a),(t=(0,d.default)(this,(0,c.default)(a).call(this,e))).fetchData=function(e){var a=e.detail,n=a.namespace,l=a.annotations,r={name:(void 0===l?{}:l)["kubesphere.io/relatedHPA"]||e.detail.name,namespace:n};t.setState({loading:!0},(function(){t.store.checkName(r).then((function(e){t.isEdit=e.exist,e.exist?t.store.fetchDetail(r).then((function(){t.setState({loading:!1})})):t.setState({loading:!1})}))}))},t.getFormData=function(){var e=t.props.detail,a=e.name,n=e.namespace,l=(0,p.toJS)(t.store.detail),r=l.cpuCurrentUtilization,o=l.cpuTargetUtilization,u=l.memoryCurrentValue,i=l.memoryTargetValue;return(0,y.default)({},l._originData,{metadata:{name:a,namespace:n,annotations:{cpuCurrentUtilization:r,cpuTargetUtilization:o,memoryCurrentValue:u,memoryTargetValue:i}},spec:{scaleTargetRef:{apiVersion:"apps/v1",kind:"Deployment",name:a}}})},t.handleOk=function(){var e=t.form.current;e&&e.validate((function(){var a=e.getData();t.isEdit&&(0,g.default)(a,"metadata.resourceVersion",null),t.props.onOk(a,t.isEdit)}))},t.form=m.default.createRef(),t.state={loading:!0},t.store=e.store,t}return(0,f.default)(a,e),(0,s.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.visible&&e.visible!==this.props.visible&&this.fetchData(e)}},{key:"componentDidMount",value:function(){this.props.visible&&this.fetchData(this.props)}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel,l=this.store.isSubmitting,r=this.getFormData();return m.default.createElement(S.default.Form,{formRef:this.form,data:r,width:691,title:t("Horizontal Pod Autoscaling"),icon:"firewall",onOk:this.handleOk,onCancel:n,visible:a,isSubmitting:l},m.default.createElement(_.default,{spinning:this.state.loading},m.default.createElement("div",null,m.default.createElement(b.default,{className:w.default.alert,type:"info",message:t("HPA_MSG")}),m.default.createElement(k.default.Item,{label:t("Resource Name"),rules:[{required:!0,message:t("Please input name")}]},m.default.createElement(E.default,{name:"metadata.name",disabled:!0})),m.default.createElement(k.default.Item,{label:"".concat(t("CPU Target Utilization")," (").concat(t("Unit"),": %)"),desc:t("CPU_REQUEST_TARGET_DESC")},m.default.createElement(C.default,{name:"metadata.annotations.cpuTargetUtilization",min:0,max:100})),m.default.createElement(k.default.Item,{label:"".concat(t("Memory Target Usage")," (").concat(t("Unit"),": Mi)"),desc:t("MEMORY_REQUEST_TARGET_DESC")},m.default.createElement(C.default,{name:"metadata.annotations.memoryTargetValue",unit:"Mi",min:0,defaultValue:""})),m.default.createElement(k.default.Item,{label:t("Min Replicas Number"),desc:t("MIN_REPLICAS_DESC")},m.default.createElement(C.default,{name:"spec.minReplicas",placeholder:t("REPLICAS_PLACEHOLDER"),min:1,integer:!0,defaultValue:1})),m.default.createElement(k.default.Item,{label:t("Max Replicas Number"),desc:t("MAX_REPLICAS_DESC")},m.default.createElement(C.default,{name:"spec.maxReplicas",placeholder:t("REPLICAS_PLACEHOLDER"),min:1,integer:!0,defaultValue:1})))))}}]),a}(m.default.Component),o.propTypes={visible:v.default.bool,store:v.default.object,detail:v.default.object,onOk:v.default.func,onCancel:v.default.func},o.defaultProps={visible:!1,store:{},detail:{},onOk:function(){},onCancel:function(){}},r=u))||r;a.default=N},3594:function(e,t,a){e.exports={alert:"HPA__alert--3edXU"}},3595:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(61)),o=l(n(30)),u=l(n(37)),i=l(n(62)),s=l(n(13)),d=l(n(14)),c=l(n(17)),f=l(n(16)),m=l(n(18)),p=l(n(0)),h=l(n(1)),v=l(n(22)),g=l(n(386)),y=l(n(2454)),E=n(938),b=l(n(387)),_=l(n(267)),S=l(n(2602)),k=l(n(2529)),C=l(n(948)),w=l(n(3596)),N=l(n(2838)),T=function(e){function a(e){var n;return(0,s.default)(this,a),(n=(0,c.default)(this,(0,f.default)(a).call(this,e))).fetchBuilders=function(){var e=(0,i.default)(r.default.mark((function e(t){var a,l,s;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props.namespace,l=t.map(function(){var e=(0,i.default)(r.default.mark((function e(t){var l,i;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.store.fetchDetail({name:t,namespace:a});case 2:return l=e.sent,i=(0,v.default)(l,"_originData.spec.config.sourceUrl",""),n.setState({urls:(0,u.default)({},n.state.urls,(0,o.default)({},t,i))}),e.abrupt("return",l);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=4,Promise.all(l);case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=[];case 7:s=e.t0,s.every((function(e){return"NotFound"===(0,v.default)(e,"_originData.reason","")}))&&n.setState({notFound:!0});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleOk=function(){var e=n.props.onOk;n.form&&e((n.form.current||{}).getData())},n.renderBuilderSelector=function(){var e=n.props.builderNames;return p.default.createElement("div",{className:N.default.builderSelector},p.default.createElement(_.default.Item,null,p.default.createElement(y.default,{direction:"column",name:"builderName",defaultValue:e&&e[0]},e.map((function(e){return p.default.createElement(w.default,{key:e,builderName:e,url:n.state.urls[e],value:e})})))))},n.renderEnableUpdate=function(){return p.default.createElement("div",{className:N.default.checkboxCard},p.default.createElement("label",null,p.default.createElement(_.default.Item,null,p.default.createElement(S.default,{name:"isUpdateWorkload",defaultValue:!0},p.default.createElement("span",{className:N.default.title},t("S2I_UPDATE_WORKLOAD"))))),p.default.createElement("p",{className:N.default.desc},t("S2I_UPDATA_WORKLOAD_DESC")))},n.renderContent=function(){return n.state.notFound?p.default.createElement(k.default,null):p.default.createElement(p.default.Fragment,null,p.default.createElement(E.Columns,null,p.default.createElement(E.Column,null,p.default.createElement(_.default.Item,{label:t("New Image Tag")},p.default.createElement(g.default,{name:"newTag"}))),p.default.createElement(E.Column,null,p.default.createElement(_.default.Item,{label:t("RevisionId")},p.default.createElement(g.default,{name:"revisionId"})))),n.renderBuilderSelector(),n.renderEnableUpdate())},n.form=p.default.createRef(),n.state={urls:{},data:{},notFound:!1},n.store=new C.default,n}return(0,m.default)(a,e),(0,d.default)(a,[{key:"componentDidUpdate",value:function(e){!e.visible&&this.props.visible&&this.fetchBuilders(this.props.builderNames)}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.isSubmitting,l=e.onCancel;return p.default.createElement(b.default.Form,{formRef:this.form,data:this.state.data,width:691,title:t("Rerun"),icon:"cdn",onOk:this.handleOk,okText:t("Rerun"),onCancel:l,visible:a,disableOk:this.state.notFound,isSubmitting:n},this.renderContent())}}]),a}(p.default.Component);a.default=T,T.propTypes={visible:h.default.bool,onOk:h.default.func,onCancel:h.default.func,isSubmitting:h.default.bool},T.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1,builderNames:[]}},3596:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(70)),o=l(n(63)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(0)),m=l(n(1)),p=l(n(390)),h=l(n(2838)),v=function(e){function a(){var e;return(0,u.default)(this,a),(e=(0,s.default)(this,(0,d.default)(a).call(this))).handleRadioClick=function(){e.radio.current.click()},e.radio=f.default.createRef(),e}return(0,c.default)(a,e),(0,i.default)(a,[{key:"render",value:function(){var e=this.props,a=e.onChange,n=e.builderName,l=e.url,u=(0,o.default)(e,["onChange","builderName","url"]);return f.default.createElement("div",{className:h.default.builderItem,onClick:this.handleRadioClick},f.default.createElement(p.default,(0,r.default)({className:h.default.radio,onChange:a},u),f.default.createElement("p",{ref:this.radio,className:h.default.title},n)),f.default.createElement("p",{className:h.default.desc},f.default.createElement("span",null,t("Repo URL"),":"),l))}}]),a}(f.default.Component);a.default=v,v.propTypes={onChange:m.default.func},v.defaultProps={onChange:function(){},builderName:"",url:""}},3597:function(e,t,a){e.exports={main:"RevisionControl__main--2uHH3",header:"RevisionControl__header--1O9lr",title:"RevisionControl__title--3NwAj",text:"RevisionControl__text--3kPku",list:"RevisionControl__list--1MX4q",item:"RevisionControl__item---w7w4",icon:"RevisionControl__icon--pdILy",checked:"RevisionControl__checked--15-hB",operations:"RevisionControl__operations--2_m24"}},3598:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(70)),o=l(n(63)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(0)),m=l(n(1)),p=l(n(3)),h=l(n(58)),v=l(n(2525)),g=l(n(3599)),y=function(e){function a(){return(0,u.default)(this,a),(0,s.default)(this,(0,d.default)(a).apply(this,arguments))}return(0,c.default)(a,e),(0,i.default)(a,[{key:"renderContent",value:function(){var e=this.props.ports;return(0,h.default)(e)?null:f.default.createElement("div",{className:g.default.content},f.default.createElement("table",{className:g.default.table},f.default.createElement("thead",null,f.default.createElement("tr",null,f.default.createElement("th",null,t("Name")),f.default.createElement("th",null,t("Protocol")),f.default.createElement("th",null,t("Port")))),f.default.createElement("tbody",null,e.map((function(e,t){return f.default.createElement("tr",{key:t},f.default.createElement("td",null,e.name),f.default.createElement("td",null,e.protocol),f.default.createElement("td",null,e.containerPort))})))))}},{key:"render",value:function(){var e=this.props,a=e.className,n=(e.loading,(0,o.default)(e,["className","loading"])),l=this.props.title||t("Ports");return f.default.createElement(v.default,(0,r.default)({className:(0,p.default)(g.default.card,a),title:l},n),this.renderContent())}}]),a}(f.default.Component);a.default=y,y.propTypes={className:m.default.string,ports:m.default.array},y.defaultProps={ports:[]}},3599:function(e,t,a){e.exports={content:"Ports__content--39OJS",table:"Ports__table--2siFI"}},3600:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o,u,i=l(n(70)),s=l(n(63)),d=l(n(13)),c=l(n(14)),f=l(n(17)),m=l(n(16)),p=l(n(18)),h=l(n(0)),v=n(60),g=l(n(1)),y=l(n(3)),E=l(n(2630)),b=l(n(38)),_=l(n(190)),S=l(n(271)),k=l(n(224)),C=l(n(2516)),w=l(n(388)),N=l(n(3601)),T=(0,v.observer)((u=o=function(e){function a(e){var n;return(0,d.default)(this,a),(n=(0,f.default)(this,(0,m.default)(a).call(this,e))).getHPAData=function(){var e=n.props.detail,a=e.minReplicas,l=void 0===a?0:a,r=e.maxReplicas,o=void 0===r?0:r,u=e.cpuCurrentUtilization,i=void 0===u?0:u,s=e.cpuTargetUtilization,d=void 0===s?0:s,c=e.memoryCurrentValue,f=void 0===c?0:c,m=e.memoryTargetValue,p=void 0===m?0:m;return[{icon:"chevron-down",name:t("Min Replicas Number"),value:l},{icon:"chevron-up",name:t("Max Replicas Number"),value:o},{icon:"cpu",name:t("Target Utilization"),value:"".concat(d,"%"),current:"".concat(i,"%")},{icon:"memory",name:t("Target Usage"),value:p,current:f}]},n.getOperations=function(){return[{key:"cancel",icon:"close",text:t("Cancel"),onClick:n.handleCancel}]},n.handleMoreClick=function(e,t){var a=n.getOperations().find((function(e){return e.key===t})).onClick;a&&a()},n.handleCancel=function(){var e=n.props,a=e.detail,l=e.onDeleted;n.store.delete(a).then((function(){w.default.success({content:"".concat(t("Canceled Successfully"),"!")}),l()}))},n.renderCard=function(e){var a=e.icon,n=e.name,l=e.value,r=e.current;return h.default.createElement("div",{key:a,className:N.default.box},h.default.createElement("div",{className:N.default.card},h.default.createElement(b.default,{name:a,size:40}),h.default.createElement("div",null,h.default.createElement("div",{className:N.default.name,title:n},n),h.default.createElement("p",{className:N.default.value},l," ",r&&"(".concat(t("Current")," ").concat(r,")")))))},n.store=e.store||new E.default,n}return(0,p.default)(a,e),(0,c.default)(a,[{key:"renderOperations",value:function(){var e=this.getOperations(),t=h.default.createElement(S.default,{onClick:this.handleMoreClick},e.map((function(e){var t=e.icon,a=e.text,n=e.show,l=void 0===n||n,r=(0,s.default)(e,["icon","text","show"]);return l?h.default.createElement(S.default.MenuItem,(0,i.default)({key:a},r),t&&h.default.createElement(b.default,{name:t,type:"light"})," ",a):null})));return h.default.createElement(_.default,{className:(0,y.default)(N.default.dropdown,"dropdown-default"),content:t},h.default.createElement(k.default,{type:"ghost",icon:"more"}))}},{key:"renderContent",value:function(){if(!this.props.detail.name)return null;var e=this.getHPAData();return h.default.createElement("div",{className:N.default.wrapper},e.map(this.renderCard))}},{key:"render",value:function(){var e=this.props,a=e.className,n=e.loading,l=this.props.title||t("Horizontal Pod Autoscaling");return h.default.createElement(C.default,{className:(0,y.default)(N.default.main,a),title:l,operations:this.renderOperations(),empty:t("NOT_ENABLE",{resource:t("Horizontal Pod Autoscaling")}),loading:n},this.renderContent())}}]),a}(h.default.Component),o.propTypes={className:g.default.string,title:g.default.string,store:g.default.object,detail:g.default.object,loading:g.default.bool,onDeleted:g.default.func},o.defaultProps={detail:{},loading:!0,onDelete:function(){}},r=u))||r;a.default=T},3601:function(e,t,a){e.exports={wrapper:"HPA__wrapper--3JO8A",box:"HPA__box--fJxys",card:"HPA__card--2VT5I",name:"HPA__name--2QZjb",value:"HPA__value--1d4Yq"}},3602:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(1)),f=l(n(3)),m=l(n(22)),p=l(n(942)),h=l(n(2525)),v=l(n(3603)),g=l(n(3606)),y=function(e){function a(){var e,t;(0,r.default)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(t=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(l)))).handleReplicaChange=function(e){e>=0&&t.props.onScale(e)},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props.className;return d.default.createElement(h.default,{className:(0,f.default)(g.default.replica,e)},d.default.createElement("div",{className:g.default.replicaCount},d.default.createElement(v.default,this.replicaStatus)),d.default.createElement(p.default,{className:g.default.replicaMsg,type:"info",message:d.default.createElement("div",{dangerouslySetInnerHTML:{__html:this.replicaMsg}})}))}},{key:"replicaMsg",get:function(){return t("".concat(this.props.module.toUpperCase(),"_REPLICA_DESC"))}},{key:"replicaStatus",get:function(){var e=this.props,t=e.module,a=e.detail,n=e.enableScale,l={};switch(t){default:case"deployments":l={current:a.availablePodNums||0,desire:a.podNums||0};break;case"statefulsets":l={current:(0,m.default)(a,"status.currentReplicas",a.readyPodNums),desire:a.podNums||0};break;case"daemonsets":l={current:(0,m.default)(a,"status.numberReady",0),desire:(0,m.default)(a,"status.desiredNumberScheduled",0)}}return l.onScale=n?this.handleReplicaChange:null,l}}]),a}(d.default.Component);a.default=y,y.propTypes={module:c.default.string,detail:c.default.object,enableScale:c.default.bool,onScale:c.default.func},y.defaultProps={module:"deployments",enableScale:!0,onScale:function(){}}},3603:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(1)),f=l(n(3)),m=l(n(2676)),p=n(2522),h=l(n(3605)),v=l(n(2839)),g=5,y=function(e){return Number(e||0)},E=function(e){function a(e){var t;(0,r.default)(this,a),(t=(0,u.default)(this,(0,i.default)(a).call(this,e))).showConfirm=function(){t.setState({showConfirm:!0},(function(){t.startTimer()}))},t.hideConfirm=function(){t.setState({showConfirm:!1},(function(){t.stopTimer()}))},t.handleCancel=function(){t.setState({desire:t.props.desire},(function(){t.hideConfirm()}))},t.handleConfirm=function(){t.props.onScale(t.state.desire),t.hideConfirm()},t.handleScale=function(e){e>=0&&t.setState({desire:e,seconds:g},(function(){t.showConfirm()}))},t.updateTime=function(){var e=t.state.seconds;t.timer=setTimeout((function(){e>0?t.setState({seconds:e-1},(function(){t.updateTime()})):(t.handleConfirm(),t.handleCancel())}),1e3)},t.startTimer=function(){t.timer&&t.stopTimer(),t.updateTime()},t.stopTimer=function(){clearTimeout(t.timer),t.timer=null};var n=y(e.desire);return t.state={prevPropDesire:n,desire:n,seconds:g,showConfirm:!1},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"componentWillUnmount",value:function(){this.stopTimer()}},{key:"renderScaleOperation",value:function(){if(!this.props.onScale)return null;var e=this.state.desire;return d.default.createElement("div",{className:v.default.scale},d.default.createElement(h.default,{value:e,onChange:this.handleScale}))}},{key:"render",value:function(){var e=this.props,a=e.theme,n=e.className,l=e.name,r=e.current,o=this.state,u=o.showConfirm,i=o.seconds,s=o.desire,c=t(l),h=t("Current Replicas"),g=t("Desired Replicas");return d.default.createElement("div",{className:(0,f.default)(v.default.card,n,v.default[a])},d.default.createElement("img",{className:v.default.cardImg,src:"/assets/banner-icon-1.svg"}),d.default.createElement("div",{className:v.default.chart},d.default.createElement(p.SimpleCircle,{theme:a,title:c,legend:[h,t("Warning")],value:r,total:s})),d.default.createElement("div",{className:v.default.status},d.default.createElement("div",{className:v.default.title},c),d.default.createElement("div",{className:v.default.detail},d.default.createElement("p",null,d.default.createElement("label",null,g,":")," ",s),d.default.createElement("p",null,d.default.createElement("label",null,h,":")," ",r))),this.renderScaleOperation(),d.default.createElement(m.default,{visible:u,width:400,title:t("REPLICAS_SCALE_NOTIFY_TITLE"),content:t.html("REPLICAS_SCALE_NOTIFY_CONTENT",{num:s}),cancelText:t("REPLICAS_SCALE_NOTIFY_CANCEL"),confirmText:t("REPLICAS_SCALE_NOTIFY_CONFIRM",{seconds:i}),onCancel:this.handleCancel,onConfirm:this.handleConfirm}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.desire!==t.prevPropDesire){var a=y(e.desire);return{prevPropDesire:a,desire:a}}return null}}]),a}(d.default.Component);a.default=E,E.propTypes={theme:c.default.string,className:c.default.string,name:c.default.string,current:c.default.number,desire:c.default.number,onScale:c.default.func},E.defaultProps={theme:"dark",name:"Replica Status",current:0,desire:0,onScale:null}},3605:function(e,t,a){"use strict";var n=a(81),l=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(a(13)),o=l(a(14)),u=l(a(17)),i=l(a(16)),s=l(a(18)),d=n(a(0)),c=l(a(1)),f=l(a(3)),m=a(114),p=l(a(38)),h=l(a(2839)),v=function(e){function t(){var e,a;(0,r.default)(this,t);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(a=(0,u.default)(this,(e=(0,i.default)(t)).call.apply(e,[this].concat(l)))).handlePlusOne=function(){var e=a.props,t=e.value,n=e.onChange;n&&n(t+1)},a.handleMinusOne=function(){var e=a.props,t=e.value,n=e.onChange;n&&n(t-1)},a}return(0,s.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){var e=this.props.className,t={primary:m.COLORS_MAP.white,secondary:m.COLORS_MAP.white};return d.default.createElement("div",{className:(0,f.default)(h.default.control,e)},d.default.createElement(p.default,{className:h.default.add,name:"chevron-up",size:24,color:t,onClick:this.handlePlusOne,clickable:!0}),d.default.createElement(p.default,{className:h.default.substract,name:"chevron-down",size:24,color:t,onClick:this.handleMinusOne,clickable:!0}))}}]),t}(d.PureComponent);v.propTypes={className:c.default.string,value:c.default.number,onChange:c.default.func};var g=v;t.default=g},3606:function(e,t,a){e.exports={replica:"Replica__replica--3G_II",replicaCount:"Replica__replicaCount--9_JUY"}},3607:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(61)),o=l(n(62)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(0)),m=l(n(22)),p=l(n(129)),h=l(n(225)),v=l(n(2516)),g=l(n(948)),y=l(n(967)),E=l(n(270)),b=l(n(3608)),_=l(n(3610)),S=l(n(3612)),k=l(n(2840)),C=function(e){function a(e){var n;(0,u.default)(this,a),(n=(0,s.default)(this,(0,d.default)(a).call(this,e))).showRerun=function(){n.setState({showRerun:!0})},n.hideRerun=function(){n.setState({showRerun:!1})},n.handleCurrentBuilderChange=function(e){n.setState({currentBuilderName:e,builderDetail:{},runDetail:{}}),n.fetchData(e)},n.fetchData=function(){var e=(0,o.default)(r.default.mark((function e(t){var a,l;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getBuilderDetail(t);case 2:a=e.sent,(l=(0,m.default)(a,"status.lastRunName"))&&n.getRunDetail(l);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.getBuilderDetail=function(){var e=(0,o.default)(r.default.mark((function e(t){var a,l;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props.namespace,e.next=3,n.builderStore.fetchDetail({name:t,namespace:a});case 3:if(l=e.sent,"NotFound"!==(0,m.default)(l,"_originData.reason","")){e.next=7;break}return n.setState({notFound:!0}),e.abrupt("return");case 7:return n.setState({builderDetail:l}),e.abrupt("return",l);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.getRunDetail=function(){var e=(0,o.default)(r.default.mark((function e(t){var a,l,o;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props.namespace,n.setState({getRunDetailLoading:!0}),clearTimeout(n.refreshTimer),l=(0,m.default)(n.state.builderDetail,"status.lastRunName"),e.next=6,n.runStore.fetchRunDetail({namespace:a,runName:t||l});case 6:o=e.sent,"running"===(0,m.default)(o,"status","")&&(n.refreshTimer=setTimeout(n.getRunDetail,4e3)),n.setState({runDetail:o,getRunDetailLoading:!1});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleRerun=function(){var e=(0,o.default)(r.default.mark((function e(t){var a,l,o,u,i;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.newTag,l=t.isUpdateWorkload,o=n.props.namespace,u=n.state.currentBuilderName,clearTimeout(n.refreshTimer),e.next=6,n.builderStore.rerun({newTag:a,name:u,namespace:o,isUpdateWorkload:l});case 6:i=e.sent,n.setState({runDetail:E.default.s2iruns(i),getRunDetailLoading:!1,showRerun:!1}),setTimeout((function(){n.fetchData(u)}),1e3);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.renderBuilderSelect=function(){var e=n.props.builderNames;if(1===e.length)return null;var t=e.map((function(e){return{label:e,value:e}}));return f.default.createElement(h.default,{className:k.default.builderSelector,onChange:n.handleCurrentBuilderChange,options:t,defaultValue:t[0]})},n.renderLog=function(){var e=n.state.runDetail,a=e.logURL,l=e.status;return!a&&"Running"===l?f.default.createElement("div",{className:k.default.title},f.default.createElement(p.default,{size:"16"}),f.default.createElement("p",null,t("Task"),f.default.createElement("span",{className:k.default.taskName},n.state.currentBuilderName),t("is Building"))):a?f.default.createElement(S.default,{onRerun:n.showRerun,runDetail:n.state.runDetail,builderName:n.state.currentBuilderName}):null};var l=e.builderNames;return n.state={builderDetail:{},runDetail:{},getRunDetailLoading:!0,currentBuilderName:l[0],showRerun:!1,notFound:!1},n.refreshTimer=null,n.builderStore=new g.default,n.runStore=new y.default,n}return(0,c.default)(a,e),(0,i.default)(a,[{key:"componentDidMount",value:function(){var e=this.props.builderNames;this.fetchData(e[0])}},{key:"componentWillUnmount",value:function(){clearTimeout(this.refreshTimer)}},{key:"render",value:function(){var e=this.props.className,a=(0,m.default)(this.state.builderDetail,"spec.config");return this.state.notFound?null:f.default.createElement(v.default,{title:t("Building Image"),operations:this.renderBuilderSelect()},f.default.createElement(b.default,{config:a,className:e}),this.renderLog(),f.default.createElement(_.default,{detail:this.state.builderDetail,visible:this.state.showRerun,onOk:this.handleRerun,onCancel:this.hideRerun}))}}]),a}(f.default.Component);a.default=C,C.defaultProps={builderNames:[]}},3608:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(3)),f=l(n(38)),m=n(49),p=l(n(3609)),h=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props.className,a=this.props.config,n=a.sourceUrl,l=a.builderImage;return d.default.createElement("ul",{className:(0,c.default)(p.default.builderContent,e)},d.default.createElement("li",null,d.default.createElement("span",{className:p.default.icon},d.default.createElement(f.default,{name:"resource",size:24})),d.default.createElement("div",{className:p.default.info},d.default.createElement("p",{className:p.default.value},n),d.default.createElement("p",{className:p.default.name},t("sourceUrl")))),d.default.createElement("li",null,d.default.createElement("span",{className:p.default.icon,style:{backgroundImage:"url('/assets/".concat((0,m.getLanguageName)(l),".png')")}}),d.default.createElement("div",{className:p.default.info},d.default.createElement("p",{className:p.default.value},l),d.default.createElement("p",{className:p.default.name},t("builderImage")))))}}]),a}(d.default.Component);a.default=h,h.defaultProps={config:{sourceUrl:"-",builderImage:"-"}}},3609:function(e,t,a){e.exports={builderContent:"BuilderInfo__builderContent--3DpW6",icon:"BuilderInfo__icon--3LFug",info:"BuilderInfo__info--2jSdd",value:"BuilderInfo__value--2x4Zp",name:"BuilderInfo__name--20yCe"}},3610:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(1)),f=l(n(386)),m=l(n(229)),p=l(n(387)),h=l(n(267)),v=l(n(3611)),g=function(e){function a(e){var n;return(0,r.default)(this,a),(n=(0,u.default)(this,(0,i.default)(a).call(this,e))).handleOk=function(){var e=n.props.onOk;n.form&&e((n.form.current||{}).getData())},n.renderEnableUpdate=function(){return d.default.createElement("div",{className:v.default.checkboxCard},d.default.createElement("label",null,d.default.createElement(h.default.Item,null,d.default.createElement(m.default,{name:"isUpdateWorkload",defaultValue:!0},d.default.createElement("span",{name:!0,className:v.default.title},t("S2I_UPDATE_WORKLOAD"))))),d.default.createElement("p",{className:v.default.desc},t("S2I_UPDATA_WORKLOAD_DESC")))},n.form=d.default.createRef(),n}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props,a=e.visible,n=e.isSubmitting,l=e.onCancel,r=e.detail;return d.default.createElement(p.default.Form,{formRef:this.form,width:691,title:t("Rerun"),icon:"cdn",onOk:this.handleOk,okText:t("Rerun"),onCancel:l,visible:a,isSubmitting:n},d.default.createElement(h.default.Item,{label:t("Repo Url")},d.default.createElement(f.default,{name:"url",defaultValue:r.sourceUrl,readOnly:!0})),d.default.createElement(h.default.Item,{label:t("New Tag")},d.default.createElement(f.default,{name:"newTag",placeholder:t("NEW_TAG_DESC")})),this.renderEnableUpdate())}}]),a}(d.default.Component);a.default=g,g.propTypes={visible:c.default.bool,onOk:c.default.func,onCancel:c.default.func,isSubmitting:c.default.bool},g.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1,url:""}},3611:function(e,t,a){e.exports={checkboxCard:"RerunModal__checkboxCard--3wxm3",title:"RerunModal__title--26pG1",desc:"RerunModal__desc--2Sc0r"}},3612:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o,u,i=l(n(61)),s=l(n(62)),d=l(n(13)),c=l(n(14)),f=l(n(17)),m=l(n(16)),p=l(n(18)),h=l(n(0)),v=n(60),g=l(n(132)),y=l(n(3)),E=l(n(38)),b=l(n(129)),_=l(n(227)),S=l(n(2529)),k=l(n(967)),C=l(n(2840)),w=(0,v.observer)((u=o=function(e){function a(){var e;return(0,d.default)(this,a),(e=(0,f.default)(this,(0,m.default)(a).call(this))).toggleLog=function(){e.state.showLog?e.setState({showLog:!1}):e.setState({showLog:!0})},e.getLog=(0,s.default)(i.default.mark((function t(){var a,n,l,r,o;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.props.runDetail,n=a.logURL,l=a.status,r=e.store.logData,o="Building"===l||"Unknown"===l,clearTimeout(e.refreshTimer),n){t.next=7;break}return e.refreshTimer=setTimeout(e.getLog,4e3),t.abrupt("return");case 7:if(!globals.app.hasKSModule("logging")){t.next=12;break}return t.next=10,e.store.getLog(n);case 10:t.next=14;break;case 12:return t.next=14,e.store.fetchPodsLogs(n).catch((function(t){"container not ready"===t&&e.setState({isContainerPending:!0})}));case 14:if(e.handleScrollToBottom(),!r.hasMore){t.next=18;break}return e.getLog(),t.abrupt("return");case 18:o&&(e.refreshTimer=setTimeout(e.getLog,4e3));case 19:case"end":return t.stop()}}),t)}))),e.handleScrollToBottom=function(){var t=e.LogContent.current;t&&(t.scrollTop=t.scrollHeight)},e.handleRerun=function(){(0,e.props.onRerun)()},e.renderTitle=function(){var a=e.props.runDetail.status,n=e.props,l=n.builderName,r=n.onRerun;return"Successful"===a?h.default.createElement(h.default.Fragment,null,h.default.createElement("span",{className:(0,y.default)(C.default.icon,C.default.successful)}),h.default.createElement("p",null,h.default.createElement("span",{className:C.default.taskName},l),t("building logs"))):"Building"===a?h.default.createElement(h.default.Fragment,null,h.default.createElement("span",{className:(0,y.default)(C.default.icon,C.default.running)}),h.default.createElement("p",null,t("Task"),h.default.createElement("span",{className:C.default.taskName},l),t("is Building"))):"Failed"===a?h.default.createElement(h.default.Fragment,null,h.default.createElement("span",{className:(0,y.default)(C.default.icon,C.default.failed)}),h.default.createElement("p",null,t("Task"),h.default.createElement("span",{className:C.default.taskName},l),t("is Failed"),(0,g.default)(r)?h.default.createElement(_.default,{content:t("Rebuild Image")},h.default.createElement(E.default,{name:"refresh",onClick:e.handleRerun})):null)):h.default.createElement(h.default.Fragment,null,h.default.createElement("span",{className:(0,y.default)(C.default.icon,C.default.unknow)}),h.default.createElement("p",null,h.default.createElement("span",{className:C.default.taskName},l),t("building logs")))},e.state={showLog:!0,isContainerPending:!1},e.store=new k.default,e.refreshTimer=null,e.LogContent=h.default.createRef(),e}return(0,p.default)(a,e),(0,c.default)(a,[{key:"componentDidMount",value:function(){this.getLog()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.refreshTimer)}},{key:"renderLog",value:function(){var e=this.store.logData.log,a=this.props.runState;return e?h.default.createElement("pre",{ref:this.LogContent},e):"Running"===a||"Unknown"===a?h.default.createElement(b.default,null,h.default.createElement("p",{className:C.default.noneLogDesc})):h.default.createElement("p",{className:C.default.noneLogDesc},t("No log records"))}},{key:"render",value:function(){return this.state.isContainerPending?h.default.createElement("div",{className:C.default.logContainer},h.default.createElement(S.default,{desc:"CONTAINER_REAL_TIME_LOGS_UNSUPPORTED_TIPS"})):h.default.createElement("div",{className:C.default.logContainer},h.default.createElement("div",{className:C.default.title,onClick:this.toggleLog},this.renderTitle(),h.default.createElement(E.default,{name:this.state.showLog?"chevron-up":"chevron-down",size:20})),this.state.showLog?this.renderLog():null)}}]),a}(h.default.Component),o.defaultProps={logURL:"",runState:""},r=u))||r;a.default=w},3613:function(e,t,a){e.exports={deployment_codeResource:"ResourceStatus__deployment_codeResource--W_sDs"}},3614:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PodsMonitoring",{enumerable:!0,get:function(){return l.default}});var l=n(a(3615))},3615:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r,o,u=n(a(61)),i=n(a(37)),s=n(a(62)),d=n(a(13)),c=n(a(14)),f=n(a(17)),m=n(a(16)),p=n(a(18)),h=a(19),v=a(60),g=n(a(1)),y=n(a(22)),E=n(a(2587)),b=n(a(3616)),_=(0,v.observer)((o=r=function(e){function t(){var e,a;(0,d.default)(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(a=(0,f.default)(this,(e=(0,m.default)(t)).call.apply(e,[this].concat(l)))).fetchResources=function(){var e=(0,s.default)(u.default.mark((function e(t){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.resourceStore.fetchSortedMetrics((0,i.default)({metrics:[a.metricType],limit:20},a.resourceParams,t));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.fetchMonitorings=function(){var e=(0,s.default)(u.default.mark((function e(t){var n;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.state.checked,e.next=3,a.monitorStore.fetchMetrics((0,i.default)({resources:n,metrics:[a.metricType]},a.resourceParams,t));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a}return(0,p.default)(t,e),(0,c.default)(t,[{key:"init",value:function(){var e=new E.default;this.resourceStore=e,this.monitorStore=e}},{key:"name",get:function(){return"Pods"}},{key:"resourceParams",get:function(){var e=this.props,t=e.module;return{namespace:e.namespace,workloadKind:t,workloadName:e.name}}},{key:"resources",get:function(){return(0,h.toJS)((0,y.default)(this.resourceStore,"sort",{}))}},{key:"resourcesData",get:function(){return(0,y.default)(this.resources,"data[".concat(this.metricType,"].data.result"),[])}},{key:"monitorsData",get:function(){return(0,y.default)(this.monitorStore,"data[".concat(this.metricType,"].data.result"),[])}}]),t}(b.default),r.propTypes=(0,i.default)({},b.default.propTypes,{module:g.default.string,name:g.default.string,namespace:g.default.string}),r.defaultProps=(0,i.default)({},b.default.defaultProps,{module:"deployments",name:"",namespace:""}),l=o))||l;t.default=_},3616:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r,o,u=n(a(70)),i=n(a(37)),s=n(a(61)),d=n(a(62)),c=n(a(13)),f=n(a(14)),m=n(a(17)),p=n(a(16)),h=n(a(18)),v=n(a(0)),g=a(19),y=a(60),E=n(a(1)),b=n(a(58)),_=n(a(22)),S=n(a(2742)),k=n(a(3617)),C=n(a(3618)),w=n(a(2678)),N=(0,y.observer)((o=r=function(e){function t(e){var a;return(0,c.default)(this,t),(a=(0,m.default)(this,(0,p.default)(t).call(this,e))).getItemName=function(e){return(0,_.default)(e,"metric.resource_name","-")},a.fetchResources=(0,d.default)(s.default.mark((function e(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),a.fetchMonitorings=(0,d.default)(s.default.mark((function e(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),a.fetchData=(0,d.default)(s.default.mark((function e(){var t,n=arguments;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},a.params=t,e.next=4,a.fetchResources();case 4:return e.next=6,a.fetchMonitorings(t);case 6:case"end":return e.stop()}}),e)}))),a.handleChangeChecked=function(e){a.setState({checked:e},(function(){var e=a.state.checked,t=a.monitorsData.map(a.getItemName);e.some((function(e){return!t.includes(e)&&(a.fetchMonitorings((0,i.default)({pods:[e],more:!0},a.params)),!0)}))}))},a.state={checked:[]},a.init(),a}return(0,h.default)(t,e),(0,f.default)(t,[{key:"componentDidMount",value:function(){var e=this;(0,g.when)((function(){return!(0,b.default)(e.resourcesData)&&(0,b.default)(e.state.checked)}),(function(){var t=e.props.defaultChecked,a=e.resourcesData.map((function(t){return e.getItemName(t)})).slice(0,t);e.setState({checked:a})}))}},{key:"init",value:function(){this.resourceStore={},this.monitorStore={}}},{key:"renderCharts",value:function(){var e=this,t=this.props.config,a=this.state.checked,n=[];return a.forEach((function(t){var a=e.monitorsData.find((function(a){return e.getItemName(a)===t}));a&&n.push(a)})),v.default.createElement(C.default,{loading:this.monitorStore.isLoading,config:t,data:n})}},{key:"renderResroucesList",value:function(){var e=this.props.config,t=this.state.checked,a=this.resources,n=a.page,l=a.total,r=a.isLoading;return v.default.createElement(k.default,{loading:r,config:e,name:this.name,page:n,total:l,checked:t,data:this.resourcesData,onFetch:this.fetchResources,onChange:this.handleChangeChecked})}},{key:"render",value:function(){var e=this.monitorStore,t=e.isLoading,a=e.isRefreshing,n=this.props,l=n.visible,r=n.onCancel;return v.default.createElement(S.default,(0,u.default)({visible:l,onFetch:this.fetchData,onCancel:r,loading:t,refreshing:a},this.monitorOptions),v.default.createElement("div",{className:w.default.content},this.renderResroucesList(),this.renderCharts()))}},{key:"monitorOptions",get:function(){return{times:50,step:"5m"}}},{key:"name",get:function(){return"Resources"}},{key:"metrics",get:function(){return this.monitorStore.data}},{key:"metricType",get:function(){return this.props.config.metricType}},{key:"resources",get:function(){return(0,g.toJS)((0,_.default)(this.resourceStore,"list",{}))}},{key:"resourcesData",get:function(){return(0,_.default)(this.resources,"data",[])}},{key:"monitorsData",get:function(){return[]}}]),t}(v.default.Component),r.propTypes={visible:E.default.bool,defaultChecked:E.default.number,limit:E.default.number,config:E.default.object,onCancel:E.default.func},r.defaultProps={visible:!1,defaultChecked:5,limit:10,config:{},onCancel:function(){}},l=o))||l;t.default=N},3617:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(30)),o=l(n(97)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(66)),f=l(n(18)),m=l(n(0)),p=l(n(1)),h=l(n(3)),v=l(n(58)),g=l(n(22)),y=l(n(2459)),E=l(n(2458)),b=n(49),_=n(114),S=n(939),k=l(n(38)),C=l(n(229)),w=l(n(129)),N=l(n(2529)),T=l(n(388)),P=l(n(2678)),M=function(e){function a(e){var n;return(0,u.default)(this,a),(n=(0,s.default)(this,(0,d.default)(a).call(this,e))).getItemName=function(e){return(0,g.default)(e,"metric.resource_name","-")},n.getCurrentValue=function(e){var t=n.props.config,a=t.type,l=t.unitType;return(0,S.getSuitableValue)((0,g.default)(e,"value[1]"),l||a)},n.handleScroll=function(e){var t=e.target,a=t.clientHeight,l=t.scrollHeight,r=a+t.scrollTop===l,o=n.props,u=o.data,i=o.page,s=o.total,d=o.onFetch;!n.scrolling&&s!==u.length&&r&&(n.scrolling=!0,d({more:!0,page:i+1}).then((function(){n.scrolling=!1})))},n.toggleChecked=function(e,t){n.setState({showChecked:t})},n.handleCheck=function(e){var a=n.getItemName(e);return(0,b.cacheFunc)("_resource_".concat(a),(function(){var e=n.props.maxChecked,l=(0,o.default)(n.props.checked);l.includes(a)?(0,y.default)(l,(function(e){return e===a})):l.length>=e?T.default.info({content:t("MONITORING_SELECT_LIMIT_MSG")}):l.push(a),n.props.onChange(l)}),(0,c.default)(n))},n.renderResourceItem=function(e){var a=n.props.checked,l=n.getItemName(e),r=n.getCurrentValue(e);return m.default.createElement("div",{key:l,className:P.default.item,onClick:n.handleCheck(e)},m.default.createElement(C.default,{className:P.default.itemCheck,checked:a.includes(l)}),m.default.createElement(k.default,{name:n.icon,size:16}),m.default.createElement("div",{className:P.default.itemInfo},m.default.createElement("strong",{title:l},l),m.default.createElement("p",null,t("Current"),": ",r)))},n.renderResourceList=function(e){return(0,v.default)(e)?m.default.createElement(N.default,null):e.map(n.renderResourceItem)},n.state={showChecked:!1},n.listRef=m.default.createRef(),n.throttleScroll=(0,E.default)(n.handleScroll,100),n}return(0,f.default)(a,e),(0,i.default)(a,[{key:"componentDidMount",value:function(){this.listNode=this.listRef.current,this.listNode&&this.listNode.addEventListener("scroll",this.throttleScroll)}},{key:"componentWillUnmount",value:function(){this.listNode&&this.listNode.removeEventListener("scroll",this.throttleScroll)}},{key:"render",value:function(){var e=this.props,a=e.loading,n=e.name,l=this.state.showChecked,o=l?this.checkedData:this.props.data;return m.default.createElement("div",{className:P.default.resources},m.default.createElement("div",{className:P.default.title},m.default.createElement("strong",null,t(n)),m.default.createElement(C.default,{checked:l,onChange:this.toggleChecked},t("Show only selected"))),m.default.createElement("div",{className:P.default.content},m.default.createElement(w.default,{spinning:a},m.default.createElement("div",{className:P.default.list},m.default.createElement("div",{className:(0,h.default)((0,r.default)({},P.default.hide,!l))},this.renderResourceList(o)),m.default.createElement("div",{className:(0,h.default)((0,r.default)({},P.default.hide,l)),ref:this.listRef},this.renderResourceList(o))))))}},{key:"icon",get:function(){return _.ICON_TYPES[this.props.name.toLowerCase()]||"appcenter"}},{key:"checkedData",get:function(){var e=this,t=this.props,a=t.checked;return t.data.filter((function(t){return a.includes(e.getItemName(t))}))}}]),a}(m.default.Component);a.default=M,M.propTypes={loading:p.default.bool,config:p.default.object,name:p.default.string,maxChecked:p.default.number,page:p.default.number,total:p.default.number,checked:p.default.array,data:p.default.array,onFetch:p.default.func,onChange:p.default.func},M.defaultProps={loading:!1,config:{},name:"Resources",maxChecked:10,page:1,total:0,checked:[],data:[],onFetch:function(){},onChange:function(){}}},3618:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(70)),r=n(a(37)),o=n(a(13)),u=n(a(14)),i=n(a(17)),s=n(a(16)),d=n(a(18)),c=n(a(0)),f=n(a(1)),m=n(a(22)),p=n(a(58)),h=a(939),v=n(a(129)),g=n(a(2529)),y=a(2522),E=n(a(2678)),b=function(e){function t(){var e,a;(0,o.default)(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(a=(0,i.default)(this,(e=(0,s.default)(t)).call.apply(e,[this].concat(l)))).getItemName=function(e){return(0,m.default)(e,"metric.resource_name","-")},a}return(0,d.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.loading,n=t.config,o=t.data;return c.default.createElement("div",{className:E.default.charts},c.default.createElement(v.default,{spinning:a},c.default.createElement("div",{className:E.default.list},(0,p.default)(o)?c.default.createElement(g.default,null):o.map((function(t){var a=e.getItemName(t),o=(0,h.getAreaChartOps)((0,r.default)({},n,{legend:[n.legend||"-"],data:[t]}));return(0,p.default)(o.data)?null:c.default.createElement("div",{key:a,className:E.default.item},c.default.createElement("div",{className:E.default.title},a),c.default.createElement(y.SimpleArea,(0,l.default)({width:"100%"},o)))})))))}}]),t}(c.default.Component);t.default=b,b.propTypes={loading:f.default.bool,config:f.default.object,data:f.default.array},b.defaultTypes={loading:!1,config:{},data:[]}},3619:function(e,t,a){e.exports={item:"Monitoring__item--3ZoGR",more:"Monitoring__more--2fsnc"}},3620:function(e,t,a){e.exports={wrapper:"ReplicasInput__wrapper--btc8I",value:"ReplicasInput__value--_1xbo",text:"ReplicasInput__text--2_YxJ",buttons:"ReplicasInput__buttons--28Qqi"}},3621:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(1)),f=l(n(3)),m=l(n(2525)),p=l(n(3622)),h=l(n(2842)),v=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props,a=e.className,n=e.prefix,l=e.containers,r=e.initContainers,o=e.podName,u=this.props.title||t("Container Config");return d.default.createElement(m.default,{className:(0,f.default)(h.default.main,a),title:u},l.map((function(e,t){return d.default.createElement(p.default,{key:t,prefix:n,detail:e,podName:o})})),r.map((function(e,t){return d.default.createElement(p.default,{key:t,prefix:n,detail:e,podName:o,isInit:!0})})))}}]),a}(d.default.Component);a.default=v,v.propTypes={className:c.default.string,prefix:c.default.string,title:c.default.string,containers:c.default.array,initContainers:c.default.array},v.defaultProps={prefix:"",containers:[],initContainers:[]}},3622:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(70)),o=l(n(63)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(0)),m=l(n(1)),p=l(n(3)),h=l(n(22)),v=l(n(38)),g=l(n(227)),y=l(n(2600)),E=l(n(2842)),b=function(e){function a(){return(0,u.default)(this,a),(0,s.default)(this,(0,d.default)(a).apply(this,arguments))}return(0,c.default)(a,e),(0,i.default)(a,[{key:"renderProbe",value:function(){var e=this.props.detail,t=e.livenessProbe,a=e.readinessProbe;return t||a?f.default.createElement("div",{className:E.default.probe},this.renderProbeRecord(a,"readiness"),this.renderProbeRecord(t,"liveness")):null}},{key:"renderProbeRecord",value:function(e,a){if(!e)return null;var n,l,r=e.initialDelaySeconds||0,o=e.timeoutSeconds||0;if("httpGet"in e){var u=e.httpGet,i=u.path,s=u.port,d=u.scheme;n="HTTP Request Check",l="GET ".concat(i," on port ").concat(s," (").concat(d,")")}else if("tcpSocket"in e)n="TCP Port Check",l="Open socket on port ".concat(e.tcpSocket.port," (TCP)");else{var c=e.exec.command;n="Exec Commnad Check",l=(void 0===c?[]:c).join(" ")}return f.default.createElement("div",{className:E.default.probeItem},f.default.createElement("div",null,f.default.createElement(y.default,{type:"liveness"===a?"warning":"primary"},"liveness"===a?t("Liveness Probe"):t("Readiness Probe")),f.default.createElement("span",{className:E.default.probeType},t(n)),f.default.createElement("span",{className:E.default.probeTime},t("Initial Delay"),": ",r,"s   ",t("Timeout"),": ",o,"s")),f.default.createElement("p",null,l))}},{key:"renderLimitRange",value:function(){var e=this.props.detail,t=(0,h.default)(e,"resources.limits",{}),a=(0,h.default)(e,"resources.requests",{});return f.default.createElement("div",{className:E.default.limits},(t.cpu||a.cpu)&&f.default.createElement("span",{className:E.default.limit},f.default.createElement(v.default,{name:"cpu",size:20}),f.default.createElement("span",null,"".concat(a.cpu||0," ~ ").concat(t.cpu||"∞"))),(t.memory||a.memory)&&f.default.createElement("span",{className:E.default.limit},f.default.createElement(v.default,{name:"memory",size:20}),"".concat(a.memory||0," ~ ").concat(t.memory||"∞")))}},{key:"render",value:function(){var e=this.props,a=e.className,n=e.detail,l=(e.prefix,e.podName,e.isInit),u=(0,o.default)(e,["className","detail","prefix","podName","isInit"]),i=n.livenessProbe||n.readinessProbe;return f.default.createElement("div",(0,r.default)({className:(0,p.default)(E.default.item,a)},u),f.default.createElement("div",{className:E.default.icon},f.default.createElement(v.default,{name:"docker",size:40})),f.default.createElement("div",{className:(0,p.default)(E.default.text,E.default.name)},f.default.createElement("div",null,n.name,l&&f.default.createElement(y.default,{className:"margin-l8",type:"warning"},t("Init Container")),i&&f.default.createElement(g.default,{content:this.renderProbe()},f.default.createElement(y.default,{className:"margin-l8"},t("Probe")))),f.default.createElement("p",null,t("Image"),":",n.image)),this.renderLimitRange())}}]),a}(f.default.Component);a.default=b,b.propTypes={className:m.default.string,prefix:m.default.string,detail:m.default.object,podName:m.default.string},b.defaultProps={prefix:"",detail:{}}},3623:function(e,t,a){e.exports={replica:"ConfigTemplate__replica--B1Vlc",replicaCount:"ConfigTemplate__replicaCount--3xTQN"}},3624:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(97)),r=a(49),o=a(564),u=n(a(2517)),i=n(a(2585)),s=n(a(2548)),d=n(a(3625)),c=n(a(2675)),f=n(a(3630)),m=n(a(3633)),p=n(a(3634)),h=n(a(3635)),v=a(2547),g="statefulsets",y="/projects/:namespace/".concat(g,"/:name"),E="".concat(y,"/revisions/:revision"),b=[{name:"resource-status",title:"Resource Status",component:f.default},{name:"revision-control",title:"Revision Control",component:c.default},{name:"monitors",title:"Monitoring",component:m.default},{name:"env",title:"Environment Variables",component:i.default},{name:"events",title:"Events",component:s.default}],_=[{name:"config-template",title:"Config Template",component:h.default},{name:"env",title:"Environment Variables",component:i.default},{name:"events",title:"Events",component:s.default}],S=[{label:"Project",url:"/projects/:namespace"},{label:"StatefulSets",url:"/projects/:namespace/".concat(g)}],k=[].concat((0,l.default)((0,v.getPodRoutes)(y,[].concat(S,[{label:"Detail",url:"/projects/:namespace/".concat(g,"/:name")}]))),[{path:E,component:(0,r.withProps)(u.default,{module:g,component:p.default,breadcrumbs:[].concat(S,[{label:"Revision Control",url:"/projects/:namespace/".concat(g,"/:name/revision-control")}])}),routes:(0,o.getChildRoutes)(_,E)},{path:y,component:(0,r.withProps)(u.default,{module:g,component:d.default,breadcrumbs:S}),routes:(0,o.getChildRoutes)(b,y)}]);t.default=k},3625:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(37)),u=l(n(61)),i=l(n(62)),s=l(n(13)),d=l(n(14)),c=l(n(17)),f=l(n(16)),m=l(n(18)),p=l(n(0)),h=n(19),v=n(60),g=l(n(22)),y=l(n(947)),E=l(n(388)),b=n(2673),_=l(n(2527)),S=l(n(2526)),k=l(n(2674)),C=l(n(2835)),w=l(n(3626)),N=l(n(2670)),T=n(114),P=(0,v.inject)("rootStore")(r=(0,v.observer)(r=function(e){function a(e){var n;return(0,s.default)(this,a),(n=(0,c.default)(this,(0,f.default)(a).call(this,e))).getOperations=function(){return[{key:"edit",type:"control",text:t("EDIT"),action:"edit",onClick:n.showModal("editBaseInfo")},{key:"rollBack",icon:"timed-task",text:t("Revision Rollback"),action:"edit",onClick:n.showModal("rollBack")},{key:"editService",show:n.resourceStore.isExistService,icon:"network-router",text:t("Edit Service"),action:"edit",onClick:n.showModal("editService")},{key:"editConfigTemplate",icon:"storage",text:t("Edit Config Template"),action:"edit",onClick:n.showModal("editConfigTemplate")},{key:"editYaml",icon:"pen",text:t("Edit YAML"),action:"edit",onClick:n.showModal("editYaml")},{key:"redeploy",icon:"restart",text:t("Redeploy"),action:"edit",onClick:n.showModal("redeploy")},{key:"delete",icon:"trash",text:t("Delete"),action:"delete",onClick:n.showModal("deleteModal")}]},n.fetchData=function(){var e=(0,i.default)(u.default.mark((function e(t){return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.store.fetchDetail){e.next=3;break}return e.next=3,n.store.fetchDetail(n.params,t).catch(n.catch);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleEditService=function(e){n.serviceStore.update(n.serviceDetail,e).then((function(){n.hideModal("editService")(),E.default.success({content:"".concat(t("Updated Successfully"),"!")}),n.fetchData()}))},n.state=(0,o.default)({},n.state,{editService:!1}),n.serviceStore=new y.default,n}return(0,m.default)(a,e),(0,d.default)(a,[{key:"renderExtraModals",value:function(){var e=this.store,t=e.detail,a=void 0===t?{}:t,n=e.isSubmitting,l=this.state,r=l.editBaseInfo,o=l.rollBack,u=l.redeploy,i=l.editConfigTemplate,s=l.editService,d=l.editYaml,c=(0,h.toJS)(a._originData);return this.serviceDetail={type:"Headless(Selector)",name:(0,g.default)(c,"spec.serviceName",""),namespace:a.namespace},p.default.createElement("div",null,p.default.createElement(_.default,{visible:r,detail:c,onOk:this.handleEdit("editBaseInfo"),onCancel:this.hideModal("editBaseInfo"),isSubmitting:n}),p.default.createElement(k.default,{visible:o,module:this.module,detail:a,onOk:this.handleRollBack,onCancel:this.hideModal("rollBack"),isSubmitting:this.revisionStore.isSubmitting}),p.default.createElement(C.default,{visible:i,store:this.store,module:this.module,detail:c,onOk:this.handleEdit("editConfigTemplate","update"),onCancel:this.hideModal("editConfigTemplate"),isSubmitting:n}),p.default.createElement(S.default,{visible:d,detail:c,onOk:this.handleEdit("editYaml","update"),onCancel:this.hideModal("editYaml"),isSubmitting:n}),p.default.createElement(N.default,{visible:u,detail:a,type:T.MODULE_KIND_MAP[this.module],onOk:this.handleRedeploy,onCancel:this.hideModal("redeploy"),isSubmitting:n}),p.default.createElement(w.default,{visible:s,store:this.serviceStore,detail:this.serviceDetail,onOk:this.handleEditService,onCancel:this.hideModal("editService"),isSubmitting:this.serviceStore.isSubmitting}))}},{key:"name",get:function(){return"StatefulSet"}}]),a}(b.Component))||r)||r;a.default=P},3626:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(1)),f=n(19),m=l(n(115)),p=n(114),h=l(n(947)),v=l(n(129)),g=l(n(387)),y=l(n(3627)),E=function(e){function a(e){var t;return(0,r.default)(this,a),(t=(0,u.default)(this,(0,i.default)(a).call(this,e))).handleOk=function(){var e=t.props.onOk,a=t.formRef.current;a&&a.validate((function(){var n=a.getData();(0,m.default)(n,"metadata.resourceVersion",t.store.detail.resourceVersion),e(n)}))},t.handleCancel=function(){(0,t.props.onCancel)()},t.formRef=d.default.createRef(),t.state={formTemplate:{}},t.store=e.store||new h.default,t.fetchData(e.detail),t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.visible&&e.visible!==this.props.visible&&this.fetchData(e.detail)}},{key:"fetchData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.name,n=t.namespace;a&&n&&this.store.fetchDetail({name:a,namespace:n}).then((function(){e.setState({formTemplate:(0,f.toJS)(e.store.detail._originData)})}))}},{key:"renderForm",value:function(){return d.default.createElement(y.default,{formRef:this.formRef,formTemplate:this.state.formTemplate})}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.isSubmitting,l=e.detail;return d.default.createElement(g.default,{width:1162,title:t("Edit Service"),onOk:l.type!==p.SERVICE_TYPES.Unknown?this.handleOk:null,onCancel:this.handleCancel,okText:t("Update"),visible:a,isSubmitting:n},d.default.createElement(v.default,{spinning:this.store.isLoading},this.renderForm()))}}]),a}(d.default.Component);a.default=E,E.propTypes={visible:c.default.bool,detail:c.default.object,onOk:c.default.func,onCancel:c.default.func,isSubmitting:c.default.bool},E.defaultProps={visible:!1,detail:{},onOk:function(){},onCancel:function(){},isSubmitting:!1}},3627:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(22)),f=l(n(2672)),m=l(n(386)),p=l(n(267)),h=l(n(952)),v=l(n(2843)),g=l(n(3629)),y=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"renderName",value:function(){return d.default.createElement(p.default.Item,{label:t("Name")},d.default.createElement(m.default,{name:"metadata.name",disabled:!0}))}},{key:"renderSelectorLabels",value:function(){var e=(0,c.default)(this.props.formTemplate,"spec.selector",{});return d.default.createElement(p.default.Item,{label:t("Selector")},d.default.createElement("div",{className:g.default.selectors},Object.keys(e).map((function(t){return d.default.createElement(v.default,{key:t,name:t,value:e[t]})}))))}},{key:"renderTypeSelect",value:function(){return d.default.createElement(p.default.Item,{label:t("Access Type")},d.default.createElement(h.default,{className:"margin-b12",value:this.state.serviceType,onChange:this.handleTypeChange,options:this.types,disabled:!0}))}},{key:"render",value:function(){var e=this.props.formRef;return d.default.createElement("div",{className:g.default.wrapper},d.default.createElement(p.default,{data:this.formTemplate,ref:e},this.renderName(),this.renderTypeSelect(),this.renderSelectorLabels(),this.renderPorts()))}}]),a}(f.default);a.default=y},3628:function(e,t,a){e.exports={label:"Label__label--2Ci7c",name:"Label__name--3c-ep"}},3629:function(e,t,a){e.exports={card:"StatefulSet__card--1RshJ",tabs:"StatefulSet__tabs--wyrLr",label:"StatefulSet__label--QqDn4",selectors:"StatefulSet__selectors--3_DdQ"}},3630:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r=n(a(61)),o=n(a(62)),u=n(a(13)),i=n(a(14)),s=n(a(17)),d=n(a(16)),c=n(a(18)),f=n(a(0)),m=a(19),p=a(60),h=n(a(22)),v=n(a(58)),g=n(a(2601)),y=a(2611),E=n(a(3631)),b=(0,p.observer)(l=function(e){function t(){var e,a;(0,u.default)(this,t);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(a=(0,s.default)(this,(e=(0,d.default)(t)).call.apply(e,[this].concat(l)))).fetchData=(0,o.default)(r.default.mark((function e(){var t,n;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.store.detail.namespace,n={name:a.serviceName,namespace:t},e.next=4,a.resourceStore.checkService(n);case 4:if(!a.resourceStore.isExistService){e.next=7;break}return e.next=7,a.resourceStore.fetchService(n);case 7:case"end":return e.stop()}}),e)}))),a}return(0,c.default)(t,e),(0,i.default)(t,[{key:"renderServices",value:function(){var e=this.resourceStore,t=e.service,a=e.isLoading;return t.name?f.default.createElement(E.default,{service:t,loading:a}):null}},{key:"renderVolumes",value:function(){var e=this.store.isLoading,t=(0,m.toJS)(this.store.detail),a=t.volumes,n=void 0===a?[]:a,l=t.containers,r=this.props.match.params.namespace;return(0,v.default)(n)?null:f.default.createElement(g.default,{title:this.volumesTitle,volumes:n,containers:l,loading:e,prefix:"/projects/".concat(r)})}},{key:"renderContent",value:function(){return f.default.createElement("div",null,this.renderReplicaInfo(),this.renderServices(),this.renderContainerPorts(),this.renderPods(),this.renderVolumes())}},{key:"serviceName",get:function(){return(0,h.default)(this.store.detail,"spec.serviceName","")}},{key:"enableScaleReplica",get:function(){return!0}}]),t}(y.Component))||l;t.default=b},3631:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=n(226),f=l(n(1)),m=l(n(3)),p=l(n(58)),h=l(n(22)),v=n(114),g=l(n(38)),y=l(n(2525)),E=l(n(3632)),b=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"renderContent",value:function(){var e=this.props.service;if((0,p.default)(e))return null;var a=e.namespace,n=e.name,l=e.type;return d.default.createElement("div",{className:E.default.item},d.default.createElement(g.default,{className:E.default.icon,name:v.ICON_TYPES.services,size:40}),d.default.createElement("div",{className:E.default.info},d.default.createElement("div",{className:E.default.base},d.default.createElement("strong",null,d.default.createElement(c.Link,{to:"/projects/".concat(a,"/services/").concat(n)},n)),d.default.createElement("p",null,l)),d.default.createElement("div",{className:E.default.ports},d.default.createElement("div",{className:E.default.record},d.default.createElement("label",null,t("Ports"),":"),d.default.createElement("div",{className:E.default.text},this.ports.map((function(e,t){return d.default.createElement("p",{key:t},e)})))))))}},{key:"render",value:function(){var e=this.props.className,a=this.props.title||t("Service");return d.default.createElement(y.default,{className:(0,m.default)(E.default.main,e),title:a},this.renderContent())}},{key:"ports",get:function(){return(0,h.default)(this.props.service,"ports",[]).map((function(e){var t=e.targetPort?":".concat(e.targetPort):"";return"".concat(e.port).concat(t,"/").concat(e.protocol)}))}}]),a}(d.default.Component);a.default=b,b.propTypes={className:f.default.string,title:f.default.string,service:f.default.object,loading:f.default.bool},b.defaultProps={service:{},loading:!0}},3632:function(e,t,a){e.exports={item:"ServiceCard__item--1_STn",info:"ServiceCard__info--2yhfT",record:"ServiceCard__record--1EGxE",text:"ServiceCard__text--2_sgX",base:"ServiceCard__base--3m_C0"}},3633:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r=n(a(13)),o=n(a(14)),u=n(a(17)),i=n(a(16)),s=n(a(18)),d=a(60),c=a(2677),f=(0,d.observer)(l=function(e){function t(){return(0,r.default)(this,t),(0,u.default)(this,(0,i.default)(t).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"monitoringModule",get:function(){return"statefulset"}}]),t}(c.Component))||l;t.default=f},3634:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=n(60),f=n(941),m=n(2679),p=(0,c.inject)("rootStore")(r=(0,c.observer)(r=function(e){function a(){var e,n;(0,o.default)(this,a);for(var l=arguments.length,r=new Array(l),u=0;u<l;u++)r[u]=arguments[u];return(n=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(r)))).getAttrs=function(){return[{name:t("Project"),value:n.namespace},{name:t("Application"),value:n.application},{name:t("Status"),value:n.revisionStatus},{name:t("Selector"),value:n.selectors},{name:t("Updated Time"),value:n.updateTime},{name:t("Creator"),value:n.creator}]},n}return(0,d.default)(a,e),(0,u.default)(a,[{key:"name",get:function(){return"StatefulSets"}},{key:"revisionStatus",get:function(){return t((0,f.getStatefulSetStatus)(this.store.detail))}}]),a}(m.Component))||r)||r;a.default=p},3635:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r=n(a(13)),o=n(a(17)),u=n(a(16)),i=n(a(18)),s=a(60),d=a(2680),c=(0,s.observer)(l=function(e){function t(){return(0,r.default)(this,t),(0,o.default)(this,(0,u.default)(t).apply(this,arguments))}return(0,i.default)(t,e),t}(d.Component))||l;t.default=c},3636:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(97)),r=a(49),o=a(564),u=n(a(2517)),i=n(a(2585)),s=n(a(2548)),d=n(a(3637)),c=n(a(2675)),f=n(a(3638)),m=n(a(3639)),p=n(a(3640)),h=n(a(3641)),v=a(2547),g="daemonsets",y="/projects/:namespace/".concat(g,"/:name"),E="".concat(y,"/revisions/:revision"),b=[{name:"resource-status",title:"Resource Status",component:f.default},{name:"revision-control",title:"Revision Control",component:c.default},{name:"monitors",title:"Monitoring",component:m.default},{name:"env",title:"Environment Variables",component:i.default},{name:"events",title:"Events",component:s.default}],_=[{name:"config-template",title:"Config Template",component:h.default},{name:"env",title:"Environment Variables",component:i.default},{name:"events",title:"Events",component:s.default}],S=[{label:"Project",url:"/projects/:namespace"},{label:"DaemonSets",url:"/projects/:namespace/".concat(g)}],k=[].concat((0,l.default)((0,v.getPodRoutes)(y,[].concat(S,[{label:"Detail",url:"/projects/:namespace/".concat(g,"/:name")}]))),[{path:E,component:(0,r.withProps)(u.default,{module:g,component:p.default,breadcrumbs:[].concat(S,[{label:"Revision Control",url:"/projects/:namespace/".concat(g,"/:name/revision-control")}])}),routes:(0,o.getChildRoutes)(_,E)},{path:y,component:(0,r.withProps)(u.default,{module:g,component:d.default,breadcrumbs:S}),routes:(0,o.getChildRoutes)(b,y)}]);t.default=k},3637:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r=n(a(13)),o=n(a(14)),u=n(a(17)),i=n(a(16)),s=n(a(18)),d=a(60),c=a(2673),f=(0,d.inject)("rootStore")(l=(0,d.observer)(l=function(e){function t(){return(0,r.default)(this,t),(0,u.default)(this,(0,i.default)(t).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"name",get:function(){return"DaemonSet"}}]),t}(c.Component))||l)||l;t.default=f},3638:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r=n(a(13)),o=n(a(14)),u=n(a(17)),i=n(a(16)),s=n(a(18)),d=a(60),c=a(2611),f=(0,d.observer)(l=function(e){function t(){return(0,r.default)(this,t),(0,u.default)(this,(0,i.default)(t).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"enableScaleReplica",get:function(){return null}}]),t}(c.Component))||l;t.default=f},3639:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r=n(a(13)),o=n(a(14)),u=n(a(17)),i=n(a(16)),s=n(a(18)),d=a(60),c=a(2677),f=(0,d.observer)(l=function(e){function t(){return(0,r.default)(this,t),(0,u.default)(this,(0,i.default)(t).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"monitoringModule",get:function(){return"daemonset"}}]),t}(c.Component))||l;t.default=f},3640:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=n(60),f=l(n(58)),m=l(n(22)),p=n(2679),h=(0,c.inject)("rootStore")(r=(0,c.observer)(r=function(e){function a(){var e,n;(0,o.default)(this,a);for(var l=arguments.length,r=new Array(l),u=0;u<l;u++)r[u]=arguments[u];return(n=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(r)))).getAttrs=function(){return[{name:t("Project"),value:n.namespace},{name:t("Application"),value:n.application},{name:t("Node Selector"),value:n.nodeSelector},{name:t("Update Strategy"),value:n.updateStrategy}]},n}return(0,d.default)(a,e),(0,u.default)(a,[{key:"name",get:function(){return"DaemonSet"}},{key:"nodeSelector",get:function(){var e=this.store.detail.spec,t=(0,m.default)(e,"template.spec.nodeSelector",{});return(0,f.default)(t)?"-":Object.keys(t).map((function(e){return"".concat(e,"=").concat(t[e])})).join(",")}},{key:"updateStrategy",get:function(){return(0,m.default)(this.store.workloadDetail,"updateStrategy")}}]),a}(p.Component))||r)||r;a.default=h},3641:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r=n(a(13)),o=n(a(14)),u=n(a(17)),i=n(a(16)),s=n(a(18)),d=a(60),c=n(a(22)),f=a(2680),m=(0,d.observer)(l=function(e){function t(){return(0,r.default)(this,t),(0,u.default)(this,(0,i.default)(t).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"replicaStatus",get:function(){return{value:(0,c.default)(this.store.workloadDetail,"status.desiredNumberScheduled",0),onChange:null}}}]),t}(f.Component))||l;t.default=m},3642:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(97)),r=a(49),o=a(564),u=n(a(2517)),i=n(a(2585)),s=n(a(2548)),d=n(a(3643)),c=n(a(3644)),f=n(a(3646)),m=a(2547),p="/projects/:namespace/".concat("jobs","/:name"),h=[{name:"records",title:"Excute Records",component:c.default},{name:"resource-status",title:"Resource Status",component:f.default},{name:"env",title:"Environment Variables",component:i.default},{name:"events",title:"Events",component:s.default}],v=[{label:"Project",url:"/projects/:namespace"},{label:"Jobs",url:"/projects/:namespace/".concat("jobs")}],g=[].concat((0,l.default)((0,m.getPodRoutes)(p,[].concat(v,[{label:"Detail",url:"/projects/:namespace/".concat("jobs","/:name")}]))),[{path:p,component:(0,r.withProps)(u.default,{module:"jobs",component:d.default,breadcrumbs:v}),routes:(0,o.getChildRoutes)(h,p)}]);t.default=g},3643:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=n(19),m=n(60),p=l(n(22)),h=l(n(58)),v=n(49),g=n(941),y=l(n(2536)),E=l(n(2681)),b=l(n(2634)),_=l(n(2520)),S=l(n(2527)),k=l(n(2526)),C=(0,m.inject)("rootStore")(r=(0,m.observer)(r=function(e){function a(){var e,n;(0,o.default)(this,a);for(var l=arguments.length,r=new Array(l),u=0;u<l;u++)r[u]=arguments[u];return(n=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(r)))).state={editBaseInfo:!1,viewYaml:!1,deleteModule:!1},n.getOperations=function(){return[{key:"edit",type:"control",text:t("EDIT"),action:"edit",onClick:n.showModal("editBaseInfo")},{key:"rerun",icon:"refresh",text:t("Rerun"),action:"edit",onClick:n.handleRerun},{key:"viewYaml",icon:"pen",text:t("View YAML"),action:"view",onClick:n.showModal("viewYaml")},{key:"delete",icon:"trash",text:t("Delete"),action:"delete",onClick:n.showModal("deleteModule")}]},n.getAttrs=function(){var e=(0,f.toJS)(n.store.detail),a=e.spec,l=void 0===a?{}:a,r=(0,g.getJobStatus)(e);return[{name:t("Project"),value:n.namespace},{name:t("Status"),value:t(r)},{name:t("backoffLimit"),value:l.backoffLimit},{name:t("completions"),value:l.completions},{name:t("parallelism"),value:l.parallelism},{name:t("activeDeadlineSeconds"),value:l.activeDeadlineSeconds},{name:t("Selector"),value:n.selectors},{name:t("Created Time"),value:n.createTime},{name:t("Creator"),value:n.creator}]},n.handleRerun=function(){var e=n.store.detail;n.store.rerun(e).then((function(){n.fetchData()}))},n}return(0,d.default)(a,e),(0,u.default)(a,[{key:"init",value:function(){this.store=new y.default(this.module),this.resourceStore=new b.default(this.module),this.recordStore=new E.default}},{key:"renderExtraModals",value:function(){var e=this.store,t=e.detail,a=void 0===t?{}:t,n=e.isSubmitting,l=this.state,r=l.editBaseInfo,o=l.viewYaml,u=(0,f.toJS)(a._originData);return c.default.createElement("div",null,c.default.createElement(S.default,{visible:r,detail:u,onOk:this.handleEdit("editBaseInfo"),onCancel:this.hideModal("editBaseInfo"),isSubmitting:n}),c.default.createElement(k.default,{visible:o,detail:u,onCancel:this.hideModal("viewYaml"),readOnly:!0}))}},{key:"name",get:function(){return"Job"}},{key:"selectors",get:function(){var e=this.store.detail.spec,t=void 0===e?{}:e,a=(0,p.default)(t,"selector.matchLabels",{});return(0,h.default)(a)?"-":c.default.createElement("span",null,Object.keys(a).map((function(e){return"".concat(e," = ").concat(a[e])})).join(", "))}},{key:"updateTime",get:function(){var e=(0,p.default)(this.store.detail,"status.conditions",[]);if((0,h.default)(e))return"-";var t=new Date((0,p.default)(e,"[0].lastTransitionTime",0)).valueOf();return e.forEach((function(e){var a=e.lastTransitionTime,n=new Date(a).valueOf();n>t&&(t=n)})),(0,v.getLocalTime)(t).format("YYYY-MM-DD HH:mm:ss")}}]),a}(_.default))||r)||r;a.default=C},3644:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(37)),u=l(n(13)),i=l(n(17)),s=l(n(16)),d=l(n(14)),c=l(n(18)),f=l(n(0)),m=n(19),p=n(60),h=n(49),v=n(938),g=l(n(2456)),y=l(n(949)),E=l(n(2516)),b=l(n(2521)),_=l(n(2534)),S=l(n(3645)),k=(0,p.inject)("rootStore")(r=(0,p.observer)(r=function(e){function a(e){var n;return(0,u.default)(this,a),(n=(0,i.default)(this,(0,s.default)(a).call(this,e))).fetchData=function(e){var t=n.props.match.params,a=t.name,l=t.namespace;n.recordStore&&n.recordStore.fetchExcuteRecords((0,o.default)({},e,{name:a,namespace:l}))},n.getColumns=function(){return[{title:t("No."),dataIndex:"id",width:"7%"},{title:t("Status"),dataIndex:"status",width:"19%",render:function(e,a){return f.default.createElement(b.default,{type:e,name:t(e),ready:a.succeed,total:a.desire})}},{title:t("Message"),dataIndex:"messages[0]",render:function(e){return e||"-"}},{title:t("Start Time"),dataIndex:"start-time",render:function(e){return(0,h.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}},{title:t("End Time"),dataIndex:"completion-time",render:function(e){return!e||/^0001-01-01/.test(e)?"-":(0,h.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}}]},n.handleSearch=function(e){n.fetchData(e)},n.handlePagination=function(e){n.fetchData({page:e})},n.renderTableTitle=function(){return f.default.createElement("div",{className:S.default.nav},f.default.createElement(v.Columns,null,f.default.createElement(v.Column,null,f.default.createElement(_.default,{name:"search",placeholder:t("Please input a keyword to filter"),onSearch:n.handleSearch}))))},n.renderTableFooter=function(){var e=n.excute,a=e.total,l=e.page,r=e.limit;return f.default.createElement(v.Level,null,f.default.createElement(v.LevelLeft,null,t("TOTAL_ITEMS",{num:a})),f.default.createElement(v.LevelRight,null,f.default.createElement(y.default,{current:l,total:a,pageSize:r,onChange:n.handlePagination})))},n.fetchData(),n}return(0,c.default)(a,e),(0,d.default)(a,[{key:"store",get:function(){return this.props.detailStore}},{key:"recordStore",get:function(){return this.props.recordStore}},{key:"excute",get:function(){return(0,m.toJS)(this.recordStore.excute)}}]),(0,d.default)(a,[{key:"renderTable",value:function(){var e=this.excute,t=e.data,a=e.isLoading;return f.default.createElement(g.default,{className:S.default.table,dataSource:t,columns:this.getColumns(),loading:a})}},{key:"render",value:function(){return f.default.createElement(E.default,{className:S.default.main,title:t("Excute Records")},f.default.createElement("div",{className:S.default.content},this.renderTable()))}}]),a}(f.default.Component))||r)||r;a.default=k},3645:function(e,t,a){e.exports={main:"ExcuteRecords__main--3MFTJ",table:"ExcuteRecords__table--10PRl"}},3646:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r=n(a(13)),o=n(a(14)),u=n(a(17)),i=n(a(16)),s=n(a(18)),d=n(a(0)),c=a(60),f=a(2611),m=(0,c.observer)(l=function(e){function t(){return(0,r.default)(this,t),(0,u.default)(this,(0,i.default)(t).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"renderContent",value:function(){return d.default.createElement("div",null,this.renderContainerPorts(),this.renderPods(),this.renderVolumes())}}]),t}(f.Component))||l;t.default=m},3647:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(49),r=a(564),o=n(a(2517)),u=n(a(2548)),i=n(a(3648)),s=n(a(3649)),d="/projects/:namespace/".concat("cronjobs","/:name"),c=[{name:"records",title:"Job Records",component:s.default},{name:"events",title:"Events",component:u.default}],f=[{path:d,component:(0,l.withProps)(o.default,{module:"cronjobs",component:i.default,breadcrumbs:[{label:"Project",url:"/projects/:namespace"},{label:"CronJobs",url:"/projects/:namespace/".concat("cronjobs")}]}),routes:(0,r.getChildRoutes)(c,d)}];t.default=f},3648:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=n(19),m=n(60),p=l(n(2536)),h=l(n(2681)),v=l(n(2520)),g=l(n(2527)),y=l(n(2526)),E=(0,m.inject)("rootStore")(r=(0,m.observer)(r=function(e){function a(){var e,n;(0,o.default)(this,a);for(var l=arguments.length,r=new Array(l),u=0;u<l;u++)r[u]=arguments[u];return(n=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(r)))).state={editBaseInfo:!1,editYaml:!1,deleteModule:!1},n.getOperations=function(){return[{key:"edit",type:"control",text:t("EDIT"),action:"edit",onClick:n.showModal("editBaseInfo")},{key:"start",icon:"start",text:t("Start"),action:"edit",onClick:n.handleSwitch(!0),show:n.suspend},{key:"pause",icon:"stop",text:t("Pause"),action:"edit",onClick:n.handleSwitch(!1),show:!n.suspend},{key:"editYaml",icon:"pen",text:t("Edit YAML"),action:"edit",onClick:n.showModal("editYaml")},{key:"delete",icon:"trash",text:t("Delete"),action:"delete",onClick:n.showModal("deleteModule")}]},n.getAttrs=function(){var e=n.store.detail.spec,a=void 0===e?{}:e,l=n.suspend?t("Suspend"):t("Running");return[{name:t("Project"),value:n.namespace},{name:t("Status"),value:l},{name:t("Schedule"),value:a.schedule},{name:t("startingDeadlineSeconds"),value:a.startingDeadlineSeconds},{name:t("successfulJobsHistoryLimit"),value:a.successfulJobsHistoryLimit},{name:t("failedJobsHistoryLimit"),value:a.failedJobsHistoryLimit},{name:t("concurrencyPolicy"),value:a.concurrencyPolicy},{name:t("Created Time"),value:n.createTime},{name:t("Creator"),value:n.creator}]},n.handleSwitch=function(e){return function(){n.store.switch(n.store.detail,e).then((function(){n.fetchData()}))}},n}return(0,d.default)(a,e),(0,u.default)(a,[{key:"init",value:function(){this.store=new p.default(this.module),this.recordStore=new h.default}},{key:"renderExtraModals",value:function(){var e=this.store,t=e.detail,a=void 0===t?{}:t,n=e.isSubmitting,l=this.state,r=l.editBaseInfo,o=l.editYaml,u=(0,f.toJS)(a._originData);return c.default.createElement("div",null,c.default.createElement(g.default,{visible:r,detail:u,onOk:this.handleEdit("editBaseInfo"),onCancel:this.hideModal("editBaseInfo"),isSubmitting:n}),c.default.createElement(y.default,{visible:o,detail:u,onOk:this.handleEdit("editYaml","update"),onCancel:this.hideModal("editYaml"),isSubmitting:n}))}},{key:"name",get:function(){return"CronJob"}},{key:"suspend",get:function(){return this.store.detail.suspend}}]),a}(v.default))||r)||r;a.default=E},3649:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(37)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(0)),m=n(19),p=n(60),h=n(226),v=l(n(22)),g=n(49),y=n(941),E=l(n(2681)),b=l(n(38)),_=l(n(2456)),S=l(n(2516)),k=l(n(2521)),C=l(n(3650)),w=(0,p.inject)("rootStore")(r=(0,p.observer)(r=function(e){function a(e){var n;return(0,u.default)(this,a),(n=(0,s.default)(this,(0,d.default)(a).call(this,e))).fetchData=function(e){var t=(0,m.toJS)(n.store.detail),a=(0,v.default)(t,"spec.jobTemplate.metadata.labels",{});n.recordStore.fetchListByK8s((0,o.default)({},e,{namespace:t.namespace,selector:a}))},n.getColumns=function(){return[{title:t("Job"),dataIndex:"name",width:"19%",render:function(e){return f.default.createElement(h.Link,{className:"item-name",to:"".concat(n.prefix,"/jobs/").concat(e)},e)}},{title:t("Status"),dataIndex:"status",width:"19%",render:function(e,a){var n=(0,y.getJobStatus)(a);return f.default.createElement(k.default,{type:n,name:t(n)})}},{title:t("Start Time"),dataIndex:"status.startTime",render:function(e){return(0,g.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss")}},{title:t("End Time"),dataIndex:"status.completionTime",render:function(e,t){var a=(0,v.default)(t,"status.conditions[0].lastProbeTime");return e?(0,g.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss"):a?(0,g.getLocalTime)(a).format("YYYY-MM-DD HH:mm:ss"):"-"}},{render:function(e){return f.default.createElement(b.default,{name:"refresh",clickable:!0,onClick:n.handleRerun(e)})}}]},n.handleRerun=function(e){return function(){n.store.rerun(e).then((function(){n.fetchData()}))}},n.recordStore=e.recordStore||new E.default,n}return(0,c.default)(a,e),(0,i.default)(a,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"renderTable",value:function(){var e=this.recordStore.list,t=e.data,a=e.isLoading;return f.default.createElement(_.default,{className:C.default.table,dataSource:t,columns:this.getColumns(),loading:a})}},{key:"render",value:function(){return f.default.createElement(S.default,{className:C.default.main,title:t("Job Records")},f.default.createElement("div",{className:C.default.content},this.renderTable()))}},{key:"store",get:function(){return this.props.detailStore}},{key:"params",get:function(){return this.props.match.params}},{key:"prefix",get:function(){var e=this.params.namespace;return"/projects/".concat(e)}}]),a}(f.default.Component))||r)||r;a.default=w},3650:function(e,t,a){e.exports={main:"JobRecords__main--3RGMg",table:"JobRecords__table--2sJ-1"}},3651:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=(0,a(2547).getPodRoutes)("/projects/:namespace",[{label:"Project",url:"/projects/:namespace"},{label:"Pods List",url:"/projects/:namespace/pods"}],{parentUrl:"/projects/:namespace/pods"});t.default=n},3652:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(97)),r=a(49),o=a(564),u=n(a(2517)),i=n(a(2548)),s=n(a(3653)),d=n(a(3654)),c=a(2547),f="/projects/:namespace/services/:name",m=[{name:"resource-status",title:"Resource Status",component:d.default},{name:"events",title:"Events",component:i.default}],p=[{label:"Project",url:"/projects/:namespace"},{label:"Services",url:"/projects/:namespace/services"}],h=[].concat((0,l.default)((0,c.getPodRoutes)(f,[].concat(p,[{label:"Detail",url:f}]))),[{path:f,component:(0,r.withProps)(u.default,{module:"services",component:s.default,breadcrumbs:p}),routes:(0,o.getChildRoutes)(m,f)}]);t.default=h},3653:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.Component=a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(22)),c=l(n(58)),f=l(n(0)),m=n(19),p=n(60),h=l(n(129)),v=n(49),g=n(114),y=l(n(947)),E=l(n(2520)),b=l(n(2527)),_=l(n(2526)),S=l(n(2819)),k=l(n(2822)),C=l(n(2823)),w=function(e){function a(){var e,n;(0,r.default)(this,a);for(var l=arguments.length,o=new Array(l),s=0;s<l;s++)o[s]=arguments[s];return(n=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(o)))).fetchData=function(){n.store.fetchDetail(n.props.match.params).then((function(){var e=n.store.detail,t=e.namespace,a=e.selector,l=(0,v.joinSelector)(a);(0,c.default)(l)||(n.store.fetchWorkloads({namespace:t,labelSelector:l}),n.store.fetchPods({namespace:t,labelSelector:l}))})).catch(n.catch),n.store.fetchEndpoints(n.props.match.params)},n.getOperations=function(){var e=[{key:"edit",type:"control",text:t("EDIT"),action:"edit",onClick:n.showModal("editBaseInfo")},{key:"editService",icon:"network-router",text:t("Edit Service"),action:"edit",onClick:n.showModal("editService")}];return(0,m.toJS)(n.store.detail).type===g.SERVICE_TYPES.VirtualIP&&e.push({key:"editGateway",icon:"ip",text:t("Edit Internet Access"),action:"edit",onClick:n.showModal("editGateway")}),[].concat(e,[{key:"editYaml",icon:"pen",text:t("Edit YAML"),action:"edit",onClick:n.showModal("editYaml")},{key:"delete",icon:"trash",type:"danger",text:t("Delete"),action:"delete",onClick:n.showModal("deleteModule")}])},n.getAttrs=function(){var e,a=(0,m.toJS)(n.store.detail);"ExternalName"===a.type?e=a.externalName:"LoadBalancer"===a.specType?e=a.loadBalancerIngress:a.externalIPs&&(e=a.externalIPs.join(", "));var l=(0,d.default)(a,'annotations["kubesphere.io/serviceType"]');return[{name:t("Project"),value:a.namespace},{name:t("Type"),value:f.default.createElement("span",null,"".concat(l?t("SERVICE_TYPE_".concat(l.toUpperCase())):t("Custom Creation")),f.default.createElement("span",{className:"text-desc"}," (",a.type,")"))},{name:t("Application"),value:n.application},{name:t("Virtual IP"),value:a.clusterIP},{name:t("External IP"),value:e},{name:t("Session Affinity"),value:a.sessionAffinity},{name:t("Selector"),value:(0,v.joinSelector)(a.selector)},{name:t("DNS"),value:n.getDNS()},{name:t("Endpoints"),value:n.renderEndpoints()},{name:t("Created Time"),value:n.createTime},{name:t("Updated Time"),value:n.updateTime},{name:t("Creator"),value:n.creator}]},n}return(0,s.default)(a,e),(0,o.default)(a,[{key:"init",value:function(){this.store=new y.default}},{key:"getDNS",value:function(){var e=this.store,t=e.detail,a=e.workloads,n=e.pods;return a.isLoading||"statefulsets"!==a.type||n.isLoading||0===n.data.length?"".concat(t.name,".").concat(t.namespace):n.data.map((function(e){return f.default.createElement("p",{key:e.uid},e.name,".",t.name,".",t.namespace)}))}},{key:"renderEndpoints",value:function(){if("Headless(ExternalName)"===this.store.detail.type)return null;var e=this.store.endpoints,t=e.isLoading,a=e.data;if(t)return f.default.createElement(h.default,{size:12});if(0===a.length)return"-";var n=[];return a.forEach((function(e){e.addresses.forEach((function(t){e.ports.forEach((function(e){t.ip&&e.port&&n.push("".concat(t.ip,":").concat(e.port))}))}))})),n.map((function(e,t){return f.default.createElement("p",{key:t},e)}))}},{key:"renderModals",value:function(){var e=this.store,a=e.detail,n=e.isSubmitting,l=this.state,r=l.deleteModule,o=l.editBaseInfo,u=l.editYaml,i=l.editService,s=l.editGateway,d=(0,m.toJS)(a._originData);return f.default.createElement("div",null,f.default.createElement(C.default,{type:t(this.name),resource:a,visible:r,onOk:this.handleDelete,onCancel:this.hideModal("deleteModule"),isSubmitting:n}),f.default.createElement(b.default,{visible:o,detail:d,onOk:this.handleEdit("editBaseInfo"),onCancel:this.hideModal("editBaseInfo"),isSubmitting:n}),f.default.createElement(_.default,{visible:u,detail:d,onOk:this.handleEdit("editYaml","update"),onCancel:this.hideModal("editYaml"),isSubmitting:n}),f.default.createElement(S.default,{visible:s,detail:d,onOk:this.handleEdit("editGateway","update"),onCancel:this.hideModal("editGateway"),isSubmitting:n}),f.default.createElement(k.default,{visible:i,detail:d,type:a.type,onOk:this.handleEdit("editService","update"),onCancel:this.hideModal("editService"),isSubmitting:n}))}},{key:"name",get:function(){return"Service"}},{key:"isLoading",get:function(){return this.store.isLoading}}]),a}(E.default),N=(0,p.inject)("rootStore")((0,p.observer)(w));a.default=N;var T=w;a.Component=T},3654:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=n(19),m=n(60),p=l(n(58)),h=l(n(227)),v=l(n(38)),g=l(n(224)),y=l(n(2525)),E=l(n(2586)),b=l(n(2588)),_=l(n(2844)),S=l(n(2556)),k=l(n(3656)),C=(0,m.observer)(r=function(e){function a(e){var t;return(0,o.default)(this,a),(t=(0,i.default)(this,(0,s.default)(a).call(this,e))).module=e.module,t.store=e.detailStore,t.routerStore=new S.default,t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"componentDidMount",value:function(){var e=this.props.match.params.namespace;this.routerStore.getGateway({namespace:e})}},{key:"renderPorts",value:function(){var e=(0,f.toJS)(this.store.detail),a=(0,f.toJS)(this.routerStore.gateway.data);return(0,p.default)(e.ports)?null:c.default.createElement(y.default,{title:t("Ports")},c.default.createElement("div",{className:k.default.portsWrapper},e.ports.map((function(e,n){return c.default.createElement("div",{key:n,className:k.default.ports},c.default.createElement(v.default,{name:"pod",size:40}),c.default.createElement("div",{className:k.default.port},c.default.createElement("p",null,c.default.createElement("strong",null,e.targetPort)),c.default.createElement("p",null,t("Container Port"))),c.default.createElement("div",{className:k.default.protocol},"→ ",e.protocol," → "),c.default.createElement(v.default,{name:"network-router",size:40}),c.default.createElement("div",{className:k.default.port},c.default.createElement("p",null,c.default.createElement("strong",null,e.port)),c.default.createElement("p",null,t("Service Port"))),e.nodePort&&c.default.createElement(c.default.Fragment,null,c.default.createElement("div",{className:k.default.protocol},"→ ",e.protocol," → "),c.default.createElement(v.default,{name:"nodes",size:40}),c.default.createElement("div",{className:k.default.port},c.default.createElement("p",null,c.default.createElement("strong",null,e.nodePort)),c.default.createElement("div",null,t("Node Port"),c.default.createElement(h.default,{content:t("SERVICE_NODE_PORT_DESC"),trigger:"hover"},c.default.createElement(v.default,{name:"information"})))),a.loadBalancerIngress&&c.default.createElement("a",{href:"http://".concat(a.loadBalancerIngress,":").concat(e.nodePort),target:"_blank"},c.default.createElement(g.default,{className:k.default.access,noShadow:!0},t("Click to visit")))))}))))}},{key:"renderWorkloads",value:function(){var e=(0,f.toJS)(this.store.workloads),t=e.data,a=e.isLoading;return c.default.createElement(_.default,{data:t,prefix:this.prefix,isLoading:a})}},{key:"renderPods",value:function(){var e=this.props.match.params,t=e.namespace,a=e.name;return c.default.createElement(b.default,{detail:this.store.detail,prefix:"/projects/".concat(t,"/").concat(this.module,"/").concat(a)})}},{key:"renderExternal",value:function(){var e=(0,f.toJS)(this.store.detail);return c.default.createElement(y.default,{title:t("External Service")},c.default.createElement(E.default,{title:e.externalName,description:t("ExternalName")}))}},{key:"renderContent",value:function(){return"ExternalName"===(0,f.toJS)(this.store.detail).specType?this.renderExternal():c.default.createElement("div",null,this.renderPorts(),this.renderWorkloads(),this.renderPods())}},{key:"render",value:function(){return c.default.createElement("div",{className:k.default.main},this.renderContent())}},{key:"prefix",get:function(){var e=this.props.match.params.namespace;return"/projects/".concat(e)}}]),a}(c.default.Component))||r;a.default=C},3655:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(22)),c=l(n(0)),f=n(226),m=l(n(1)),p=l(n(2535)),h=n(49),v=n(941),g=n(114),y=l(n(2569)),E=l(n(2845)),b=function(e){function a(){var e,t;(0,r.default)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(t=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(l)))).getStatus=function(e){return(0,v.getWorkloadStatus)(e,e.type)},t.getTotal=function(e){var t;return"deployments"===e.type?t=e.podNums||e.desire||0:"statefulsets"===e.type&&(t=e.podNums||e.desire||0),t},t.getReady=function(e){var t;return"deployments"===e.type?t=e.availablePodNums||e.available||0:"statefulsets"===e.type&&(t=e.readyPodNums||e.available||0),t},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"getDescription",value:function(e,a,n){if(e)return c.default.createElement(y.default,{status:a,reason:t(e),data:n});var l=n.updateTime,r=n.createTime;return l?"".concat(t("Updated at")," ").concat((0,h.getLocalTime)(l).fromNow()):"".concat(t("Created at")," ").concat((0,h.getLocalTime)(r).fromNow())}},{key:"renderExtra",value:function(){}},{key:"render",value:function(){var e=this.props,a=e.detail,n=e.prefix;if(!a)return null;var l=this.getStatus(a),r=l.status,o=l.reason,u=[{title:a.hasS2i?c.default.createElement("span",null,t(g.S2I_STATUS_DESC[r])):c.default.createElement("span",null,t(r)," (",this.getReady(a),"/",this.getTotal(a),")"),description:t("Status")}],i=(0,d.default)(a,'annotations["deployment.kubernetes.io/revision"]');return i&&u.push({title:"#".concat(i),description:t("Version")}),c.default.createElement(p.default.Item,{icon:g.ICON_TYPES[a.type],status:r,className:E.default.item,title:c.default.createElement(f.Link,{to:"".concat(n,"/").concat(a.type,"/").concat(a.name)},a.name),description:this.getDescription(o,r,a),extra:this.renderExtra(),details:u})}}]),a}(c.default.Component);a.default=b,b.propTypes={className:m.default.string,prefix:m.default.string,detail:m.default.object},b.defaultProps={prefix:"",detail:{}}},3656:function(e,t,a){e.exports={portsWrapper:"ResourceStatus__portsWrapper--2uXQX",ports:"ResourceStatus__ports--1z-jw",port:"ResourceStatus__port--4axLW",protocol:"ResourceStatus__protocol--2BWFq",access:"ResourceStatus__access--2N2s5"}},3657:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(49),r=a(564),o=n(a(2517)),u=n(a(2548)),i=n(a(3658)),s="/projects/:namespace/routes/:name",d=[{name:"resource-status",title:"Resource Status",component:n(a(3659)).default},{name:"events",title:"Events",component:u.default}],c=[{path:s,component:(0,l.withProps)(o.default,{module:"ingresses",component:i.default,breadcrumbs:[{label:"Project",url:"/projects/:namespace"},{label:"Routes",url:"/projects/:namespace/routes"}]}),routes:(0,r.getChildRoutes)(d,s)}];t.default=c},3658:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.Component=a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=n(19),f=n(60),m=l(n(2556)),p=l(n(2520)),h=l(n(2527)),v=l(n(2526)),g=l(n(2825)),y=l(n(2827)),E=function(e){function a(){var e,n;(0,r.default)(this,a);for(var l=arguments.length,o=new Array(l),s=0;s<l;s++)o[s]=arguments[s];return(n=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(o)))).getOperations=function(){return[{key:"edit",type:"control",text:t("EDIT"),action:"edit",onClick:n.showModal("editBaseInfo")},{key:"editYaml",icon:"pen",text:t("Edit YAML"),action:"edit",onClick:n.showModal("editYaml")},{key:"editRules",icon:"firewall",text:t("Edit Rules"),action:"edit",onClick:n.showModal("editRules")},{key:"editAnnotations",icon:"firewall",text:t("Edit Annotations"),action:"edit",onClick:n.showModal("editAnnotations")},{key:"delete",icon:"trash",text:t("Delete"),action:"delete",onClick:n.showModal("deleteModule")}]},n.getAttrs=function(){var e=(0,c.toJS)(n.store.detail),a=e.loadBalancerIngress,l=[];return(void 0===a?[]:a).forEach((function(e){e.ip&&l.push(e.ip)})),l=l.map((function(e,t){return d.default.createElement("p",{key:t},e)})),[{name:t("Project"),value:e.namespace},{name:t("Application"),value:n.application},{name:t("Gateway Address"),value:l},{name:t("Created Time"),value:n.createTime},{name:t("Creator"),value:n.creator}]},n}return(0,s.default)(a,e),(0,o.default)(a,[{key:"init",value:function(){this.store=new m.default}},{key:"renderExtraModals",value:function(){var e=(0,c.toJS)(this.store.detail),t=this.store.isSubmitting,a=this.state,n=a.editBaseInfo,l=a.editYaml,r=a.editRules,o=a.editAnnotations,u=(0,c.toJS)(e._originData);return d.default.createElement("div",null,d.default.createElement(h.default,{visible:n,detail:u,onOk:this.handleEdit("editBaseInfo"),onCancel:this.hideModal("editBaseInfo"),isSubmitting:t}),d.default.createElement(v.default,{visible:l,detail:u,onOk:this.handleEdit("editYaml","update"),onCancel:this.hideModal("editYaml"),isSubmitting:t}),d.default.createElement(g.default,{visible:o,detail:u,onOk:this.handleEdit("editAnnotations","update"),onCancel:this.hideModal("editAnnotations"),isSubmitting:t}),d.default.createElement(y.default,{visible:r,detail:u,onOk:this.handleEdit("editRules","update"),onCancel:this.hideModal("editRules"),isSubmitting:t}))}},{key:"name",get:function(){return"Route"}},{key:"authKey",get:function(){return"routes"}},{key:"listUrl",get:function(){return"/projects/".concat(this.namespace,"/routes")}}]),a}(p.default),b=(0,f.inject)("rootStore")((0,f.observer)(E));a.default=b;var _=E;a.Component=_},3659:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(269)),f=l(n(58)),m=l(n(0)),p=n(19),h=n(60),v=l(n(2516)),g=l(n(3660)),y=l(n(3662)),E=l(n(2846)),b=(0,h.observer)(r=function(e){function a(e){var t;return(0,o.default)(this,a),(t=(0,i.default)(this,(0,s.default)(a).call(this,e))).store=e.detailStore,t.module=e.module,t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"componentDidMount",value:function(){var e=(0,p.toJS)(this.store.detail);this.store.getGateway({namespace:e.namespace})}},{key:"renderRules",value:function(){var e=(0,p.toJS)(this.store.detail),a=(0,p.toJS)(this.store.gateway.data),n=e.tls[0]||{};if((0,f.default)(e.rules))return null;var l=this.props.match.params.namespace;return m.default.createElement(v.default,{title:t("Rules")},e.rules.map((function(e){return m.default.createElement(y.default,{key:e.host,tls:n,rule:e,gateway:a,prefix:"/projects/".concat(l)})})))}},{key:"renderAnnotations",value:function(){var e=(0,p.toJS)(this.store.detail);return m.default.createElement(g.default,{data:(0,c.default)(e.annotations,["displayName","desc","creator"])})}},{key:"renderContent",value:function(){return m.default.createElement("div",null,this.renderRules(),this.renderAnnotations())}},{key:"render",value:function(){return m.default.createElement("div",{className:E.default.main},this.renderContent())}}]),a}(m.default.Component))||r;a.default=b},3660:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(1)),f=l(n(58)),m=n(938),p=l(n(2516)),h=l(n(3661)),v=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props,a=e.className,n=e.data;return(0,f.default)(n)?null:d.default.createElement(p.default,{className:a,title:t("Annotations")},d.default.createElement("ul",{className:h.default.annotations},Object.keys(n).filter((function(e){return!(0,f.default)(n[e])})).map((function(e){return d.default.createElement("li",{key:e},d.default.createElement(m.Columns,null,d.default.createElement(m.Column,{className:"is-narrow"},d.default.createElement("p",{style:{width:317}},e)),d.default.createElement(m.Column,null,d.default.createElement("p",null,n[e]))))}))))}}]),a}(d.default.Component);a.default=v,v.propTypes={className:c.default.string,data:c.default.object},v.defaultProps={data:{}}},3661:function(e,t,a){e.exports={annotations:"Annotations__annotations--2_w63"}},3662:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(0)),o=l(n(1)),u=n(226),i=l(n(38)),s=n(938),d=l(n(227)),c=l(n(224)),f=l(n(2846)),m=function(e){var a=e.gateway,n=e.rule,l=e.tls,o=void 0===l?{}:l,m=e.prefix,p=o.hosts&&o.hosts.includes(n.host)?"https":"http",h=n.host;if(a&&a.ports&&"NodePort"===a.type){var v=a.ports.find((function(e){return e.name===p}));v&&("http"===p&&80!==v.nodePort||"https"===p&&443!==v.nodePort)&&(h="".concat(h,":").concat(v.nodePort))}return r.default.createElement("div",{className:f.default.card},r.default.createElement("div",{className:f.default.content},r.default.createElement(i.default,{name:"earth",size:40}),r.default.createElement("div",{className:f.default.title},h,r.default.createElement("p",null,r.default.createElement("span",null,t("Protocol"),": ",p),"https"===p&&r.default.createElement("span",null,t("Certificate"),": ",o.secretName),r.default.createElement("span",{className:f.default.tip},t("Unable to access"),"  ",r.default.createElement(d.default,{content:t.html("UNABLE_TO_ACCESS_TIP")},r.default.createElement(i.default,{name:"question"})))))),n.http.paths.map((function(e){return r.default.createElement("div",{key:e.path,className:f.default.path},r.default.createElement(s.Columns,null,r.default.createElement(s.Column,null,r.default.createElement("span",null,t("path"),": ",r.default.createElement("strong",null,e.path))),r.default.createElement(s.Column,null,r.default.createElement("span",null,t("Service"),":"," ",r.default.createElement("strong",null,r.default.createElement(u.Link,{to:"".concat(m,"/services/").concat(e.backend.serviceName)},e.backend.serviceName)))),r.default.createElement(s.Column,null,r.default.createElement("span",null,t("Port"),": ",r.default.createElement("strong",null,e.backend.servicePort))),r.default.createElement(s.Column,null,r.default.createElement("a",{href:"".concat(p,"://").concat(h).concat(e.path),target:"_blank"},r.default.createElement(c.default,{className:f.default.access,noShadow:!0},t("Click to visit"))))))})))};m.propTypes={rule:o.default.object};var p=m;a.default=p},3663:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(49),r=a(564),o=n(a(2517)),u=n(a(3664)),i=n(a(3665)),s=n(a(3666)),d="/projects/:namespace/roles/:name",c=[{name:"authorizations",title:"Authorization List",component:i.default},{name:"users",title:"Authorized Users",component:s.default}],f=[{path:d,component:(0,l.withProps)(o.default,{module:"roles",component:u.default,breadcrumbs:[{label:"Project",url:"/projects/:namespace"},{label:"Roles",url:"/projects/:namespace/roles"}]}),routes:(0,r.getChildRoutes)(c,d)}];t.default=f},3664:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o,u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(41)),m=l(n(115)),p=l(n(22)),h=l(n(0)),v=n(19),g=n(60),y=l(n(940)),E=l(n(2557)),b=l(n(2520)),_=l(n(2623)),S=l(n(2624)),k=(0,g.inject)("rootStore")(r=(0,g.observer)((o=function(e){function a(){var e,n;(0,u.default)(this,a);for(var l=arguments.length,r=new Array(l),o=0;o<l;o++)r[o]=arguments[o];return(n=(0,s.default)(this,(e=(0,d.default)(a)).call.apply(e,[this].concat(r)))).fetchData=function(){n.store.fetchDetail(n.props.match.params).catch(n.catch),n.store.fetchRules(n.props.match.params),n.store.fetchUsers(n.props.match.params)},n.getOperations=function(){var e=n.props.match.params.name,a=!globals.config.presetRoles.includes(e);return[{key:"edit",type:"control",text:t("EDIT"),action:"edit",show:a,onClick:n.showModal("editBaseInfo")},{key:"delete",type:"danger",text:t("Delete"),action:"delete",show:a,onClick:n.showModal("deleteModule")}]},n.getAttrs=function(){var e=(0,v.toJS)(n.store.detail);return[{name:t("Project"),value:e.namespace},{name:t("Created Time"),value:n.createTime},{name:t("Updated Time"),value:n.updateTime},{name:t("Creator"),value:n.creator}]},n}return(0,c.default)(a,e),(0,i.default)(a,[{key:"init",value:function(){this.store=new E.default(this.module),this.store.fetchRulesInfo()}},{key:"getDetailFormTemplate",value:function(e){if(!e)return{};var t=this.formTemplate;return(0,m.default)(t,"metadata.name",e.name),(0,m.default)(t,"metadata.annotations['kubesphere.io/description']",(0,p.default)(e,"description")),t}},{key:"renderModals",value:function(){var e=this.store,a=e.detail,n=e.rulesInfo,l=e.isSubmitting,r=this.state,o=r.deleteModule,u=r.editBaseInfo;return h.default.createElement("div",null,h.default.createElement(_.default,{detail:a,module:this.module,visible:o,onOk:this.handleDelete,onCancel:this.hideModal("deleteModule"),isSubmitting:l}),h.default.createElement(S.default,{store:this.store,visible:u,title:t("Edit Member Role"),rulesInfo:(0,v.toJS)(n),formTemplate:this.getDetailFormTemplate(a),onOk:this.handleEdit("editBaseInfo"),onCancel:this.hideModal("editBaseInfo"),isSubmitting:l,edit:!0}))}},{key:"name",get:function(){return"Project Role"}},{key:"authKey",get:function(){return"roles"}},{key:"formTemplate",get:function(){var e=this.props.match.params.namespace;return y.default[this.module]({namespace:e})}},{key:"detailDesc",get:function(){var e=this.store.detail.name,a=(0,p.default)(this.store.detail,"description");return globals.config.presetRoles.includes(e)?t(a):a}}]),a}(b.default),(0,f.default)(o.prototype,"detailDesc",[v.computed],Object.getOwnPropertyDescriptor(o.prototype,"detailDesc"),o.prototype),r=o))||r)||r;a.default=k},3665:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=n(19),m=n(60),p=l(n(2516)),h=l(n(2646)),v=(0,m.observer)(r=function(e){function a(){return(0,o.default)(this,a),(0,i.default)(this,(0,s.default)(a).apply(this,arguments))}return(0,d.default)(a,e),(0,u.default)(a,[{key:"render",value:function(){var e=(0,f.toJS)(this.props.detailStore.rules),a=e.data,n=void 0===a?[]:a,l=e.isLoading;return c.default.createElement(p.default,{title:t("Authorization List"),empty:t("No Authorization"),loading:l,isEmpty:n.length<=0},c.default.createElement(h.default,{rules:n}))}}]),a}(c.default.Component))||r;a.default=v},3666:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=n(19),m=n(60),p=n(49),h=l(n(2456)),v=l(n(2516)),g=l(n(2584)),y=(0,m.observer)(r=function(e){function a(){var e,n;(0,o.default)(this,a);for(var l=arguments.length,r=new Array(l),u=0;u<l;u++)r[u]=arguments[u];return(n=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(r)))).getColumns=function(){return[{title:t("User Name"),dataIndex:"username",width:"33%"},{title:t("Status"),dataIndex:"status",width:"33%",render:function(e){return c.default.createElement(g.default,{status:e})}},{title:t("Last Login Time"),dataIndex:"last_login_time",width:"33%",render:function(e){return c.default.createElement("p",null,e?(0,p.getLocalTime)(e).format("YYYY-MM-DD HH:mm:ss"):t("Not logged in yet"))}}]},n}return(0,d.default)(a,e),(0,u.default)(a,[{key:"render",value:function(){var e=(0,f.toJS)(this.props.detailStore.users),a=e.data,n=e.isLoading;return c.default.createElement(v.default,{title:t("Authorized Users")},c.default.createElement(h.default,{dataSource:a,columns:this.getColumns(),loading:n}))}}]),a}(c.default.Component))||r;a.default=y},3667:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(97)),r=a(49),o=a(564),u=n(a(2517)),i=n(a(2548)),s=n(a(2732)),d=n(a(2733)),c=a(2547),f="/projects/:namespace/volumes/:name",m=[{name:"resource-status",title:"Resource Status",component:d.default},{name:"events",title:"Events",component:i.default}],p=[{label:"Project",url:"/projects/:namespace"},{label:"Volumes",url:"/projects/:namespace/volumes"}],h=[].concat((0,l.default)((0,c.getPodRoutes)(f,[].concat(p,[{label:"Detail",url:f}]))),[{path:f,component:(0,r.withProps)(u.default,{module:"volumes",component:s.default,breadcrumbs:p}),routes:(0,o.getChildRoutes)(m,f)}]);t.default=h},3668:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(49),r=a(564),o=n(a(2517)),u=n(a(3669)),i=n(a(3670)),s=n(a(3675)),d=n(a(3682)),c=n(a(3686)),f=n(a(3688)),m=n(a(3693)),p=n(a(3715)),h=n(a(3751)),v="/projects/:namespace/applications/template/:id",g="/projects/:namespace/applications/composing/:name",y=[{name:"components",title:"Application Components",component:f.default},{name:"traffic",title:"Traffic Management",component:m.default,ksModule:"servicemesh"},{name:"grayrelease",title:"Grayscale Release",component:p.default,ksModule:"servicemesh"},{name:"tracing",title:"Tracing",component:h.default,ksModule:["servicemesh","logging"]}],E=[{name:"resource-status",title:"Resource Status",component:s.default},{name:"template",title:"App Template",component:d.default},{name:"env",title:"Environment Variables",component:c.default}],b=[{path:v,component:(0,l.withProps)(o.default,{module:"applications",component:u.default,breadcrumbs:[{label:"Project",url:"/projects/:namespace"},{label:"Applications",url:"/projects/:namespace/applications/template"}]}),ksModule:"openpitrix",routes:(0,r.getChildRoutes)(E,v)},{path:g,component:(0,l.withProps)(o.default,{module:"applications",component:i.default,breadcrumbs:[{label:"Project",url:"/projects/:namespace"},{label:"Applications",url:"/projects/:namespace/applications/composing"}]}),routes:(0,r.getChildRoutes)(y,g)}];t.default=b},3669:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.Component=a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(22)),c=l(n(0)),f=n(19),m=n(60),p=n(49),h=l(n(388)),v=l(n(944)),g=l(n(2541)),y=l(n(2524)),E=l(n(2520)),b=l(n(2810)),_=l(n(2665)),S=l(n(2847)),k=function(e){function a(){var e,n;(0,r.default)(this,a);for(var l=arguments.length,o=new Array(l),s=0;s<l;s++)o[s]=arguments[s];return(n=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(o)))).getOperations=function(){var e=(0,f.toJS)(n.store.detail),a=[{key:"edit",type:"control",text:t("EDIT"),action:"edit",onClick:n.showModal("editBaseInfo")}];return e&&"deleted"===e.status?a.push({key:"destroy",type:"danger",text:t("Destroy"),action:"delete",onClick:n.showModal("destroyModule")}):a.push({key:"delete",type:"danger",text:t("Delete"),action:"delete",onClick:n.showModal("deleteModule")}),a},n.getAttrs=function(){var e=(0,f.toJS)(n.store.detail);return[{name:t("Project"),value:n.namespace},{name:t("Application"),value:(0,d.default)(e,"app.name","-")},{name:t("Version"),value:(0,d.default)(e,"version.name","-")},{name:t("Created Time"),value:(0,p.getLocalTime)((0,d.default)(e,"create_time")).format("YYYY-MM-DD HH:mm:ss")},{name:t("Updated Time"),value:(0,p.getLocalTime)((0,d.default)(e,"status_time")).format("YYYY-MM-DD HH:mm:ss")},{name:t("Creator"),value:(0,d.default)(e,"owner","-")}]},n.handleEdit=function(e){var a=n.store.detail,l=a.cluster_id,r=a.zone;n.store.patch({cluster_id:l,zone:r},e).then((function(){n.hideModal("editBaseInfo")(),h.default.success({content:"".concat(t("Updated Successfully"),"!")}),n.fetchData()}))},n.handleDestroy=function(){n.store.destroy(n.store.detail.cluster).then((function(){n.hideModal("destroyModule")(),n.deleteCallback()}))},n}return(0,s.default)(a,e),(0,o.default)(a,[{key:"init",value:function(){this.store=new _.default}},{key:"isInvalidRoute",value:function(e){return!e.name}},{key:"renderSider",value:function(){var e=(0,f.toJS)(this.store.detail),t=c.default.createElement("label",{className:S.default.icon},c.default.createElement(v.default,{iconLetter:(0,d.default)(e,"app.name"),src:(0,d.default)(e,"app.icon"),alt:""}));return c.default.createElement(g.default,{icon:t,name:(0,d.default)(e,"name",""),desc:this.detailDesc,operations:this.getEnabledOperations(),labels:this.labels,attrs:this.getAttrs()})}},{key:"renderExtraModals",value:function(){var e=this.store,a=e.detail,n=e.isSubmitting,l=this.state,r=l.editBaseInfo,o=l.destroyModule;return c.default.createElement("div",null,c.default.createElement(b.default,{visible:r,detail:(0,f.toJS)(a),onOk:this.handleEdit,onCancel:this.hideModal("editBaseInfo"),isSubmitting:n}),c.default.createElement(y.default,{title:t("DESTROY_TITLE"),desc:t.html("DESTROY_TIP",{type:t("Application"),resource:a.name}),visible:o,onOk:this.handleDestroy,onCancel:this.hideModal("destroyModule"),isSubmitting:n}))}},{key:"name",get:function(){return"Application"}},{key:"detailDesc",get:function(){return(0,d.default)(this.store.detail,"description")}},{key:"listUrl",get:function(){return"/projects/".concat(this.namespace,"/").concat(this.module)}}]),a}(E.default),C=(0,m.inject)("rootStore")((0,m.observer)(k));a.default=C;var w=k;a.Component=w},3670:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.Component=a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(22)),c=l(n(0)),f=n(19),m=n(60),p=n(49),h=l(n(388)),v=l(n(2541)),g=l(n(2527)),y=l(n(3671)),E=l(n(2520)),b=l(n(2608)),_=l(n(2847)),S=function(e){function a(){var e,n;(0,r.default)(this,a);for(var l=arguments.length,o=new Array(l),s=0;s<l;s++)o[s]=arguments[s];return(n=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(o)))).getOperations=function(){return[{key:"edit",type:"control",text:t("EDIT"),action:"edit",onClick:n.showModal("editBaseInfo")},{key:"addComponent",text:t("Add Component"),action:"edit",onClick:n.showModal("addComponent")},{key:"delete",text:t("Delete"),action:"delete",onClick:n.showModal("deleteModule")}]},n.getAttrs=function(){var e=(0,f.toJS)(n.store.detail),a=(0,d.default)(e,'labels["app.kubernetes.io/name"]');return[{name:t("Project"),value:e.namespace},{name:t("Application"),value:a},{name:t("Version"),value:e.version},{name:t("Created Time"),value:(0,p.getLocalTime)(e.createTime).format("YYYY-MM-DD HH:mm:ss")},{name:t("Updated Time"),value:(0,p.getLocalTime)(e.updateTime).format("YYYY-MM-DD HH:mm:ss")},{name:t("Creator"),value:(0,d.default)(e,"creator","-")}]},n.handleEdit=function(e){n.store.patch(n.params,e).then((function(){n.hideModal("editBaseInfo")(),h.default.success({content:"".concat(t("Updated Successfully"),"!")}),n.fetchData()}))},n.handleAddComponent=function(e){n.store.addComponent(e,n.params).then((function(){n.hideModal("addComponent")(),h.default.success({content:"".concat(t("Add Component Successfully"),"!")}),n.fetchData()}))},n}return(0,s.default)(a,e),(0,o.default)(a,[{key:"init",value:function(){this.store=new b.default(this.module)}},{key:"handleImageOnError",value:function(e){"/assets/default-app.svg"!==e.target.src&&(e.target.src="/assets/default-app.svg")}},{key:"isInvalidRoute",value:function(e){var t=this.store.detail;return"true"!==(0,d.default)(t,'annotations["servicemesh.kubesphere.io/enabled"]')?e.servicemesh:!e.name}},{key:"renderSider",value:function(){var e=(0,f.toJS)(this.store.detail),t=c.default.createElement("img",{className:_.default.icon,src:(0,d.default)(e,"icon","/assets/default-app.svg"),alt:"",onError:this.handleImageOnError});return c.default.createElement(v.default,{icon:t,name:this.detailName,desc:this.detailDesc,operations:this.getEnabledOperations(),labels:this.labels,attrs:this.getAttrs()})}},{key:"renderExtraModals",value:function(){var e=this.store,t=e.detail,a=e.isSubmitting,n=this.state,l=n.editBaseInfo,r=n.addComponent,o=this.props.match.params.namespace;return c.default.createElement("div",null,c.default.createElement(g.default,{visible:l,detail:(0,f.toJS)(t._originData),onOk:this.handleEdit,onCancel:this.hideModal("editBaseInfo"),isSubmitting:a}),c.default.createElement(y.default,{visible:r,namespace:o,detail:(0,f.toJS)(t),onOk:this.handleAddComponent,onCancel:this.hideModal("addComponent"),isSubmitting:a}))}},{key:"name",get:function(){return"Application"}},{key:"detailDesc",get:function(){return(0,d.default)(this.store.detail,"description")}},{key:"listUrl",get:function(){return"/projects/".concat(this.namespace,"/").concat(this.module,"/composing")}}]),a}(E.default),k=(0,m.inject)("rootStore")((0,m.observer)(S));a.default=k;var C=S;a.Component=C},3671:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(82)),o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(22)),f=l(n(115)),m=l(n(58)),p=l(n(132)),h=l(n(0)),v=l(n(1)),g=l(n(2559)),y=l(n(2537)),E=l(n(2543)),b=n(49),_=l(n(387)),S=l(n(388)),k=l(n(954)),C=l(n(3672)),w=l(n(3674)),N=function(e){function a(e){var n;return(0,o.default)(this,a),(n=(0,i.default)(this,(0,s.default)(a).call(this,e))).handleSubFormSave=function(){var e=n.state.subRoute;e&&(0,p.default)(e.onSave)&&e.onSave()},n.handleSubFormCancel=function(){var e=n.state.subRoute;e&&(0,p.default)(e.onCancel)&&e.onCancel()},n.registerSubRoute=function(e,t){n.setState({subRoute:{onSave:e,onCancel:t}})},n.resetSubRoute=function(){n.setState({subRoute:{}})},n.hasSubRoute=function(){return!(0,m.default)(n.state.subRoute)},n.handleSubmit=function(){var e=n.props,a=e.detail,l=e.onOk;if(n.hasSubRoute())return S.default.warning(t("Please save the current form first"));var r=n.formRef.current;r&&r.validate((function(){var e=r.getData();n.updateAppLabels(e,a.labels),n.updateGovernance(e,a.serviceMeshEnable);var t=(0,c.default)(e,"workload.spec.template.spec.containers",[]),o=[];t.forEach((function(e){e.ports&&e.ports.forEach((function(e){e.servicePort&&o.push({name:e.name,protocol:e.protocol,port:e.servicePort,targetPort:e.containerPort})}))})),(0,f.default)(e,"service.spec.ports",o),l(e)}))},n.state={subRoute:{}},n.configMapStore=new g.default,n.secretStore=new y.default,n.projectStore=new E.default,n.formRef=h.default.createRef(),n}return(0,d.default)(a,e),(0,u.default)(a,[{key:"getChildContext",value:function(){return{registerSubRoute:this.registerSubRoute,resetSubRoute:this.resetSubRoute}}},{key:"componentDidMount",value:function(){this.fetchData()}},{key:"fetchData",value:function(){var e=this,t=this.props.namespace;Promise.all([this.configMapStore.fetchByK8s({namespace:t}),this.secretStore.fetchByK8s({namespace:t}),this.secretStore.fetchByK8s({namespace:t,fieldSelector:"type=kubernetes.io/dockerconfigjson"}),this.projectStore.fetchLimitRanges({namespace:t})]).then((function(t){var a=(0,r.default)(t,4),n=a[0],l=a[1],o=a[2],u=a[3];e.setState({configMaps:n,secrets:l,imageRegistries:o,limitRange:(0,c.default)(u,"[0].limit")})}))}},{key:"updateAppLabels",value:function(e,t){(0,b.mergeLabels)(e.workload,t),(0,b.mergeLabels)(e.service,t)}},{key:"updateGovernance",value:function(e,t){(0,f.default)(e.workload,'metadata.annotations["servicemesh.kubesphere.io/enabled"]',String(t)),(0,f.default)(e.service,'metadata.annotations["servicemesh.kubesphere.io/enabled"]',String(t)),(0,f.default)(e.workload,'spec.template.metadata.annotations["sidecar.istio.io/inject"]',String(t))}},{key:"renderFooter",value:function(){var e=this.state.subRoute;return(0,m.default)(e)?null:h.default.createElement("div",{className:w.default.footer},h.default.createElement(k.default,{onOk:this.handleSubFormSave,onCancel:this.handleSubFormCancel}))}},{key:"render",value:function(){var e=this.props,a=e.detail,n=e.namespace,l=e.visible,r=e.isSubmitting,o=e.onCancel,u=this.state,i=u.limitRange,s=u.configMaps,d=u.secrets,f=u.imageRegistries;return h.default.createElement(_.default,{title:t("Add Component"),bodyClassName:w.default.body,width:873,visible:l,onOk:this.handleSubmit,onCancel:o,isSubmitting:r},h.default.createElement(C.default,{formRef:this.formRef,appName:(0,c.default)(a,"labels['app.kubernetes.io/name']"),namespace:n,limitRange:i,configMaps:s,secrets:d,imageRegistries:f,isGovernance:a.serviceMeshEnable}),this.renderFooter())}}]),a}(h.default.Component);a.default=N,N.propTypes={detail:v.default.object,visible:v.default.bool,onOk:v.default.func,onCancel:v.default.func},N.defaultProps={detail:{},visible:!1,onOk:function(){},onCancel:function(){}},N.childContextTypes={registerSubRoute:v.default.func,resetSubRoute:v.default.func}},3672:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(267)),f=l(n(2786)),m=l(n(3673)),p=function(e){function a(){var e,t;(0,r.default)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(t=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(l)))).registerForm=function(){var e=t.context.resetSubRoute;e&&e()},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"renderContent",value:function(){var e=this.props.formRef,t=this.state.formData;return d.default.createElement("div",{className:m.default.wrapper},d.default.createElement(c.default,{ref:e,data:t},this.renderBaseInfo(),this.renderContainerList(),this.renderVolumeSettings()))}},{key:"title",get:function(){return t("Add Component")}}]),a}(f.default);a.default=p},3673:function(e,t,a){e.exports={wrapper:"ComponentForm__wrapper--1bids"}},3674:function(e,t,a){e.exports={body:"AddComponent__body--R5-q2",footer:"AddComponent__footer--1fyFr"}},3675:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r=n(a(37)),o=n(a(13)),u=n(a(14)),i=n(a(17)),s=n(a(16)),d=n(a(18)),c=n(a(58)),f=n(a(572)),m=n(a(0)),p=a(19),h=a(60),v=n(a(2844)),g=n(a(3676)),y=n(a(2848)),E=n(a(3681)),b=(0,h.observer)(l=function(e){function t(e){var a;return(0,o.default)(this,t),(a=(0,i.default)(this,(0,s.default)(t).call(this,e))).store=e.detailStore,a.module=e.module,a}return(0,d.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e=(0,p.toJS)(this.store),t=e.detail,a=e.isLoading,n=[];return(0,c.default)(t.workloads)||(n=(0,f.default)(Object.keys(t.workloads).map((function(e){return t.workloads[e].map((function(t){return(0,r.default)({},t,{type:e})}))})))),m.default.createElement("div",{className:E.default.main},!(0,c.default)(t.ingresses)&&m.default.createElement(y.default,{data:t.ingresses,loading:a,prefix:"".concat(this.prefix,"/routes")}),!(0,c.default)(t.services)&&m.default.createElement(g.default,{className:"margin-t12",data:t.services,loading:a,prefix:"".concat(this.prefix,"/services")}),m.default.createElement(v.default,{className:"margin-t12",data:n,loading:a,prefix:this.prefix}))}},{key:"prefix",get:function(){var e=this.props.match.params.namespace;return"/projects/".concat(e)}}]),t}(m.default.Component))||l;t.default=b},3676:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(1)),f=l(n(58)),m=l(n(2516)),p=l(n(3677)),h=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"renderContent",value:function(){var e=this.props,t=e.data,a=e.prefix;return(0,f.default)(t)?null:t.map((function(e){return d.default.createElement(p.default,{key:"".concat(e.type,"-").concat(e.name),prefix:a,detail:e})}))}},{key:"render",value:function(){var e=this.props,a=e.className,n=e.loading;return d.default.createElement(m.default,{className:a,title:t("Services"),loading:n,empty:t("NOT_AVAILABLE",{resource:t("Service")})},this.renderContent())}}]),a}(d.default.Component);a.default=h,h.propTypes={className:c.default.string,prefix:c.default.string,data:c.default.array,isLoading:c.default.bool},h.defaultProps={prefix:"",data:[],isLoading:!1}},3677:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(50)),c=l(n(0)),f=l(n(1)),m=n(226),p=l(n(3)),h=l(n(38)),v=l(n(3678)),g=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props,a=e.className,n=e.detail,l=e.prefix;if(!n)return null;var r=n.ports;(0,d.default)(r)&&(r=r.map((function(e){return"".concat(e.port,":").concat(e.targetPort,"/").concat(e.protocol)})).join(";"));var o=n.type,u=n.clusterIP,i=n.loadBalancerIngress,s=n.externalName,f="Virtual IP"===o?u:i||s;return c.default.createElement("div",{className:(0,p.default)(v.default.item,a)},c.default.createElement("div",{className:v.default.icon},c.default.createElement(h.default,{name:"network-router",size:40})),c.default.createElement("div",{className:v.default.name},c.default.createElement(m.Link,{to:"".concat(l,"/").concat(n.name)},n.name),c.default.createElement("p",null,t(o),": ",f||"-")),c.default.createElement("div",{className:v.default.status},c.default.createElement("p",null,c.default.createElement("span",null,t("Port")),": ",r),c.default.createElement("p",null,c.default.createElement("span",null,t("IP")),": ",n.virtualIp||"-")))}}]),a}(c.default.Component);a.default=g,g.propTypes={className:f.default.string,prefix:f.default.string,detail:f.default.object},g.defaultProps={prefix:"",detail:{}}},3678:function(e,t,a){e.exports={item:"Services__item--3B11h",icon:"Services__icon--1KdqM",name:"Services__name--3yNrX",status:"Services__status--3-_9T"}},3679:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(58)),o=l(n(0)),u=l(n(1)),i=n(226),s=l(n(38)),d=l(n(224)),c=l(n(3680)),f=function(e){var a=e.detail,n=e.gateway,l=e.prefix,u={};if(n&&n.ports&&"NodePort"===n.type&&n.ports.forEach((function(e){"http"===e.name&&80!==e.nodePort&&(u.http=e.nodePort),"https"===e.name&&443!==e.nodePort&&(u.https=e.nodePort)})),(0,r.default)(a.rules))return null;var f=a.tls[0]||{};return o.default.createElement("div",{className:c.default.card},o.default.createElement("div",{className:c.default.content},o.default.createElement(s.default,{name:"loadbalancer",size:40}),o.default.createElement("div",{className:c.default.text},o.default.createElement(i.Link,{to:"".concat(l,"/").concat(a.name)},a.name),o.default.createElement("p",null,"hostname: ",a.rules.map((function(e){return e.host})).join(", ")))),o.default.createElement("ul",{className:c.default.rules},a.rules.map((function(e){var a=f.hosts&&f.hosts.includes(e.host)?"https":"http",n="".concat(a,"://").concat(e.host);return u[a]&&(n="".concat(n,":").concat(u[a])),e.http.paths.map((function(a){return o.default.createElement("li",{key:"".concat(e.host).concat(a.path)},o.default.createElement("span",null,t("Url"),":    "),o.default.createElement("span",null,o.default.createElement("strong",null,n,a.path)),o.default.createElement("a",{href:"".concat(n).concat(a.path),target:"_blank"},o.default.createElement(d.default,{className:c.default.access,noShadow:!0},t("Click to visit"))))}))}))))};f.propTypes={rule:u.default.object};var m=f;a.default=m},3680:function(e,t,a){e.exports={card:"Routes__card--3aX_B",content:"Routes__content--yFmHZ",text:"Routes__text--7kTf1",rules:"Routes__rules--26M4u",access:"Routes__access--23PcB"}},3681:function(e,t,a){e.exports={ports:"ResourceStatus__ports--QWH4r",card:"ResourceStatus__card--3z-5r",content:"ResourceStatus__content--2vo2o",title:"ResourceStatus__title--PPXjz",path:"ResourceStatus__path--3Ooxd",access:"ResourceStatus__access--2l5Lj"}},3682:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(22)),f=l(n(58)),m=l(n(0)),p=n(19),h=n(60),v=l(n(2555)),g=l(n(2558)),y=l(n(2464)),E=l(n(2516)),b=l(n(2607)),_=l(n(2668)),S=l(n(3683)),k=l(n(3685)),C=y.default.TabPanel,w=(0,h.inject)("rootStore")(r=(0,h.observer)(r=function(e){function a(e){var t;return(0,o.default)(this,a),(t=(0,i.default)(this,(0,s.default)(a).call(this,e))).handleTabChange=function(e){t.setState({tab:e})},t.handleUpgrade=function(e){var a=(0,p.toJS)(t.store).detail.cluster_id;t.store.upgrade({cluster_id:a,version_id:e})},t.handleRollback=function(e){var a=(0,p.toJS)(t.store).detail.cluster_id;t.store.upgrade({cluster_id:a,version_id:e})},t.state={tab:"readme"},t.store=e.detailStore,t.module=e.module,t.appVersionStore=new v.default,t.appFileStore=new g.default,(0,p.when)((function(){return!(0,f.default)(t.store.detail)}),(function(){return t.getData()})),t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"getData",value:function(){var e=(0,p.toJS)(this.store).detail,t=e.app_id,a=e.version_id;this.appVersionStore.fetchList({app_id:t,status:"active"}),this.appFileStore.fetch({app_id:t,version_id:a})}},{key:"renderReadme",value:function(){var e=this.appFileStore.files;return e["README.md"]||this.appFileStore.isLoading?m.default.createElement(b.default,{source:e["README.md"],className:k.default.markdown}):m.default.createElement("p",null,t("The app has no documentation"))}},{key:"renderSettings",value:function(){var e=this.appFileStore.files;return m.default.createElement(_.default,{files:e})}},{key:"renderVersionInfo",value:function(){var e=(0,p.toJS)(this.store).detail,t=this.props.match.params.namespace,a=(0,p.toJS)(this.appVersionStore.list),n=a.data,l=a.isLoading;return m.default.createElement(S.default,{data:n,loading:l,detail:e,workspace:this.workspace,namespace:t,onUpgrade:this.handleUpgrade,onRollback:this.handleRollback})}},{key:"render",value:function(){var e=this.state.tab;return m.default.createElement(E.default,{title:t("App Description"),className:k.default.wrapper},m.default.createElement(y.default,{className:"tabs-default",activeName:e,onChange:this.handleTabChange},m.default.createElement(C,{label:t("App Description"),name:"readme"},this.renderReadme()),m.default.createElement(C,{label:t("Configuration Files"),name:"settings"},this.renderSettings()),m.default.createElement(C,{label:t("Version Info"),name:"version"},this.renderVersionInfo())))}},{key:"workspace",get:function(){return(0,c.default)(this,"props.rootStore.project.data.workspace")}}]),a}(m.default.Component))||r)||r;a.default=w},3683:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=n(226),f=l(n(224)),m=l(n(3684)),p=function(e){var a=e.data,n=e.currentVersion,l=e.urlPrefix,r="".concat(l,"&version=").concat(a.version_id);return d.default.createElement("div",{className:m.default.item},d.default.createElement(c.Link,{to:r},a.name),n.version_id===a.version_id&&d.default.createElement("div",{className:m.default.tag},t("Current Version")),n.version_id!==a.version_id&&d.default.createElement("div",{className:m.default.operations},d.default.createElement(c.Link,{to:r},d.default.createElement(f.default,{noShadow:!0},t("Deploy New Application")))))},h=function(e){function t(){return(0,r.default)(this,t),(0,u.default)(this,(0,i.default)(t).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){var e=this.props,t=e.data,a=e.detail,n=e.workspace,l=e.namespace,r=e.onUpgrade,o=e.onRollback,u=t.find((function(e){return e.version_id===a.version_id}))||{},i="/apps/".concat(a.app_id,"?workspace=").concat(n,"&namespace=").concat(l);return d.default.createElement("ul",null,t.map((function(e){return d.default.createElement(p,{key:e.version_id,data:e,currentVersion:u,onUpgrade:r,onRollback:o,urlPrefix:i})})))}}]),t}(d.default.Component);a.default=h},3684:function(e,t,a){e.exports={item:"VersionInfo__item--o8GMf",operations:"VersionInfo__operations--wLWWq",tag:"VersionInfo__tag--37cjj"}},3685:function(e,t,a){e.exports={wrapper:"AppTemplate__wrapper--3OZ2o"}},3686:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.Component=a.default=void 0;var r=l(n(82)),o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(58)),f=l(n(0)),m=n(19),p=n(60),h=l(n(2516)),v=n(49),g=l(n(3687)),y=function(e){function a(){return(0,o.default)(this,a),(0,i.default)(this,(0,s.default)(a).apply(this,arguments))}return(0,d.default)(a,e),(0,u.default)(a,[{key:"render",value:function(){var e=(0,m.toJS)(this.store.env),a=e.data,n=e.isLoading;if((0,c.default)(a))return null;var l=Object.entries((0,v.flattenObject)(a)).filter((function(e){var t=(0,r.default)(e,1)[0];return"Description"!==t&&"Name"!==t}));return f.default.createElement(h.default,{title:t("Environment Variables"),loading:n},f.default.createElement("ul",{className:g.default.values},l.map((function(e){var t=(0,r.default)(e,2),a=t[0],n=t[1];return f.default.createElement("li",{key:a},f.default.createElement("span",{className:g.default.title},a),f.default.createElement("span",null,(0,c.default)(n)?JSON.stringify(n):String(n)))}))))}},{key:"store",get:function(){return this.props.detailStore}}]),a}(f.default.Component),E=(0,p.inject)("rootStore")((0,p.observer)(y));a.default=E;var b=y;a.Component=b},3687:function(e,t,a){e.exports={values:"EnvVariables__values--2cgW2",title:"EnvVariables__title--2s2Tx"}},3688:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r=n(a(13)),o=n(a(14)),u=n(a(17)),i=n(a(16)),s=n(a(18)),d=n(a(58)),c=n(a(0)),f=a(19),m=a(60),p=a(49),h=n(a(2556)),v=n(a(3689)),g=n(a(2848)),y=n(a(3692)),E=(0,m.observer)(l=function(e){function t(e){var a;return(0,r.default)(this,t),(a=(0,u.default)(this,(0,i.default)(t).call(this,e))).store=e.detailStore,a.routerStore=new h.default,a.module=e.module,a.getData(),a}return(0,s.default)(t,e),(0,o.default)(t,[{key:"getData",value:function(){var e=(0,f.toJS)(this.store.detail).selector,t=this.props.match.params.namespace;if(e){var a={namespace:t,labelSelector:(0,p.joinSelector)(e)};this.store.fetchComponents(a),this.store.routerStore.fetchListByK8s(a)}this.routerStore.getGateway({namespace:t})}},{key:"render",value:function(){var e=(0,f.toJS)(this.store.routerStore.list.data),t=(0,f.toJS)(this.store.components.data),a=(0,f.toJS)(this.routerStore.gateway.data);return c.default.createElement("div",{className:y.default.main},!(0,d.default)(e)&&c.default.createElement(g.default,{data:e,gateway:a,loading:this.store.routerStore.list.isLoading,prefix:"".concat(this.prefix,"/routes")}),c.default.createElement(v.default,{className:"margin-t12",data:t,loading:this.store.components.isLoading,prefix:"".concat(this.prefix,"/services")}))}},{key:"prefix",get:function(){var e=this.props.match.params.namespace;return"/projects/".concat(e)}}]),t}(c.default.Component))||l;t.default=E},3689:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(1)),f=l(n(58)),m=l(n(2516)),p=l(n(3690)),h=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"renderContent",value:function(){var e=this.props,t=e.data,a=e.prefix;return(0,f.default)(t)?null:t.map((function(e){return d.default.createElement(p.default,{key:e.uid,prefix:a,detail:e})}))}},{key:"render",value:function(){var e=this.props,a=e.className,n=e.loading;return d.default.createElement(m.default,{className:a,title:t("Services"),loading:n,empty:t("NOT_AVAILABLE",{resource:t("Service")})},this.renderContent())}}]),a}(d.default.Component);a.default=h,h.propTypes={className:c.default.string,prefix:c.default.string,data:c.default.array,isLoading:c.default.bool},h.defaultProps={prefix:"",data:[],isLoading:!1}},3690:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(22)),c=l(n(0)),f=l(n(1)),m=n(226),p=l(n(3)),h=l(n(38)),v=l(n(3691)),g=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props,a=e.className,n=e.detail,l=e.prefix;return n?c.default.createElement("div",{className:(0,p.default)(v.default.item,a)},c.default.createElement("div",{className:v.default.icon},c.default.createElement(h.default,{name:"network-router",size:40})),c.default.createElement("div",{className:v.default.name},c.default.createElement(m.Link,{to:"".concat(l,"/").concat(n.name)},n.name),c.default.createElement("p",null,t(n.type))),c.default.createElement("div",{className:v.default.status},c.default.createElement("p",null,c.default.createElement("span",null,t("Grayscale Release Version")),":"," ",(0,d.default)(n,"grayRelease.oldVersion","-")," ",(0,d.default)(n,"grayRelease.newVersion","-")),c.default.createElement("p",null,c.default.createElement("span",null,t("Pod Count")),": ",n.podNums)),c.default.createElement("div",{className:v.default.status},c.default.createElement("p",null,c.default.createElement("span",null,t("Access Method")),": ",t("Internal access")),c.default.createElement("p",null,c.default.createElement("span",null,t("IP"),": "),c.default.createElement("span",null,n.ports.map((function(e,t){var a="";return e.name&&-1!==e.name.indexOf("-")&&(a=(e.name.split("-")[0]||"").toUpperCase()),c.default.createElement("span",{key:t},"HTTP"===a?"http://".concat(n.clusterIP,":").concat(e.targetPort):"".concat(n.clusterIP,":").concat(e.targetPort,"/").concat(a))})))))):null}}]),a}(c.default.Component);a.default=g,g.propTypes={className:f.default.string,prefix:f.default.string,detail:f.default.object},g.defaultProps={prefix:"",detail:{}}},3691:function(e,t,a){e.exports={item:"AppComponents__item--2StJg",name:"AppComponents__name--JvZqf",status:"AppComponents__status--1E5d_"}},3692:function(e,t,a){e.exports={ports:"AppComponents__ports--xyar4",card:"AppComponents__card--1Z5O3",content:"AppComponents__content--1ZzP0",title:"AppComponents__title--1XZz4",path:"AppComponents__path--213Jn",access:"AppComponents__access--27SBW"}},3693:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(58)),f=l(n(0)),m=n(19),p=n(60),h=l(n(129)),v=l(n(224)),g=l(n(2552)),y=l(n(3694)),E=l(n(3714)),b=(0,p.observer)(r=function(e){function a(e){var t;return(0,o.default)(this,a),(t=(0,i.default)(this,(0,s.default)(a).call(this,e))).handleRefresh=function(){t.getData()},t.state={isGraphLoading:!0},t.store=e.detailStore,t.module=e.module,t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval((function(){e.getData()}),1e4),this.getData()}},{key:"componentWillUnmount",value:function(){this.unmount=!0,this.interval&&clearInterval(this.interval)}},{key:"getData",value:function(){var e=this,t=(0,m.toJS)(this.store.detail).selector,a=this.props.match.params.namespace;t&&(this.setState({isGraphLoading:!0}),this.store.fetchGraph({namespace:a,selector:t}).then((function(){e.unmount||e.setState({isGraphLoading:!1})})))}},{key:"render",value:function(){var e=this.state.isGraphLoading,a=this.store.graph,n=a.data,l=a.health;return(0,c.default)(n)||(0,c.default)(n.nodes)?e?f.default.createElement(h.default,{className:E.default.loading}):f.default.createElement(g.default,{image:"/assets/traffic-management.svg",title:t("Temporarily unable to use traffic management"),desc:t("The app has not received the request for a long time, please visit the app and try traffic management"),actions:f.default.createElement(v.default,{onClick:this.handleRefresh},t("Refresh"))}):f.default.createElement("div",{className:E.default.main},f.default.createElement(y.default,{data:n,health:l,store:this.store,loading:e,onFetch:this.handleRefresh}))}}]),a}(f.default.Component))||r;a.default=b},3694:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(30)),r=n(a(97)),o=n(a(13)),u=n(a(17)),i=n(a(16)),s=n(a(14)),d=n(a(18)),c=n(a(0)),f=n(a(1)),m=n(a(3)),p=n(a(129)),h=a(570),v=n(a(2682)),g=a(3696),y=n(a(3697)),E=n(a(3699)),b=n(a(3703)),_=n(a(3713)),S=function(e){function t(e){var a;return(0,o.default)(this,t),(a=(0,u.default)(this,(0,i.default)(t).call(this,e))).handleWrapperClick=function(e){if(e&&null===(0,h.findParent)(e.target,"ks-app-component")&&"app"===a.state.selectedType){var t=a.draggerRef.current.content.querySelector("[data-component='".concat(a.state.selectedData.name,"']"));t&&!t.contains(e.target)&&a.setState({selectedData:{},selectedType:"",selectedEdges:[]})}},a.toggleFullScreen=function(){a.setState((function(e){return{fullScreen:!e.fullScreen}}))},a.handleRefresh=function(){a.props.onFetch()},a.handleSelect=function(e,t){a.setState({selectedData:e,selectedType:t,selectedEdges:[].concat((0,r.default)(e.edges.in.map((function(e){return e.data.id}))),(0,r.default)(e.edges.out.map((function(e){return e.data.id}))))})},a.state={graph:(0,g.processData)(e.data,e.health),selectedData:{},selectedEdges:[],selectedType:"",fullScreen:!1},a.draggerRef=c.default.createRef(),a}return(0,d.default)(t,e),(0,s.default)(t,[{key:"getChildContext",value:function(){return{selectedData:this.state.selectedData,selectedType:this.state.selectedType,onSelectApp:this.handleSelect}}}]),(0,s.default)(t,[{key:"componentWillReceiveProps",value:function(e){var t=this,a=(0,g.processData)(e.data,e.health);if(this.setState({graph:a}),this.state.selectedData&&this.state.selectedData.name){var n=a.nodes.find((function(e){return e.name===t.state.selectedData.name}));this.setState({selectedData:n})}}},{key:"render",value:function(){var e=this.props,t=e.store,a=e.loading,n=this.state,r=n.graph,o=n.selectedType,u=n.selectedData,i=n.selectedEdges,s=n.fullScreen;return c.default.createElement("div",{className:(0,m.default)(_.default.graph,(0,l.default)({},_.default.fullScreen,s))},c.default.createElement("div",{className:_.default.loading},c.default.createElement(p.default,{spinning:a})),c.default.createElement(v.default,{className:_.default.dragger,contentClassName:_.default.mainContent,ref:this.draggerRef,onClick:this.handleWrapperClick,initialScale:.6,onFullScreen:this.toggleFullScreen,controlStyle:{right:o?350:20},onRefresh:this.handleRefresh},c.default.createElement("div",{className:_.default.graphContent},r.nodes.map((function(e){return c.default.createElement(E.default,{key:e.name,data:e})})),c.default.createElement("svg",{className:_.default.edgeWrapper},r.edges.map((function(e){return c.default.createElement(y.default,{key:e.data.id,data:e,selected:i.includes(e.data.id)})}))))),o&&c.default.createElement(b.default,{className:_.default.detail,type:o,data:u,store:t,fullScreen:s}))}}]),t}(c.default.Component);t.default=S,S.propTypes={data:f.default.shape({nodes:f.default.arrayOf(f.default.object),edges:f.default.arrayOf(f.default.object)}),health:f.default.object},S.defaultProps={data:{nodes:[],edges:[]},health:{}},S.childContextTypes={wrapperRef:f.default.object,selectedData:f.default.object,selectedType:f.default.string,onSelectApp:f.default.func}},3696:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.processEdges=t.processData=void 0;var l=n(a(37)),r=n(a(22)),o=n(a(115)),u=n(a(58)),i=n(a(2462)),s=n(a(950)),d=n(a(2501)),c={rankdir:"LR",nodesep:"60",ranksep:"240"};t.processData=function(e,t){return e&&e.edges&&(e.edges=f(e.edges)),function(e){var t=new d.default.graphlib.Graph({multigraph:!0,compound:!0});t.setGraph(c),t.setDefaultEdgeLabel((function(){return{}})),t.setDefaultNodeLabel((function(){return{}}));var a=(0,s.default)(e,"name"),n={};e.forEach((function(a){var l=a.nodes.filter((function(e){return e.data.workload})),r=203*l.length+12*(l.length-1)+56,o=-1!==a.name.indexOf("kubesphere")||"unknown"===a.name;o&&(r=52),l.length>0&&t.setNode(a.name,{name:a.name,width:226,height:r,workloadNum:l.length,isGateway:o}),a.workloads=l,a.edges.out.forEach((function(l){var r=e.find((function(e){return e.ids.includes(l.data.target)}));r&&r.name&&(t.setEdge(a.name,r.name,{id:l.data.id,out:a.edges.out,name:a.name}),n[l.data.id]=l)}))})),d.default.layout(t);var r=[],o=[];return t.nodes().forEach((function(e){var n=t.node(e);n.workloadNum>1&&(n.y-=110*(n.workloadNum-1)),r.push((0,l.default)({},a[e],{position:n}))})),t.edges().forEach((function(e){var r=t.edge(e),u=t.node(r.name),i=n[r.id],s=r.out.filter((function(e){return e.data.target===i.data.target})),d=r.points.length;if(d>0)if(3===d&&(r.points=[r.points[0],r.points[d-1]],d=r.points.length),u.isGateway)r.points[0].x=u.x+u.width-137,r.points[0].y=u.y+u.height/2-130,o.push((0,l.default)({},i,{position:r}));else{var c=a[r.name].workloads.map((function(e){return e.data.id}));s.forEach((function(e){var t=c.indexOf(e.data.source),a={points:[{x:r.points[0].x-12,y:u.y+220*t},{x:r.points[d-1].x,y:r.points[d-1].y+30*t}]};o.push((0,l.default)({},e,{position:a}))}))}})),{nodes:r,edges:o}}(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.nodes,a=void 0===t?[]:t,n=e.edges,l=void 0===n?[]:n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,u.default)(a))return[];for(var o=[],s={},d=0;d<a.length;d++)a[d].data.isRoot&&o.push(a[d]),s[a[d].data.id]=a[d];var c=[],f=(0,i.default)(a,"data.app");return Object.keys(f).forEach((function(e){for(var t=f[e],a=t.map((function(e){return e.data.id})),n=[],o=[],u=[],i=0;i<l.length;i++){var s=l[i],d=s.data.source,m=s.data.target;a.includes(d)&&a.includes(m)?u.push(s):!a.includes(d)&&a.includes(m)?n.push(s):a.includes(d)&&!a.includes(m)&&o.push(s)}c.push({name:e,ids:a,nodes:t,health:r[e]||{},edges:{in:n,out:o,inner:u}})})),c}(e,t))};var f=function(e){if((0,u.default)(e))return[];var t={};return e.forEach((function(e){if(t[e.data.id]){var a=(0,r.default)(t[e.data.id],"data.traffic",{}),n=(0,r.default)(e,"data.traffic",{});if("tcp"===a.protocol||"tcp"===n.protocol){var l=Number((0,r.default)(a,"rates.tcp",0)),u=Number((0,r.default)(n,"rates.tcp",0));(0,o.default)(a,"rates.tcp",(l+u).toFixed(2))}}else t[e.data.id]=e})),Object.values(t)};t.processEdges=f},3697:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(30)),r=n(a(82)),o=n(a(13)),u=n(a(14)),i=n(a(17)),s=n(a(16)),d=n(a(18)),c=n(a(0)),f=n(a(3)),m=n(a(22)),p=n(a(130)),h=n(a(3698)),v=function(e){function t(e){var a;return(0,o.default)(this,t),(a=(0,i.default)(this,(0,s.default)(t).call(this,e))).handleMouseover=function(){var e=a.props.data;document.getElementById(e.data.id).classList.add(h.default.selected)},a.handleMouseout=function(){var e=a.props.data;document.getElementById(e.data.id).classList.remove(h.default.selected)},a.getStatus=function(){var e=a.props.data,t=(0,m.default)(e,"data.traffic");if(!t||!t.rates)return"nodata";if(t.rates.tcp>0)return"tcpActive";var n=0,l=0;return t.rates.http>0?(n=Number(t.rates.http),l=t.rates.httpPercentErr>0?Number(t.rates.httpPercentErr):0):t.rates.grpc>0&&(n=Number(t.rates.grpc),l=t.rates.grpcPercentErr>0?Number(t.rates.grpcPercentErr):0),0===n?"nodata":l>20?"error":l>.1?"degrade":"active"},a.getPath=function(){var e,t=a.props.data;if(t.position.points.length<=2){var n=(0,r.default)(t.position.points,2),l=n[0],o=n[1],u=(l.x+o.x)/2,i=(o.y-l.y)/4;e="M".concat(l.x,",").concat(l.y," C").concat(u,",").concat(l.y+i," ").concat(u,",").concat(o.y-i," ").concat(o.x,",").concat(o.y)}else e=t.position.points.reduce((function(e,t){return""===e?"M".concat(t.x,",").concat(t.y):-1!==e.indexOf("C")?"".concat(e,", ").concat(t.x," ").concat(t.y):"".concat(e," C").concat(t.x," ").concat(t.y)}),"");return e},a.hoverRef=c.default.createRef(),a}return(0,d.default)(t,e),(0,u.default)(t,[{key:"componentDidMount",value:function(){this.hoverRef.current&&(this.hoverRef.current.addEventListener("mouseover",this.handleMouseover),this.hoverRef.current.addEventListener("mouseout",this.handleMouseout))}},{key:"componentWillUnmount",value:function(){this.hoverRef.current&&(this.hoverRef.current.removeEventListener("mouseover",this.handleMouseover),this.hoverRef.current.removeEventListener("mouseout",this.handleMouseout))}},{key:"render",value:function(){var e=this.props,t=e.data,a=e.selected,n=this.getPath(),r=this.getStatus(),o=(0,f.default)(h.default.path,h.default[r],(0,l.default)({},h.default.selected,a)),u=(0,f.default)(h.default.marker,h.default[r]);return c.default.createElement("g",null,c.default.createElement("defs",null,c.default.createElement("marker",{id:"triangle-".concat(r),viewBox:"0 0 10 10",refX:"5",refY:"5",markerWidth:"6",markerHeight:"6",orient:"auto-start-reverse"},c.default.createElement("path",{d:"M 0 0 L 10 5 L 0 10 z",className:u})),c.default.createElement("marker",{id:"dot-".concat(r),viewBox:"0 0 10 10",refX:"5",refY:"5",markerWidth:"5",markerHeight:"5"},c.default.createElement("circle",{cx:"5",cy:"5",r:"5",className:u}))),c.default.createElement("path",{className:o,id:t.data.id,d:n,markerStart:"url(#dot-".concat(r,")"),markerEnd:"url(#triangle-".concat(r,")")}),c.default.createElement("path",{ref:this.hoverRef,d:n,fill:"none",stroke:"transparent",strokeWidth:"30"}),["active","tcpActive"].includes(r)&&c.default.createElement("circle",{r:"6",className:u},c.default.createElement("animateMotion",{dur:"6s",repeatCount:"indefinite"},c.default.createElement("mpath",{xlinkHref:"#".concat(t.data.id)}))),c.default.createElement("text",{width:"500",className:u,transform:"translate(0 -20)"},c.default.createElement("textPath",{xlinkHref:"#".concat(t.data.id),startOffset:"50%",textAnchor:"middle"},this.traffic)))}},{key:"traffic",get:function(){var e=this.props.data,t=(0,m.default)(e,"data.traffic"),a=(0,m.default)(t,"rates.tcp");if(!(0,p.default)(a))return"".concat(a," B/s");var n=(0,m.default)(t,"rates.http",0);return"".concat(n," RPS")}}]),t}(c.default.Component);t.default=v},3698:function(e,t,a){e.exports={path:"Edge__path--f-qkO",error:"Edge__error--C5K1T",active:"Edge__active--q8TR7",tcpActive:"Edge__tcpActive--3s88I",selected:"Edge__selected--3Y5xa",marker:"Edge__marker--3q-X0"}},3699:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(30)),o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=l(n(1)),m=l(n(22)),p=l(n(950)),h=l(n(2462)),v=l(n(3)),g=l(n(3700)),y=l(n(3702)),E=function(e){function a(){var e,t;(0,o.default)(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(t=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(l)))).handleClick=function(){var e=t.props.data;(0,t.context.onSelectApp)(e,"app")},t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"render",value:function(){var e,a=this.props,n=a.data,l=a.store,o=this.context,u=o.selectedData,i=o.selectedType;if(!n.nodes)return null;var s=(0,h.default)(n.nodes,(function(e){return"app"===e.data.isGroup?"group":"unknown"===e.data.nodeType?"app":e.data.nodeType})),d=(0,m.default)(s,"group.length")>0,f=(0,m.default)(n,"health.workloadStatuses",[]).reduce((function(e,t){return e+t.replicas}),0),E=(0,m.default)(n,"health.workloads",{}),b=(0,p.default)((0,m.default)(n,"edges.inner",[]),"data.target");return c.default.createElement("div",{className:"ks-app-component",onClick:d?this.handleClick:null,"data-component":n.name,style:{position:"absolute",top:n.position.y,left:n.position.x,zIndex:2}},d&&c.default.createElement("p",{className:y.default.title},n.name),c.default.createElement("div",{className:(0,v.default)((e={},(0,r.default)(e,y.default.group,d),(0,r.default)(e,y.default.selected,"app"===i&&u.name===n.name),(0,r.default)(e,y.default.error,(0,m.default)(n,"health.requests.errorRatio")>0||(0,m.default)(n,"health.service.requests.errorRatio")>0),e))},d&&c.default.createElement("p",{className:y.default.pods},c.default.createElement("img",{src:"/assets/health.svg",alt:""}),t("Pods"),": ",f),s.service&&s.service.map((function(e){return c.default.createElement("div",{key:e.data.id,"data-service":e.data.service,"data-service-id":e.data.id})})),s.app&&s.app.map((function(e){return c.default.createElement(g.default,{className:y.default.app,key:e.data.id,data:e.data,edge:b[e.data.id],health:E[e.data.workload],inGroup:d,store:l})}))))}}]),a}(c.default.Component);a.default=E,E.propTypes={data:f.default.object},E.contextTypes={selectedData:f.default.object,selectedType:f.default.string,onSelectApp:f.default.func}},3700:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(30)),o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(22)),f=l(n(0)),m=l(n(1)),p=l(n(3)),h=l(n(38)),v=l(n(3701)),g=function(e){function a(){return(0,o.default)(this,a),(0,i.default)(this,(0,s.default)(a).apply(this,arguments))}return(0,d.default)(a,e),(0,u.default)(a,[{key:"renderHTTPMetrics",value:function(){var e=this.props,a=e.health,n=e.edge,l=(0,c.default)(a,"requests.errorRatio"),r=(0,c.default)(n,"data.traffic.rates.http",0),o=-1===l?NaN:(100-l).toFixed(2),u=(0,c.default)(n,"data.responseTime",NaN);return f.default.createElement("div",{className:v.default.detail},f.default.createElement("p",null,f.default.createElement(h.default,{name:"changing-over",size:16})," ","".concat(r," RPS")),f.default.createElement("p",null,f.default.createElement(h.default,{name:"check",size:16})," ",isNaN(o)?t("No Data"):"".concat(o,"%")),f.default.createElement("p",null,f.default.createElement(h.default,{name:"timed-task",size:16})," ",isNaN(u)||"0"===u?t("No Data"):"".concat(u," ms")),f.default.createElement("p",null,f.default.createElement(h.default,{name:"pod",size:16})," ",(0,c.default)(a,"workloadStatus.available")," /"," ",(0,c.default)(a,"workloadStatus.replicas")))}},{key:"renderTCPMetrics",value:function(){var e=this.props,a=e.data,n=e.health,l=(0,c.default)(a,"traffic[0].rates.tcpIn"),r=(0,c.default)(a,"traffic[0].rates.tcpOut");return f.default.createElement("div",{className:v.default.detail},f.default.createElement("p",null,f.default.createElement(h.default,{name:"next",size:16})," ",isNaN(l)?t("No Data"):"".concat(l," B/s")),f.default.createElement("p",null,f.default.createElement(h.default,{name:"previous",size:16})," ",isNaN(r)?t("No Data"):"".concat(r," B/s")),f.default.createElement("p",null,f.default.createElement(h.default,{name:"pod",size:16})," ",(0,c.default)(n,"workloadStatus.available")," /"," ",(0,c.default)(n,"workloadStatus.replicas")))}},{key:"renderDetail",value:function(){var e=this.props.edge;return"http"===((0,c.default)(e,"data.traffic.protocol")||"http")?this.renderHTTPMetrics():this.renderTCPMetrics()}},{key:"render",value:function(){var e=this.props,a=e.data,n=e.health,l=e.className,o=e.inGroup;if(-1!==a.app.indexOf("kubesphere")||"unknown"===a.app)return f.default.createElement("div",{className:(0,p.default)(v.default.card,l),"data-workload":a.workload,"data-workload-id":a.id,"data-group":o},f.default.createElement("div",{className:v.default.type},t("Traffic Entry")),f.default.createElement("div",{className:v.default.wrapper},f.default.createElement("div",{className:v.default.gatewayName},f.default.createElement(h.default,{name:"project",size:16}),a.targetNamespace)));var u=(0,c.default)(n,"requests.errorRatio");return f.default.createElement("div",{className:(0,p.default)(v.default.card,l,(0,r.default)({},v.default.error,u>0)),"data-workload":a.workload,"data-workload-id":a.id,"data-group":o},f.default.createElement("div",{className:v.default.type},a.hasCB&&f.default.createElement(h.default,{name:"thunder",type:"light"}),t("Deployment")),f.default.createElement("div",{className:v.default.wrapper},this.renderDetail(),f.default.createElement("div",{className:v.default.componentName},a.app),a.version&&f.default.createElement("div",{className:v.default.version},f.default.createElement("span",null,"version")," ",a.version)))}}]),a}(f.default.PureComponent);a.default=g,g.propTypes={data:m.default.object,health:m.default.object,edge:m.default.object},g.defaultProps={data:{},health:{},edge:{}}},3701:function(e,t,a){e.exports={card:"Card__card--3UtyX",error:"Card__error--1f5z3",type:"Card__type--3ig_h",wrapper:"Card__wrapper--2-NCj",detail:"Card__detail--3Rb35",componentName:"Card__componentName--2K6kX",gatewayName:"Card__gatewayName---s8vb",version:"Card__version--3If_x"}},3702:function(e,t,a){e.exports={title:"App__title--vt11z",app:"App__app--2VIFm",group:"App__group--GBv7I",selected:"App__selected--3hAJJ",error:"App__error--3cHhj",pods:"App__pods--2g9MF"}},3703:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(30)),o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(22)),f=l(n(0)),m=l(n(1)),p=l(n(3)),h=l(n(38)),v=l(n(2502)),g=l(n(3704)),y=l(n(3706)),E=l(n(3710)),b=l(n(3712)),_=v.default.CollapseItem,S=function(e){function a(){var e,t;(0,o.default)(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(t=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(l)))).state={activeKey:["monitor"]},t.handleCollapseChange=function(e){t.setState({activeKey:e})},t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.data&&e.data.name!==(0,c.default)(this.props,"data.name")&&this.setState({activeKey:["monitor"]})}},{key:"render",value:function(){var e=this.props,a=e.data,n=e.fullScreen;if(!a.nodes)return null;var l=a.nodes.find((function(e){return"service"===e.data.nodeType}));if(!l)return null;var o=(0,c.default)(l,"data.traffic[0].protocol");return f.default.createElement("div",{className:(0,p.default)(b.default.detail,"ks-service-detail")},f.default.createElement("div",{className:(0,p.default)(b.default.wrapper,(0,r.default)({},b.default.fullscreen,n))},f.default.createElement("div",{className:b.default.title},f.default.createElement(h.default,{name:"network-router",size:32}),f.default.createElement("div",null,f.default.createElement("div",{className:"h5"},a.name),f.default.createElement("p",null,t("Service")))),f.default.createElement(v.default,{accordion:!0,activeKey:this.state.activeKey,onChange:this.handleCollapseChange},f.default.createElement(_,{label:t("Traffic Monitoring"),key:"monitor"},f.default.createElement(g.default,{detail:a,store:this.props.store,protocol:o})),f.default.createElement(_,{label:t("Traffic Management"),key:"form"},f.default.createElement(y.default,{detail:a,store:this.props.store,protocol:o})),f.default.createElement(_,{label:t("Pods"),key:"pods"},f.default.createElement(E.default,{detail:a,store:this.props.store})))))}}]),a}(f.default.Component);a.default=S,S.propTypes={type:m.default.string,data:m.default.object}},3704:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(70)),o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(22)),f=l(n(58)),m=l(n(0)),p=l(n(1)),h=l(n(943)),v=n(939),g=n(964),y=n(2522),E=l(n(3705)),b=l(n(2849)),_=function(e){function a(e){var t;return(0,o.default)(this,a),(t=(0,i.default)(this,(0,s.default)(a).call(this,e))).state={metrics:{},outMetrics:{}},t.getData(),t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"componentWillReceiveProps",value:function(e){(0,h.default)(e.detail,this.props.detail)||this.getData(e)}},{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval((function(){e.getData()}),1e4)}},{key:"componentWillUnmount",value:function(){this.interval&&clearInterval(this.interval)}},{key:"getData",value:function(e){var t=this,a=e||this.props,n=a.detail,l=a.store,r="tcp"===a.protocol?this.store.fetchAppMetrics:this.store.fetchServiceMetrics;n&&n.name&&(r({name:n.name,namespace:l.detail.namespace},{duration:1800}).then((function(e){t.setState({metrics:e})})),r({name:n.name,namespace:l.detail.namespace},{duration:1800,direction:"outbound",reporter:"source"}).then((function(e){t.setState({outMetrics:e})})))}},{key:"render",value:function(){var e=this.props.protocol,a=this.tcpInMetrics,n=this.tcpOutMetrics;return"http"===e?m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{className:b.default.title},t("Traffic (requests per second)")),m.default.createElement(E.default,{metrics:this.trafficMetrics}),m.default.createElement(y.SimpleArea,(0,r.default)({},this.requestMetrics,{height:100})),!(0,f.default)(n)&&m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{className:b.default.title},t("TCP - Outbound Traffic")),m.default.createElement(y.SimpleArea,(0,r.default)({},n,{height:100})))):"tcp"===e?m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{className:b.default.title},t("TCP - Inbound Traffic")),m.default.createElement(y.SimpleArea,(0,r.default)({},a,{height:100})),m.default.createElement("div",{className:b.default.title},t("TCP - Outbound Traffic")),m.default.createElement(y.SimpleArea,(0,r.default)({},n,{height:100}))):null}},{key:"store",get:function(){return this.props.store}},{key:"requestMetrics",get:function(){if(!this.props.detail)return[];var e=this.state.metrics,t=(0,c.default)(e,"metrics.request_count.matrix[0].values",[]),a=(0,c.default)(e,"metrics.request_error_count.matrix[0].values",[]),n=t.map((function(e,t){return(0,g.getSuccessCount)(e,a[t])}));return(0,v.getAreaChartOps)({title:"traffic",legend:["Success","All"],areaColors:["#329dce","#d8dee5"],data:[{values:n},{values:t}],unit:"RPS"})}},{key:"tcpInMetrics",get:function(){if(!this.props.detail)return[];var e=this.state.metrics,t=(0,c.default)(e,"metrics.tcp_received.matrix[0].values",[]),a=(0,c.default)(e,"metrics.tcp_sent.matrix[0].values",[]);return 0===t.length&&0===a.length?{}:(0,v.getAreaChartOps)({title:"bandwith",legend:["Send","Receive"],data:[{values:a},{values:t}],unit:"B/s"})}},{key:"tcpOutMetrics",get:function(){if(!this.props.detail)return{};var e=this.state.outMetrics,t=(0,c.default)(e,"metrics.tcp_received.matrix[0].values",[]),a=(0,c.default)(e,"metrics.tcp_sent.matrix[0].values",[]);return 0===t.length&&0===a.length?{}:(0,v.getAreaChartOps)({title:"bandwith",legend:["Send","Receive"],data:[{values:a},{values:t}],unit:"B/s"})}},{key:"trafficMetrics",get:function(){var e=this.props.detail;if(!e)return[];var t=e.health,a=e.nodes.find((function(e){return"service"===e.data.nodeType})),n=(0,c.default)(t,"requests.errorRatio");return[{title:"Traffic",data:(0,c.default)(a,"data.traffic[0].rates.httpIn",0),unit:"RPS",icon:"changing-over"},{title:"Success rate",data:-1===n?NaN:(100-n).toFixed(2),icon:"check",unit:"%"},{title:"Duration",data:1e3*(0,g.getMetricData)((0,c.default)(this.state.metrics,'histograms.request_duration["0.95"].matrix[0].values',[]),NaN),icon:"timed-task",unit:"ms"}]}}]),a}(m.default.Component);a.default=_,_.propTypes={detail:p.default.object,store:p.default.object}},3705:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(1)),f=l(n(38)),m=l(n(2849)),p=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props.metrics;return d.default.createElement("div",{className:m.default.trafficCard},e.map((function(e){return d.default.createElement("div",{key:e.title},d.default.createElement("div",{className:"h5"},isNaN(e.data)?t("No Data"):"".concat(e.data," ").concat(e.unit)),d.default.createElement("p",null,d.default.createElement(f.default,{name:e.icon}),e.title))})))}}]),a}(d.default.Component);a.default=p,p.propTypes={metrics:c.default.array},p.defaultProps={metrics:[]}},3706:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o,u,i=l(n(37)),s=l(n(13)),d=l(n(14)),c=l(n(17)),f=l(n(16)),m=l(n(18)),p=l(n(22)),h=l(n(115)),v=l(n(566)),g=l(n(58)),y=l(n(0)),E=l(n(1)),b=n(19),_=n(60),S=l(n(2469)),k=l(n(943)),C=l(n(2454)),w=l(n(2455)),N=l(n(225)),T=l(n(942)),P=l(n(2470)),M=l(n(224)),R=l(n(388)),D=l(n(267)),O=l(n(2530)),x=n(49),I=l(n(940)),A=l(n(3707)),L=l(n(3708)),j=l(n(3709)),V=(0,_.observer)((u=o=function(e){function a(e){var n;return(0,s.default)(this,a),(n=(0,c.default)(this,(0,f.default)(a).call(this,e))).handleModeChange=function(e){n.setState({mode:e},(function(){"lb"===n.state.mode?(0,v.default)(n.state.formData,"spec.template.spec.trafficPolicy.loadBalancer.consistentHash"):(0,v.default)(n.state.formData,"spec.template.spec.trafficPolicy.loadBalancer.simple")}))},n.handlePoolToggle=function(e){n.setState({showPoolForm:e})},n.handleCircuitToggle=function(e){n.setState({showCircuitForm:e})},n.handleSubmit=function(e){var a=n.state,l=a.showCircuitForm,r=a.showPoolForm;l||(0,v.default)(e,"spec.template.spec.trafficPolicy.outlierDetection"),r||(0,v.default)(e,"spec.template.spec.trafficPolicy.connectionPool");var o=function(){n.getData(n.props),R.default.success({content:"".concat(t("Updated Successfully"),"!")})};(0,g.default)(n.detail)?n.store.create(e).then(o):((0,h.default)(e,"metadata.resourceVersion",n.detail.resourceVersion),n.store.update(n.detail,e).then(o))},n.state={mode:"lb",showPoolForm:!1,showCircuitForm:!1,formData:{}},n.store=new A.default,n.getData(e),n}return(0,m.default)(a,e),(0,d.default)(a,[{key:"getData",value:function(e){var t=this,a=e.detail.name,n=(0,b.toJS)(e.store.detail).namespace;this.store.fetchListByK8s({namespace:n,labelSelector:(0,x.joinSelector)({app:a}),limit:1}).then((function(){t.setState({showPoolForm:t.detail.connectPoolEnable,showCircuitForm:t.detail.outlierDetectionEnable,formData:t.formTemplate})}))}},{key:"componentWillReceiveProps",value:function(e){e.detail.name!==this.props.detail.name&&this.getData(e)}},{key:"shouldComponentUpdate",value:function(e,t){return e.detail.name!==this.props.detail.name||!(0,k.default)(t,this.state)}},{key:"getLBOptions",value:function(){return[{label:t("LB_ROUND_ROBIN"),value:"ROUND_ROBIN"},{label:t("LB_LEAST_CONN"),value:"LEAST_CONN"},{label:t("LB_RANDOM"),value:"RANDOM"}]}},{key:"renderLB",value:function(){var e=this.state.mode;return y.default.createElement(y.default.Fragment,null,y.default.createElement("div",{className:j.default.title},t("Load balance algorithm")),y.default.createElement(C.default,{wrapClassName:"radio-default margin-t12",buttonWidth:148,value:e,onChange:this.handleModeChange,size:"small"},y.default.createElement(w.default,{value:"lb"},t("Load balance algorithm")),y.default.createElement(w.default,{value:"session"},t("Session retention"))),"lb"===e&&this.renderLBOptions(),"session"===e&&this.renderSessionOptions())}},{key:"renderPool",value:function(){var e=this.state.showPoolForm,a=y.default.createElement("div",{className:j.default.title},t("Connection pool management"),y.default.createElement(P.default,{checked:e,onChange:this.handlePoolToggle,onText:t("On"),offText:t("Off")})),n=y.default.createElement("div",{className:j.default.tip},t("CONNECTION_POOL_TIP"));return this.isHTTP?y.default.createElement(y.default.Fragment,null,a,e?y.default.createElement(y.default.Fragment,null,y.default.createElement(D.default.Item,{className:"margin-t12",label:t("Max number of connections"),desc:t("The maximum number of HTTP1 or TCP connections to the target host.")},y.default.createElement(O.default,{name:"spec.template.spec.trafficPolicy.connectionPool.tcp.maxConnections",min:0})),y.default.createElement(D.default.Item,{label:t("Max number of requests per connection"),desc:t("If the maximum number of requests in the backend connection is set to 1, the keep alive feature is disabled.")},y.default.createElement(O.default,{name:"spec.template.spec.trafficPolicy.connectionPool.http.maxRequestsPerConnection",defaultValue:1,min:0})),y.default.createElement(D.default.Item,{label:t("Max request retries"),desc:t("The maximum number of retries to the target host within the specified time.")},y.default.createElement(O.default,{name:"spec.template.spec.trafficPolicy.connectionPool.http.maxRetries",defaultValue:3,min:0})),y.default.createElement(D.default.Item,{label:t("Connection timeout"),desc:t("TCP connection timeout.")},y.default.createElement(O.default,{name:"spec.template.spec.trafficPolicy.connectionPool.tcp.connectTimeout",min:0,unit:"ms",showUnit:!0})),y.default.createElement(D.default.Item,{label:t("Maximum requests")},y.default.createElement(O.default,{name:"spec.template.spec.trafficPolicy.connectionPool.http.http2MaxRequests",defaultValue:1024,min:0})),y.default.createElement(D.default.Item,{label:t("Maximum pending requests")},y.default.createElement(O.default,{name:"spec.template.spec.trafficPolicy.connectionPool.http.http1MaxPendingRequests",defaultValue:1024,min:0}))):n):y.default.createElement(y.default.Fragment,null,a,e?y.default.createElement(y.default.Fragment,null,y.default.createElement(D.default.Item,{className:"margin-t12",label:t("Max number of connections"),desc:t("The maximum number of HTTP1 or TCP connections to the target host.")},y.default.createElement(O.default,{name:"spec.template.spec.trafficPolicy.connectionPool.tcp.maxConnections",min:0})),y.default.createElement(D.default.Item,{label:t("Connection timeout"),desc:t("TCP connection timeout.")},y.default.createElement(O.default,{name:"spec.template.spec.trafficPolicy.connectionPool.tcp.connectTimeout",min:0,unit:"ms",showUnit:!0}))):n)}},{key:"renderCircuit",value:function(){var e=this.state.showCircuitForm;return this.isHTTP?y.default.createElement(y.default.Fragment,null,y.default.createElement("div",{className:j.default.title},t("Circuit Breaker"),y.default.createElement(P.default,{checked:e,onChange:this.handleCircuitToggle,onText:t("On"),offText:t("Off")})),e?y.default.createElement(y.default.Fragment,null,y.default.createElement(D.default.Item,{className:"margin-t12",label:t("Continuous error response (5xx) number"),desc:t("The number of consecutive 5xx errors in one inspection cycle")},y.default.createElement(O.default,{name:"spec.template.spec.trafficPolicy.outlierDetection.consecutiveErrors",defaultValue:5,min:0})),y.default.createElement(D.default.Item,{label:t("Inspection period (unit: s)"),desc:t("The response code will be filtered in the inspection cycle.")},y.default.createElement(O.default,{name:"spec.template.spec.trafficPolicy.outlierDetection.interval",defaultValue:"10s",min:.001,unit:"s",showUnit:!0})),y.default.createElement(D.default.Item,{label:t("Pod isolation ratio (unit: %)"),desc:t("POD_ISOLATION_RATIO_DESC")},y.default.createElement(O.default,{name:"spec.template.spec.trafficPolicy.outlierDetection.maxEjectionPercent",defaultValue:10,min:0})),y.default.createElement(D.default.Item,{label:t("Base ejection time (s)"),desc:t("BASE_EJECTION_TIME_DESC")},y.default.createElement(O.default,{name:"spec.template.spec.trafficPolicy.outlierDetection.baseEjectionTime",defaultValue:"30s",min:0,unit:"s",showUnit:!0}))):y.default.createElement("div",{className:j.default.tip},t("CIRCUIT_DESC"))):null}},{key:"renderLBOptions",value:function(){return y.default.createElement("div",{className:"margin-t12"},y.default.createElement(D.default.Item,{label:t("Load balance algorithm")},y.default.createElement(N.default,{name:"spec.template.spec.trafficPolicy.loadBalancer.simple",options:this.getLBOptions(),defaultValue:"ROUND_ROBIN"})),y.default.createElement(T.default,{className:j.default.alert,description:t.html("LB_ALG_DESC"),type:"info"}))}},{key:"renderSessionOptions",value:function(){return y.default.createElement("div",{className:"margin-t12"},y.default.createElement(D.default.Item,{label:t("Method")},y.default.createElement(L.default,{name:"spec.template.spec.trafficPolicy.loadBalancer.consistentHash",protocol:this.props.protocol})))}},{key:"render",value:function(){return y.default.createElement(D.default,{onSubmit:this.handleSubmit,data:this.state.formData},this.renderLB(),this.renderPool(),this.renderCircuit(),y.default.createElement("div",{className:"text-right margin-t12"},y.default.createElement(M.default,{onClick:this.handleCancel},t("Cancel")),y.default.createElement(M.default,{type:"primary",htmlType:"submit",loading:this.store.isSubmitting,disabled:this.store.isSubmitting},t("OK"))))}},{key:"detail",get:function(){var e=(0,b.toJS)(this.store.list);return(0,p.default)(e,"data.[0]",{})}},{key:"isHTTP",get:function(){return"http"===this.props.protocol}},{key:"formTemplate",get:function(){if(this.detail._originData)return(0,S.default)(this.detail._originData);var e=this.props.detail.name,t=(0,b.toJS)(this.props.store.detail),a=t.namespace,n=t.selector;return I.default.strategyPolicy({name:e,namespace:a,selector:(0,i.default)({},n,{app:e})})}}]),a}(y.default.Component),o.propTypes={detail:E.default.object,store:E.default.object},o.defaultProps={detail:{}},r=u))||r;a.default=V},3707:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(13)),r=n(a(14)),o=n(a(17)),u=n(a(16)),i=n(a(18)),s=function(e){function t(){var e;return(0,l.default)(this,t),(e=(0,o.default)(this,(0,u.default)(t).call(this))).module="servicepolicies",e}return(0,i.default)(t,e),(0,r.default)(t,[{key:"apiVersion",get:function(){return"apis/servicemesh.kubesphere.io/v1alpha2"}}]),t}(n(a(228)).default);t.default=s},3708:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(82)),o=l(n(30)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(268)),m=l(n(0)),p=l(n(1)),h=l(n(225)),v=l(n(386)),g=function(e){for(var t=!0,a=e.replace(/\s+/g,"").split(";"),n={},l=0;l<a.length;l++){var r=a[l].split("=");r.length>1?n[r[0]]=r[1]:t=!1}return{result:n,status:t}},y=function(e){function a(e){var t;(0,u.default)(this,a),(t=(0,s.default)(this,(0,d.default)(a).call(this,e))).triggerChange=(0,f.default)((function(e){t.props.onChange(e)}),500),t.handleTypeChange=function(e){t.setState({type:e,value:""},(function(){"useSourceIp"===e&&t.triggerChange((0,o.default)({},e,!0))}))},t.handleValueChange=function(e,a){t.setState({value:a},(function(){var e=t.state.type;if("httpCookie"===e){var n=g(a),l=n.parsedValue;n.status&&t.triggerChange((0,o.default)({},e,l))}else t.triggerChange((0,o.default)({},e,a))}))};var n=t.getOptions(),l=Object.keys(t.props.value)[0]||n[0].value,i=e.value[l];return"httpCookie"===l&&i&&(i=Object.entries(i).map((function(e){var t=(0,r.default)(e,2),a=t[0],n=t[1];return"".concat(a,"=").concat(n)})).join("; ")),t.state={type:l,value:i},t}return(0,c.default)(a,e),(0,i.default)(a,[{key:"componentWillReceiveProps",value:function(e){var t=Object.keys(e.value)[0],a=e.value[t];"httpCookie"===t&&a&&(a=Object.entries(a).map((function(e){var t=(0,r.default)(e,2),a=t[0],n=t[1];return"".concat(a,"=").concat(n)})).join("; ")),t!==this.state.type&&this.setState({type:t}),a!==this.state.value&&this.setState({value:a})}},{key:"getOptions",value:function(){return"http"===this.props.protocol?[{label:t("Hash based on a specific HTTP header."),value:"httpHeaderName"},{label:t("Hash based on HTTP cookie."),value:"httpCookie"},{label:t("Hash based on the source IP address."),value:"useSourceIp"}]:[{label:t("Hash based on the source IP address."),value:"useSourceIp"}]}},{key:"render",value:function(){var e=this.state,a=e.type,n=e.value;return m.default.createElement("div",null,m.default.createElement(h.default,{value:a,options:this.getOptions(),onChange:this.handleTypeChange}),"httpHeaderName"===a&&m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{className:"margin-t12"},t("Based on HTTP header")),m.default.createElement(v.default,{value:n,onChange:this.handleValueChange})),"httpCookie"===a&&m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{className:"margin-t12"},t("Based on HTTP cookie")),m.default.createElement(v.default,{value:n,onChange:this.handleValueChange,placeholder:"key1=val1; key2=val2"})))}}]),a}(m.default.Component);a.default=y,y.propTypes={value:p.default.object,onChange:p.default.func},y.defaultProps={value:{},onChange:function(){}}},3709:function(e,t,a){e.exports={alert:"PolicyForm__alert--1vmq3",title:"PolicyForm__title--UJTgR",tip:"PolicyForm__tip--IYAZY"}},3710:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(37)),r=n(a(13)),o=n(a(14)),u=n(a(17)),i=n(a(16)),s=n(a(18)),d=n(a(0)),c=n(a(58)),f=a(19),m=n(a(38)),p=n(a(943)),h=a(49),v=n(a(961)),g=n(a(3711)),y=n(a(2850)),E=function(e){function t(e){var a;return(0,r.default)(this,t),(a=(0,u.default)(this,(0,i.default)(t).call(this,e))).podStore=new v.default,a.state={pods:{}},a.getData(),a}return(0,s.default)(t,e),(0,o.default)(t,[{key:"componentWillReceiveProps",value:function(e){(0,p.default)(e.detail,this.props.detail)||this.getData(e)}},{key:"getData",value:function(e){var t=this,a=e||this.props,n=a.detail,r=a.store;n&&n.name&&this.podStore.fetchListByK8s({namespace:r.detail.namespace,labelSelector:(0,h.joinSelector)((0,l.default)({},r.detail.selector,{app:n.name}))}).then((function(){var e=(0,f.toJS)(t.podStore.list.data),a={};e.forEach((function(e){e.labels&&e.labels.version&&(a[e.labels.version]=a[e.labels.version]||[],a[e.labels.version].push(e))})),t.setState({pods:a})}))}},{key:"render",value:function(){var e=this.props.detail,t=this.state.pods;if((0,c.default)(e.nodes))return null;var a=e.nodes.filter((function(e){return e.data.workload}))||[];return d.default.createElement("div",{className:y.default.wrapper},a.map((function(e){return d.default.createElement("div",{className:y.default.item,key:e.data.id},d.default.createElement("div",{className:y.default.title},d.default.createElement(m.default,{name:"backup",size:32}),d.default.createElement("div",{className:y.default.text},d.default.createElement("p",null,d.default.createElement("strong",null,e.data.workload)),d.default.createElement("div",{className:y.default.version},d.default.createElement("span",null,"version")," ",e.data.version))),d.default.createElement("div",{className:y.default.pods},t[e.data.version]&&t[e.data.version].map((function(e){return d.default.createElement(g.default,{key:e.uid,data:e})}))))})))}}]),t}(d.default.Component);t.default=E},3711:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(3)),f=l(n(22)),m=l(n(38)),p=n(226),h=n(49),v=l(n(2850)),g=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props.data,a=e.podStatus,n="running"===a.type||"completed"===a.type?"running":"updating";return d.default.createElement("div",{className:v.default.podItem},d.default.createElement("div",{className:v.default.icon},d.default.createElement(m.default,{name:"pod",size:32}),d.default.createElement("span",{className:(0,c.default)(v.default.status,v.default[n])})),d.default.createElement("div",{className:v.default.text},d.default.createElement(p.Link,{to:"/projects/".concat(e.namespace,"/pods/").concat(e.name)},d.default.createElement("strong",null,e.name)),d.default.createElement("p",null,t("Updated at")," ",(0,h.getLocalTime)((0,f.default)(e,"status.startTime")||(0,f.default)(e,"createTime")).format("YYYY-MM-DD HH:mm:ss"))))}}]),a}(d.default.Component);a.default=g},3712:function(e,t,a){e.exports={detail:"Detail__detail--2nZLG",wrapper:"Detail__wrapper--1nI-r",fullscreen:"Detail__fullscreen--3tl83",title:"Detail__title--1JiVM"}},3713:function(e,t,a){e.exports={graph:"Graph__graph--1XGva",graphContent:"Graph__graphContent--2owoC",edgeWrapper:"Graph__edgeWrapper--cZDah",body:"Graph__body--qDE6K",fullScreen:"Graph__fullScreen--ZOIRU",loading:"Graph__loading--2O0O0",dragger:"Graph__dragger--2m-Ch",mainContent:"Graph__mainContent--QUutK"}},3714:function(e,t,a){e.exports={main:"TrafficManangement__main--2L3eE",loading:"TrafficManangement__loading--1W1hi"}},3715:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(58)),f=l(n(0)),m=n(226),p=n(938),h=n(19),v=n(60),g=n(49),y=l(n(224)),E=l(n(2552)),b=n(2851),_=l(n(3750)),S=(0,v.observer)(r=function(e){function a(e){var t;return(0,o.default)(this,a),(t=(0,i.default)(this,(0,s.default)(a).call(this,e))).detailStore=e.detailStore,t.module=e.module,t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"componentDidMount",value:function(){var e=this;this.disposer=(0,h.when)((function(){return!(0,c.default)(e.detailStore.detail)}),(function(){return e.getData()}))}},{key:"componentWillUnmount",value:function(){this.disposer&&this.disposer()}},{key:"getData",value:function(){var e=(0,h.toJS)(this.detailStore.detail).selector,t={namespace:this.namespace,labelSelector:(0,g.joinSelector)(e)};this.store.fetchList(t).then()}},{key:"renderEmpty",value:function(){return f.default.createElement(E.default,{icon:"istio",title:t("NO_GRAY_RELEASE_JOBS_TIP"),desc:t("NO_GRAY_RELEASE_JOBS_TIP_2")})}},{key:"renderHeader",value:function(){var e=this.props.match.params.namespace;return f.default.createElement("div",{className:_.default.header},f.default.createElement(p.Columns,null,f.default.createElement(p.Column,null,f.default.createElement("p",{className:_.default.headerTip},t("GRAY_RELEASE_DESC"))),f.default.createElement(p.Column,{className:"is-narrow"},f.default.createElement(m.Link,{to:"/projects/".concat(e,"/grayrelease/cates")},f.default.createElement(y.default,{type:"control"},t("Create Grayscale Release Job"))))))}}]),a}(b.Component))||r;a.default=S},3716:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o,u,i=l(n(30)),s=l(n(70)),d=l(n(63)),c=l(n(37)),f=l(n(13)),m=l(n(14)),p=l(n(17)),h=l(n(16)),v=l(n(18)),g=l(n(22)),y=l(n(115)),E=l(n(566)),b=l(n(58)),_=l(n(950)),S=l(n(2458)),k=l(n(0)),C=l(n(1)),w=l(n(3)),N=n(19),T=n(60),P=l(n(129)),M=n(938),R=l(n(942)),D=l(n(38)),O=l(n(224)),x=l(n(387)),I=l(n(2676)),A=l(n(2852)),L=l(n(2632)),j=l(n(2536)),V=n(49),F=n(114),U=l(n(940)),B=l(n(3718)),G=l(n(3720)),Y=l(n(3723)),q=l(n(3747)),W={exact:"Exact Match",prefix:"Prefix Match",regex:"Regex Match"},H=(0,_.default)(F.GRAY_RELEASE_CANARY_CONTENT,"value"),J=(0,T.inject)("rootStore")(r=(0,T.observer)((u=o=function(e){function a(e){var n;return(0,f.default)(this,a),(n=(0,p.default)(this,(0,h.default)(a).call(this,e))).updateTipInfo=function(){var e=(0,N.toJS)(n.store.detail),a=e.governor,l=e.newVersion,r=e.oldVersion;a?n.setState({tipType:"info",tipInfo:t("JOB_OFFLINE_INFO",{version:a===r?l:r})}):n.setState({tipInfo:""})},n.handlePatch=function(e){var t=(0,N.toJS)(n.store.detail),a=t.name,l=t.namespace;n.store.patch({name:a,namespace:l},e).then((function(){n.store.fetchDetail({name:a,namespace:l}).then((function(){var e=(0,N.toJS)(n.store.detail);if("Canary"===e.type&&!e.byContent){var t=(0,g.default)(e,"newRoute.weight",50);n.setState({ratio:t})}n.updateTipInfo()}))}))},n.handleRatioChange=function(e){n.setState({ratio:e})},n.handleConfirmSaveRatio=function(){var e=n.state.ratio;n.handleSaveRatio(e)},n.handleSaveRatio=function(e){var t=(0,N.toJS)(n.store.detail),a=t.oldRoute,l=t.oldVersion,r=t.newRoute,o=t.newVersion,u=t.protocol,i={};(0,y.default)(i,"spec.template.spec.".concat(u,"[0].route"),[(0,c.default)({},a,{weight:100-e}),(0,c.default)({},r,{weight:e})]),"tcp"===u&&(0,y.default)(i,"spec.template.spec.".concat(u,"[0].match"),[]),100===e?(0,y.default)(i,"spec.governor",o):0===e?(0,y.default)(i,"spec.governor",l):(0,y.default)(i,"spec.governor",""),n.handlePatch(i)},n.handleResetRatio=function(){var e=(0,N.toJS)(n.store.detail),t=(0,g.default)(e,"newRoute.weight");n.setState({ratio:t})},n.showEditModal=function(){n.setState({showEditModal:!0})},n.hideEditModal=function(){n.setState({showEditModal:!1})},n.updateStrategy=function(e){var t=(0,g.default)(e,"spec.protocol","http"),a="spec.template.spec.".concat(t,"[0]"),n=(0,g.default)(e,"".concat(a,".match[0].headers.cookie"));n&&(0,b.default)(Object.values(n)[0])&&(0,E.default)(e,"".concat(a,".match[0].headers.cookie"));var l=(0,g.default)(e,"".concat(a,".match[0].headers"));l&&Object.keys(l).forEach((function(t){(0,b.default)(t)&&(0,E.default)(e,"".concat(a,".match[0].headers.").concat(t))}));var r=(0,g.default)(e,"".concat(a,".match[0].uri"));r&&(0,b.default)(Object.values(r)[0])&&(0,E.default)(e,"".concat(a,".match[0].uri"));var o=(0,g.default)(e,"".concat(a,".match[0].headers['User-Agent'].regex"));return o&&(0,b.default)(Object.values(o)[0])&&(0,E.default)(e,"".concat(a,".match[0].headers['User-Agent'].regex")),e},n.handleComponentEdit=function(e,t){var a=(0,N.toJS)(n.store.detail),l=a.name,r=a.namespace,o={};t.includes("grayReleaseStrategy")&&(o.strategy=n.updateStrategy(e.strategy)),t.includes("grayReleaseComponent")&&(o.workload=e.workload),n.store.update(a,o).then((function(){n.store.fetchDetail({name:l,namespace:r}).then((function(){n.hideEditModal();var e=(0,N.toJS)(n.store.detail);if("Canary"===e.type&&!e.byContent){var t=(0,g.default)(e,"newRoute.weight",50);n.setState({ratio:t})}n.updateTipInfo()}))}))},n.handleOffline=function(){var e=(0,N.toJS)(n.store.detail),a=e.type,l=e.hosts,r=e.namespace,o=e.governor,u=e.oldVersion,i=e.newVersion;if(o){var s=n.props.onDelete,d=o===u?i:u;d&&(n.workloadStore.delete({name:"".concat(l,"-").concat(d),namespace:r}),s())}else if("Mirror"!==a)n.setState({tipType:"warning",tipInfo:t("JOB_OFFLINE_WARNING")});else{var c=n.props.onDelete,f=i;f&&(n.workloadStore.delete({name:"".concat(l,"-").concat(f),namespace:r}),c())}},n.handleTakeover=function(e){var t=(0,N.toJS)(n.store.detail);"Canary"===t.type?t.byContent?n.handlePatch({spec:{governor:"new"===e?t.newVersion:t.oldVersion}}):n.handleSaveRatio("new"===e?100:0):"Bluegreen"===t.type&&n.handlePatch({spec:{governor:"new"===e?t.newVersion:t.oldVersion}})},n.handleRecover=function(){n.handlePatch({spec:{governor:""}})},n.state={tipType:"",tipInfo:"",ratio:50,showEditModal:!1},n.store=new L.default,n.workloadType=(0,g.default)(e.detail,'annotations["servicemesh.kubesphere.io/workloadType"]',"deployments"),n.workloadStore=new j.default(n.workloadType),e.visible&&(n.getData(e.detail),n.getWorkLoadDetail(e.detail)),n}return(0,v.default)(a,e),(0,m.default)(a,[{key:"initWebsocket",value:function(e){var t=this,a=e||{},n=a.namespace,l=a.selector,r="api/v1/watch/namespaces/".concat(n,"/pods?labelSelector=").concat((0,V.joinSelector)(l));r&&n&&l&&(this.websocket.watch(r),this.getWorkLoadDetail=(0,S.default)(this.getWorkLoadDetail,2e3),this.disposer=(0,N.reaction)((function(){return t.websocket.message}),(function(a){"Pod"===a.object.kind&&"ADDED"!==a.type&&t.getWorkLoadDetail((0,c.default)({},e,{silent:!0}))})))}},{key:"componentWillReceiveProps",value:function(e){e.visible&&e.visible!==this.props.visible&&(this.getData(e.detail),this.getWorkLoadDetail(e.detail))}},{key:"componentWillUnmount",value:function(){this.disposer&&this.disposer(),this.websocket.close()}},{key:"getData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.name,n=t.namespace;a&&n&&this.store.fetchDetail({name:a,namespace:n}).then((function(){var t=(0,N.toJS)(e.store.detail);if("Canary"===t.type&&!t.byContent){var a=(0,g.default)(t,"newRoute.weight",50);e.setState({ratio:a})}e.initWebsocket(t),e.updateTipInfo()}))}},{key:"getWorkLoadDetail",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.silent,a=(0,d.default)(e,["silent"]),n=a.namespace,l=a.selector,r=a.hosts,o=a.newVersion,u=a.oldVersion;if(n&&l){var i=(0,V.joinSelector)(l);this.workloadStore.fetchListByK8s({namespace:n,labelSelector:i}),this.store.fetchComponents({namespace:n,service:r,labelSelector:i,newVersion:o,oldVersion:u,silent:t})}}},{key:"renderTitle",value:function(){var e=(0,N.toJS)(this.store.detail),a=F.GRAY_RELEASE_CATEGORIES.find((function(t){return t.type===e.type}))||{};return k.default.createElement("div",{className:q.default.title},k.default.createElement("img",{src:"/assets/default-app.svg",alt:""}),k.default.createElement("div",{className:q.default.text},k.default.createElement("div",{className:"h4"},e.name),k.default.createElement("p",null,t("Grayscale Release Strategy"),": ",k.default.createElement("strong",null,t(a.title)))),k.default.createElement(O.default,{noShadow:!0,onClick:this.handleOffline},t("Job offline")))}},{key:"renderComponents",value:function(){var e=(0,N.toJS)(this.store.detail),a=this.store.components.data,n=this.store.isComponentsLoading;if(n)return k.default.createElement("div",null,k.default.createElement("div",{className:q.default.sectionTitle},k.default.createElement("div",null,t("Grayscale Release Components")),k.default.createElement("p",null,t("CANARY_RELEASES_DESC"))),k.default.createElement(P.default,{spinning:n,className:q.default.loading}));var l={showEditModal:this.showEditModal,onTakeover:"Mirror"!==e.type?this.handleTakeover:null,namespace:this.props.detail.namespace,maxLength:Math.min(Math.max((0,g.default)(a,"[".concat(e.newVersion,"].pods.length"),0),(0,g.default)(a,"[".concat(e.oldVersion,"].pods.length"),0)),3),jobDetail:e,workloadType:this.workloadType};return k.default.createElement("div",null,k.default.createElement("div",{className:q.default.sectionTitle},k.default.createElement("div",null,t("Grayscale Release Components")),k.default.createElement("p",null,t("CANARY_RELEASES_DESC"))),k.default.createElement(M.Columns,null,k.default.createElement(M.Column,null,k.default.createElement(B.default,(0,s.default)({data:a[e.newVersion],pods:(0,N.toJS)((0,g.default)(a,"[".concat(e.newVersion,"].pods"),[])),type:"new",isGovernor:e.governor===e.newVersion},l))),k.default.createElement(M.Column,null,k.default.createElement(B.default,(0,s.default)({data:a[e.oldVersion],pods:(0,N.toJS)((0,g.default)(a,"[".concat(e.oldVersion,"].pods"),[])),type:"old",isGovernor:e.governor===e.oldVersion},l)))))}},{key:"renderTraffic",value:function(){var e=(0,N.toJS)(this.store.detail),a=this.state.ratio,n="".concat(e.newVersion," ").concat(t("traffic")),l="".concat(e.oldVersion," ").concat(t("traffic")),r=(0,g.default)(e,"newRoute.weight");return k.default.createElement(k.default.Fragment,null,k.default.createElement("div",{className:q.default.sectionTitle},k.default.createElement("div",null,t("Real-time traffic distribution")),k.default.createElement("p",null,t("Allocate all traffic proportionally to grayscale release components"))),k.default.createElement(A.default,{min:0,max:100,value:a,leftContent:n,rightContent:l,onChange:this.handleRatioChange}),k.default.createElement(I.default,{visible:a!==r,width:400,title:t("REPLICAS_SCALE_NOTIFY_TITLE"),content:t.html("RATIO_MODIFY_NOTIFY_CONTENT",{version:e.newVersion,ratio:a}),cancelText:t("Reset"),confirmText:t("Save"),isSubmitting:this.store.isSubmitting,onCancel:this.handleResetRatio,onConfirm:this.handleConfirmSaveRatio}))}},{key:"renderBluegreen",value:function(){var e=(0,N.toJS)(this.store.detail),a=e.governor||(100===e.oldRoute.weight?e.oldVersion:e.newVersion);return k.default.createElement(k.default.Fragment,null,k.default.createElement("div",{className:q.default.sectionTitle},k.default.createElement("div",null,t("Real-time traffic distribution")),k.default.createElement("p",null,t("Real-time traffic ratio"))),k.default.createElement("div",{className:q.default.barWrapper},k.default.createElement("div",{className:q.default.bar},"".concat(a," ").concat(t("traffic")," 100%"))))}},{key:"renderMirror",value:function(){var e=(0,N.toJS)(this.store.detail),a=e.governor||(100===e.oldRoute.weight?e.oldVersion:e.newVersion);return k.default.createElement(k.default.Fragment,null,k.default.createElement("div",{className:q.default.sectionTitle},k.default.createElement("div",null,t("Real-time traffic distribution")),k.default.createElement("p",null,t("Real-time traffic ratio"))),k.default.createElement("div",{className:q.default.mirror},k.default.createElement("div",{className:q.default.barWrapper},k.default.createElement("div",{className:(0,w.default)(q.default.bar,(0,i.default)({},q.default.mirrorBar,a!==e.newVersion))},"".concat(e.newVersion," ").concat(t("traffic")," 100%"))),k.default.createElement("div",{className:(0,w.default)(q.default.mirrorIcon,(0,i.default)({},q.default.revertMirrorIcon,a===e.oldVersion))},k.default.createElement("img",{src:"/assets/mirror.svg",alt:""})),k.default.createElement("div",{className:q.default.barWrapper},k.default.createElement("div",{className:(0,w.default)(q.default.bar,(0,i.default)({},q.default.mirrorBar,a!==e.oldVersion))},"".concat(e.oldVersion," ").concat(t("traffic")," 100%")))))}},{key:"renderContentMatch",value:function(){var e=(0,N.toJS)(this.store.detail),a=this.store.components.data,n=this.store.isComponentsLoading;if(n)return k.default.createElement("div",null,k.default.createElement("div",{className:q.default.sectionTitle},k.default.createElement("div",null,t("Traffic Control")),k.default.createElement("p",null,t("Introduce traffic that meets the following rules into grayscale version"))),k.default.createElement(P.default,{spinning:n,className:q.default.loading}));var l=(0,g.default)(e,"newRoute.match[0]"),r=a[e.newVersion]||{};if(!l)return null;var o=(0,g.default)(l,"uri",{}),u=(0,g.default)(l,"headers",{}),i=Object.keys(o)[0]||"",s=o[i]||"-",d=u.cookie||{},c=Object.keys(d)[0]||"",f=d[c]||"-",m=u["User-Agent"]||{},p=m.regex&&m.regex.slice(2,m.regex.length-2).split("|").map((function(e){return H[e]?H[e].label:e})).join(", ")||"-",h=Object.keys(u).find((function(e){return!["cookie","User-Agent"].includes(e)})),v=u[h]||{},y=Object.keys(v)[0]||"",E=v[y]||"-";return k.default.createElement(k.default.Fragment,null,k.default.createElement("div",{className:q.default.sectionTitle},k.default.createElement("div",null,t("Traffic Control")),k.default.createElement("p",null,t("Introduce traffic that meets the following rules into grayscale version"))),k.default.createElement("div",{className:q.default.matchWrapper},e.governor&&k.default.createElement("div",{className:q.default.governor},k.default.createElement("div",null,k.default.createElement("div",null,k.default.createElement(D.default,{name:"appcenter",size:40})),k.default.createElement("div",null,k.default.createElement("span",{className:"ks-tag"},e.governor)),k.default.createElement("div",null,k.default.createElement("strong",null,e.hosts)),k.default.createElement("p",null,t("Has taken over all traffic")),k.default.createElement("div",null,k.default.createElement(O.default,{noShadow:!0,onClick:this.handleRecover},t("Recover"))))),k.default.createElement(M.Columns,null,k.default.createElement(M.Column,null,k.default.createElement("ul",null,k.default.createElement("li",null,k.default.createElement(D.default,{name:"earth",size:24}),k.default.createElement("strong",null,"".concat(t("Cookie Content")).concat(c?"(".concat(t(W[c]),")"):"")),f),k.default.createElement("li",null,k.default.createElement(D.default,{name:"image",size:24}),k.default.createElement("strong",null,t("Operating System")),p),k.default.createElement("li",null,k.default.createElement(D.default,{name:"pen",size:24}),k.default.createElement("strong",null,"".concat(t("Custom Header")).concat(y?"(".concat(t(W[y]),")"):"")),h?"".concat(h,": ").concat(E):""),k.default.createElement("li",null,k.default.createElement(D.default,{name:"ip",size:24}),k.default.createElement("strong",null,"".concat(t("URI")).concat(i?"(".concat(t(W[i]),")"):"")),s))),k.default.createElement(M.Column,{className:"is-narrow"},k.default.createElement("div",{className:q.default.matchArrow},k.default.createElement(D.default,{name:"update",color:{primary:"#329dce"},size:24}))),k.default.createElement(M.Column,{className:"is-narrow"},k.default.createElement("div",{className:q.default.matchVersion},k.default.createElement("div",null,k.default.createElement("div",null,k.default.createElement(D.default,{name:"appcenter",size:40})),k.default.createElement("div",null,k.default.createElement("span",{className:"ks-tag"},e.newVersion)),k.default.createElement("div",null,k.default.createElement("strong",null,e.hosts)),k.default.createElement("p",null,t("Replicas"),": ",k.default.createElement("strong",null,r.available),"/",r.desire)))))))}},{key:"renderPolicy",value:function(){var e=(0,N.toJS)(this.store.detail);return"Canary"===e.type?k.default.createElement("div",{style:{marginTop:20}},e.byContent?this.renderContentMatch():this.renderTraffic()):"Bluegreen"===e.type?k.default.createElement("div",{style:{marginTop:20}},this.renderBluegreen()):"Mirror"===e.type?k.default.createElement("div",{style:{marginTop:20}},this.renderMirror()):null}},{key:"renderMonitor",value:function(){var e=(0,N.toJS)(this.store.detail);return k.default.createElement(G.default,{detail:e,store:this.store})}},{key:"render",value:function(){var e=this.props,a=e.visible,n=e.onCancel,l=this.state,r=l.showEditModal,o=l.tipInfo,u=l.tipType;return k.default.createElement(x.default,{className:q.default.modal,bodyClassName:q.default.body,headerClassName:q.default.header,title:t("Job Status"),cancelText:t("Close"),onCancel:n,visible:a,fullScreen:!0},o&&k.default.createElement(R.default,{className:"margin-b8",type:u,message:o}),this.renderTitle(),k.default.createElement("div",{className:q.default.wrapper},this.renderComponents(),this.renderPolicy()),k.default.createElement("div",{className:q.default.monitor},this.renderMonitor()),k.default.createElement(Y.default,{visible:r,module:"grayreleases",formData:this.formData,onOk:this.handleComponentEdit,onCancel:this.hideEditModal,isSubmitting:this.store.isSubmitting}))}},{key:"websocket",get:function(){return this.props.rootStore.websocket}},{key:"formData",get:function(){var e=(0,N.toJS)(this.store.detail),t="".concat(e.hosts,"-").concat(e.newVersion),a=(0,N.toJS)(this.workloadStore.list.data).find((function(e){return e.name===t}))||{},n=U.default[this.workloadType]({namespace:e.namespace}),l={strategy:(0,N.toJS)(e._originData),workload:{apiVersion:n.apiVersion,kind:n.kind,metadata:{name:t,namespace:a.namespace,labels:a.labels,annotations:a.annotations},spec:a.spec}};return(0,V.mergeLabels)(l.workload,{version:e.newVersion}),l}}]),a}(k.default.Component),o.propTypes={visible:C.default.bool,detail:C.default.object,onCancel:C.default.func,onDelete:C.default.func},o.defaultProps={visible:!1,detail:{},onCancel:function(){},onDelete:function(){}},r=u))||r)||r;a.default=J},3717:function(e,t,a){e.exports={wrapper:"TrafficSlider__wrapper--3SwZz",slider:"TrafficSlider__slider--28M70",floatContent:"TrafficSlider__floatContent--XqxDC"}},3718:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(37)),o=l(n(82)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(0)),m=l(n(1)),p=l(n(3)),h=n(226),v=l(n(943)),g=l(n(22)),y=l(n(58)),E=l(n(132)),b=n(19),_=l(n(271)),S=l(n(38)),k=l(n(190)),C=l(n(227)),w=l(n(224)),N=l(n(2587)),T=l(n(3719)),P=l(n(2853)),M={cpu:"pod_cpu_usage",memory:"pod_memory_usage_wo_cache"},R=function(e){function a(e){var t;return(0,u.default)(this,a),(t=(0,s.default)(this,(0,d.default)(a).call(this,e))).handleMoreMenuClick=function(e,a){switch(a){case"edit":t.props.showEditModal();break;case"offline":t.props.onOffline(t.props.type);break;case"takeover":t.props.onTakeover(t.props.type)}},t.state={pods:e.pods||[]},t.monitorStore=new N.default,t.getData(e.pods),t}return(0,c.default)(a,e),(0,i.default)(a,[{key:"componentWillReceiveProps",value:function(e){(0,v.default)(e.pods,this.props.pods)||this.getData(e.pods)}},{key:"getData",value:function(e){var t=this;(0,y.default)(e)||this.monitorStore.fetchMetrics({namespace:this.props.namespace,resources:e.map((function(e){return e.name})),metrics:Object.values(M),last:!0}).then((function(){var a=(0,b.toJS)(t.monitorStore.data);t.setState({pods:e.map((function(e){var t={};return Object.entries(M).forEach((function(n){var l=(0,o.default)(n,2),r=l[0],u=l[1],i=(0,g.default)(a,"".concat(u,".data.result"))||[];t[r]=i.find((function(t){return(0,g.default)(t,"metric.resource_name",(0,g.default)(t,"metric.pod"))===e.name}))})),(0,r.default)({},e,{metrics:t})}))})}))}},{key:"renderMoreMenu",value:function(){var e=this.props,a=e.type,n=e.isGovernor,l=e.onTakeover;return f.default.createElement(_.default,{onClick:this.handleMoreMenuClick},"new"===a&&f.default.createElement(_.default.MenuItem,{key:"edit"},f.default.createElement(S.default,{name:"update",type:"light"})," ",t("Edit Component")),!n&&(0,E.default)(l)&&f.default.createElement(_.default.MenuItem,{key:"takeover"},f.default.createElement(S.default,{name:"linechart",type:"light"})," ",t("Take Over")))}},{key:"render",value:function(){var e=this.props,a=e.data,n=e.type,l=e.isGovernor,r=e.onTakeover,o=e.jobDetail,u=e.maxLength,i=e.workloadType,s=this.state.pods,d="new"!==n&&(l||!(0,E.default)(r)),c={minHeight:40*u+4*(u-1)},m=["Bluegreen","Mirror"].includes(o.type)&&!l;return f.default.createElement("div",{className:P.default.wrapper},f.default.createElement("div",{className:P.default.header},f.default.createElement(S.default,{name:"appcenter",size:40}),f.default.createElement("div",{className:P.default.title},f.default.createElement("div",{className:"h6"},f.default.createElement(h.Link,{to:"/projects/".concat(o.namespace,"/").concat(i,"/").concat(a.name,"-").concat(a.version)},a.name),"  ",f.default.createElement("span",{className:(0,p.default)("ks-tag",{"ks-tag-disable":m})},a.version),m&&f.default.createElement(C.default,{content:"Mirror"===o.type?t("Mirrored traffic is only receiving traffic, no service"):t("The current version is not online, you can let this version take over all traffic and bring it online.")},f.default.createElement("span",{className:"ks-tag ks-tag-disable"},"Mirror"===o.type?t("Mirrored traffic"):t("Not online")))),f.default.createElement("p",null,t("Replicas"),": ",f.default.createElement("strong",null,a.available),"/",a.desire)),!d&&f.default.createElement("div",{className:P.default.right},f.default.createElement(k.default,{className:"dropdown-default",content:this.renderMoreMenu(),trigger:"click",placement:"bottomRight"},f.default.createElement(w.default,{icon:"more",type:"flat"})))),f.default.createElement("ul",{className:P.default.pods,style:c},s.map((function(e){return f.default.createElement(T.default,{data:e,key:e.uid})}))))}}]),a}(f.default.Component);a.default=R,R.propTypes={namespace:m.default.string,data:m.default.object,isGovernor:m.default.bool,showEditModal:m.default.func,onTakeover:m.default.func},R.defaultProps={namespace:"",data:{},isGovernor:!0,maxLength:0,jobDetail:{},showEditModal:function(){}}},3719:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(13)),r=n(a(14)),o=n(a(17)),u=n(a(16)),i=n(a(18)),s=n(a(0)),d=a(226),c=n(a(22)),f=n(a(38)),m=n(a(2579)),p=a(939),h=n(a(2853)),v=function(e){function t(){return(0,l.default)(this,t),(0,o.default)(this,(0,u.default)(t).apply(this,arguments))}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.data,t=e.podStatus.type;return s.default.createElement("li",null,s.default.createElement("div",{className:h.default.icon},s.default.createElement(f.default,{name:"pod",size:24}),s.default.createElement(m.default,{type:t.toLowerCase(),className:h.default.status,flicker:!0})),s.default.createElement(d.Link,{to:"/projects/".concat(e.namespace,"/pods/").concat(e.name)},e.name),s.default.createElement("div",{className:h.default.metric},s.default.createElement(f.default,{name:"memory",size:20}),s.default.createElement("div",null,(0,p.getSuitableValue)((0,c.default)(e,"metrics.memory.value[1]"),"memory"))),s.default.createElement("div",{className:h.default.metric},s.default.createElement(f.default,{name:"cpu",size:20}),s.default.createElement("div",null,(0,p.getSuitableValue)((0,c.default)(e,"metrics.cpu.value[1]"),"cpu"))))}}]),t}(s.default.Component);t.default=v},3720:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(70)),o=l(n(30)),u=l(n(82)),i=l(n(13)),s=l(n(14)),d=l(n(17)),c=l(n(16)),f=l(n(18)),m=l(n(0)),p=l(n(943)),h=l(n(22)),v=l(n(1)),g=l(n(3)),y=n(938),E=n(964),b=l(n(3721)),_=l(n(3722)),S=l(n(2683)),k=function(e){function a(e){var t;return(0,i.default)(this,a),(t=(0,d.default)(this,(0,c.default)(a).call(this,e))).handleTypeChange=function(e){var a=e.currentTarget.dataset.type;t.setState({selectedType:a})},t.state={newMetrics:{},oldMetrics:{},selectedType:"traffic-in"},t.getData(),t}return(0,f.default)(a,e),(0,s.default)(a,[{key:"componentWillReceiveProps",value:function(e){(0,p.default)(e.detail,this.props.detail)||this.getData(e)}},{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval((function(){e.getData()}),1e4)}},{key:"componentWillUnmount",value:function(){this.interval&&clearInterval(this.interval)}},{key:"getData",value:function(e){var t=this,a=(e||this.props).detail;a&&a.namespace&&this.store.fetchMetrics(a,{duration:1800}).then((function(e){var a=(0,u.default)(e,2),n=a[0],l=a[1];t.setState({newMetrics:n,oldMetrics:l})}))}},{key:"render",value:function(){var e=this,t=this.state.selectedType,a="tcp"===this.props.detail.protocol?this.tcpMetrics:this.metrics,n=a.find((function(e){return e.type===t}));return m.default.createElement(y.Columns,null,m.default.createElement(y.Column,{className:"is-narrow"},m.default.createElement("ul",{className:S.default.leftPane},a.map((function(a){return m.default.createElement("li",{key:a.type,className:(0,g.default)((0,o.default)({},S.default.selected,a.type===t)),"data-type":a.type,onClick:e.handleTypeChange},m.default.createElement(b.default,(0,r.default)({},a,{whiteMode:a.type===t})))})))),m.default.createElement(y.Column,null,n&&m.default.createElement(_.default,n)))}},{key:"store",get:function(){return this.props.store}},{key:"metrics",get:function(){var e=this.props.detail;if(!e)return[];var a=this.state,n=a.newMetrics,l=a.oldMetrics,r=[(0,h.default)(n,"metrics.request_count.matrix[0].values",[]),(0,h.default)(l,"metrics.request_count.matrix[0].values",[])],o=[(0,h.default)(n,"metrics.request_error_count.matrix[0].values",[]),(0,h.default)(l,"metrics.request_error_count.matrix[0].values",[])],i=[r[0].map((function(e,t){return(0,E.getSuccessRate)(e,o[0][t])})),r[1].map((function(e,t){return(0,E.getSuccessRate)(e,o[1][t])}))],s=[(0,h.default)(n,'histograms.request_duration["0.95"].matrix[0].values',[]).map((function(e){var t=(0,u.default)(e,2),a=t[0],n=t[1];return[a,parseFloat(n)]})),(0,h.default)(l,'histograms.request_duration["0.95"].matrix[0].values',[]).map((function(e){var t=(0,u.default)(e,2),a=t[0],n=t[1];return[a,parseFloat(n)]}))];return[{type:"traffic-in",title:t("Traffic monitor"),legendData:[e.newVersion,e.oldVersion],data:r,unit:"RPS",tip:t("Traffic of last five minutes")},{type:"request_success_rate",title:t("Request success rate"),legendData:[e.newVersion,e.oldVersion],data:i,unit:"%"},{type:"request_duration",title:t("Request duration"),legendData:[e.newVersion,e.oldVersion],data:s,unit:"ms",tip:t("95% requests duration")}]}},{key:"tcpMetrics",get:function(){var e=this.props.detail;if(!e)return[];var a=this.state,n=a.newMetrics,l=a.oldMetrics,r=[(0,h.default)(n,"metrics.tcp_received.matrix[0].values",[]),(0,h.default)(l,"metrics.tcp_received.matrix[0].values",[])],o=[(0,h.default)(n,"metrics.tcp_sent.matrix[0].values",[]),(0,h.default)(l,"metrics.tcp_sent.matrix[0].values",[])];return[{type:"traffic-in",title:t("TCP - Inbound Traffic"),legendData:[e.newVersion,e.oldVersion],data:r,unit:"B/s",icon:"next"},{type:"traffic-out",title:t("TCP - Outbound Traffic"),legendData:[e.newVersion,e.oldVersion],data:o,unit:"B/s",icon:"previous"}]}}]),a}(m.default.Component);a.default=k,k.propTypes={detail:v.default.object,store:v.default.object}},3721:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(1)),f=l(n(22)),m=l(n(38)),p=l(n(227)),h=n(2522),v=n(939),g=l(n(2683)),y=function(e){function a(){var e,t;(0,r.default)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(t=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(l)))).getSeriesData=function(){var e=t.props,a=e.data,n=e.legendData,l=e.whiteMode,r=a[0]?(0,f.default)(a[0],"[".concat(a[0].length-1,"].[1]"),NaN):NaN,o=a[1]?(0,f.default)(a[1],"[".concat(a[1].length-1,"].[1]"),NaN):NaN;return[{name:n[0],itemStyle:{fill:l?"#ffffff":"#329dce"},value:Number(r)},{name:n[1],itemStyle:{fill:l?"#6fbadc":"#c7deef"},value:Number(o)}]},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"renderTip",value:function(){var e=this.props,t=e.tip,a=e.whiteMode;return d.default.createElement(p.default,{content:t},d.default.createElement(m.default,{name:"information",className:g.default.tip,type:a?"light":"dark"}))}},{key:"render",value:function(){var e=this.props,a=e.title,n=e.tip,l=e.data,r=e.unit,o=l[0]?(0,f.default)(l[0],"[".concat(l[0].length-1,"].[1]"),NaN):NaN,u=l[1]?(0,f.default)(l[1],"[".concat(l[1].length-1,"].[1]"),NaN):NaN;return d.default.createElement("div",{className:g.default.chart},d.default.createElement("div",{className:g.default.circle},d.default.createElement(h.PieChart,{width:40,height:40,data:this.getSeriesData()})),d.default.createElement("div",{className:g.default.chartDetail},d.default.createElement("div",{className:g.default.title},a," ",n&&this.renderTip()),d.default.createElement("div",null,d.default.createElement("span",{className:g.default.tag},isNaN(o)?t("No Data"):"".concat((0,v.getSuitableValue)(o,r)," ").concat(r)),d.default.createElement("span",{className:g.default.tag},isNaN(u)?t("No Data"):"".concat((0,v.getSuitableValue)(u,r)," ").concat(r)))))}}]),a}(d.default.Component);a.default=y,y.propTypes={title:c.default.string,unit:c.default.string,data:c.default.array,legendData:c.default.array,whiteMode:c.default.bool},y.defaultProps={title:"",data:[],legendData:[],whiteMode:!1}},3722:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(37)),r=n(a(63)),o=n(a(13)),u=n(a(14)),i=n(a(17)),s=n(a(16)),d=n(a(18)),c=n(a(0)),f=n(a(1)),m=a(939),p=a(2522),h=n(a(2683)),v=function(e){function t(){return(0,o.default)(this,t),(0,i.default)(this,(0,s.default)(t).apply(this,arguments))}return(0,d.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e=this.props,t=e.data,a=e.legendData,n=(0,r.default)(e,["data","legendData"]),o=(0,l.default)({width:"100%",legend:a,data:t.map((function(e){return{values:e}})),areaColors:["#329dce","#c7deef"]},n);return c.default.createElement("div",{className:h.default.chart},c.default.createElement(p.SimpleArea,(0,m.getAreaChartOps)(o)))}}]),t}(c.default.Component);t.default=v,v.propTypes={title:f.default.string,unit:f.default.string,data:f.default.array,legendData:f.default.array},v.defaultProps={title:"",data:[],legendData:[]}},3723:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(70)),r=n(a(63)),o=n(a(13)),u=n(a(14)),i=n(a(17)),s=n(a(16)),d=n(a(18)),c=n(a(0)),f=n(a(1)),m=n(a(2836)),p=n(a(3724)),h=function(e){function t(){return(0,o.default)(this,t),(0,i.default)(this,(0,s.default)(t).apply(this,arguments))}return(0,d.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e=this.props,t=e.module,a=(0,r.default)(e,["module"]);return c.default.createElement(m.default,(0,l.default)({title:"Edit Component",icon:"components",module:t,forms:this.forms},a))}},{key:"forms",get:function(){return p.default}}]),t}(c.default.Component);t.default=h,h.propTypes={module:f.default.string},h.defaultProps={module:"grayreleases"}},3724:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(3725)),r=n(a(2856)),o=[{icon:"appcenter",name:"grayReleaseComponent",title:"Grayscale Release Component",component:l.default},{icon:"appcenter",name:"grayReleaseStrategy",title:"Grayscale Release Strategy",component:r.default}];t.default=o},3725:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(22)),c=function(e){function a(){var e,n;(0,r.default)(this,a);for(var l=arguments.length,o=new Array(l),s=0;s<l;s++)o[s]=arguments[s];return(n=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(o)))).versionValidator=function(e,a,l){if(!a)return l();if(a===(0,d.default)(n.formTemplate,'metadata.labels["version"]',""))return l();var r=(0,d.default)(n.formTemplate,"metadata.labels.app",""),o="".concat(r,"-").concat(a),u=n.workloadKind;n.workloadStore.checkName({name:o,namespace:n.namespace}).then((function(a){if(a.exist)return l({message:t("".concat(t(u)," ").concat(o," ").concat(t("exists"),", ").concat(t("version number is invalid"))),field:e.field});l()}))},n}return(0,s.default)(a,e),(0,o.default)(a,[{key:"templatePrefix",get:function(){return"workload"}},{key:"isEdit",get:function(){return!0}}]),a}(l(n(2854)).default);a.default=c},3726:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(13)),r=n(a(14)),o=n(a(17)),u=n(a(16)),i=n(a(18)),s=n(a(0)),d=n(a(2667)),c=n(a(3727)),f=n(a(2855)),m=function(e){function t(){return(0,l.default)(this,t),(0,o.default)(this,(0,u.default)(t).apply(this,arguments))}return(0,i.default)(t,e),(0,r.default)(t,[{key:"renderEmpty",value:function(){return null}},{key:"renderContainers",value:function(){var e=this,t=this.props,a=t.value,n=t.disabled;return s.default.createElement("ul",{className:f.default.list},a.map((function(t){return s.default.createElement(c.default,{container:t,key:t.name,onEdit:e.handleEdit,disabled:n})})))}}]),t}(d.default);t.default=m},3727:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(0)),o=l(n(1)),u=l(n(224)),i=l(n(38)),s=n(938),d=l(n(386)),c=l(n(2855)),f=function(e){var a=e.container,n=e.onEdit,l=e.disabled;return r.default.createElement("li",{className:c.default.card},r.default.createElement(i.default,{name:"docker",size:40}),r.default.createElement("div",{className:c.default.text},r.default.createElement("div",{className:"h6"},a.name),r.default.createElement("p",null,t("Image"),": ",a.image)),r.default.createElement("div",{className:c.default.inputs},r.default.createElement(d.default,{defaultValue:a.image,onChange:function(e,t){a.image=t},disabled:l})),!l&&r.default.createElement(s.Buttons,null,n&&r.default.createElement(u.default,{type:"flat",icon:"pen",onClick:function(){return n(a)}})))};f.propTypes={container:o.default.object};var m=f;a.default=m},3728:function(e,t,a){e.exports={narrow:"Version__narrow--3MyIB",specify:"Version__specify--2_94G"}},3729:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(22)),c=l(n(115)),f=l(n(2469)),m=l(n(0)),p=l(n(38)),h=l(n(2455)),v=l(n(2454)),g=l(n(227)),y=l(n(3730)),E=l(n(3732)),b=l(n(3741)),_=function(e){function a(e){var t;(0,r.default)(this,a),(t=(0,u.default)(this,(0,i.default)(a).call(this,e))).initFormTemplate=function(e){var a=t.props.formTemplate,n=(0,d.default)(a,"strategy.spec.template.spec.hosts[0]"),l=(0,d.default)(a,"strategy.spec.principal"),r=(0,d.default)(a,"workload.metadata.labels.version"),o="traffic"===e?[{route:[{destination:{subset:l,host:n}},{destination:{subset:r,host:n}}]}]:[{route:[{destination:{subset:r,host:n},weight:100}]},{route:[{destination:{subset:l,host:n},weight:100}]}];if(t.oldHttpData&&(1===t.oldHttpData.length&&"traffic"===e||2===t.oldHttpData.length&&"content"===e))if("traffic"===e){var u=(0,d.default)(t.oldHttpData,"[0].route",[]),i=u.find((function(e){return(0,d.default)(e,"destination.subset")===l})),s=u.find((function(e){return(0,d.default)(e,"destination.subset")===r}));i&&s&&((0,c.default)(o[0],"route[0].weight",i.weight),(0,c.default)(o[0],"route[1].weight",s.weight))}else{var f=t.oldHttpData.find((function(e){return!!e.match}));(0,c.default)(o[0],"match",f.match)}"tcp"===t.protocol&&o.forEach((function(e){e.match=e.match||[]})),(0,c.default)(t.formTemplate,t.strategyPath,o)},t.handleModeChange=function(e){t.initFormTemplate(e),t.setState({mode:e})};var n=(0,d.default)(t.formTemplate,t.strategyPath,[]);return t.state={mode:n.some((function(e){return!!e.match&&e.match.lenth>0}))?"content":"traffic"},t.oldHttpData=(0,f.default)(n),t.initFormTemplate(t.state.mode),t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"renderContent",value:function(){return"traffic"===this.state.mode?m.default.createElement(y.default,this.props):m.default.createElement(E.default,this.props)}},{key:"render",value:function(){return m.default.createElement("div",{className:b.default.wrapper},m.default.createElement("div",{className:b.default.bar},m.default.createElement(v.default,{wrapClassName:"radio-default",value:this.state.mode,onChange:this.handleModeChange,size:"small"},m.default.createElement(h.default,{value:"traffic"},t("Forward by traffic ratio")),m.default.createElement(h.default,{value:"content",disabled:"http"!==this.protocol},t("Forward by request content"))),this.protocol&&m.default.createElement(g.default,{content:t("Port protocol is not HTTP, cannot publish policy by request content")},m.default.createElement(p.default,{className:b.default.tip,name:"question"}))),m.default.createElement("div",{className:b.default.contentWrapper},this.renderContent()))}},{key:"formTemplate",get:function(){return this.props.formTemplate.strategy}},{key:"protocol",get:function(){return(0,d.default)(this.formTemplate,"spec.protocol","http")}},{key:"strategyPath",get:function(){return"spec.template.spec.".concat(this.protocol)}}]),a}(m.default.Component);a.default=_},3730:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(70)),o=l(n(63)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(22)),m=l(n(115)),p=l(n(130)),h=l(n(0)),v=l(n(267)),g=l(n(2852)),y=l(n(3731)),E=function(e){function a(e){var t;return(0,u.default)(this,a),(t=(0,s.default)(this,(0,d.default)(a).call(this,e))).handleRatioChange=function(e){t.setState({ratio:e},(function(){(0,m.default)(t.oldRoute,"weight",100-e)}))},t.state={ratio:(0,f.default)(t.newRoute,"weight",50)},t}return(0,c.default)(a,e),(0,i.default)(a,[{key:"componentDidMount",value:function(){var e=(0,f.default)(this.oldRoute,"weight"),t=(0,f.default)(this.newRoute,"weight");(0,p.default)(e)&&(0,m.default)(this.oldRoute,"weight",100-this.state.ratio),(0,p.default)(t)&&(0,m.default)(this.newRoute,"weight",this.state.ratio)}},{key:"render",value:function(){var e=this.state.ratio,a=this.props,n=a.formRef,l=(a.formTemplate,(0,o.default)(a,["formRef","formTemplate"])),u=(0,f.default)(this.formTemplate,"spec.template.spec.hosts[0]"),i=(0,f.default)(this.newRoute,"destination.subset"),s=(0,f.default)(this.oldRoute,"destination.subset"),d="".concat(i," ").concat(t("traffic")),c="".concat(s," ").concat(t("traffic"));return h.default.createElement("div",{className:y.default.wrapper},h.default.createElement("div",{className:y.default.item},h.default.createElement("div",{className:y.default.title},t("Rule Description")),h.default.createElement("p",null,t("CANARY_BY_TRAFFIC_DESC",{ratio:e,component:u,newVersion:i}))),h.default.createElement("div",{className:y.default.item},h.default.createElement("div",{className:y.default.title},t("Traffic Ratio")),h.default.createElement(v.default,(0,r.default)({ref:n,data:this.formTemplate},l),h.default.createElement(v.default.Item,null,h.default.createElement(g.default,{name:"".concat(this.strategyPath,"[0].route[1].weight"),min:0,max:100,leftContent:d,rightContent:c,onChange:this.handleRatioChange})))))}},{key:"formTemplate",get:function(){return this.props.formTemplate.strategy}},{key:"strategyPath",get:function(){var e=(0,f.default)(this.formTemplate,"spec.protocol","http");return"spec.template.spec.".concat(e)}},{key:"oldRoute",get:function(){return(0,f.default)(this.formTemplate,"".concat(this.strategyPath,"[0].route[0]"),{})}},{key:"newRoute",get:function(){return(0,f.default)(this.formTemplate,"".concat(this.strategyPath,"[0].route[1]"),{})}}]),a}(h.default.Component);a.default=E},3731:function(e,t,a){e.exports={wrapper:"ByTraffic__wrapper--nETb4",title:"ByTraffic__title--1rwGy",item:"ByTraffic__item--383D6"}},3732:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(70)),o=l(n(63)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(22)),m=l(n(58)),p=l(n(566)),h=l(n(0)),v=l(n(267)),g=n(114),y=l(n(3733)),E=l(n(3735)),b=l(n(3737)),_=l(n(3740)),S=function(e){function a(){var e,t;(0,u.default)(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(t=(0,s.default)(this,(e=(0,d.default)(a)).call.apply(e,[this].concat(l)))).handleCookieChange=function(e){t.setState({cookie:e})},t.handleFormChange=function(e,a){e==="".concat(t.prefix,".match[0].headers.cookie")?(0,m.default)(Object.values(a)[0])&&(0,p.default)(t.formTemplate,e):e==="".concat(t.prefix,".match[0].headers")?(0,m.default)(Object.keys(a)[0])&&(0,p.default)(t.formTemplate,e):e==="".concat(t.prefix,".match[0].uri")?(0,m.default)(Object.values(a)[0])&&(0,p.default)(t.formTemplate,e):e==="".concat(t.prefix,".match[0].headers['User-Agent'].regex")&&(0,m.default)(a)&&(0,p.default)(t.formTemplate,"".concat(t.prefix,".match[0].headers['User-Agent']"))},t}return(0,c.default)(a,e),(0,i.default)(a,[{key:"render",value:function(){var e=this.props,a=e.formRef,n=(e.formTemplate,(0,o.default)(e,["formRef","formTemplate"]));return h.default.createElement("div",{className:_.default.wrapper},h.default.createElement("div",{className:_.default.item},h.default.createElement("div",{className:_.default.title},t("Rule Description")),h.default.createElement("p",null,t("GRAY_RELEASE_BY_CONTENT_TIP"))),h.default.createElement("div",{className:_.default.item},h.default.createElement("div",{className:_.default.title},t("Grayscale release version access rule")),h.default.createElement(v.default,(0,r.default)({ref:a,data:this.formTemplate,onChange:this.handleFormChange},n),h.default.createElement(v.default.Item,{label:t("Cookie")},h.default.createElement(y.default,{name:"".concat(this.prefix,".match[0].headers.cookie"),onChange:this.handleCookieChange,placeholder:"key=value"})),h.default.createElement(v.default.Item,{label:t("Custom Header")},h.default.createElement(E.default,{name:"".concat(this.prefix,".match[0].headers")})),h.default.createElement(v.default.Item,{label:t("URI")},h.default.createElement(y.default,{name:"".concat(this.prefix,".match[0].uri"),placeholder:"URI",matchTypes:["prefix","regex"]})),h.default.createElement(v.default.Item,{label:t("Traffic comes from the following operating systems")},h.default.createElement(b.default,{name:"".concat(this.prefix,".match[0].headers['User-Agent'].regex"),options:g.GRAY_RELEASE_CANARY_CONTENT})))))}},{key:"formTemplate",get:function(){return this.props.formTemplate.strategy}},{key:"prefix",get:function(){var e=(0,f.default)(this.formTemplate,"spec.protocol","http");return"spec.template.spec.".concat(e,"[0]")}}]),a}(h.default.Component);a.default=S},3733:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(30)),o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=l(n(1)),m=l(n(268)),p=l(n(225)),h=l(n(386)),v=n(938),g=l(n(3734)),y=function(e){function a(e){var t;return(0,o.default)(this,a),(t=(0,i.default)(this,(0,s.default)(a).call(this,e))).triggerChange=(0,m.default)((function(){var e=t.state,a=e.match,n=e.value,l=t.props.onChange;a&&l((0,r.default)({},a,n||""))}),200),t.handleMatchChange=function(e){t.setState({match:e},(function(){t.triggerChange()}))},t.handleValueChange=function(e,a){t.setState({value:a},(function(){t.triggerChange()}))},t.state={match:Object.keys(e.value)[0]||t.matchTypes[0].value,value:Object.values(e.value)[0]||""},t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"componentWillReceiveProps",value:function(e){var t=Object.keys(e.value)[0],a=Object.values(e.value)[0];t===this.state.match&&a===this.state.value||this.setState({match:t,value:a})}},{key:"render",value:function(){var e=this.state,t=e.match,a=e.value;return c.default.createElement(v.Group,{className:g.default.match},c.default.createElement(p.default,{value:t,options:this.matchTypes,onChange:this.handleMatchChange}),c.default.createElement(h.default,{value:a,placeholder:this.props.placeholder||"key=value",onChange:this.handleValueChange}))}},{key:"matchTypes",get:function(){var e=this.props.matchTypes;return[{label:t("Exact Match"),value:"exact"},{label:t("Prefix Match"),value:"prefix"},{label:t("Regex Match"),value:"regex"}].filter((function(t){var a=t.value;return e.includes(a)}))}}]),a}(c.default.Component);a.default=y,y.propTypes={value:f.default.object,onChange:f.default.func,matchTypes:f.default.array},y.defaultProps={value:{},onChange:function(){},matchTypes:["exact","regex"]}},3734:function(e,t,a){e.exports={match:"CookieMatch__match--1Nxal"}},3735:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(30)),o=l(n(37)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(0)),m=l(n(1)),p=l(n(268)),h=l(n(2466)),v=l(n(225)),g=l(n(386)),y=n(938),E=l(n(3736)),b=["cookie","User-Agent"],_=function(e){function a(e){var t;return(0,u.default)(this,a),(t=(0,s.default)(this,(0,d.default)(a).call(this,e))).triggerChange=(0,p.default)((function(){var e=t.state,a=e.match,n=e.key,l=e.value,u=t.props,i=u.onChange,s=u.value;i((0,o.default)((0,r.default)({},n,(0,r.default)({},a,l)),(0,h.default)(s,b)))}),200),t.handleMatchChange=function(e){t.setState({match:e},(function(){t.triggerChange()}))},t.handleKeyChange=function(e,a){t.setState({key:a},(function(){t.triggerChange()}))},t.handleValueChange=function(e,a){t.setState({value:a},(function(){t.triggerChange()}))},t.state=t.getStateFromProps(e),t}return(0,c.default)(a,e),(0,i.default)(a,[{key:"componentWillReceiveProps",value:function(e){var t=this.getStateFromProps(e);if(t.key!==this.state.key||t.match!==this.state.match||t.value!==this.state.value)return this.setState(t)}},{key:"getStateFromProps",value:function(e){var t=Object.keys(e.value).filter((function(e){return!b.includes(e)}))[0];return{key:t,match:(t?Object.keys(e.value[t])[0]:"exact")||"exact",value:(t?Object.values(e.value[t])[0]:"")||""}}},{key:"render",value:function(){var e=this.state,t=e.match,a=e.key,n=e.value;return f.default.createElement(y.Group,{className:E.default.match},f.default.createElement(v.default,{value:t,defaultValue:"exact",options:this.matchTypes,onChange:this.handleMatchChange}),f.default.createElement(g.default,{value:a,placeholder:"key",onChange:this.handleKeyChange}),f.default.createElement(g.default,{value:n,placeholder:"value",onChange:this.handleValueChange}))}},{key:"matchTypes",get:function(){return[{label:t("Exact Match"),value:"exact"},{label:t("Regex Match"),value:"regex"}]}}]),a}(f.default.Component);a.default=_,_.propTypes={value:m.default.object,onChange:m.default.func},_.defaultProps={value:{},onChange:function(){}}},3736:function(e,t,a){e.exports={match:"HeaderMatch__match--38Cti"}},3737:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(70)),r=n(a(13)),o=n(a(14)),u=n(a(17)),i=n(a(16)),s=n(a(18)),d=n(a(0)),c=n(a(3738)),f=n(a(58)),m=function(e){function t(){var e,a;(0,r.default)(this,t);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(a=(0,u.default)(this,(e=(0,i.default)(t)).call.apply(e,[this].concat(l)))).getValueFromProps=function(e){return e.value?e.value.slice(2,e.value.length-2).split("|"):[]},a.handleChange=function(e){var t=a.props.onChange;(0,f.default)(e)?t&&t(""):t&&t(".*".concat(e.join("|"),".*"))},a}return(0,s.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){var e=this.getValueFromProps(this.props);return d.default.createElement(c.default,(0,l.default)({},this.props,{value:e,onChange:this.handleChange}))}}]),t}(d.default.Component);t.default=m},3738:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(30)),r=n(a(97)),o=n(a(13)),u=n(a(14)),i=n(a(17)),s=n(a(16)),d=n(a(18)),c=n(a(0)),f=n(a(1)),m=n(a(3)),p=n(a(38)),h=n(a(3739)),v=function(e){function t(){var e,a;(0,o.default)(this,t);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(a=(0,i.default)(this,(e=(0,s.default)(t)).call.apply(e,[this].concat(l)))).handleClick=function(e){var t=e.currentTarget.dataset.value,n=a.props,l=n.value,o=n.onChange;l.includes(t)?o(l.filter((function(e){return e!==t}))):o([].concat((0,r.default)(l),[t]))},a}return(0,d.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.options,n=t.value;return c.default.createElement("ul",{className:h.default.wrapper},a.map((function(t){return c.default.createElement("li",{className:(0,m.default)((0,l.default)({},h.default.select,n.includes(t.value))),key:t.value,"data-value":t.value,onClick:e.handleClick},t.icon&&c.default.createElement(p.default,{name:t.icon,size:24}),t.label)})))}}]),t}(c.default.Component);t.default=v,v.propTypes={options:f.default.array,value:f.default.array,onChange:f.default.func},v.defaultProps={options:[],value:[],onChange:function(){}}},3739:function(e,t,a){e.exports={wrapper:"BoxSelect__wrapper--3RvD5",select:"BoxSelect__select--1aQ7C"}},3740:function(e,t,a){e.exports={wrapper:"ByContent__wrapper--1aRge",title:"ByContent__title--3z2kL",item:"ByContent__item--dfPze"}},3741:function(e,t,a){e.exports={wrapper:"Canary__wrapper---dBWX",bar:"Canary__bar--1sECN",contentWrapper:"Canary__contentWrapper--3b2bE",tip:"Canary__tip--2hEEn"}},3742:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(70)),o=l(n(63)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(0)),m=l(n(22)),p=l(n(115)),h=l(n(58)),v=l(n(267)),g=l(n(3743)),y=l(n(3745)),E=function(e){function a(){var e,t;(0,u.default)(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(t=(0,s.default)(this,(e=(0,d.default)(a)).call.apply(e,[this].concat(l)))).state={versions:[]},t.handleVersionChange=function(e){(0,m.default)(t.formTemplate,"spec.principal")===e?((0,p.default)(t.formTemplate,"".concat(t.strategyPath,"[0].route[0].weight"),100),(0,p.default)(t.formTemplate,"".concat(t.strategyPath,"[0].route[1].weight"),0)):((0,p.default)(t.formTemplate,"".concat(t.strategyPath,"[0].route[0].weight"),0),(0,p.default)(t.formTemplate,"".concat(t.strategyPath,"[0].route[1].weight"),100))},t}return(0,c.default)(a,e),(0,i.default)(a,[{key:"componentDidMount",value:function(){var e=this.props.formTemplate,t=(0,m.default)(e,"strategy.spec.template.spec.hosts[0]"),a=(0,m.default)(e,"strategy.spec.principal"),n=(0,m.default)(e,"workload.metadata.labels.version"),l=(0,m.default)(e,"workload.spec.replicas"),r=(0,m.default)(e,'strategy.metadata.annotations["servicemesh.kubesphere.io/workloadReplicas"]',0),o=[{route:[{destination:{subset:a,host:t},weight:100},{destination:{subset:n,host:t},weight:0}]}];"tcp"===this.protocol&&o.forEach((function(e){e.match=e.match||[]})),(0,h.default)((0,m.default)(this.formTemplate,"spec.governor"))&&(0,p.default)(this.formTemplate,"spec.governor",a),(0,h.default)((0,m.default)(this.formTemplate,this.strategyPath))&&(0,p.default)(this.formTemplate,this.strategyPath,o),this.setState({versions:[{name:a,replicas:r},{name:n,replicas:l}]})}},{key:"render",value:function(){var e=this.props,a=e.formRef,n=(e.formTemplate,(0,o.default)(e,["formRef","formTemplate"]));return f.default.createElement("div",{className:y.default.wrapper},f.default.createElement("div",{className:y.default.item},f.default.createElement("div",{className:y.default.title},t("Rule Description")),f.default.createElement("p",null,t("two versions"))),f.default.createElement("div",{className:y.default.item},f.default.createElement("div",{className:y.default.title},t("Traffic Rules")),f.default.createElement(v.default,(0,r.default)({ref:a,data:this.formTemplate},n),f.default.createElement(v.default.Item,null,f.default.createElement(g.default,{name:"spec.governor",options:this.state.versions,onChange:this.handleVersionChange})))))}},{key:"formTemplate",get:function(){return this.props.formTemplate.strategy}},{key:"protocol",get:function(){return(0,m.default)(this.formTemplate,"spec.protocol","http")}},{key:"strategyPath",get:function(){return"spec.template.spec.".concat(this.protocol)}}]),a}(f.default.Component);a.default=E},3743:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(30)),o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=l(n(1)),m=l(n(3)),p=l(n(38)),h=l(n(224)),v=l(n(3744)),g=function(e){function a(){var e,t;(0,o.default)(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(t=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(l)))).handleTakeOver=function(e){t.props.onChange(e.currentTarget.dataset.version)},t.handleOffline=function(e){var a=t.props,n=a.onChange,l=a.options,r=e.currentTarget.dataset.version,o=l.find((function(e){return e.name!==r}));o&&n(o.name)},t}return(0,d.default)(a,e),(0,u.default)(a,[{key:"render",value:function(){var e=this,a=this.props,n=a.value,l=a.options;return c.default.createElement("ul",{className:v.default.wrapper},l.map((function(a){return c.default.createElement("li",{key:a.name,className:(0,m.default)((0,r.default)({},v.default.selected,n===a.name))},c.default.createElement(p.default,{name:"appcenter",size:40}),c.default.createElement("div",{className:v.default.text},c.default.createElement("p",null,"".concat(t("Version"),": ").concat(a.name)),c.default.createElement("p",null,"".concat(t("Replicas"),": ").concat(a.replicas))),n!==a.name?c.default.createElement(h.default,{className:v.default.button,type:"control","data-version":a.name,onClick:e.handleTakeOver},t("Take over all traffic")):c.default.createElement(h.default,{className:v.default.button,"data-version":a.name,noShadow:!0,onClick:e.handleOffline},t("Offline this version")))})))}}]),a}(c.default.Component);a.default=g,g.propTypes={value:f.default.string,options:f.default.array,onChange:f.default.func},g.defaultProps={value:"",options:[],onChange:function(){}}},3744:function(e,t,a){e.exports={wrapper:"VersionSelect__wrapper--3Xscn",selected:"VersionSelect__selected--pu6Il",text:"VersionSelect__text--3EXmN",button:"VersionSelect__button--1Y__c"}},3745:function(e,t,a){e.exports={wrapper:"Bluegreen__wrapper--fPQ8T",title:"Bluegreen__title--65t8-",item:"Bluegreen__item--hyg1h"}},3746:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(22)),f=l(n(115)),m=l(n(58)),p=l(n(942)),h=l(n(267)),v=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"componentDidMount",value:function(){var e=this.props.formTemplate,t=(0,c.default)(e,"strategy.spec.template.spec.hosts[0]"),a=[{route:[{destination:{subset:(0,c.default)(e,"strategy.spec.principal"),host:t},weight:100}],mirror:{host:t,subset:(0,c.default)(e,"workload.metadata.labels.version")}}];"tcp"===this.protocol&&a.forEach((function(e){e.match=e.match||[]})),(0,m.default)((0,c.default)(this.formTemplate,this.strategyPath))&&(0,f.default)(this.formTemplate,this.strategyPath,a)}},{key:"render",value:function(){var e=this.props,a=e.formRef,n=e.formTemplate;return d.default.createElement(h.default,{ref:a,data:n},d.default.createElement(p.default,{type:"info",message:t.html("MIRROR_POLICY_DESC")}))}},{key:"formTemplate",get:function(){return this.props.formTemplate.strategy}},{key:"protocol",get:function(){return(0,c.default)(this.formTemplate,"spec.protocol","http")}},{key:"strategyPath",get:function(){return"spec.template.spec.".concat(this.protocol)}}]),a}(d.default.Component);a.default=v},3747:function(e,t,a){e.exports={modal:"GrayReleaseDetail__modal--1YO6q",header:"GrayReleaseDetail__header--2vVO-",body:"GrayReleaseDetail__body--2vJZE",title:"GrayReleaseDetail__title--31-lg",text:"GrayReleaseDetail__text--89vaF",wrapper:"GrayReleaseDetail__wrapper--3rzjt",loading:"GrayReleaseDetail__loading--lwBci",sectionTitle:"GrayReleaseDetail__sectionTitle--3k9Gd",matchWrapper:"GrayReleaseDetail__matchWrapper--1pNGh",matchArrow:"GrayReleaseDetail__matchArrow--3ruGe",matchVersion:"GrayReleaseDetail__matchVersion--Q1Eqk",governor:"GrayReleaseDetail__governor--2MPS2",barWrapper:"GrayReleaseDetail__barWrapper--2NHJd",bar:"GrayReleaseDetail__bar--1V8kz",mirrorBar:"GrayReleaseDetail__mirrorBar--pK-Em",mirror:"GrayReleaseDetail__mirror--2r0HB",mirrorIcon:"GrayReleaseDetail__mirrorIcon--25PLS",revertMirrorIcon:"GrayReleaseDetail__revertMirrorIcon--LxkxC",monitor:"GrayReleaseDetail__monitor--1DCVu"}},3748:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(70)),o=l(n(82)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(22)),m=l(n(0)),p=l(n(943)),h=l(n(38)),v=n(964),g=n(114),y=l(n(3749)),E=l(n(2684)),b=function(e){function a(e){var t;return(0,u.default)(this,a),(t=(0,s.default)(this,(0,d.default)(a).call(this,e))).handleClick=function(){var e=t.props,a=e.data;(0,e.onClick)(a)},t.state={newMetrics:{},oldMetrics:{},newHealth:{},oldHealth:{}},t}return(0,c.default)(a,e),(0,i.default)(a,[{key:"componentDidMount",value:function(){this.getData()}},{key:"componentWillUnmount",value:function(){this.unmount=!0}},{key:"componentWillReceiveProps",value:function(e){(0,p.default)(e.data,this.props.data)||this.getData(e)}},{key:"getData",value:function(e){var t=this,a=(e||this.props).data;this.store.fetchMetrics(a).then((function(e){var a=(0,o.default)(e,2),n=a[0],l=a[1];t.unmount||t.setState({newMetrics:n,oldMetrics:l})})),this.store.fetchHealth(a).then((function(e){var a=(0,o.default)(e,2),n=a[0],l=a[1];t.unmount||t.setState({newHealth:n,oldHealth:l})}))}},{key:"render",value:function(){var e=this.props.data,a=this.state,n=a.newHealth,l=a.oldHealth,o=g.GRAY_RELEASE_CATEGORIES.find((function(t){return t.type===e.type}))||{},u="tcp"===e.protocol?this.tcpMetrics:this.metrics;return m.default.createElement("div",{className:E.default.item,onClick:this.handleClick},m.default.createElement("div",{className:E.default.left},m.default.createElement("div",{className:E.default.icon},m.default.createElement("img",{src:(0,f.default)(e,'annotations["app.kubernetes.io/icon"]',"/assets/default-app.svg"),alt:""}),m.default.createElement("div",{className:E.default.iconExtra},m.default.createElement(h.default,{name:o.icon,size:24,type:"light"}))),m.default.createElement("div",{className:E.default.title},m.default.createElement("div",{className:"h5"},e.name),m.default.createElement("p",null,m.default.createElement("span",null,t("Application")),":"," ",(0,f.default)(e,'labels["app.kubernetes.io/name"]')),m.default.createElement("p",null,m.default.createElement("span",null,t("GRAY_RELEASE_CATEGORIES")),": ",t(o.title)),m.default.createElement("p",null,m.default.createElement("span",null,t("Grayscale Release Component")),": ",e.hosts))),m.default.createElement("div",{className:E.default.right},m.default.createElement("div",{className:E.default.versions},m.default.createElement("p",null,m.default.createElement("strong",null,t("Version Compare"))),m.default.createElement("p",{className:E.default.tag},e.newVersion," ",m.default.createElement("span",null,"(",t("Replicas"),": ",(0,f.default)(n,"workloadStatus.available"),"/",(0,f.default)(n,"workloadStatus.replicas"),")")),m.default.createElement("p",{className:E.default.tag},e.oldVersion," ",m.default.createElement("span",null,"(",t("Replicas"),": ",(0,f.default)(l,"workloadStatus.available"),"/",(0,f.default)(l,"workloadStatus.replicas"),")"))),u.map((function(e){return m.default.createElement(y.default,(0,r.default)({key:e.type},e))}))))}},{key:"store",get:function(){return this.props.store}},{key:"metrics",get:function(){var e=this.props.data;if(!e)return[];var a=this.state,n=a.newMetrics,l=a.oldMetrics,r=[(0,v.getMetricData)((0,f.default)(n,"metrics.request_count.matrix[0].values",[]),0),(0,v.getMetricData)((0,f.default)(l,"metrics.request_count.matrix[0].values",[]),0)],o=[(0,v.getMetricData)((0,f.default)(n,"metrics.request_error_count.matrix[0].values",[]),0),(0,v.getMetricData)((0,f.default)(l,"metrics.request_error_count.matrix[0].values",[]),0)],u=[r[0]>0?Number((100*(r[0]-o[0])/r[0]).toFixed(2)):NaN,r[1]>0?Number((100*(r[1]-o[1])/r[1]).toFixed(2)):NaN],i=[1e3*(0,v.getMetricData)((0,f.default)(n,'histograms.request_duration["0.95"].matrix[0].values',[]),NaN),1e3*(0,v.getMetricData)((0,f.default)(l,'histograms.request_duration["0.95"].matrix[0].values',[]),NaN)];return[{type:"traffic",name:t("Traffic monitor"),legendData:[e.newVersion,e.oldVersion],data:r,unit:"RPS",icon:"changing-over",tip:t("Traffic of last five minutes")},{type:"request_success_rate",name:t("Request success rate"),legendData:[e.newVersion,e.oldVersion],data:u,icon:"check",unit:"%"},{type:"request_duration",name:t("Request duration"),legendData:[e.newVersion,e.oldVersion],data:i,icon:"timed-task",unit:"ms",tip:t("95% requests duration")}]}},{key:"tcpMetrics",get:function(){var e=this.props.data;if(!e)return[];var a=this.state,n=a.newMetrics,l=a.oldMetrics,r=[(0,v.getMetricData)((0,f.default)(n,"metrics.tcp_received.matrix[0].values",[]),0),(0,v.getMetricData)((0,f.default)(l,"metrics.tcp_received.matrix[0].values",[]),0)],o=[(0,v.getMetricData)((0,f.default)(n,"metrics.tcp_sent.matrix[0].values",[]),0),(0,v.getMetricData)((0,f.default)(l,"metrics.tcp_sent.matrix[0].values",[]),0)];return[{type:"traffic-in",name:t("TCP - Inbound Traffic"),legendData:[e.newVersion,e.oldVersion],data:r,unit:"B/s",icon:"next"},{type:"traffic-out",name:t("TCP - Outbound Traffic"),legendData:[e.newVersion,e.oldVersion],data:o,unit:"B/s",icon:"previous"}]}}]),a}(m.default.Component);a.default=b},3749:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(1)),f=l(n(38)),m=l(n(227)),p=n(2522),h=l(n(2684)),v=function(e){function a(){var e,t;(0,r.default)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(t=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(l)))).getSeriesData=function(){var e=t.props,a=e.data,n=e.legendData;return[{name:n[0],itemStyle:{fill:"#329dce"},value:a[0]||0},{name:n[1],itemStyle:{fill:"#c7deef"},value:a[1]||0}]},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"renderTip",value:function(){var e=this.props.tip;return d.default.createElement(m.default,{content:e},d.default.createElement(f.default,{name:"information",className:h.default.tip}))}},{key:"render",value:function(){var e=this.props,a=e.name,n=e.icon,l=e.data,r=e.unit,o=e.tip;return d.default.createElement("div",{className:h.default.chart},d.default.createElement("div",{className:h.default.circle},d.default.createElement(f.default,{name:n,size:20}),d.default.createElement(p.PieChart,{width:60,height:60,data:this.getSeriesData()})),d.default.createElement("div",{className:h.default.chartDetail},d.default.createElement("div",null,a," ",o&&this.renderTip()),d.default.createElement("p",{className:h.default.tag},isNaN(l[0])?t("No Data"):"".concat(l[0]," ").concat(r)),d.default.createElement("p",{className:h.default.tag},isNaN(l[1])?t("No Data"):"".concat(l[1]," ").concat(r))))}}]),a}(d.default.Component);a.default=v,v.propTypes={name:c.default.string,tip:c.default.string,unit:c.default.string,data:c.default.array,legendData:c.default.array},v.defaultProps={name:"",data:[],legendData:[]}},3750:function(e,t,a){e.exports={header:"GrayRelease__header--1geoR",headerTip:"GrayRelease__headerTip--1_CmP"}},3751:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(37)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(58)),m=l(n(0)),p=n(19),h=n(60),v=n(565),g=n(49),y=l(n(225)),E=l(n(224)),b=l(n(3752)),_=l(n(3754)),S=l(n(3763)),k=l(n(3765)),C=(0,h.observer)(r=function(e){function a(e){var t;(0,u.default)(this,a),(t=(0,s.default)(this,(0,d.default)(a).call(this,e))).fetchTracing=function(){var e=(0,p.toJS)(t.detailStore.detail).namespace,a=(0,o.default)({namespace:e,service:t.state.serviceName},t.state.query);t.detailStore.fetchTracing(a)},t.showDetailModal=function(e){t.setState({showDetailModal:!0,selectItem:e})},t.hideDetailModal=function(){t.setState({showDetailModal:!1,selectItem:{}})},t.handleServiceChange=function(e){t.setState({serviceName:e.name},(function(){t.fetchTracing()}))},t.handleRefresh=function(){t.fetchTracing()},t.handleLookbackChange=function(e){t.setState((function(t){var a=t.query;return{query:(0,o.default)({},a,{lookback:e})}}),(function(){return t.fetchTracing()}))},t.handleLimitChange=function(e){t.setState((function(t){var a=t.query;return{query:(0,o.default)({},a,{limit:e})}}),(function(){return t.fetchTracing()}))},t.detailStore=e.detailStore;var n=(0,v.parse)(location.search.slice(1));return t.state={showDetailModal:!1,selectItem:{},serviceName:"",query:{lookback:"1h",limit:5},defaultService:n.service},t}return(0,c.default)(a,e),(0,i.default)(a,[{key:"componentDidMount",value:function(){var e=this;this.disposer=(0,p.when)((function(){return!(0,f.default)(e.detailStore.detail)}),(function(){return e.getData()}))}},{key:"componentWillUnmount",value:function(){this.disposer&&this.disposer()}},{key:"getData",value:function(){var e=this,t=(0,p.toJS)(this.detailStore.detail),a=t.selector,n=t.namespace;if(a){var l={namespace:n,labelSelector:(0,g.joinSelector)(a)};this.detailStore.serviceStore.fetchListByK8s(l).then((function(){var t=(0,p.toJS)(e.detailStore.serviceStore.list.data);t.length>0&&e.setState({serviceName:t[0].name},(function(){return e.fetchTracing()}))}))}}},{key:"renderServices",value:function(){var e=this.detailStore.serviceStore.list,t=e.isLoading,a=e.data;return m.default.createElement(S.default,{defaultService:this.state.defaultService,options:a,isLoading:t,onChange:this.handleServiceChange})}},{key:"renderOperations",value:function(){var e=this.state.query;return m.default.createElement("div",{className:k.default.operations},m.default.createElement(y.default,{value:e.lookback,options:this.lookbackOptions,onChange:this.handleLookbackChange}),m.default.createElement(y.default,{value:e.limit,options:this.limitOptions,onChange:this.handleLimitChange}),m.default.createElement(E.default,{type:"flat",icon:"refresh",onClick:this.handleRefresh}))}},{key:"renderTracing",value:function(){var e=this.detailStore,t=e.tracing,a=e.isTracingLoading,n=this.detailStore.serviceStore.list,l=n.isLoading,r=n.data;return!l&&(0,f.default)(r)?null:m.default.createElement(b.default,{loading:a,data:t.data,operations:this.renderOperations(),onItemClick:this.showDetailModal})}},{key:"render",value:function(){return m.default.createElement("div",null,this.renderServices(),this.renderTracing(),m.default.createElement(_.default,{detail:this.state.selectItem,visible:this.state.showDetailModal,onCancel:this.hideDetailModal}))}},{key:"limitOptions",get:function(){return[{label:t("Last {num} records",{num:5}),value:5},{label:t("Last {num} records",{num:10}),value:10},{label:t("Last {num} records",{num:20}),value:20},{label:t("Last {num} records",{num:50}),value:50}]}},{key:"lookbackOptions",get:function(){return[{label:t("Last {hour} hour",{hour:1}),value:"1h"},{label:t("Last {hour} hours",{hour:2}),value:"2h"},{label:t("Last {hour} hours",{hour:3}),value:"3h"},{label:t("Last {hour} hours",{hour:6}),value:"6h"},{label:t("Last {hour} hours",{hour:12}),value:"12h"},{label:t("Last {hour} hours",{hour:24}),value:"24h"},{label:t("Last {day} days",{day:2}),value:"2d"}]}}]),a}(m.default.Component))||r;a.default=C},3752:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(1)),f=l(n(58)),m=l(n(38)),p=l(n(2516)),h=l(n(3753)),v=l(n(2857)),g=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"shouldComponentUpdate",value:function(e){return e.loading!==this.props.loading}},{key:"renderContent",value:function(){var e=this.props,t=e.data,a=e.onItemClick;return(0,f.default)(t)?null:d.default.createElement("div",{className:v.default.cardContent},t.map((function(e){return d.default.createElement(h.default,{key:e.traceID,detail:e,onClick:a})})))}},{key:"renderEmpty",value:function(){return d.default.createElement("div",{className:v.default.empty},d.default.createElement("div",null,d.default.createElement("div",{className:v.default.icon},d.default.createElement(m.default,{name:"target",size:40})),d.default.createElement("p",null,d.default.createElement("strong",null,t("No result found"))),d.default.createElement("p",null,t("Please try other query conditions"))))}},{key:"renderHeader",value:function(){var e=this.props.operations;return d.default.createElement("div",{className:v.default.cardHeader},e&&d.default.createElement("div",{className:v.default.operations},e),t("Tracing"))}},{key:"render",value:function(){var e=this.props.loading;return d.default.createElement(p.default,{className:v.default.tracing,header:this.renderHeader(),empty:this.renderEmpty(),loading:e},this.renderContent())}}]),a}(d.default.Component);a.default=g,g.propTypes={className:c.default.string,data:c.default.array,loading:c.default.bool,operations:c.default.oneOfType([c.default.string,c.default.element,c.default.node]),onItemClick:c.default.func},g.defaultProps={prefix:"",data:[],onItemClick:function(){},loading:!1}},3753:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(13)),r=n(a(14)),o=n(a(17)),u=n(a(16)),i=n(a(18)),s=n(a(966)),d=n(a(0)),c=n(a(1)),f=n(a(3)),m=a(49),p=a(2573),h=n(a(38)),v=n(a(2857)),g=function(e){var t=e.key,a=e.value;return"error"===t&&(!0===a||"true"===a)},y=function(e){function t(){var e,a;(0,l.default)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=(0,o.default)(this,(e=(0,u.default)(t)).call.apply(e,[this].concat(r)))).handleClick=function(){var e=a.props;(0,e.onClick)(e.detail)},a}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props,t=e.className,a=e.detail;if(!a)return null;var n=a.duration,l=a.durationPercent,r=a.services,o=a.startTime,u=a.spans,i=a.traceName,c=a.serviceColorMap,y=(0,m.getLocalTime)(o/1e3),E=y.format("HH:mm:ss"),b=y.fromNow(),_=u.length,S=u.filter((function(e){return e.tags.some(g)})).length;return d.default.createElement("div",{className:(0,f.default)(v.default.item,t),onClick:this.handleClick},d.default.createElement("div",{className:v.default.header},d.default.createElement("div",{className:v.default.title},i),d.default.createElement("div",{className:v.default.duration},d.default.createElement(h.default,{name:"timed-task"}),"".concat(n/1e3," ms")),d.default.createElement("div",{className:v.default.durationBar,style:{width:"".concat(l,"%"),borderTopRightRadius:100===l?4:0}})),d.default.createElement("div",{className:v.default.content},d.default.createElement("div",{className:v.default.spanWrapper},d.default.createElement("div",{className:v.default.spans},_," Span",_>1&&"s"),S>0&&d.default.createElement("div",{className:v.default.errorSpans},S," Error",S>1&&"s")),d.default.createElement("ul",{className:v.default.services},(0,s.default)(r,"name").map((function(e){return d.default.createElement("li",{key:e.name},d.default.createElement("span",{className:v.default.tag,style:{backgroundColor:c[e.name]}}),"".concat(e.name,"(").concat(e.numberOfSpans,")"))}))),d.default.createElement("div",{className:v.default.startTime},d.default.createElement("p",null,(0,p.formatRelativeDate)(o/1e3),"  |  ",d.default.createElement("strong",null,E)),d.default.createElement("p",null,b))))}}]),t}(d.default.Component);t.default=y,y.propTypes={className:c.default.string,onClick:c.default.func,detail:c.default.object,durationPercent:c.default.number},y.defaultProps={onClick:function(){},durationPercent:0,detail:{}}},3754:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(58)),c=l(n(0)),f=l(n(1)),m=l(n(38)),p=n(938),h=l(n(943)),v=l(n(387)),g=n(49),y=n(2573),E=l(n(3755)),b=l(n(3757)),_=l(n(3759)),S=l(n(3762)),k=function(e){function a(e){var t;return(0,r.default)(this,a),(t=(0,u.default)(this,(0,i.default)(a).call(this,e))).handleMouseDown=function(e){e.offsetY<4&&(t.originPos=e.y,document.addEventListener("mousemove",t.handleResize,!1))},t.handleMouseUp=function(){document.removeEventListener("mousemove",t.handleResize,!1)},t.handleResize=function(e){var a=t.originPos-e.y;t.originPos=e.y;var n=t.detailPane.current,l=parseInt(getComputedStyle(n.parentNode,"").height,10),r=parseInt(getComputedStyle(n,"").height,10);r+a<l-83&&(n.style.height="".concat(r+a,"px"),t.listPane&&t.listPane.current&&(t.listPane.current.style.bottom="".concat(r+a,"px")))},t.handleSpanClick=function(e){t.setState({selectSpan:e})},t.hideSpanDetail=function(){t.setState({selectSpan:{}})},t.handleRangeChange=function(e){t.getViewedBounds=(0,y.createViewedBoundsFunc)({min:t.props.detail.startTime,max:t.props.detail.endTime,viewStart:e.viewStart,viewEnd:e.viewEnd}),t.setState(e)},t.state={selectSpan:{},viewStart:0,viewEnd:1},t.getViewedBounds=(0,y.createViewedBoundsFunc)({min:e.detail.startTime,max:e.detail.endTime,viewStart:0,viewEnd:1}),t.listPane=c.default.createRef(),t.detailPane=c.default.createRef(),t.originPos=0,t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"componentWillReceiveProps",value:function(e){(0,h.default)(e.detail,this.props.detail)||(this.getViewedBounds=(0,y.createViewedBoundsFunc)({min:e.detail.startTime,max:e.detail.endTime,viewStart:0,viewEnd:1}),this.setState({selectSpan:{},viewStart:0,viewEnd:1}))}},{key:"componentDidUpdate",value:function(e,t){this.detailPane&&this.detailPane.current&&(!(0,d.default)(this.state.selectSpan)&&(0,d.default)(t.selectSpan)?(this.detailPane.current.addEventListener("mousedown",this.handleMouseDown,!1),document.addEventListener("mouseup",this.handleMouseUp,!1)):(0,d.default)(this.state.selectSpan)&&!(0,d.default)(t.selectSpan)&&(this.detailPane.current.removeEventListener("mousedown",this.handleMouseDown,!1),document.removeEventListener("mouseup",this.handleMouseUp,!1),document.removeEventListener("mousemove",this.handleResize,!1)))}},{key:"componentWillUnmount",value:function(){this.detailPane&&this.detailPane.current&&(this.detailPane.current.removeEventListener("mousedown",this.handleMouseDown,!1),document.removeEventListener("mouseup",this.handleMouseUp,!1),document.removeEventListener("mousemove",this.handleResize,!1))}},{key:"getCoords",value:function(){for(var e=100/y.COORD_COUNT,t=[],a=0;a<y.COORD_COUNT;a++)t.push({percent:"".concat(a*e,"%")});return t.push({percent:"100%"}),t}},{key:"renderHeader",value:function(){var e=this.props.detail,a=e.traceName,n=e.traceID,l=e.duration,r=e.startTime,o=e.services,u=e.spans;if(!u)return null;var i=0;return u.forEach((function(e){i=Math.max(i,e.depth)})),c.default.createElement("div",{className:S.default.header},c.default.createElement(m.default,{name:"target",size:40}),c.default.createElement("div",{className:S.default.title},c.default.createElement("div",{className:S.default.name},a," ",c.default.createElement("span",null,n)),c.default.createElement("ul",null,c.default.createElement("li",null,c.default.createElement("span",null,t("Start Time"),": "),c.default.createElement("span",null,(0,g.getLocalTime)(r/1e3).format("YYYY-MM-DD HH:mm:ss"))),c.default.createElement("li",null,c.default.createElement("span",null,t("Duration"),": "),c.default.createElement("span",null,(0,y.formatDuration)(l))),c.default.createElement("li",null,c.default.createElement("span",null,t("Called Services"),": "),c.default.createElement("span",null,o.length)),c.default.createElement("li",null,c.default.createElement("span",null,t("Called Depth"),": "),c.default.createElement("span",null,i)))),c.default.createElement("div",{className:S.default.close,onClick:this.props.onCancel},c.default.createElement(m.default,{name:"close",size:20,type:"light"})))}},{key:"render",value:function(){var e=this,a=this.props,n=a.visible,l=a.detail,r=a.onCancel,o=this.state.selectSpan,u=this.getCoords();return c.default.createElement(v.default,{visible:n,bodyClassName:S.default.body,onCancel:r,hideHeader:!0,hideFooter:!0,fullScreen:!0},this.renderHeader(),c.default.createElement("div",{className:S.default.content},c.default.createElement("div",{className:S.default.wrapper},c.default.createElement(p.Columns,{className:"is-gapless"},c.default.createElement(p.Column,{className:"is-3"},c.default.createElement("div",{className:S.default.leftPane},c.default.createElement("div",{className:S.default.timelineTitle},t("Services & Operations")))),c.default.createElement(p.Column,null,c.default.createElement("div",{className:S.default.rightPane},c.default.createElement("div",{className:S.default.timelineSelect},c.default.createElement(_.default,{data:l,viewRange:this.viewRange,onRangeChange:this.handleRangeChange})),c.default.createElement("svg",{className:S.default.coords},u.map((function(e){return c.default.createElement("line",{key:e.percent,y1:"0%",y2:"100%",x1:e.percent,x2:e.percent})})))))),c.default.createElement("ul",{className:S.default.listPane,ref:this.listPane,style:{bottom:(0,d.default)(o)?0:"50%"}},l.spans&&l.spans.map((function(t){return c.default.createElement(E.default,{key:t.spanID,span:t,selected:o.spanID===t.spanID,color:l.serviceColorMap[t.process.serviceName],getViewedBounds:e.getViewedBounds,onClick:e.handleSpanClick})}))),!(0,d.default)(o)&&c.default.createElement("div",{className:S.default.detailPane,ref:this.detailPane},c.default.createElement(b.default,{span:o,onClose:this.hideSpanDetail})))))}},{key:"viewRange",get:function(){return{viewStart:this.state.viewStart,viewEnd:this.state.viewEnd}}}]),a}(c.default.Component);a.default=k,k.propTypes={visible:f.default.bool,detail:f.default.object,onCancel:f.default.func},k.defaultProps={visible:!1,detail:{},onCancel:function(){}}},3755:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(30)),r=n(a(13)),o=n(a(14)),u=n(a(17)),i=n(a(16)),s=n(a(18)),d=n(a(0)),c=n(a(3)),f=n(a(38)),m=a(938),p=a(2573),h=n(a(3756));function v(e){return"".concat((100*e).toFixed(1),"%")}var g=function(e){function t(){var e,a;(0,r.default)(this,t);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(a=(0,u.default)(this,(e=(0,i.default)(t)).call.apply(e,[this].concat(l)))).handleClick=function(){var e=a.props;(0,e.onClick)(e.span)},a}return(0,s.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){var e,t=this.props,a=t.span,n=t.color,r=t.getViewedBounds,o=t.selected,u=(0,p.isErrorSpan)(a),i=(0,p.formatDuration)(a.duration),s=r(a.startTime,a.startTime+a.duration);return e=s.start>1-s.end?"Left":"Right",d.default.createElement("li",{className:(0,c.default)(h.default.wrapper,(0,l.default)({},h.default.selected,o)),onClick:this.handleClick},d.default.createElement(m.Columns,{className:"is-gapless"},d.default.createElement(m.Column,{className:"is-3"},d.default.createElement("div",{className:h.default.nameWrapper},d.default.createElement("span",{className:h.default.padder,style:{paddingLeft:12*(a.depth+1)}}),d.default.createElement("a",{className:h.default.name,style:{borderColor:n}},d.default.createElement("span",{className:h.default.svc},u&&d.default.createElement(f.default,{name:"error",color:{primary:"#fff",secondary:"#ea4641"}}),a.process.serviceName," "),d.default.createElement("span",{className:h.default.endpoint},a.operationName)))),d.default.createElement(m.Column,{className:"margin-l12 margin-r12"},d.default.createElement("div",{className:h.default.barWrapper},d.default.createElement("div",{className:h.default.bar,style:{backgroundColor:n,left:v(s.start),width:v(s.end-s.start)}},d.default.createElement("div",{className:(0,c.default)(h.default.barLabel,h.default["barLabel".concat(e)])},i))))))}}]),t}(d.default.Component);t.default=g},3756:function(e,t,a){e.exports={wrapper:"Span__wrapper--3FpC5",selected:"Span__selected--11Aet",nameWrapper:"Span__nameWrapper--cWTG6",name:"Span__name--vjWzJ",svc:"Span__svc--1-OgJ",endpoint:"Span__endpoint--6EPxZ",padder:"Span__padder--Xpivf",barWrapper:"Span__barWrapper--2jIAb",bar:"Span__bar--1kkSL",barLabel:"Span__barLabel--2jh31",barLabelLeft:"Span__barLabelLeft--32_b1",barLabelRight:"Span__barLabelRight--3V0eV"}},3757:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(58)),c=l(n(0)),f=l(n(38)),m=l(n(2454)),p=l(n(2455)),h=l(n(2843)),v=n(2573),g=l(n(3758)),y=function(e,t){switch(e){case"bool":return String(t);case"string":case"number":return t;default:return JSON.stringify(t)}},E=function(e){var t=e.data;return c.default.createElement("ul",{className:g.default.properties},t.map((function(e){return c.default.createElement("li",{key:e.key},c.default.createElement("span",null,e.key,": "),c.default.createElement("span",null,y(e.type,e.value)))})))},b=function(e){var t=e.data,a=e.startTime;return c.default.createElement("div",null,t.map((function(e){var t=(0,v.formatDuration)(e.timestamp-a);return c.default.createElement("div",{key:e.timestamp,classNames:g.default.log},c.default.createElement("span",null,t),e.fields.map((function(e){return c.default.createElement("span",{className:"margin-l12",key:e.key},c.default.createElement("span",null,e.key,"= "),c.default.createElement("span",null,c.default.createElement("strong",null," ",y(e.type,e.value))))})))})))},_=function(e){function a(e){var t;return(0,r.default)(this,a),(t=(0,u.default)(this,(0,i.default)(a).call(this,e))).handleTypeChange=function(e){t.setState({type:e})},t.renderContentBody=function(){var e=t.props.span;switch(t.state.type){case"tags":return c.default.createElement(E,{data:e.tags});case"process":return c.default.createElement(E,{data:e.process.tags});case"logs":return c.default.createElement(b,{data:e.logs,startTime:e.startTime-e.relativeStartTime})}return null},t.state={type:"tags"},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.span!==this.props.span&&this.setState({type:"tags"})}},{key:"render",value:function(){var e=this.props,a=e.span,n=e.onClose,l=this.state.type,r=(0,v.formatDuration)(a.relativeStartTime),o=(0,v.formatDuration)(a.duration),u=a.process.serviceName.split(".")[0];return c.default.createElement("div",{className:g.default.wrapper},c.default.createElement("div",{className:g.default.header},c.default.createElement(f.default,{name:"target",size:40}),c.default.createElement("div",{className:g.default.text},c.default.createElement("div",{className:g.default.name},a.process.serviceName,c.default.createElement(h.default,{name:t("Service"),value:u}),c.default.createElement(h.default,{name:t("Start Time"),value:r}),c.default.createElement(h.default,{name:t("Duration"),value:o})),c.default.createElement("p",null,a.operationName)),c.default.createElement("div",{className:g.default.close,onClick:n},c.default.createElement(f.default,{name:"minimize",size:20}))),c.default.createElement("div",{className:g.default.content},c.default.createElement("div",{className:g.default.contentHeader},c.default.createElement(m.default,{wrapClassName:"radio-default",buttonWidth:155,value:l,onChange:this.handleTypeChange,size:"small"},c.default.createElement(p.default,{value:"tags"},t("Tags")),c.default.createElement(p.default,{value:"process"},t("Process")),!(0,d.default)(a.logs)&&c.default.createElement(p.default,{value:"logs"},t("Log")))),c.default.createElement("div",{className:g.default.contentBody},this.renderContentBody())))}}]),a}(c.default.Component);a.default=_},3758:function(e,t,a){e.exports={wrapper:"SpanDetail__wrapper--2SrTH",header:"SpanDetail__header--14Vao",text:"SpanDetail__text--1iF8T",name:"SpanDetail__name--afCuD",content:"SpanDetail__content--iQqWG",contentHeader:"SpanDetail__contentHeader--I7j76",contentBody:"SpanDetail__contentBody--3soUT",properties:"SpanDetail__properties--33lp7",close:"SpanDetail__close--PLv31",log:"SpanDetail__log--Wzdc9"}},3759:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(13)),r=n(a(14)),o=n(a(17)),u=n(a(16)),i=n(a(18)),s=n(a(0)),d=n(a(58)),c=n(a(3760)),f=n(a(3761)),m=n(a(2858)),p=function(e){function t(){return(0,l.default)(this,t),(0,o.default)(this,(0,u.default)(t).apply(this,arguments))}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props,t=e.data,a=e.viewRange,n=e.onRangeChange;return(0,d.default)(t)?null:s.default.createElement("div",{className:m.default.graph},s.default.createElement(c.default,{data:t}),s.default.createElement(f.default,{data:t,viewRange:a,onRangeChange:n}))}}]),t}(s.default.Component);t.default=p},3760:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(13)),r=n(a(14)),o=n(a(17)),u=n(a(16)),i=n(a(18)),s=n(a(0)),d=a(2573),c=function(e){function t(e){var a;return(0,l.default)(this,t),(a=(0,o.default)(this,(0,u.default)(t).call(this,e))).getColor=function(e){return a.props.data.serviceColorMap[e]},a.canvas=s.default.createRef(),a}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){this.drawCanvas()}},{key:"drawCanvas",value:function(){if(this.canvas&&this.canvas.current){var e=this.props.data,t=e.spans.map((function(e){return{valueOffset:e.relativeStartTime,valueWidth:e.duration,serviceName:e.process.serviceName}}));(0,d.renderIntoCanvas)(this.canvas.current,t,e.duration,this.getColor)}}},{key:"render",value:function(){return s.default.createElement("canvas",{ref:this.canvas})}}]),t}(s.default.Component);t.default=c},3761:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=n(2573),f=l(n(2858)),m=function(e){function a(e){var t;return(0,r.default)(this,a),(t=(0,u.default)(this,(0,i.default)(a).call(this,e))).handleMouseDown=function(e){t.originX=e.x,t.hideCursorGuide();var a=t.svgBound,n=a.left,l=a.width,r=Math.max(e.x-n,0)/l;t.setState({viewStart:r,viewEnd:r})},t.handleMouseUp=function(){t.originX=-1;var e=t.state,a=e.viewStart,n=e.viewEnd;Math.abs(a-n)>.01&&t.props.onRangeChange({viewStart:a,viewEnd:n})},t.handleMouseLeave=function(){t.hideCursorGuide()},t.handleMouseMove=function(e){if(t.originX>-1){var a=t.svgBound,n=a.left,l=a.width,r=Math.max(e.x-n,0)/l;r>t.state.viewStart?t.setState({viewEnd:r}):t.setState({viewStart:r})}else t.showCursorGuide(e)},t.handleClear=function(){t.props.onRangeChange({viewStart:0,viewEnd:1})},t.showCursorGuide=function(e){if(t.cursorGuide)for(var a=t.svgBound,n=a.left,l=a.width,r=Math.max(e.x-n,0)/l,o="".concat(100*r,"%"),u=0;u<t.cursorGuide.children.length;u++)t.cursorGuide.children[u].setAttribute("x1",o),t.cursorGuide.children[u].setAttribute("x2",o),t.cursorGuide.children[u].setAttribute("stroke-opacity",1)},t.hideCursorGuide=function(){if(t.cursorGuide)for(var e=0;e<t.cursorGuide.children.length;e++)t.cursorGuide.children[e].setAttribute("stroke-opacity",0)},t.svg=d.default.createRef(),t.originX=-1,t.state={viewStart:e.viewRange.viewStart,viewEnd:e.viewRange.viewEnd},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"componentWillReceiveProps",value:function(e){e.viewRange.viewStart!==this.state.viewStart&&this.setState({viewStart:e.viewRange.viewStart}),e.viewRange.viewEnd!==this.state.viewEnd&&this.setState({viewEnd:e.viewRange.viewEnd})}},{key:"componentDidMount",value:function(){this.svg&&this.svg.current&&(this.svg.current.addEventListener("mousedown",this.handleMouseDown),this.svg.current.addEventListener("mousemove",this.handleMouseMove),this.svg.current.addEventListener("mouseup",this.handleMouseUp),this.svg.current.addEventListener("mouseleave",this.handleMouseLeave),this.svgBound=this.svg.current.getBoundingClientRect(),this.cursorGuide=this.svg.current.querySelector('[name="cursor-guide"]'))}},{key:"componentWillUnmount",value:function(){this.svg&&this.svg.current&&(this.svg.current.removeEventListener("mousedown",this.handleMouseDown),this.svg.current.removeEventListener("mousemove",this.handleMouseMove),this.svg.current.removeEventListener("mouseup",this.handleMouseUp),this.svg.current.removeEventListener("mouseleave",this.handleMouseLeave))}},{key:"getCoords",value:function(){for(var e=this.props.data.duration,t=(e/c.COORD_COUNT).toFixed(2),a=100/c.COORD_COUNT,n=[],l=0;l<c.COORD_COUNT;l++)n.push({value:l*t,percent:"".concat(l*a,"%")});return n.push({value:e,percent:"100%"}),n}},{key:"render",value:function(){var e=this.state,a=e.viewStart,n=e.viewEnd,l=a>0&&n<1,r="".concat(100*a,"%"),o="".concat(100*n,"%"),u=this.getCoords();return d.default.createElement("div",{className:f.default.range},d.default.createElement("svg",{height:"100%",width:"100%",ref:this.svg},d.default.createElement("g",{className:f.default.coord},u.map((function(e,t){return d.default.createElement("g",{key:e.value,className:f.default.coordLine},d.default.createElement("line",{y1:"0%",y2:"100%",x1:e.percent,x2:e.percent}),d.default.createElement("text",{x:e.percent,y:12,transform:t===c.COORD_COUNT?"translate(-2,0)":"translate(2,0)",textAnchor:t===c.COORD_COUNT?"end":"start"},(0,c.formatDuration)(e.value)))}))),d.default.createElement("g",{className:f.default.cursorGuide,name:"cursor-guide"},d.default.createElement("line",{y1:0,y2:58,strokeWidth:"1",stroke:"#212b36",strokeOpacity:"0",strokeDasharray:"2,2"}),d.default.createElement("line",{y1:19,y2:41,stroke:"#242e42",strokeWidth:"4",strokeOpacity:"0",strokeLinecap:"round"}),d.default.createElement("line",{y1:0,y2:58,strokeWidth:"20",stroke:"transparent"})),l&&d.default.createElement("g",{className:f.default.scrubber},d.default.createElement("line",{className:f.default.scrubberLine,y1:"0%",y2:"100%",x1:r,x2:r}),d.default.createElement("line",{className:f.default.scrubberLine,y1:"0%",y2:"100%",x1:o,x2:o}))),l&&d.default.createElement(d.default.Fragment,null,d.default.createElement("div",{className:f.default.hoverBlock,style:{left:0,width:r}}),d.default.createElement("div",{className:f.default.hoverBlock,style:{left:o,width:"".concat(100*(1-n),"%")}}),d.default.createElement("div",{className:f.default.clearBlock,onClick:this.handleClear},t("Clear"))))}}]),a}(d.default.Component);a.default=m},3762:function(e,t,a){e.exports={body:"TracingDetail__body--1pPFS",header:"TracingDetail__header--2DMYd",title:"TracingDetail__title--1Erbw",name:"TracingDetail__name--3ugl6",close:"TracingDetail__close--2i5KJ",content:"TracingDetail__content--1lhG8",wrapper:"TracingDetail__wrapper--3n2Yy",timelineTitle:"TracingDetail__timelineTitle--3kkKn",leftPane:"TracingDetail__leftPane--pfziZ",rightPane:"TracingDetail__rightPane--36cdS",timelineSelect:"TracingDetail__timelineSelect--2mJV8",listPane:"TracingDetail__listPane--Ggsvl",detailPane:"TracingDetail__detailPane--4xyXv",coords:"TracingDetail__coords--20avL"}},3763:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(58)),c=l(n(0)),f=n(1),m=l(n(38)),p=l(n(190)),h=l(n(943)),v=l(n(3764)),g=l(n(2859)),y=function(e){function a(){var e,t;(0,r.default)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(t=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(l)))).state={value:t.props.defaultValue||t.props.options[0]||{}},t.handleChange=function(e){t.setState({value:e},(function(){t.props.onChange(e)}))},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"componentWillReceiveProps",value:function(e){(0,h.default)(e.options,this.props.options)||this.setState({value:this.props.defaultValue||e.options[0]})}},{key:"renderOptions",value:function(){var e=this,t=this.props.options;return c.default.createElement("ul",{className:g.default.options},t.map((function(t){return c.default.createElement("li",{key:t.uid},c.default.createElement(v.default,{data:t,onClick:e.handleChange}))})))}},{key:"render",value:function(){var e=this.props,a=e.isLoading,n=e.options;return c.default.createElement("div",{className:g.default.select},!a&&(0,d.default)(n)?c.default.createElement("div",{className:g.default.empty},t("NOT_AVAILABLE",{resource:t("Service")})):c.default.createElement(p.default,{trigger:"click",placement:"bottom",content:this.renderOptions()},c.default.createElement("div",{className:g.default.control},c.default.createElement(v.default,{className:g.default.selected,data:this.state.value}),c.default.createElement(m.default,{className:g.default.rightIcon,name:"chevron-down",size:24}))))}}]),a}(c.default.Component);a.default=y,y.propTypes={defaultValue:f.PropTypes.object,options:f.PropTypes.array,onChange:f.PropTypes.func,isLoading:f.PropTypes.bool},y.defaultProps={options:[],onChange:function(){},isLoading:!0}},3764:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(0)),o=l(n(3)),u=l(n(38)),i=l(n(2859)),s=function(e){var a=e.className,n=e.data,l=e.onClick;return r.default.createElement("div",{className:(0,o.default)(i.default.item,a),onClick:function(){return l(n)}},r.default.createElement("div",{className:i.default.icon},r.default.createElement(u.default,{name:"network-router",size:40})),r.default.createElement("div",{className:i.default.name},r.default.createElement("div",{className:"h6"},n.name),r.default.createElement("p",null,t(n.type))))};a.default=s},3765:function(e,t,a){e.exports={operations:"Tracing__operations--3dKtx"}},3766:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(49),r=a(564),o=n(a(2517)),u=n(a(3767)),i="/projects/:namespace/configmaps/:name",s=[{name:"detail",title:"Detail",component:n(a(3768)).default}],d=[{path:i,component:(0,l.withProps)(o.default,{module:"configmaps",component:u.default,breadcrumbs:[{label:"Project",url:"/projects/:namespace"},{label:"ConfigMaps",url:"/projects/:namespace/configmaps"}]}),routes:(0,r.getChildRoutes)(s,i)}];t.default=d},3767:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.Component=a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=n(19),f=n(60),m=l(n(2559)),p=l(n(2520)),h=l(n(2527)),v=l(n(2526)),g=l(n(2831)),y=function(e){function a(){var e,n;(0,r.default)(this,a);for(var l=arguments.length,o=new Array(l),s=0;s<l;s++)o[s]=arguments[s];return(n=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(o)))).getOperations=function(){return[{key:"edit",type:"control",text:t("EDIT"),action:"edit",onClick:n.showModal("editBaseInfo")},{key:"editYaml",icon:"pen",text:t("Edit YAML"),action:"edit",onClick:n.showModal("editYaml")},{key:"editConfigMap",icon:"pen",text:t("Modify Config"),action:"edit",onClick:n.showModal("editConfigMap")},{key:"delete",icon:"trash",text:t("Delete"),action:"delete",onClick:n.showModal("deleteModule")}]},n.getAttrs=function(){var e=(0,c.toJS)(n.store.detail);return[{name:t("Project"),value:e.namespace},{name:t("Created Time"),value:n.createTime},{name:t("Creator"),value:n.creator}]},n}return(0,s.default)(a,e),(0,o.default)(a,[{key:"init",value:function(){this.store=new m.default}},{key:"renderExtraModals",value:function(){var e=this.store,t=e.detail,a=e.isSubmitting,n=this.state,l=n.editBaseInfo,r=n.editYaml,o=n.editConfigMap,u=(0,c.toJS)(t._originData);return d.default.createElement("div",null,d.default.createElement(h.default,{visible:l,detail:u,onOk:this.handleEdit("editBaseInfo"),onCancel:this.hideModal("editBaseInfo"),isSubmitting:a}),d.default.createElement(v.default,{visible:r,detail:u,onOk:this.handleEdit("editYaml","update"),onCancel:this.hideModal("editYaml"),isSubmitting:a}),d.default.createElement(g.default,{visible:o,detail:u,onOk:this.handleEdit("editConfigMap","update"),onCancel:this.hideModal("editConfigMap"),isSubmitting:a}))}},{key:"name",get:function(){return"ConfigMap"}}]),a}(p.default),E=(0,f.inject)("rootStore")((0,f.observer)(y));a.default=E;var b=y;a.Component=b},3768:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(82)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(0)),m=n(60),p=l(n(2516)),h=l(n(3769)),v=(0,m.observer)(r=function(e){function a(e){var t;return(0,u.default)(this,a),(t=(0,s.default)(this,(0,d.default)(a).call(this,e))).store=e.detailStore,t.module=e.module,t}return(0,c.default)(a,e),(0,i.default)(a,[{key:"renderContent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return f.default.createElement("div",{className:h.default.wrapper},f.default.createElement("ul",null,Object.entries(e).map((function(e){var t=(0,o.default)(e,2),a=t[0],n=t[1];return f.default.createElement("li",{key:a},f.default.createElement("div",{className:"h6"},a),f.default.createElement("pre",{className:h.default.value},n))}))))}},{key:"render",value:function(){var e=this.store,a=e.detail,n=e.isLoading;return f.default.createElement(p.default,{title:t("Config Value"),loading:n},this.renderContent(a.data))}}]),a}(f.default.Component))||r;a.default=v},3769:function(e,t,a){e.exports={wrapper:"ConfigDetail__wrapper--objLg",value:"ConfigDetail__value--SkXJa"}},3770:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(49),r=a(564),o=n(a(2517)),u=n(a(3771)),i="/projects/:namespace/secrets/:name",s=[{name:"detail",title:"Detail",component:n(a(3772)).default}],d=[{path:i,component:(0,l.withProps)(o.default,{module:"secrets",component:u.default,breadcrumbs:[{label:"Project",url:"/projects/:namespace"},{label:"Secrets",url:"/projects/:namespace/secrets"}]}),routes:(0,r.getChildRoutes)(s,i)}];t.default=d},3771:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.Component=a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=n(19),f=n(60),m=n(114),p=l(n(2537)),h=l(n(2520)),v=l(n(2526)),g=l(n(2527)),y=l(n(2833)),E=function(e){function a(){var e,n;(0,r.default)(this,a);for(var l=arguments.length,o=new Array(l),s=0;s<l;s++)o[s]=arguments[s];return(n=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(o)))).getOperations=function(){return[{key:"edit",type:"control",text:t("EDIT"),action:"edit",onClick:n.showModal("editBaseInfo")},{key:"editYaml",icon:"pen",text:t("Edit YAML"),action:"edit",onClick:n.showModal("editYaml")},{key:"editSecret",icon:"pen",text:t("Edit Secret"),action:"edit",onClick:n.showModal("editSecret")},{key:"delete",icon:"trash",text:t("Delete"),action:"delete",onClick:n.showModal("deleteModule")}]},n.getAttrs=function(){var e=(0,c.toJS)(n.store.detail);return[{name:t("Project"),value:e.namespace},{name:t("Type"),value:t(m.SECRET_TYPES[e.type]||e.type)},{name:t("Created Time"),value:n.createTime},{name:t("Creator"),value:n.creator}]},n}return(0,s.default)(a,e),(0,o.default)(a,[{key:"init",value:function(){this.store=new p.default}},{key:"renderExtraModals",value:function(){var e=this.store,t=e.detail,a=e.isSubmitting,n=this.state,l=n.editBaseInfo,r=n.editYaml,o=n.editSecret,u=(0,c.toJS)(t._originData);return d.default.createElement("div",null,d.default.createElement(g.default,{visible:l,detail:u,onOk:this.handleEdit("editBaseInfo"),onCancel:this.hideModal("editBaseInfo"),isSubmitting:a}),d.default.createElement(v.default,{visible:r,detail:u,onOk:this.handleEdit("editYaml","update"),onCancel:this.hideModal("editYaml"),isSubmitting:a}),d.default.createElement(y.default,{visible:o,detail:t,onOk:this.handleEdit("editSecret","updateWithEncode"),onCancel:this.hideModal("editSecret"),isSubmitting:a}))}},{key:"name",get:function(){return"Secret"}}]),a}(h.default),b=(0,f.inject)("rootStore")((0,f.observer)(E));a.default=b;var _=E;a.Component=_},3772:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(82)),u=l(n(13)),i=l(n(14)),s=l(n(17)),d=l(n(16)),c=l(n(18)),f=l(n(0)),m=n(60),p=l(n(38)),h=l(n(224)),v=l(n(2516)),g=l(n(3773)),y=(0,m.observer)(r=function(e){function a(e){var t;return(0,u.default)(this,a),(t=(0,s.default)(this,(0,d.default)(a).call(this,e))).convert=function(e){return t.state.showSecret?e:btoa(e)},t.changeSecretState=function(){t.setState((function(e){return{showSecret:!e.showSecret}}))},t.store=e.detailStore,t.module=e.module,t.state={showSecret:!1},t}return(0,c.default)(a,e),(0,i.default)(a,[{key:"renderTLS",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return f.default.createElement("div",{className:g.default.tlsWrapper},f.default.createElement("div",{className:g.default.tlsItem},f.default.createElement("div",{className:"h6"},t("Credential")),f.default.createElement("pre",null,this.convert(e["tls.crt"]))),f.default.createElement("div",{className:g.default.tlsItem},f.default.createElement("div",{className:"h6"},t("Private Key")),f.default.createElement("pre",null,this.convert(e["tls.key"]))))}},{key:"renderImageRepositorySecret",value:function(e){var t=this,a=e[".dockerconfigjson"];return a&&a.auths?f.default.createElement("div",{className:g.default.imageWrapper},f.default.createElement("ul",null,Object.entries(a.auths).map((function(e){var a=(0,o.default)(e,2),n=a[0],l=a[1];return f.default.createElement("li",{key:n},f.default.createElement("div",{className:"h6"},f.default.createElement(p.default,{name:"earth"}),n),f.default.createElement("ul",null,f.default.createElement("li",null,f.default.createElement("span",null,"Username:"),f.default.createElement("span",null,t.convert(l.username))),f.default.createElement("li",null,f.default.createElement("span",null,"Password:"),f.default.createElement("span",null,t.convert(l.password))),l.email&&f.default.createElement("li",null,f.default.createElement("span",null,"Email:"),f.default.createElement("span",null,t.convert(l.email)))))})))):null}},{key:"renderDefault",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return f.default.createElement("div",{className:g.default.defaultWrapper},f.default.createElement("ul",null,Object.entries(t).map((function(t){var a=(0,o.default)(t,2),n=a[0],l=a[1];return f.default.createElement("li",{key:n},f.default.createElement("span",null,n,":"),f.default.createElement("span",null,f.default.createElement("pre",null,e.convert(l))))}))))}},{key:"renderContent",value:function(e){if(!e.type)return null;var t=null;switch(e.type){case"kubernetes.io/tls":t=this.renderTLS(e.data);break;case"kubernetes.io/dockerconfigjson":t=this.renderImageRepositorySecret(e.data);break;default:t=this.renderDefault(e.data)}return t}},{key:"renderOperations",value:function(){var e=this.state.showSecret;return f.default.createElement(h.default,{type:"flat",icon:e?"eye-closed":"eye",onClick:this.changeSecretState})}},{key:"render",value:function(){var e=this.store.detail;return f.default.createElement(v.default,{title:t("Secret"),operations:this.renderOperations()},this.renderContent(e))}}]),a}(f.default.Component))||r;a.default=y},3773:function(e,t,a){e.exports={defaultWrapper:"SecretDetail__defaultWrapper--2peh6",tlsWrapper:"SecretDetail__tlsWrapper--2tLwX",tlsItem:"SecretDetail__tlsItem--2r-ra",imageWrapper:"SecretDetail__imageWrapper--2zQda"}},3774:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(49),r=a(564),o=n(a(2517)),u=n(a(2755)),i=n(a(2756)),s=n(a(2757)),d=n(a(2758)),c=n(a(3775)),f="/projects/:namespace/alert-message",m="".concat(f,"/unresolved/:id"),p="".concat(f,"/all/:id"),h=[{name:"alert-detail",title:"Alerting Detail",component:u.default},{name:"alert-policy",title:"Alerting Policy",component:i.default},{name:"notification-history",title:"Recent Notification",component:s.default},{name:"comment",title:"ALERT_COMMENT",component:d.default}],v=[{path:m,component:(0,l.withProps)(o.default,{module:"alert-message",component:c.default,breadcrumbs:[{label:"Project",url:"/projects/:namespace"},{label:"Alerting Message",url:"/projects/:namespace/alert-message"},{label:"Unresolved",url:"/projects/:namespace/alert-message/unresolved"}]}),ksModule:"alerting",routes:(0,r.getChildRoutes)(h,m)},{path:p,component:(0,l.withProps)(o.default,{module:"alert-message",component:c.default,breadcrumbs:[{label:"Project",url:"/projects/:namespace"},{label:"Alerting Message",url:"/projects/:namespace/alert-message"},{label:"All",url:"/projects/:namespace/alert-message/all"}]}),ksModule:"alerting",routes:(0,r.getChildRoutes)(h,p)}];t.default=v},3775:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r=n(a(13)),o=n(a(17)),u=n(a(16)),i=n(a(18)),s=a(60),d=a(2754),c=(0,s.inject)("rootStore")(l=(0,s.observer)(l=function(e){function t(){return(0,r.default)(this,t),(0,o.default)(this,(0,u.default)(t).apply(this,arguments))}return(0,i.default)(t,e),t}(d.Component))||l)||l;t.default=c},3776:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(49),r=a(564),o=n(a(2517)),u=n(a(2760)),i=n(a(2762)),s=n(a(2763)),d=n(a(2764)),c=n(a(3777)),f="/projects/:namespace/alert-policy/:name",m=[{name:"alert-rules",title:"Alerting Rules",component:u.default},{name:"monitoring-target",title:"Monitoring Target",component:i.default},{name:"notification-rules",title:"Notification Rules",component:s.default},{name:"alert-history",title:"Alerting History",component:d.default}],p=[{path:f,component:(0,l.withProps)(o.default,{module:"policy",component:c.default,breadcrumbs:[{label:"Project",url:"/projects/:namespace"},{label:"Alerting Policy",url:"/projects/:namespace/alert-policy"}]}),ksModule:"alerting",routes:(0,r.getChildRoutes)(m,f)}];t.default=p},3777:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r=n(a(13)),o=n(a(14)),u=n(a(17)),i=n(a(16)),s=n(a(18)),d=a(60),c=a(2759),f=(0,d.inject)("rootStore")(l=(0,d.observer)(l=function(e){function t(){return(0,r.default)(this,t),(0,u.default)(this,(0,i.default)(t).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"enabledActions",get:function(){return globals.app.getActions({module:"alerting",project:this.props.match.params.namespace})}}]),t}(c.Component))||l)||l;t.default=f},3778:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(564),r=n(a(2747)),o=n(a(2748)),u=n(a(3779)),i=n(a(3780)),s="/projects/:namespace",d="".concat(s,"/alert-message"),c="".concat(s,"/alert-policy"),f=[{name:"unresolved",title:"Unresolved",component:r.default},{name:"all",title:"All",component:o.default}],m=[{path:d,component:u.default,ksModule:"alerting",routes:(0,l.getChildRoutes)(f,d)},{path:c,component:i.default,ksModule:"alerting",exact:!0}];t.default=m},3779:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r=n(a(13)),o=n(a(17)),u=n(a(16)),i=n(a(18)),s=a(60),d=a(2746),c=(0,s.inject)("rootStore")(l=(0,s.observer)(l=function(e){function t(){return(0,r.default)(this,t),(0,o.default)(this,(0,u.default)(t).apply(this,arguments))}return(0,i.default)(t,e),t}(d.Component))||l)||l;t.default=c},3780:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r=n(a(13)),o=n(a(14)),u=n(a(17)),i=n(a(16)),s=n(a(18)),d=a(60),c=a(2749),f=(0,d.inject)("rootStore")(l=(0,d.observer)(l=function(e){function t(){return(0,r.default)(this,t),(0,u.default)(this,(0,i.default)(t).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"enabledActions",get:function(){return globals.app.getActions({module:"alerting",project:this.props.match.params.namespace})}}]),t}(c.Component))||l)||l;t.default=f},3781:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(564),r=n(a(2824)),o=n(a(3782)),u=n(a(2851)),i="/projects/:namespace/grayrelease",s=[{name:"cates",title:"GRAY_RELEASE_CATEGORIES",component:o.default},{name:"jobs",title:"Job Status",component:u.default}],d=[{path:i,component:r.default,breadcrumbs:[{label:"Project",url:"/projects/:namespace"},{label:"Grayscale Release",url:"/projects/:namespace/grayrelease"}],ksModule:"servicemesh",routes:(0,l.getChildRoutes)(s,i)}];t.default=d},3782:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=n(60),m=l(n(38)),p=l(n(224)),h=l(n(388)),v=l(n(2539)),g=n(114),y=l(n(940)),E=l(n(2617)),b=l(n(2632)),_=l(n(2556)),S=l(n(3783)),k=l(n(3791)),C=(0,f.inject)("rootStore")(r=(0,f.observer)(r=function(e){function a(e){var n;return(0,o.default)(this,a),(n=(0,i.default)(this,(0,s.default)(a).call(this,e))).showCreate=function(e){n.setState({showCreateModal:!0,selectType:e.currentTarget.dataset.type})},n.hideCreate=function(){n.setState({showCreateModal:!1,selectType:""})},n.handleCreate=function(e){var a=n.props.match.params.namespace;n.store.create(e,{namespace:a}).then((function(){n.hideCreate(),h.default.success({content:"".concat(t("Created Successfully"),"!")}),n.routing.push("/projects/".concat(a,"/grayrelease/jobs")),E.default.delete("".concat(n.module,"_create_form"))}))},n.state={showCreateModal:!1,selectType:""},n.store=new b.default,n.routerStore=new _.default,n.module="strategies",n.namespace=n.props.match.params.namespace,n}return(0,d.default)(a,e),(0,u.default)(a,[{key:"componentDidMount",value:function(){this.routerStore.getGateway(this.props.match.params)}},{key:"render",value:function(){var e=this,a=this.state,n=a.showCreateModal,l=a.selectType,r=g.GRAY_RELEASE_CATEGORIES.find((function(e){return e.type===l}))||{};return c.default.createElement("div",null,c.default.createElement("ul",{className:k.default.wrapper},g.GRAY_RELEASE_CATEGORIES.map((function(a){return c.default.createElement("li",{key:a.title},c.default.createElement("div",{className:k.default.content},c.default.createElement("div",{className:k.default.icon},c.default.createElement(m.default,{name:a.icon,size:24,type:"light"})),c.default.createElement("div",{className:k.default.text},c.default.createElement("div",{className:"h5"},t(a.title)),c.default.createElement("p",null,t.html(a.desc)))),c.default.createElement("div",{className:k.default.footer},e.canCreate&&c.default.createElement(p.default,{type:"control","data-type":a.type,onClick:e.showCreate,disabled:!e.serviceMeshEnable,noShadow:!0},t("Create Job"))))}))),c.default.createElement(v.default,{title:t(r.title),module:"grayreleases_".concat(r.type),formTemplate:this.formTemplate,store:this.store,visible:n,steps:this.steps,onCancel:this.hideCreate,onOk:this.handleCreate,closable:!0,noCodeEdit:!0}))}},{key:"routing",get:function(){return this.props.rootStore.routing}},{key:"formTemplate",get:function(){return{strategy:y.default[this.module]({namespace:this.namespace,type:this.state.selectType})}}},{key:"steps",get:function(){return S.default}},{key:"canCreate",get:function(){var e=this.props.match.params.namespace;return globals.app.getActions({module:"applications",project:e}).includes("edit")}},{key:"serviceMeshEnable",get:function(){return globals.app.hasKSModule("servicemesh")&&this.routerStore.gateway.data.serviceMeshEnable}}]),a}(c.default.Component))||r)||r;a.default=C},3783:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(3784)),r=n(a(3785)),o=n(a(2854)),u=n(a(2856)),i=[{title:"Basic Info",component:l.default,required:!0},{title:"Grayscale Release Components",component:r.default,required:!0},{title:"Grayscale Release Version",component:o.default,required:!0},{title:"Policy Config",component:u.default,required:!0}];t.default=i},3784:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(22)),f=l(n(0)),m=n(60),p=n(114),h=n(938),v=l(n(386)),g=l(n(2453)),y=l(n(267)),E=(0,m.observer)(r=function(e){function a(){var e,n;(0,o.default)(this,a);for(var l=arguments.length,r=new Array(l),u=0;u<l;u++)r[u]=arguments[u];return(n=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(r)))).nameValidator=function(e,a,l){if(!a)return l();n.props.store.checkName({name:a,namespace:n.namespace}).then((function(a){if(a.exist)return l({message:t("Name exists"),field:e.field});l()}))},n}return(0,d.default)(a,e),(0,u.default)(a,[{key:"render",value:function(){var e=this.props.formRef;return f.default.createElement(y.default,{data:this.formTemplate,ref:e},f.default.createElement(h.Columns,null,f.default.createElement(h.Column,null,f.default.createElement(y.default.Item,{label:t("Release Job Name"),desc:t("LONG_NAME_DESC"),rules:[{required:!0,message:t("Please input name")},{pattern:p.PATTERN_NAME,message:"".concat(t("Invalid name"),", ").concat(t("LONG_NAME_DESC"))},{validator:this.nameValidator}]},f.default.createElement(v.default,{name:"metadata.name"}))),f.default.createElement(h.Column,null,f.default.createElement(y.default.Item,{label:t("Alias"),desc:t("ALIAS_DESC")},f.default.createElement(v.default,{name:"metadata.annotations['kubesphere.io/alias-name']"})))),f.default.createElement(h.Columns,null,f.default.createElement(h.Column,null,f.default.createElement(y.default.Item,{label:t("Description")},f.default.createElement(g.default,{name:"metadata.annotations['kubesphere.io/description']"})))))}},{key:"formTemplate",get:function(){return this.props.formTemplate.strategy}},{key:"namespace",get:function(){return(0,c.default)(this.formTemplate,"metadata.namespace")}},{key:"strategyType",get:function(){return(0,c.default)(this.formTemplate,"spec.type")}}]),a}(f.default.Component))||r;a.default=E},3785:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(37)),u=l(n(61)),i=l(n(62)),s=l(n(13)),d=l(n(14)),c=l(n(17)),f=l(n(16)),m=l(n(18)),p=l(n(22)),h=l(n(58)),v=l(n(115)),g=l(n(2469)),y=l(n(0)),E=n(19),b=n(60),_=l(n(38)),S=l(n(227)),k=l(n(225)),C=n(49),w=n(114),N=l(n(940)),T=l(n(267)),P=l(n(2608)),M=l(n(947)),R=l(n(3786)),D=l(n(3790)),O=(0,b.observer)(r=function(e){function a(e){var n;return(0,s.default)(this,a),(n=(0,c.default)(this,(0,f.default)(a).call(this,e))).valueRenderer=function(e){return y.default.createElement("p",{className:D.default.option},y.default.createElement("img",{src:e.icon||"/assets/default-app.svg",alt:""}),t("Application"),": ",e.name,e.disabled&&y.default.createElement(S.default,{trigger:"click",content:t("未开启应用治理的应用无法使用灰度发布")},y.default.createElement(_.default,{name:"question",className:"float-right"})))},n.optionRenderer=n.valueRenderer,n.updateAppInfo=function(e){(0,v.default)(n.formTemplate,"metadata.labels",e.selector),(0,v.default)(n.formTemplate,"spec.selector.matchLabels",e.selector),(0,v.default)(n.formTemplate,'metadata.annotations["app.kubernetes.io/icon"]',e.icon)},n.selectApp=function(){var e=(0,i.default)(u.default.mark((function e(t){var a;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.updateAppInfo(t),n.setState({isLoading:!0}),a={namespace:n.namespace,labelSelector:(0,C.joinSelector)(t.selector)},e.next=5,Promise.all([n.store.fetchList(a),n.serviceStore.fetchListByK8s(a),n.serviceStore.fetchWorkloads(a)]).then((function(){var e=(0,E.toJS)(n.serviceStore.list.data),t=(0,E.toJS)(n.serviceStore.workloads.data),a=(0,E.toJS)(n.store.list.data);n.setState({components:e.map((function(e){e.workloads=[];var n=(0,p.default)(e,"labels.app");t.forEach((function(t){n===(0,p.default)(t,"labels.app")&&e.workloads.push(t)}));var l=(0,p.default)(e.workloads,"[0].type","");return e.workloadType=w.MODULE_KIND_MAP[l]||"",e.strategies=a.filter((function(t){return t.hosts.includes(e.name)}))||[],e})),isLoading:!1})}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleAppChange=function(e){n.setState({selectApp:e},(function(){var t=(0,E.toJS)(n.appStore.list.data).find((function(t){return t.name===e}))||{};t.selector&&n.selectApp(t)}))},n.handleComponentSelect=function(e,t){var a=n.state.components.find((function(t){return t.name===e}))||{};if(!(0,h.default)(a.selector)){var l=(0,g.default)(a.workloads[0]),r=N.default[l.type]({namespace:n.namespace}),o="http"===((0,p.default)(a,"ports[0].name","").split("-")[0]||"").toLowerCase()?"http":"tcp",u=l.labels.version;(0,v.default)(n.formTemplate,"metadata.labels.app",e),(0,v.default)(n.formTemplate,"spec.selector.matchLabels.app",e),(0,v.default)(n.formTemplate,"spec.principal",u),(0,v.default)(n.formTemplate,"spec.protocol",o),(0,v.default)(n.formTemplate,'metadata.annotations["servicemesh.kubesphere.io/workloadType"]',l.type),(0,v.default)(n.formTemplate,'metadata.annotations["servicemesh.kubesphere.io/workloadReplicas"]',String(l.podNums)),(0,v.default)(n.formTemplate,"spec.template.spec",{hosts:[e]}),n.props.formTemplate.workload={apiVersion:r.apiVersion,kind:r.kind,metadata:{name:"",namespace:l.namespace,labels:l.labels,annotations:l.annotations},spec:l.spec},(0,C.mergeLabels)(n.props.formTemplate.workload,{version:""})}t&&t(e)},n.handleIstioProxyChange=function(e){n.setState({istioProxyChecked:e})},n.state={istioProxyChecked:!0,selectApp:"",components:[],isLoading:!1},n.store=e.store,n.appStore=new P.default,n.serviceStore=new M.default,n}return(0,m.default)(a,e),(0,d.default)(a,[{key:"componentDidMount",value:function(){var e=this;this.appStore.fetchList({namespace:this.namespace}).then((function(){var t=(0,E.toJS)(e.appStore.list.data).find((function(e){return e.serviceMeshEnable}))||{};e.setState({selectApp:t.name}),t.selector&&e.selectApp(t)}))}},{key:"getApplications",value:function(){return(0,E.toJS)(this.appStore.list.data).map((function(e){return(0,o.default)({},e,{value:e.name,disabled:!e.serviceMeshEnable})}))}},{key:"renderForm",value:function(){var e=this.props.formRef,a=this.state,n=a.components,l=a.isLoading;return y.default.createElement(T.default,{data:this.formTemplate,ref:e},y.default.createElement(T.default.Item,{rules:[{required:!0,message:t("Please select a grayscale release component")}]},y.default.createElement(R.default,{name:"spec.hosts",data:n,loading:l,onSelect:this.handleComponentSelect})))}},{key:"render",value:function(){var e=this.state.selectApp;return y.default.createElement("div",null,y.default.createElement("div",{className:D.default.bar},y.default.createElement(k.default,{value:e,onChange:this.handleAppChange,options:this.getApplications(),isLoading:this.appStore.list.isLoading,valueRenderer:this.valueRenderer,optionRenderer:this.optionRenderer})),y.default.createElement("div",{className:D.default.formWrapper},this.renderForm()))}},{key:"namespace",get:function(){return(0,p.default)(this.formTemplate,"metadata.namespace")}},{key:"formTemplate",get:function(){return this.props.formTemplate.strategy}},{key:"strategyType",get:function(){return(0,p.default)(this.formTemplate,"spec.type")}}]),a}(y.default.Component))||r;a.default=O},3786:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(13)),r=n(a(14)),o=n(a(17)),u=n(a(16)),i=n(a(18)),s=n(a(0)),d=n(a(1)),c=n(a(129)),f=n(a(3787)),m=n(a(3789)),p=function(e){function t(){var e,a;(0,l.default)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=(0,o.default)(this,(e=(0,u.default)(t)).call.apply(e,[this].concat(r)))).state={loadingName:""},a.handleCardSelect=function(e,t){var n=a.props,l=n.onChange,r=n.onSelect;a.setState({loadingName:e.name}),r(t?e.name:"",(function(e){l(e),a.setState({loadingName:""})}))},a}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.data,n=t.value,l=t.loading,r=this.state.loadingName;return l?s.default.createElement("div",{className:"text-center margin-t12"},s.default.createElement(c.default,{spinning:!0})):s.default.createElement("div",{className:m.default.wrapper},a.map((function(t){return s.default.createElement(f.default,{key:t.name,component:t,value:t.name===n,loading:t.name===r,onSelect:e.handleCardSelect})})))}}]),t}(s.default.Component);t.default=p,p.propTypes={data:d.default.array,value:d.default.string,onChange:d.default.func,onSelect:d.default.func},p.defaultProps={data:[],value:"",onChange:function(){},onSelect:function(){}}},3787:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(1)),f=l(n(22)),m=l(n(58)),p=l(n(38)),h=l(n(224)),v=l(n(3788)),g=function(e){function a(){var e,t;(0,r.default)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(t=(0,u.default)(this,(e=(0,i.default)(a)).call.apply(e,[this].concat(l)))).handleClick=function(){var e=t.props,a=e.value,n=e.component;(0,e.onSelect)(n,!a)},t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"renderActions",value:function(){var e=this.props,a=e.value,n=e.component,l=e.loading;return n.workloads.length<=0?d.default.createElement("span",{className:v.default.right},t("No workload found")):"Deployment"!==n.workloadType?d.default.createElement("span",{className:v.default.right},t("Unsupported workload type")):n.strategies.length>0?d.default.createElement("span",{className:v.default.right},t("Unfinished grayscale release jobs exist")):d.default.createElement(h.default,{className:v.default.right,type:a?"control":"default",loading:l,onClick:this.handleClick},a?t("Cancel Select"):t("Select"))}},{key:"render",value:function(){var e=this.props.component,a=e.workloads.map((function(e){return(0,f.default)(e,"labels.version")})).filter((function(e){return!(0,m.default)(e)})),n="true"===(0,f.default)(e,'annotations["servicemesh.kubesphere.io/enabled"]');return d.default.createElement("div",{className:v.default.card},d.default.createElement("div",{className:v.default.icon},d.default.createElement(p.default,{name:"network-router",size:40}),n&&d.default.createElement("span",{className:v.default.istio},d.default.createElement(p.default,{name:"istio",size:16,color:{primary:"#329dce"}}))),d.default.createElement("div",{className:v.default.text},d.default.createElement("div",{className:"h6"},e.name),d.default.createElement("p",null,"".concat(t("Workload Type"),": ").concat(e.workloadType?t("SERVICE_".concat(e.workloadType.toUpperCase())):""))),d.default.createElement("div",{className:v.default.version},d.default.createElement("strong",null,a.join(",")||"-"),d.default.createElement("p",null,t("Version"))),this.renderActions())}}]),a}(d.default.PureComponent);a.default=g,g.propTypes={component:c.default.object,value:c.default.bool,loading:c.default.bool,onSelect:c.default.func},g.defaultProps={component:{},value:!1,loading:!1,onSelect:function(){}}},3788:function(e,t,a){e.exports={card:"Card__card--3vdiL",text:"Card__text--2C5MP",version:"Card__version--3BdnF",right:"Card__right--22_hd",icon:"Card__icon--NrHNP",istio:"Card__istio--QsKsU"}},3789:function(e,t,a){e.exports={wrapper:"SelectComponent__wrapper--3jlq6"}},3790:function(e,t,a){e.exports={bar:"Components__bar--j7RcI",checkbox:"Components__checkbox--ZE5YW",formWrapper:"Components__formWrapper--3ytQ7",option:"Components__option--34g2-"}},3791:function(e,t,a){e.exports={wrapper:"Categories__wrapper--2dK7F",footer:"Categories__footer--1eOm_",content:"Categories__content--2nDIf",icon:"Categories__icon--2PXqS",text:"Categories__text--29dUS"}},3792:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(49),r=a(564),o=n(a(2517)),u=n(a(3793)),i=n(a(3798)),s=n(a(3805)),d=n(a(3806)),c=n(a(3807)),f=n(a(3808)),m="/projects/:namespace/".concat("s2ibuilders","/:name"),p=[{name:"records",title:"Excute Records",component:i.default},{name:"resource-status",title:"Resource Status",component:s.default},{name:"image-artifacts",title:"Image Artifacts",component:f.default},{name:"env",title:"Environment Variables",component:d.default},{name:"events",title:"Events",component:c.default}],h=[{path:m,component:(0,l.withProps)(o.default,{module:"s2ibuilders",component:u.default,breadcrumbs:[{label:"Project",url:"/projects/:namespace"},{label:"Image Builder",url:"/projects/:namespace/".concat("s2ibuilders")}]}),ksModule:"devops",routes:(0,r.getChildRoutes)(p,m)}];t.default=h},3793:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(61)),u=l(n(37)),i=l(n(62)),s=l(n(13)),d=l(n(14)),c=l(n(17)),f=l(n(16)),m=l(n(18)),p=l(n(0)),h=n(19),v=n(60),g=l(n(22)),y=l(n(58)),E=n(49),b=l(n(948)),_=l(n(967)),S=l(n(2634)),k=n(564),C=l(n(129)),w=l(n(2520)),N=l(n(2526)),T=l(n(3794)),P=l(n(3796)),M=l(n(3797)),R=(0,v.inject)("rootStore")(r=(0,v.observer)(r=function(e){function a(){var e,n;(0,s.default)(this,a);for(var l=arguments.length,r=new Array(l),d=0;d<l;d++)r[d]=arguments[d];return(n=(0,c.default)(this,(e=(0,f.default)(a)).call.apply(e,[this].concat(r)))).state={editBaseInfo:!1,viewYaml:!1,deleteModule:!1},n.fetchData=function(){var e=(0,i.default)(o.default.mark((function e(t){var a,l;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.store.fetchDetail){e.next=9;break}return e.next=3,n.store.fetchDetail(n.params,t).catch(n.catch);case 3:return a=e.sent,e.next=6,n.s2iRunStore.fetchRunDetail((0,u.default)({},n.params,{runName:(0,g.default)(a,"status.lastRunName","")}));case 6:return l=e.sent,e.next=9,n.s2iRunStore.fetchJobDetail((0,u.default)({},n.params,{name:(0,g.default)(l,"_originData.status.kubernetesJobName","")}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.getOperations=function(){return[{key:"reRun",text:t("Rerun"),action:"edit",type:"control",onClick:n.showModal("reRun")},{key:"edit",icon:"pen",text:t("EDIT"),action:"edit",onClick:n.showModal("editBaseInfo")},{key:"viewYaml",icon:"eye",text:t("View YAML"),action:"view",onClick:n.showModal("viewYaml")},{key:"editYaml",icon:"pen",text:t("Edit YAML"),action:"edit",onClick:n.showModal("editYaml")},{key:"delete",icon:"trash",text:t("Delete"),action:"delete",onClick:n.showModal("deleteModule")}]},n.getAttrs=function(){var e=(0,h.toJS)(n.store.detail),a=e.spec,l=void 0===a?{}:a,r=(0,g.default)(l,"config.isBinaryURL",""),o=n.s2iRunStore.runDetail.binaryName,u=(0,g.default)(l,"config.sourceUrl",""),i=(0,g.default)((0,E.parseUrl)(u),"pathname","/".concat(u)),s="".concat(window.location.protocol,"//").concat(window.location.host,"/b2i_download").concat(i);return[{name:t("Name"),value:e.name},{name:t("Project"),value:n.namespace},{name:t("type"),value:t(e.type)},{name:t("BuilderImage"),value:(0,g.default)(l,"config.builderImage","-")},{name:t("imageName"),value:(0,g.default)(l,"config.imageName","-")},{name:t("BuilderPullPolicy"),value:(0,g.default)(l,"config.builderPullPolicy","-")},{name:t("SourceUrl"),value:r?p.default.createElement("a",{href:s,download:!0},o):u},{name:t("Created Time"),value:n.createTime},{name:t("Creator"),value:e.creator}]},n.handleRerun=function(e){n.store.updateBuilder(e,n.params).then((function(){n.fetchData(),n.setState({reRun:!1,editYaml:!1})}))},n}return(0,m.default)(a,e),(0,d.default)(a,[{key:"init",value:function(){this.store=new b.default(this.module),this.resourceStore=new S.default(this.module),this.s2iRunStore=new _.default}},{key:"renderSubView",value:function(){var e=this.props.route;return this.store.isLoading||this.s2iRunStore.isLoading?p.default.createElement("div",{className:M.default.loading},p.default.createElement(C.default,null)):(0,k.renderRoutes)(e.routes,(0,u.default)({},this.baseProps,this.getRouteProps()))}},{key:"renderExtraModals",value:function(){var e=this.store,t=e.detail,a=void 0===t?{}:t,n=e.isSubmitting,l=this.state,r=l.editBaseInfo,o=l.viewYaml,u=l.reRun,i=l.editYaml;return p.default.createElement("div",null,p.default.createElement(P.default,{visible:r,detail:a,onOk:this.handleEdit("editBaseInfo"),onCancel:this.hideModal("editBaseInfo"),isSubmitting:n}),p.default.createElement(N.default,{readOnly:!0,visible:o,detail:(0,h.toJS)(a._originData),onCancel:this.hideModal("viewYaml")}),p.default.createElement(N.default,{visible:i,detail:(0,h.toJS)(a._originData),onCancel:this.hideModal("editYaml"),onOk:this.handleRerun}),p.default.createElement(T.default,{detail:a._originData,visible:u,isSubmitting:n,onOk:this.handleRerun,onCancel:this.hideModal("reRun")}))}},{key:"module",get:function(){return"s2ibuilders"}},{key:"name",get:function(){return"s2ibuilders"}},{key:"selectors",get:function(){var e=this.store.detail.spec,t=void 0===e?{}:e,a=(0,g.default)(t,"selector.matchLabels",{});return(0,y.default)(a)?"-":p.default.createElement("span",null,Object.keys(a).map((function(e){return"".concat(e," = ").concat(a[e])})).join(", "))}},{key:"labels",get:function(){var e=(0,g.default)(this.store.detail,"labels",{});return e.tag=(0,g.default)(this.store.detail,"spec.config.tag",""),e}},{key:"updateTime",get:function(){var e=(0,g.default)(this.store.detail,"status.conditions",[]);if((0,y.default)(e))return"-";var t=new Date((0,g.default)(e,"[0].lastTransitionTime",0)).valueOf();return e.forEach((function(e){var a=e.lastTransitionTime,n=new Date(a).valueOf();n>t&&(t=n)})),(0,E.getLocalTime)(t).format("YYYY-MM-DD HH:mm:ss")}}]),a}(w.default))||r)||r;a.default=R},3794:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(1)),f=l(n(22)),m=l(n(115)),p=l(n(387)),h=l(n(267)),v=l(n(2602)),g=l(n(2633)),y=l(n(2671)),E=l(n(3795)),b=function(e){function a(e){var n;return(0,r.default)(this,a),(n=(0,u.default)(this,(0,i.default)(a).call(this,e))).handleOk=function(){var e=n.props,t=e.onOk,a=e.detail;a&&((0,f.default)(a,"metadata.annotations['devops.kubesphere.io/donotautoscale']")&&(0,m.default)(a,"metadata.annotations['devops.kubesphere.io/donotautoscale']","true"),n.content.current.validate((function(){t(a)})))},n.renderEnableUpdate=function(){var e=n.props.detail;return(0,f.default)(e,"metadata.annotations.serviceName")?d.default.createElement("div",{className:E.default.checkboxCard},d.default.createElement("label",null,d.default.createElement(h.default.Item,null,d.default.createElement(v.default,{name:"isUpdateWorkload",defaultValue:!0},d.default.createElement("span",{name:!0,className:E.default.title},t("S2I_UPDATE_WORKLOAD"))))),d.default.createElement("p",{className:E.default.desc},t("S2I_UPDATA_WORKLOAD_DESC"))):null},n.form=d.default.createRef(),n.content=d.default.createRef(),n}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props,a=e.visible,n=e.isSubmitting,l=e.onCancel,r=e.detail,o=(0,f.default)(r,"spec.config.isBinaryURL");return d.default.createElement(p.default.Form,{formRef:this.form,width:691,title:t("Rerun"),icon:"cdn",onOk:this.handleOk,okText:t("Rerun"),onCancel:l,visible:a,data:r,isSubmitting:n},o?d.default.createElement(y.default,{formTemplate:r,formRef:this.content,mode:"edit"}):d.default.createElement(g.default,{formTemplate:r,formRef:this.content,mode:"edit"}),this.renderEnableUpdate())}}]),a}(d.default.Component);a.default=b,b.propTypes={visible:c.default.bool,onOk:c.default.func,onCancel:c.default.func,isSubmitting:c.default.bool},b.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1}},3795:function(e,t,a){e.exports={checkboxCard:"RerunForm__checkboxCard--3Y2ty",title:"RerunForm__title--3ATnn",desc:"RerunForm__desc--rnfyY"}},3796:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(22)),c=l(n(115)),f=l(n(0)),m=l(n(1)),p=l(n(386)),h=l(n(387)),v=l(n(267)),g=function(e){function a(e){var t;return(0,r.default)(this,a),(t=(0,u.default)(this,(0,i.default)(a).call(this,e))).handleOk=function(){var e=t.props.onOk;if(t.form){var a=(t.form.current||{}).getData(),n={apiVersion:"devops.kubesphere.io/v1alpha1",kind:"S2iBuilder"};Object.keys(t.mapper).forEach((function(e){(0,c.default)(n,t.mapper[e],a[e])})),e(n)}},t.form=f.default.createRef(),t}return(0,s.default)(a,e),(0,o.default)(a,[{key:"render",value:function(){var e=this.props,a=e.detail,n=e.visible,l=e.isSubmitting,r=e.onCancel,o=(0,d.default)(a,"aliasName");return f.default.createElement(h.default.Form,{formRef:this.form,data:a,width:691,title:t("Edit Info"),icon:"pen",onOk:this.handleOk,okText:t("Update"),onCancel:r,visible:n,isSubmitting:l},f.default.createElement(v.default.Item,{label:t("Name"),desc:t("NAME_DESC")},f.default.createElement(p.default,{name:"name",disabled:!0})),f.default.createElement(v.default.Item,{label:t("Alias"),desc:t("ALIAS_DESC")},f.default.createElement(p.default,{name:"displayName",defaultValue:o})))}},{key:"mapper",get:function(){return{name:"metadata.name",displayName:"spec.config.displayName"}}}]),a}(f.default.Component);a.default=g,g.propTypes={detail:m.default.object,visible:m.default.bool,onOk:m.default.func,onCancel:m.default.func,isSubmitting:m.default.bool},g.defaultProps={visible:!1,onOk:function(){},onCancel:function(){},isSubmitting:!1}},3797:function(e,t,a){e.exports={loading:"Detail__loading--17hUP",modalInfo:"Detail__modalInfo--3dhNr"}},3798:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=l(n(22)),m=n(60),p=l(n(3799)),h=l(n(2860)),v=l(n(3804)),g=(0,m.inject)("rootStore")(r=(0,m.observer)(r=function(e){function a(){return(0,o.default)(this,a),(0,i.default)(this,(0,s.default)(a).apply(this,arguments))}return(0,d.default)(a,e),(0,u.default)(a,[{key:"render",value:function(){var e=this.props.match.params,a=this.props.s2iRunStore.runDetail;return c.default.createElement(c.default.Fragment,null,c.default.createElement("div",{className:v.default.title},t("Last build environment")),c.default.createElement("div",{className:v.default.card},c.default.createElement(p.default,{isB2i:this.isB2i,runDetail:a})),c.default.createElement("div",{className:v.default.title},t("Jobs Records")),c.default.createElement("div",{className:v.default.card},c.default.createElement(h.default,{isB2i:this.isB2i,params:e})))}},{key:"store",get:function(){return this.props.detailStore}},{key:"isB2i",get:function(){return(0,f.default)(this.store.detail,"spec.config.isBinaryURL")}}]),a}(c.default.Component))||r)||r;a.default=g},3799:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(n(13)),o=l(n(14)),u=l(n(17)),i=l(n(16)),s=l(n(18)),d=l(n(0)),c=l(n(3)),f=l(n(38)),m=l(n(22)),p=n(49),h=l(n(3800)),v=function(e){function a(){return(0,r.default)(this,a),(0,u.default)(this,(0,i.default)(a).apply(this,arguments))}return(0,s.default)(a,e),(0,o.default)(a,[{key:"renderB2i",value:function(){var e=this.props.className,a=this.props.runDetail,n=a.builderImage,l=a.sourceUrl,r=a.binaryName,o=a.binarySize,u=(0,m.default)((0,p.parseUrl)(l),"pathname","/".concat(l)),i="".concat(window.location.protocol,"//").concat(window.location.host,"/b2i_download").concat(u);return d.default.createElement("ul",{className:(0,c.default)(h.default.builderContent,e)},d.default.createElement("li",null,d.default.createElement("span",{className:h.default.icon},d.default.createElement(f.default,{name:(0,p.getLanguageName)(n),size:40})),d.default.createElement("div",{className:h.default.info},d.default.createElement("p",{className:h.default.value},n),d.default.createElement("p",{className:h.default.name},t("builderImage")))),d.default.createElement("li",null,d.default.createElement("span",{className:h.default.icon},d.default.createElement(f.default,{name:"resource",size:40})),d.default.createElement("div",{className:h.default.info},d.default.createElement("p",{className:h.default.value},r),d.default.createElement("p",{className:h.default.name},d.default.createElement("a",{href:i,download:!0},"".concat(t("File Size"),": ").concat((0,p.formatSize)(o)))))))}},{key:"render",value:function(){var e=this.props,a=e.className;if(e.isB2i)return this.renderB2i();var n=this.props.runDetail,l=n.sourceUrl,r=n.builderImage,o=n.revisionId;return d.default.createElement("ul",{className:(0,c.default)(h.default.builderContent,a)},d.default.createElement("li",null,d.default.createElement("span",{className:h.default.icon,style:{backgroundImage:"url('/assets/".concat((0,p.getLanguageName)(r),".png')")}}),d.default.createElement("div",{className:h.default.info},d.default.createElement("p",{className:h.default.value},r),d.default.createElement("p",{className:h.default.name},t("builderImage")))),d.default.createElement("li",null,d.default.createElement("span",{className:h.default.icon},d.default.createElement(f.default,{name:"resource",size:40})),d.default.createElement("div",{className:h.default.info},d.default.createElement("p",{className:h.default.value},l),d.default.createElement("p",{className:h.default.name},t("sourceUrl")))),d.default.createElement("li",null,d.default.createElement(f.default,{name:"branch",className:h.default.icon}),d.default.createElement("div",{className:h.default.info},d.default.createElement("p",{className:h.default.value},o||"master"),d.default.createElement("p",{className:h.default.name},t("Branch")))))}}]),a}(d.default.Component);a.default=v},3800:function(e,t,a){e.exports={builderContent:"ImageBuilderLastRun__builderContent--BkSp1",icon:"ImageBuilderLastRun__icon--Hd8bC",info:"ImageBuilderLastRun__info--2WqRt",value:"ImageBuilderLastRun__value--J0OCu",name:"ImageBuilderLastRun__name--2czgy"}},3801:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(30)),u=l(n(61)),i=l(n(62)),s=l(n(13)),d=l(n(14)),c=l(n(17)),f=l(n(16)),m=l(n(18)),p=l(n(0)),h=l(n(3)),v=n(60),g=l(n(22)),y=l(n(38)),E=l(n(129)),b=l(n(227)),_=l(n(2521)),S=l(n(224)),k=n(49),C=l(n(3802)),w=(0,v.observer)(r=function(e){function a(e){var n;return(0,s.default)(this,a),(n=(0,c.default)(this,(0,f.default)(a).call(this,e))).toggleShowLog=function(){var e=n.state.showLog;e?clearTimeout(n.refreshTimer):n.getLog(),n.setState({showLog:!e})},n.getLog=(0,i.default)(u.default.mark((function e(){var t,a,l,r,o;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props.runDetail,a=t.logURL,l=t.status,r=n.store.logData,o="Building"===l||"Unknown"===l,clearTimeout(n.refreshTimer),a){e.next=7;break}return n.refreshTimer=setTimeout(n.getLog,4e3),e.abrupt("return");case 7:if(!globals.app.hasKSModule("logging")){e.next=12;break}return e.next=10,n.store.getLog(a);case 10:e.next=14;break;case 12:return e.next=14,n.store.fetchPodsLogs(a);case 14:if(n.handleScrollToBottom(),!r.hasMore){e.next=18;break}return n.getLog(),e.abrupt("return");case 18:o&&(n.refreshTimer=setTimeout(n.getLog,4e3));case 19:case"end":return e.stop()}}),e)}))),n.handleScrollToBottom=function(){var e=n.LogContent.current;e&&(e.scrollTop=e.scrollHeight)},n.showLog=function(){n.setState({showLog:!0})},n.stopPropagation=function(e){e&&e.stopPropagation()},n.handleDownload=function(){var e=n.props.runDetail.sourceUrl,t=(0,g.default)((0,k.parseUrl)(e),"pathname","/".concat(e)),a="".concat(window.location.protocol,"//").concat(window.location.host,"/b2i_download").concat(t);window.open(a)},n.renderLog=function(){var e=n.store.logData,a=e.log,l=e.isLoading;return n.state.showLog?l?p.default.createElement("div",{className:C.default.logContent,onClick:n.stopPropagation},p.default.createElement(E.default,null)):p.default.createElement("div",{className:C.default.logContent,onClick:n.stopPropagation},p.default.createElement("pre",{ref:n.LogContent},a||t("Log is loading..."))):null},n.renderDetailInfo=function(){var e=n.props.runDetail,a=e.imageName,l=e.branch,r=e.binaryName,o=e.binarySize;if(!n.props.isB2i)return p.default.createElement("span",{className:C.default.branchName},p.default.createElement(y.default,{name:"branch"}),p.default.createElement("span",null,l||"master"));var u=p.default.createElement("div",{className:C.default.artifactContent},p.default.createElement("p",{className:C.default.title},"制品文件"),p.default.createElement("div",{className:C.default.info},p.default.createElement(y.default,{name:"file"}),p.default.createElement("p",null,r," ",p.default.createElement("span",null,(0,k.formatSize)(o)))),p.default.createElement("div",{className:C.default.info},p.default.createElement(y.default,{name:"templet"}),p.default.createElement("p",null,a)),p.default.createElement(S.default,{onClick:n.handleDownload,type:"primary"},t("Download Artifact")));return p.default.createElement(b.default,{className:C.default.tooltip,content:u,trigger:"hover"},p.default.createElement(y.default,{name:"file"}))},n.state={showLog:!1},n.LogContent=p.default.createRef(),n.store=e.store,n}return(0,m.default)(a,e),(0,d.default)(a,[{key:"componentWillUnmount",value:function(){clearTimeout(this.refreshTimer)}},{key:"render",value:function(){var e=this.props.runDetail,a=e.count,n=e.status,l=e.imageName,r=e.startTime,u=e.name;return this.props.loading?null:p.default.createElement("ul",{className:(0,h.default)(C.default.item,(0,o.default)({},C.default.active,this.state.showLog)),onClick:this.toggleShowLog},p.default.createElement("li",null,p.default.createElement("div",{className:C.default.value},"#",a," ",this.renderDetailInfo()),p.default.createElement("div",{className:C.default.label},t("Build Times"))),p.default.createElement("li",null,p.default.createElement("div",{className:C.default.value},p.default.createElement(_.default,{className:C.default.status,type:n,name:t(t(n)),flicker:!0})),p.default.createElement("div",{className:C.default.label},t("Status"))),p.default.createElement("li",null,p.default.createElement("div",{className:C.default.value},l),p.default.createElement("div",{className:C.default.label},t("ImageName"))),p.default.createElement("li",null,p.default.createElement("div",{className:C.default.value},(0,k.getLocalTime)(r).format("YYYY-MM-DD HH:mm:ss")),p.default.createElement("div",{className:C.default.label},t("StartTime"))),p.default.createElement("li",null,p.default.createElement("div",{className:C.default.value},t("".concat(t("Image"),": ").concat(u," ").concat(t("S2I_".concat(n))))),p.default.createElement("div",{className:C.default.label},t("Last Message"))),p.default.createElement(y.default,{className:C.default.icon,name:"chevron-down"}),this.renderLog())}}]),a}(p.default.Component))||r;a.default=w},3802:function(e,t,a){e.exports={item:"Item__item--3elQc",value:"Item__value--3T4SM",status:"Item__status--3SKf3",label:"Item__label--oc_0Y",icon:"Item__icon--1KE-W",branchName:"Item__branchName--3mBN7",active:"Item__active--AkkmS",logContent:"Item__logContent--x1_td",tooltip:"Item__tooltip--3YH0x",artifactContent:"Item__artifactContent--3IzWA",title:"Item__title--30zaQ",info:"Item__info--2KW1j"}},3803:function(e,t,a){e.exports={content:"ImageRunRecord__content--_1slg",header:"ImageRunRecord__header--33WAU",search:"ImageRunRecord__search--1R7RI",actions:"ImageRunRecord__actions--1IG1p"}},3804:function(e,t,a){e.exports={main:"BuildRecords__main--3cgE6",table:"BuildRecords__table--3j0UW",clickable:"BuildRecords__clickable--3h3Vp",content:"BuildRecords__content--1qU2s",title:"BuildRecords__title--uMJf_",card:"BuildRecords__card--_iGPp"}},3805:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r=n(a(13)),o=n(a(14)),u=n(a(17)),i=n(a(16)),s=n(a(18)),d=n(a(0)),c=a(60),f=n(a(22)),m=a(2611),p=n(a(2588)),h=n(a(129)),v=(0,c.observer)(l=function(e){function t(){return(0,r.default)(this,t),(0,u.default)(this,(0,i.default)(t).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"renderPods",value:function(){var e=this.props.match.params,t=(void 0===e?{}:e).namespace,a=this.store.jobDetail,n=(0,f.default)(a,"name");return d.default.createElement(p.default,{prefix:"/projects/".concat(t,"/jobs/").concat(n),detail:this.store.jobDetail})}},{key:"renderContent",value:function(){return this.store.isLoading?d.default.createElement(h.default,null):d.default.createElement("div",null,this.renderContainerPorts(),this.renderPods(),this.renderVolumes())}},{key:"store",get:function(){return this.props.s2iRunStore}}]),t}(m.Component))||l;t.default=v},3806:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.Component=t.default=void 0;var l=n(a(13)),r=n(a(14)),o=n(a(17)),u=n(a(16)),i=n(a(18)),s=n(a(0)),d=a(19),c=a(60),f=n(a(58)),m=n(a(22)),p=n(a(2720)),h=n(a(2721)),v=function(e){function t(e){var a;return(0,l.default)(this,t),(a=(0,o.default)(this,(0,u.default)(t).call(this,e))).fetchData=function(){a.envStore.fetchList({namespace:a.namespace,containers:a.containers})},a.envStore=new p.default,a}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e=(0,d.toJS)(this.envStore.list),t=e.data,a=e.isLoading;return s.default.createElement("div",null,t.map((function(e,t){return s.default.createElement(h.default,{key:t,detail:e,expand:0===t,loading:a})})))}},{key:"module",get:function(){return this.props.module}},{key:"store",get:function(){return this.props.s2iRunStore}},{key:"namespace",get:function(){return this.store.jobDetail.namespace}},{key:"containers",get:function(){var e=(0,d.toJS)(this.store.jobDetail),t=e.spec,a=e.containers,n=void 0===a?[]:a;return"containers"===this.module?[e]:(0,f.default)(n)?(0,f.default)(t)?[]:(0,m.default)(t,"template.spec.containers",[]):n}},{key:"test",get:function(){return"2"}}]),t}(s.default.Component),g=(0,c.inject)("rootStore")((0,c.observer)(v));t.default=g;var y=v;t.Component=y},3807:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.Component=t.default=void 0;var l=n(a(13)),r=n(a(14)),o=n(a(17)),u=n(a(16)),i=n(a(18)),s=n(a(0)),d=a(19),c=a(60),f=a(49),m=n(a(2722)),p=n(a(2723)),h=function(e){function t(e){var a;return(0,l.default)(this,t),(a=(0,o.default)(this,(0,u.default)(t).call(this,e))).fetchData=function(){var e=a.store.jobDetail,t=e.uid,n={"involvedObject.name":e.name,"involvedObject.namespace":e.namespace,"involvedObject.kind":"Job","involvedObject.uid":t};a.eventStore.fetchList({namespace:a.namespace,fieldSelector:(0,f.joinSelector)(n)})},a.eventStore=new m.default,a.fetchData(),a}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=(0,d.toJS)(this.eventStore.list),t=e.data,a=e.isLoading;return s.default.createElement(p.default,{data:t,loading:a})}},{key:"store",get:function(){return this.props.s2iRunStore}},{key:"namespace",get:function(){return this.store.jobDetail.namespace}}]),t}(s.default.Component),v=(0,c.inject)("rootStore")((0,c.observer)(h));t.default=v;var g=h;t.Component=g},3808:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=n(60),m=l(n(2516)),p=l(n(3809)),h=l(n(3812)),v=(0,f.inject)("rootStore")(r=(0,f.observer)(r=function(e){function a(){return(0,o.default)(this,a),(0,i.default)(this,(0,s.default)(a).apply(this,arguments))}return(0,d.default)(a,e),(0,u.default)(a,[{key:"render",value:function(){var e=this.props.match.params;return c.default.createElement(m.default,{className:h.default.main,title:t("Image Artifacts")},c.default.createElement(p.default,{params:e}))}}]),a}(c.default.Component))||r)||r;a.default=v},3809:function(e,t,a){"use strict";var n=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,r=n(a(61)),o=n(a(37)),u=n(a(62)),i=n(a(13)),s=n(a(14)),d=n(a(17)),c=n(a(16)),f=n(a(18)),m=n(a(0)),p=a(60),h=n(a(2860)),v=n(a(3810)),g=(0,p.observer)(l=function(e){function t(){var e,a;(0,i.default)(this,t);for(var n=arguments.length,l=new Array(n),s=0;s<n;s++)l[s]=arguments[s];return(a=(0,d.default)(this,(e=(0,c.default)(t)).call.apply(e,[this].concat(l)))).fetchData=(0,u.default)(r.default.mark((function e(){var t,n,l,u,i=arguments;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},n=a.props,l=n.limit,(u=n.params).status="Successful",e.next=5,a.store.fetchS2IRunRecords((0,o.default)({limit:l},u,t));case 5:a.setAutoRefresh();case 6:case"end":return e.stop()}}),e)}))),a}return(0,f.default)(t,e),(0,s.default)(t,[{key:"renderItem",value:function(e){var t=this.store.list.isLoading;return m.default.createElement(v.default,{key:e.name,runDetail:e,loading:t,store:this.store})}}]),t}(h.default))||l;t.default=g},3810:function(e,a,n){"use strict";var l=n(4);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,o=l(n(13)),u=l(n(14)),i=l(n(17)),s=l(n(16)),d=l(n(18)),c=l(n(0)),f=n(60),m=n(49),p=l(n(38)),h=n(2503),v=l(n(388)),g=l(n(3811)),y=(0,f.observer)(r=function(e){function a(){var e,n;(0,o.default)(this,a);for(var l=arguments.length,r=new Array(l),u=0;u<l;u++)r[u]=arguments[u];return(n=(0,i.default)(this,(e=(0,s.default)(a)).call.apply(e,[this].concat(r)))).handleCopy=function(){v.default.success({content:t("Copy Successfully")})},n}return(0,d.default)(a,e),(0,u.default)(a,[{key:"render",value:function(){var e=this.props.runDetail,a=e.imageName,n=e.imageCreated,l=e.imageSize,r=e.commandPull;return this.props.loading?null:c.default.createElement("ul",{className:g.default.item},c.default.createElement(p.default,{name:"cdn",size:40}),c.default.createElement("li",null,c.default.createElement("div",{className:g.default.value},a),c.default.createElement("div",{className:g.default.label},t("ImageName"))),c.default.createElement("li",null,c.default.createElement("div",{className:g.default.value},(0,m.formatSize)(l)),c.default.createElement("div",{className:g.default.label},t("Image Size"))),c.default.createElement("li",null,c.default.createElement("div",{className:g.default.value},r,c.default.createElement(h.CopyToClipboard,{text:r,onCopy:this.handleCopy},c.default.createElement(p.default,{className:g.default.copyIcon,name:"copy",changeable:!0}))),c.default.createElement("div",{className:g.default.label},t("Pull Command"))),c.default.createElement("li",null,c.default.createElement("div",{className:g.default.value},(0,m.getLocalTime)(n).format("YYYY-MM-DD HH:mm:ss")),c.default.createElement("div",{className:g.default.label},t("Publish Time"))))}}]),a}(c.default.Component))||r;a.default=y},3811:function(e,t,a){e.exports={item:"Item__item--1c8i_",value:"Item__value--25Hi7",status:"Item__status--3SFV9",label:"Item__label--2pyps",icon:"Item__icon--2e4Tf",copyIcon:"Item__copyIcon--1HwMm"}},3812:function(e,t,a){e.exports={table:"ImageProduct__table--JkzBF"}}}]);